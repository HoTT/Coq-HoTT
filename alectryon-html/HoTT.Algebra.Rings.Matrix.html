<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Matrix.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk0"><span class="kn">Require Import</span> Basics.Overture Basics.Trunc Basics.Tactics Basics.Decidable.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Types.Sigma.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Spaces.List.Core Spaces.List.Theory Spaces.List.Paths.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Algebra.Rings.Ring Algebra.Rings.<span class="kn">Module</span> <span class="nf">Algebra</span>.Rings.CRing
  Algebra.Rings.KroneckerDelta Algebra.Rings.Vector.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> abstract_algebra.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> WildCat.Core WildCat.Paths.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Modalities.ReflectiveSubuniverse.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Universe Minimization ToSet</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Matrices *)</span>

<span class="sd">(** ** Definition *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Matrix</span>@{i} (R : <span class="kt">Type</span>@{i}) (m n : nat) : <span class="kt">Type</span>@{i}
  := Vector (Vector R n) m.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">istrunc_matrix</span> (<span class="nv">R</span> : <span class="kt">Type</span>) <span class="nv">k</span> `{IsTrunc k.+<span class="mi">2</span> R} m n
  : IsTrunc k.+<span class="mi">2</span> (Matrix R m n)
  := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Building a matrix from a function that takes row and column indices. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1"><span class="kn">Definition</span> <span class="nf">Build_Matrix</span> (<span class="nv">R</span> : <span class="kt">Type</span>) (<span class="nv">m</span> <span class="nv">n</span> : nat)
  (<span class="nv">M_fun</span> : <span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">j</span> : nat), (i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R)
  : Matrix R m n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M_fun</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
(i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Matrix R m n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M_fun</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
(i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Matrix R m n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk3">snapply Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M_fun</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
(i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : nat, (i &lt; m)%nat -&gt; Vector R n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk4"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M_fun</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
(i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector R n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk5">snapply Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M_fun</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
(i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> : nat, (i &lt; n)%nat -&gt; R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk6"><span class="nb">intros</span> j Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M_fun</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
(i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (M_fun i j Hi Hj).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The length conditions here are decidable so can be inferred in proofs. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk7"><span class="kn">Definition</span> <span class="nf">Build_Matrix&#39;</span> (<span class="nv">R</span> : <span class="kt">Type</span>) (<span class="nv">m</span> <span class="nv">n</span> : nat)
  (<span class="nv">l</span> : list (list R))
  (<span class="nv">wf_row</span> : length l = m)
  (<span class="nv">wf_col</span> : for_all (<span class="kr">fun</span> <span class="nv">row</span> =&gt; length row = n) l)
  : Matrix R m n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Matrix R m n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Matrix R m n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk9">snrefine (_; _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list (Vector R n)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chka" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><label class="goal-separator" for="matrix-v-chka"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">l</span> : list (Vector R n) =&gt; length l = m) <span class="nl">?proj1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list (Vector R n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc">snapply list_sigma.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list (list R)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chkd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><label class="goal-separator" for="matrix-v-chkd"><hr></label><div class="goal-conclusion">for_all (<span class="kr">fun</span> <span class="nv">x</span> : list R =&gt; length x = n) <span class="nl">?l</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list (list R)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkf">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">for_all (<span class="kr">fun</span> <span class="nv">x</span> : list R =&gt; length x = n) l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> wf_col.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk10">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>list (list R)</span></span></span><br><span><var>wf_row</var><span class="hyp-type"><b>: </b><span>length l = m</span></span></span><br><span><var>wf_col</var><span class="hyp-type"><b>: </b><span>for_all (<span class="kr">fun</span> <span class="nv">row</span> : list R =&gt; length row = n)
  l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">l</span> : list (Vector R n) =&gt; length l = m)
  (list_sigma (<span class="kr">fun</span> <span class="nv">x</span> : list R =&gt; length x = n) l
     wf_col)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> lhs napply length_list_sigma.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">entries</span>@{i|} {R : <span class="kt">Type</span>@{i}} {m n} (M : Matrix R m n)
  : list (list R)
  := list_map@{i i} pr1 (pr1 M).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The entry at row [i] and column [j] of a matrix [M]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">entry</span> {<span class="nv">R</span> : <span class="kt">Type</span>} {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">M</span> : Matrix R m n) (<span class="nv">i</span> <span class="nv">j</span> : nat)
  {<span class="nv">H1</span> : (i &lt; m)%nat} {<span class="nv">H2</span> : (j &lt; n)%nat}
  : R
  := Vector.entry (Vector.entry M i) j.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Mapping a function on all the entries of a matrix. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_map</span> {<span class="nv">R</span> <span class="nv">S</span> : <span class="kt">Type</span>} {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">f</span> : R -&gt; S)
  : Matrix R m n -&gt; Matrix S m n
  := <span class="kr">fun</span> <span class="nv">M</span> =&gt; Build_Matrix S m n (<span class="kr">fun</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; f (entry M i j)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_map2</span> {<span class="nv">R</span> <span class="nv">S</span> <span class="nv">T</span> : <span class="kt">Type</span>} {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">f</span> : R -&gt; S -&gt; T)
  : Matrix R m n -&gt; Matrix S m n -&gt; Matrix T m n
  := <span class="kr">fun</span> <span class="nv">M</span> <span class="nv">N</span> =&gt; Build_Matrix T m n
    (<span class="kr">fun</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; f (entry M i j) (entry N i j)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The [(i, j)]-entry of [Build_Matrix R m n M_fun] is [M_fun i j]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk11"><span class="kn">Definition</span> <span class="nf">entry_Build_Matrix</span> {<span class="nv">R</span> : <span class="kt">Type</span>} {<span class="nv">m</span> <span class="nv">n</span>}
  (<span class="nv">M_fun</span> : <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span>, (i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R)
  (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">H1</span> : (i &lt; m)%nat) (<span class="nv">H2</span> : (j &lt; n)%nat)
  : entry (Build_Matrix R m n M_fun) i j = M_fun i j _ _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M_fun</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
(i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (Build_Matrix R m n M_fun) i j = M_fun i j H1 H2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk12"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M_fun</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
(i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (Build_Matrix R m n M_fun) i j = M_fun i j H1 H2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk13"><span class="nb">unfold</span> entry.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M_fun</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
(i &lt; m)%nat -&gt; (j &lt; n)%nat -&gt; R</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector.entry
  (Vector.entry (Build_Matrix R m n M_fun) i) j =
M_fun i j H1 H2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Vector.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Two matrices are equal if all their entries are equal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk14"><span class="kn">Definition</span> <span class="nf">path_matrix</span> {<span class="nv">R</span> : <span class="kt">Type</span>} {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">M</span> <span class="nv">N</span> : Matrix R m n)
  (<span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> (<span class="nv">Hi</span> : (i &lt; m)%nat) (<span class="nv">Hj</span> : (j &lt; n)%nat), entry M i j = entry N i j)
  : M = N.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), entry M i j = entry N i j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">M = N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk15"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), entry M i j = entry N i j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">M = N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk16">snapply path_vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), entry M i j = entry N i j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">H</span> : (i &lt; m)%nat),
Vector.entry M i = Vector.entry N i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk17"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), entry M i j = entry N i j</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector.entry M i = Vector.entry N i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk18">snapply path_vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), entry M i j = entry N i j</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i0</span> : nat) (<span class="nv">H</span> : (i0 &lt; n)%nat),
Vector.entry (Vector.entry M i) i0 =
Vector.entry (Vector.entry N i) i0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk19"><span class="nb">intros</span> j Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), entry M i j = entry N i j</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector.entry (Vector.entry M i) j =
Vector.entry (Vector.entry N i) j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (H i j Hi Hj).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Addition and module structure *)</span>

<span class="sd">(** Here we define the abelian group of (n x m)-matrices over a ring. This follows from the abelian group structure of the underlying vectors. We are also able to derive a left module structure when the entries come from a left module. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">abgroup_matrix</span> (<span class="nv">A</span> : AbGroup) (<span class="nv">m</span> <span class="nv">n</span> : nat) : AbGroup
  := abgroup_vector (abgroup_vector A n) m.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_plus</span> {<span class="nv">A</span> : AbGroup} {<span class="nv">m</span> <span class="nv">n</span>}
  : Matrix A m n -&gt; Matrix A m n -&gt; Matrix A m n
  := @sg_op (abgroup_matrix A m n) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_zero</span> (<span class="nv">A</span> : AbGroup) <span class="nv">m</span> <span class="nv">n</span> : Matrix A m n
  := @mon_unit (abgroup_matrix A m n) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_negate</span> {<span class="nv">A</span> : AbGroup} {<span class="nv">m</span> <span class="nv">n</span>}
  : Matrix A m n -&gt; Matrix A m n
  := @negate (abgroup_matrix A m n) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1a"><span class="kn">Instance</span> <span class="nf">isleftmodule_isleftmodule_matrix</span> (<span class="nv">A</span> : AbGroup) (<span class="nv">m</span> <span class="nv">n</span> : nat)
  {<span class="nv">R</span> : Ring} `{IsLeftModule R A}
  : IsLeftModule R (abgroup_matrix A m n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsLeftModule R A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLeftModule R (abgroup_matrix A m n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsLeftModule R A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLeftModule R (abgroup_matrix A m n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1c">snapply isleftmodule_isleftmodule_vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsLeftModule R A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLeftModule R (abgroup_vector A n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d">snapply isleftmodule_isleftmodule_vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsLeftModule R A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLeftModule R A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** As a special case, we get the left module of matrices over a ring. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">isleftmodule_abgroup_matrix</span> (<span class="nv">R</span> : Ring) (<span class="nv">m</span> <span class="nv">n</span> : nat)
  : IsLeftModule R (abgroup_matrix R m n)
  := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_lact</span> {<span class="nv">R</span> : Ring} {<span class="nv">m</span> <span class="nv">n</span> : nat} (<span class="nv">r</span> : R) (<span class="nv">M</span> : Matrix R m n)
  : Matrix R m n
  := lact r M.</span><span class="alectryon-wsp">  
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Multiplication *)</span>

<span class="sd">(** Matrix multiplication is defined such that the entry at row [i] and column [j] of the resulting matrix is the sum of the products of the corresponding entries from the [i]th row of the first matrix and the [j]th column of the second matrix. Matrices correspond to module homomorphisms between free modules of finite rank (think vector spaces), and matrix multiplication represents the composition of these homomorphisms. **)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e"><span class="kn">Definition</span> <span class="nf">matrix_mult</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">m</span> <span class="nv">n</span> <span class="nv">k</span> : nat} (<span class="nv">M</span> : Matrix R m n) (<span class="nv">N</span> : Matrix R n k)
  : Matrix R m k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Matrix R m k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Matrix R m k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk20">snapply Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n k</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat, (i &lt; m)%nat -&gt; (j &lt; k)%nat -&gt; R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk21"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n k</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; k)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ab_sum n (<span class="kr">fun</span> <span class="nv">k</span> <span class="nv">Hk</span> =&gt; entry M i k * entry N k j)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The identity matrix is the matrix with ones on the diagonal and zeros elsewhere. It acts as the multiplicative identity for matrix multiplication. We define it here using the [kronecker_delta] function which will make proving properties about it conceptually easier later. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">identity_matrix</span> (<span class="nv">R</span> : Ring@{i}) (<span class="nv">n</span> : nat) : Matrix R n n
  := Build_Matrix R n n (<span class="kr">fun</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; kronecker_delta i j).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** This is the most general statement of associativity for matrix multiplication. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk22"><span class="kn">Definition</span> <span class="nf">associative_matrix_mult</span> (<span class="nv">R</span> : Ring) (<span class="nv">m</span> <span class="nv">n</span> <span class="nv">p</span> <span class="nv">q</span> : nat)
  : HeteroAssociative
      (@matrix_mult R m n q) (@matrix_mult R n p q)
      (@matrix_mult R m p q) (@matrix_mult R m n p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HeteroAssociative matrix_mult matrix_mult matrix_mult
  matrix_mult</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk23"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HeteroAssociative matrix_mult matrix_mult matrix_mult
  matrix_mult</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk24"><span class="nb">intros</span> M N P; napply path_matrix; <span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_mult M (matrix_mult N P)) i j =
entry (matrix_mult (matrix_mult M N) P) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk25"><span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry (matrix_mult N P) k j) =
ab_sum p
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; p)%nat) =&gt;
   entry (matrix_mult M N) i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk26">lhs napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry M i k * entry (matrix_mult N P) k j = <span class="nl">?Goal</span> k Hk</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk27" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk27"><hr></label><div class="goal-conclusion">ab_sum n <span class="nl">?Goal</span> =
ab_sum p
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; p)%nat) =&gt;
   entry (matrix_mult M N) i k * entry P k j)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk28">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry M i k * entry (matrix_mult N P) k j = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk29"><span class="nb">intros</span> k Hk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k * entry (matrix_mult N P) k j = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk2a"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k *
ab_sum p
  (<span class="kr">fun</span> (<span class="nv">k0</span> : nat) (<span class="nv">Hk0</span> : (k0 &lt; p)%nat) =&gt;
   entry N k k0 * entry P k0 j) = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> rng_sum_dist_l.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk2b">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   ab_sum p
     (<span class="kr">fun</span> (<span class="nv">k0</span> : nat) (<span class="nv">Hk0</span> : (k0 &lt; p)%nat) =&gt;
      entry M i k *
      (<span class="kr">fun</span> (<span class="nv">k1</span> : nat) (<span class="nv">Hk1</span> : (k1 &lt; p)%nat) =&gt;
       entry N k k1 * entry P k1 j) k0 Hk0)) =
ab_sum p
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; p)%nat) =&gt;
   entry (matrix_mult M N) i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk2c">lhs napply ab_sum_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum p
  (<span class="kr">fun</span> (<span class="nv">j0</span> : nat) (<span class="nv">Hj0</span> : (j0 &lt; p)%nat) =&gt;
   ab_sum n
     (<span class="kr">fun</span> (<span class="nv">i0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat) =&gt;
      entry M i i0 * (entry N i0 j0 * entry P j0 j))) =
ab_sum p
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; p)%nat) =&gt;
   entry (matrix_mult M N) i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk2d">rhs napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum p
  (<span class="kr">fun</span> (<span class="nv">j0</span> : nat) (<span class="nv">Hj0</span> : (j0 &lt; p)%nat) =&gt;
   ab_sum n
     (<span class="kr">fun</span> (<span class="nv">i0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat) =&gt;
      entry M i i0 * (entry N i0 j0 * entry P j0 j))) =
ab_sum p <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk2e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk2e"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; p)%nat),
entry (matrix_mult M N) i k * entry P k j = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk2f"><span class="mi">2</span>: <span class="nb">intros</span> k Hk; <span class="bp">by</span> <span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum p
  (<span class="kr">fun</span> (<span class="nv">j0</span> : nat) (<span class="nv">Hj0</span> : (j0 &lt; p)%nat) =&gt;
   ab_sum n
     (<span class="kr">fun</span> (<span class="nv">i0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat) =&gt;
      entry M i i0 * (entry N i0 j0 * entry P j0 j))) =
ab_sum p
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; p)%nat) =&gt;
   ab_sum n
     (<span class="kr">fun</span> (<span class="nv">k0</span> : nat) (<span class="nv">Hk0</span> : (k0 &lt; n)%nat) =&gt;
      entry M i k0 * entry N k0 k) * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk30">napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; p)%nat),
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat) =&gt;
   entry M i i0 * (entry N i0 k * entry P k j)) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k0</span> : nat) (<span class="nv">Hk0</span> : (k0 &lt; n)%nat) =&gt;
   entry M i k0 * entry N k0 k) * entry P k j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk31"><span class="nb">intros</span> k Hk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat) =&gt;
   entry M i i0 * (entry N i0 k * entry P k j)) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k0</span> : nat) (<span class="nv">Hk0</span> : (k0 &lt; n)%nat) =&gt;
   entry M i k0 * entry N k0 k) * entry P k j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk32">rhs napply rng_sum_dist_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat) =&gt;
   entry M i i0 * (entry N i0 k * entry P k j)) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k0</span> : nat) (<span class="nv">Hk0</span> : (k0 &lt; n)%nat) =&gt;
   entry M i k0 * entry N k0 k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk33">napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k0</span> : nat) (<span class="nv">Hk0</span> : (k0 &lt; n)%nat),
entry M i k0 * (entry N k0 k * entry P k j) =
entry M i k0 * entry N k0 k * entry P k j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk34"><span class="nb">intros</span> l Hl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p, q</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R p q</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; q)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; p)%nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>(l &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i l * (entry N l k * entry P k j) =
entry M i l * entry N l k * entry P k j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> associativity.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Matrix multiplication distributes over addition of matrices on the left. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk35"><span class="kn">Definition</span> <span class="nf">left_distribute_matrix_mult</span> (<span class="nv">R</span> : Ring) (<span class="nv">m</span> <span class="nv">n</span> <span class="nv">p</span> : nat)
  : LeftHeteroDistribute (@matrix_mult R m n p) matrix_plus matrix_plus.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftHeteroDistribute matrix_mult matrix_plus
  matrix_plus</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk36"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftHeteroDistribute matrix_mult matrix_plus
  matrix_plus</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk37"><span class="nb">intros</span> M N P; <span class="nb">apply</span> path_matrix; <span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N, P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_mult M (matrix_plus N P)) i j =
entry
  (matrix_plus (matrix_mult M N) (matrix_mult M P)) i
  j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk38"><span class="nb">rewrite</span> !entry_Build_Matrix, !entry_Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N, P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry (matrix_plus N P) k j) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry N k j) +
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk39"><span class="nb">change</span> (<span class="nl">?x</span> = <span class="nl">?y</span> + <span class="nl">?z</span>) <span class="kr">with</span> (x = sg_op y z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N, P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry (matrix_plus N P) k j) =
sg_op
  (ab_sum n
     (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
      entry M i k * entry N k j))
  (ab_sum n
     (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
      entry M i k * entry P k j))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk3a"><span class="nb">rewrite</span> &lt;- ab_sum_plus.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N, P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry (matrix_plus N P) k j) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   sg_op (entry M i k * entry N k j)
     (entry M i k * entry P k j))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk3b">napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N, P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry M i k * entry (matrix_plus N P) k j =
sg_op (entry M i k * entry N k j)
  (entry M i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk3c"><span class="nb">intros</span> k Hk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N, P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k * entry (matrix_plus N P) k j =
sg_op (entry M i k * entry N k j)
  (entry M i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk3d"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N, P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k *
(Vector.entry (Vector.entry N k) j +
 Vector.entry (Vector.entry P k) j) =
sg_op (entry M i k * entry N k j)
  (entry M i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> rng_dist_l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Matrix multiplication distributes over addition of matrices on the right. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk3e"><span class="kn">Definition</span> <span class="nf">right_distribute_matrix_mult</span> (<span class="nv">R</span> : Ring) (<span class="nv">m</span> <span class="nv">n</span> <span class="nv">p</span> : nat)
  : RightHeteroDistribute (@matrix_mult R m n p) matrix_plus matrix_plus.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightHeteroDistribute matrix_mult matrix_plus
  matrix_plus</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk3f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightHeteroDistribute matrix_mult matrix_plus
  matrix_plus</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk40"><span class="nb">intros</span> M N P; <span class="nb">apply</span> path_matrix; <span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_mult (matrix_plus M N) P) i j =
entry
  (matrix_plus (matrix_mult M P) (matrix_mult N P)) i
  j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk41"><span class="nb">rewrite</span> !entry_Build_Matrix, !entry_Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry (matrix_plus M N) i k * entry P k j) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry P k j) +
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry N i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk42"><span class="nb">change</span> (<span class="nl">?x</span> = <span class="nl">?y</span> + <span class="nl">?z</span>) <span class="kr">with</span> (x = sg_op y z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry (matrix_plus M N) i k * entry P k j) =
sg_op
  (ab_sum n
     (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
      entry M i k * entry P k j))
  (ab_sum n
     (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
      entry N i k * entry P k j))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk43"><span class="nb">rewrite</span> &lt;- ab_sum_plus.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry (matrix_plus M N) i k * entry P k j) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   sg_op (entry M i k * entry P k j)
     (entry N i k * entry P k j))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk44">napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry (matrix_plus M N) i k * entry P k j =
sg_op (entry M i k * entry P k j)
  (entry N i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk45"><span class="nb">intros</span> k Hk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_plus M N) i k * entry P k j =
sg_op (entry M i k * entry P k j)
  (entry N i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk46"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Vector.entry (Vector.entry M i) k +
 Vector.entry (Vector.entry N i) k) * entry P k j =
sg_op (entry M i k * entry P k j)
  (entry N i k * entry P k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> rng_dist_r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The identity matrix acts as a left identity for matrix multiplication. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk47"><span class="kn">Definition</span> <span class="nf">left_identity_matrix_mult</span> (<span class="nv">R</span> : Ring) (<span class="nv">m</span> <span class="nv">n</span>: nat)
  : LeftIdentity (@matrix_mult R m m n) (identity_matrix R m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftIdentity matrix_mult (identity_matrix R m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk48"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftIdentity matrix_mult (identity_matrix R m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk49"><span class="nb">intros</span> M; <span class="nb">apply</span> path_matrix; <span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_mult (identity_matrix R m) M) i j =
entry M i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk4a"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum m
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; m)%nat) =&gt;
   entry (identity_matrix R m) i k * entry M k j) =
entry M i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk4b">lhs napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; m)%nat),
entry (identity_matrix R m) i k * entry M k j =
<span class="nl">?Goal</span> k Hk</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk4c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk4c"><hr></label><div class="goal-conclusion">ab_sum m <span class="nl">?Goal</span> = entry M i j</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk4d"><span class="mi">1</span>: <span class="nb">intros</span> k Hk; <span class="bp">by</span> <span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum m
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; m)%nat) =&gt;
   kronecker_delta i k * entry M k j) = entry M i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">napply rng_sum_kronecker_delta_l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The identity matrix acts as a right identity for matrix multiplication. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk4e"><span class="kn">Definition</span> <span class="nf">right_identity_matrix_mult</span> (<span class="nv">R</span> : Ring) (<span class="nv">m</span> <span class="nv">n</span> : nat)
  : RightIdentity (@matrix_mult R m n n) (identity_matrix R n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightIdentity matrix_mult (identity_matrix R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk4f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightIdentity matrix_mult (identity_matrix R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk50"><span class="nb">intros</span> M; <span class="nb">apply</span> path_matrix; <span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_mult M (identity_matrix R n)) i j =
entry M i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk51"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry (identity_matrix R n) k j) =
entry M i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk52">lhs napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry M i k * entry (identity_matrix R n) k j =
<span class="nl">?Goal</span> k Hk</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk53" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk53"><hr></label><div class="goal-conclusion">ab_sum n <span class="nl">?Goal</span> = entry M i j</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk54"><span class="mi">1</span>: <span class="nb">intros</span> k Hk; <span class="bp">by</span> <span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * kronecker_delta k j) = entry M i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">napply rng_sum_kronecker_delta_r&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** TODO: define this as an R-algebra. What is an R-algebra over a non-commutative right however? (Here we have a bimodule which might be important) *)</span>
<span class="sd">(** Matrices over a ring form a (generally) non-commutative ring. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk55"><span class="kn">Definition</span> <span class="nf">matrix_ring</span> (<span class="nv">R</span> : Ring@{i}) (<span class="nv">n</span> : nat) : Ring.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Ring</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk56"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Ring</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk57">snapply Build_Ring.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">AbGroup</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk58" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk58"><hr></label><div class="goal-conclusion">Mult <span class="nl">?R</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk59" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk59"><hr></label><div class="goal-conclusion">One <span class="nl">?R</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk5a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk5a"><hr></label><div class="goal-conclusion">Associative mult</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk5b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk5b"><hr></label><div class="goal-conclusion">LeftDistribute mult plus</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk5c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk5c"><hr></label><div class="goal-conclusion">RightDistribute mult plus</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk5d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk5d"><hr></label><div class="goal-conclusion">LeftIdentity mult <span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk5e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk5e"><hr></label><div class="goal-conclusion">RightIdentity mult <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk5f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">AbGroup</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (abgroup_matrix R n n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk60">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Mult (abgroup_matrix R n n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> matrix_mult.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk61">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">One (abgroup_matrix R n n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (identity_matrix R n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk62">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Associative mult</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (associative_matrix_mult R n n n n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk63">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftDistribute mult plus</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (left_distribute_matrix_mult R n n n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk64">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightDistribute mult plus</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (right_distribute_matrix_mult R n n n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk65">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftIdentity mult <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (left_identity_matrix_mult R n n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk66">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightIdentity mult <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (right_identity_matrix_mult R n n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Matrix multiplication on the right preserves scalar multiplication in the sense that [matrix_lact r (matrix_mult M N) = matrix_mult (matrix_lact r M) N] for [r] a ring element and [M] and [N] matrices of compatible sizes. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk67"><span class="kn">Definition</span> <span class="nf">matrix_mult_lact_l</span> {<span class="nv">R</span> : Ring} {<span class="nv">m</span> <span class="nv">n</span> <span class="nv">p</span> : nat}
  : HeteroAssociative (@matrix_lact R m p) (@matrix_mult R m n p)
      (@matrix_mult R m n p) (@matrix_lact R m n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HeteroAssociative matrix_lact matrix_mult matrix_mult
  matrix_lact</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk68"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HeteroAssociative matrix_lact matrix_mult matrix_mult
  matrix_lact</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk69"><span class="nb">intros</span> r M N.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_lact r (matrix_mult M N) =
matrix_mult (matrix_lact r M) N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk6a">snapply path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat)
(<span class="nv">Hj</span> : (j &lt; p)%nat),
entry (matrix_lact r (matrix_mult M N)) i j =
entry (matrix_mult (matrix_lact r M) N) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk6b"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_lact r (matrix_mult M N)) i j =
entry (matrix_mult (matrix_lact r M) N) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk6c"><span class="nb">rewrite</span> !entry_Build_Matrix, !entry_Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">lact r
  (ab_sum n
     (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
      entry M i k * entry N k j)) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry (matrix_lact r M) i k * entry N k j)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk6d">lhs napply rng_sum_dist_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   r * (entry M i k * entry N k j)) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry (matrix_lact r M) i k * entry N k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk6e">snapply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
(<span class="kr">fun</span> (<span class="nv">k0</span> : nat) (<span class="nv">Hk0</span> : (k0 &lt; n)%nat) =&gt;
 r * (entry M i k0 * entry N k0 j)) k Hk =
(<span class="kr">fun</span> (<span class="nv">k0</span> : nat) (<span class="nv">Hk0</span> : (k0 &lt; n)%nat) =&gt;
 entry (matrix_lact r M) i k0 * entry N k0 j) k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk6f"><span class="nb">intros</span> k Hk; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r * (entry M i k * entry N k j) =
entry (vector_lact r M) i k * entry N k j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk70"><span class="nb">rewrite</span> !entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r * (entry M i k * entry N k j) =
lact r (Vector.entry (Vector.entry M i) k) *
entry N k j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">snapply rng_mult_assoc.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The same doesn&#39;t hold for the right matrix, since the ring is not commutative. However we could say an analogous statement for the right action. We haven&#39;t yet stated a definition of right module yet though. *)</span>

<span class="sd">(** In a commutative ring, matrix multiplication over the ring and the opposite ring agree. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk71"><span class="kn">Definition</span> <span class="nf">matrix_mult_rng_op</span> {<span class="nv">R</span> : CRing} {<span class="nv">m</span> <span class="nv">n</span> <span class="nv">p</span>}
  (<span class="nv">M</span> : Matrix R m n) (<span class="nv">N</span> : Matrix R n p)
  : matrix_mult (R:=rng_op R) M N = matrix_mult M N.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_mult M N = matrix_mult M N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk72"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_mult M N = matrix_mult M N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk73"><span class="nb">apply</span> path_matrix; <span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_mult M N) i j =
entry (matrix_mult M N) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk74"><span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry N k j) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry N k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk75"><span class="nb">apply</span> path_ab_sum; <span class="nb">intros</span> k Hk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; p)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k * entry N k j = entry M i k * entry N k j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> rng_mult_comm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Transpose *)</span>

<span class="sd">(** The transpose of a matrix is the matrix with the rows and columns swapped. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_transpose</span> {<span class="nv">R</span> : <span class="kt">Type</span>} {<span class="nv">m</span> <span class="nv">n</span>} : Matrix R m n -&gt; Matrix R n m
  := <span class="kr">fun</span> <span class="nv">M</span> =&gt; Build_Matrix R n m (<span class="kr">fun</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">H1</span> <span class="nv">H2</span> =&gt; entry M j i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Transposing a matrix is involutive. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk76"><span class="kn">Definition</span> <span class="nf">matrix_transpose_transpose</span> {<span class="nv">R</span> : <span class="kt">Type</span>} {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">M</span> : Matrix R m n)
  : matrix_transpose (matrix_transpose M) = M.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_transpose M) = M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk77"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_transpose M) = M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk78"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry (matrix_transpose (matrix_transpose M)) i j =
entry M i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk79"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose (matrix_transpose M)) i j =
entry M i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk7a">lhs napply entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose M) j i = entry M i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">napply entry_Build_Matrix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Transpose distributes over addition. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk7b"><span class="kn">Definition</span> <span class="nf">matrix_transpose_plus</span> {<span class="nv">R</span> : Ring} {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">M</span> <span class="nv">N</span> : Matrix R m n)
  : matrix_transpose (matrix_plus M N)
    = matrix_plus (matrix_transpose M) (matrix_transpose N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_plus M N) =
matrix_plus (matrix_transpose M) (matrix_transpose N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk7c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_plus M N) =
matrix_plus (matrix_transpose M) (matrix_transpose N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk7d"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; m)%nat),
entry (matrix_transpose (matrix_plus M N)) i j =
entry
  (matrix_plus (matrix_transpose M)
     (matrix_transpose N)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk7e"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose (matrix_plus M N)) i j =
entry
  (matrix_plus (matrix_transpose M)
     (matrix_transpose N)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !entry_Build_Matrix, !entry_Build_Vector.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Transpose commutes with scalar multiplication. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk7f"><span class="kn">Definition</span> <span class="nf">matrix_transpose_lact</span> {<span class="nv">R</span> : Ring} {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">r</span> : R) (<span class="nv">M</span> : Matrix R m n)
  : matrix_transpose (matrix_lact r M)
    = matrix_lact r (matrix_transpose M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_lact r M) =
matrix_lact r (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk80"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_lact r M) =
matrix_lact r (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk81"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; m)%nat),
entry (matrix_transpose (matrix_lact r M)) i j =
entry (matrix_lact r (matrix_transpose M)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk82"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose (matrix_lact r M)) i j =
entry (matrix_lact r (matrix_transpose M)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !entry_Build_Matrix, !entry_Build_Vector.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The negation of a transposed matrix is the same as the transposed matrix of the negation. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk83"><span class="kn">Definition</span> <span class="nf">matrix_transpose_negate</span> {<span class="nv">R</span> : Ring} {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">M</span> : Matrix R m n)
  : matrix_transpose (matrix_negate M) = matrix_negate (matrix_transpose M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_negate M) =
matrix_negate (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk84"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_negate M) =
matrix_negate (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk85"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; m)%nat),
entry (matrix_transpose (matrix_negate M)) i j =
entry (matrix_negate (matrix_transpose M)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk86"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose (matrix_negate M)) i j =
entry (matrix_negate (matrix_transpose M)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !entry_Build_Matrix, !entry_Build_Vector.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Transpose distributes over multiplication when you reverse the ring multiplication. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk87"><span class="kn">Definition</span> <span class="nf">matrix_transpose_mult</span> {<span class="nv">R</span> : Ring} {<span class="nv">m</span> <span class="nv">n</span> <span class="nv">p</span>}
  (<span class="nv">M</span> : Matrix R m n) (<span class="nv">N</span> : Matrix R n p)
  : matrix_transpose (matrix_mult M N)
    = matrix_mult (R:=rng_op R) (matrix_transpose N) (matrix_transpose M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_mult M N) =
matrix_mult (matrix_transpose N) (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk88"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_mult M N) =
matrix_mult (matrix_transpose N) (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk89"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; p)%nat)
(<span class="nv">Hj</span> : (j &lt; m)%nat),
entry (matrix_transpose (matrix_mult M N)) i j =
entry
  (matrix_mult (matrix_transpose N)
     (matrix_transpose M)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk8a"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; p)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose (matrix_mult M N)) i j =
entry
  (matrix_mult (matrix_transpose N)
     (matrix_transpose M)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk8b"><span class="nb">rewrite</span> <span class="mi">3</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; p)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M j k * entry N k i) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry (matrix_transpose N) i k *
   entry (matrix_transpose M) k j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk8c"><span class="nb">apply</span> path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; p)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry M j k * entry N k i =
entry (matrix_transpose N) i k *
entry (matrix_transpose M) k j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk8d"><span class="nb">intros</span> k Hk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; p)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; m)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M j k * entry N k i =
entry (matrix_transpose N) i k *
entry (matrix_transpose M) k j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk8e"><span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; p)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; m)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M j k * entry N k i = entry N k i * entry M j k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** When the ring is commutative, there is no need to reverse the multiplication. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk8f"><span class="kn">Definition</span> <span class="nf">matrix_transpose_mult_comm</span> {<span class="nv">R</span> : CRing} {<span class="nv">m</span> <span class="nv">n</span> <span class="nv">p</span>}
  (<span class="nv">M</span> : Matrix R m n) (<span class="nv">N</span> : Matrix R n p)
  : matrix_transpose (matrix_mult M N)
    = matrix_mult (matrix_transpose N) (matrix_transpose M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_mult M N) =
matrix_mult (matrix_transpose N) (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk90"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_mult M N) =
matrix_mult (matrix_transpose N) (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk91">lhs napply matrix_transpose_mult.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n, p</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_mult (matrix_transpose N) (matrix_transpose M) =
matrix_mult (matrix_transpose N) (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> matrix_mult_rng_op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The transpose of the zero matrix is the zero matrix. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk92"><span class="kn">Definition</span> <span class="nf">matrix_transpose_zero</span> {<span class="nv">R</span> : Ring} {<span class="nv">m</span> <span class="nv">n</span>}
  : matrix_transpose (matrix_zero R m n) = matrix_zero R n m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_zero R m n) =
matrix_zero R n m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk93"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_zero R m n) =
matrix_zero R n m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk94"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; m)%nat),
entry (matrix_transpose (matrix_zero R m n)) i j =
entry (matrix_zero R n m) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk95"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>m, n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose (matrix_zero R m n)) i j =
entry (matrix_zero R n m) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !entry_Build_Matrix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The transpose of the identity matrix is the identity matrix. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk96"><span class="kn">Definition</span> <span class="nf">matrix_transpose_identity</span>@{i} {R : Ring@{i}} {n}
  : matrix_transpose (identity_matrix R n) = identity_matrix R n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (identity_matrix R n) =
identity_matrix R n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk97"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (identity_matrix R n) =
identity_matrix R n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk98"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry (matrix_transpose (identity_matrix R n)) i j =
entry (identity_matrix R n) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk99"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose (identity_matrix R n)) i j =
entry (identity_matrix R n) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk9a"><span class="nb">rewrite</span> <span class="mi">3</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta j i = kronecker_delta i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> kronecker_delta_symm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Diagonal matrices *)</span>

<span class="sd">(** A diagonal matrix is a matrix with zeros everywhere except on the diagonal. Its entries are given by a vector. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk9b"><span class="kn">Definition</span> <span class="nf">matrix_diag</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">v</span> : Vector R n)
  : Matrix R n n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Matrix R n n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk9c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Matrix R n n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk9d">snapply Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat, (i &lt; n)%nat -&gt; (j &lt; n)%nat -&gt; R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk9e"><span class="nb">intros</span> i j H1 H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">R</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (kronecker_delta i j * Vector.entry v i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Addition of diagonal matrices is the same as addition of the corresponding vectors. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk9f"><span class="kn">Definition</span> <span class="nf">matrix_diag_plus</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">v</span> <span class="nv">w</span> : Vector R n)
  : matrix_plus (matrix_diag v) (matrix_diag w) = matrix_diag (vector_plus v w).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_plus (matrix_diag v) (matrix_diag w) =
matrix_diag (vector_plus v w)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_plus (matrix_diag v) (matrix_diag w) =
matrix_diag (vector_plus v w)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka1"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_diag (vector_plus v w) =
matrix_plus (matrix_diag v) (matrix_diag w)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka2">snapply path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry (matrix_diag (vector_plus v w)) i j =
entry (matrix_plus (matrix_diag v) (matrix_diag w)) i
  j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka3"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_diag (vector_plus v w)) i j =
entry (matrix_plus (matrix_diag v) (matrix_diag w)) i
  j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka4"><span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Matrix, <span class="mi">5</span> entry_Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i j *
(Vector.entry v i + Vector.entry w i) =
kronecker_delta i j * Vector.entry v i +
kronecker_delta i j * Vector.entry w i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">napply rng_dist_l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Matrix multiplication of diagonal matrices is the same as multiplying the corresponding vectors pointwise. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka5"><span class="kn">Definition</span> <span class="nf">matrix_diag_mult</span> {<span class="nv">R</span> : Ring} {<span class="nv">n</span> : nat} (<span class="nv">v</span> <span class="nv">w</span> : Vector R n)
  : matrix_mult (matrix_diag v) (matrix_diag w)
    = matrix_diag (vector_map2 (.*.) v w).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_mult (matrix_diag v) (matrix_diag w) =
matrix_diag (vector_map2 mult v w)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_mult (matrix_diag v) (matrix_diag w) =
matrix_diag (vector_map2 mult v w)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka7">snapply path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry (matrix_mult (matrix_diag v) (matrix_diag w)) i
  j = entry (matrix_diag (vector_map2 mult v w)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka8"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_mult (matrix_diag v) (matrix_diag w)) i
  j = entry (matrix_diag (vector_map2 mult v w)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chka9"><span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry (matrix_diag v) i k *
   entry (matrix_diag w) k j) =
kronecker_delta i j *
Vector.entry (vector_map2 mult v w) i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkaa">lhs snapply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry (matrix_diag v) i k * entry (matrix_diag w) k j =
<span class="nl">?Goal0</span> k Hk</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chkab" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chkab"><hr></label><div class="goal-conclusion">ab_sum n <span class="nl">?Goal0</span> =
kronecker_delta i j *
Vector.entry (vector_map2 mult v w) i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkac">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry (matrix_diag v) i k * entry (matrix_diag w) k j =
<span class="nl">?Goal0</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkad"><span class="nb">intros</span> k Hk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_diag v) i k * entry (matrix_diag w) k j =
<span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkae"><span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i k * Vector.entry v i *
(kronecker_delta k j * Vector.entry w k) = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkaf"><span class="nb">rewrite</span> rng_mult_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i k * Vector.entry v i *
kronecker_delta k j * Vector.entry w k = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb0"><span class="nb">rewrite</span> &lt;- (rng_mult_assoc (kronecker_delta _ _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i k *
(Vector.entry v i * kronecker_delta k j) *
Vector.entry w k = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb1"><span class="nb">rewrite</span> kronecker_delta_comm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i k *
(kronecker_delta k j * Vector.entry v i) *
Vector.entry w k = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb2"><span class="nb">rewrite</span> &lt;- <span class="mi">2</span> rng_mult_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i k *
(kronecker_delta k j *
 (Vector.entry v i * Vector.entry w k)) = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb3">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   kronecker_delta i k *
   (kronecker_delta k j *
    (Vector.entry v i * Vector.entry w k))) =
kronecker_delta i j *
Vector.entry (vector_map2 mult v w) i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb4"><span class="nb">rewrite</span> (rng_sum_kronecker_delta_l _ _ Hi).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v, w</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i j *
(Vector.entry v i * Vector.entry w i) =
kronecker_delta i j *
Vector.entry (vector_map2 mult v w) i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> entry_Build_Vector.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The transpose of a diagonal matrix is the same diagonal matrix. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb5"><span class="kn">Definition</span> <span class="nf">matrix_transpose_diag</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">v</span> : Vector R n)
  : matrix_transpose (matrix_diag v) = matrix_diag v.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_diag v) = matrix_diag v</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_diag v) = matrix_diag v</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb7">snapply path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry (matrix_transpose (matrix_diag v)) i j =
entry (matrix_diag v) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb8"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose (matrix_diag v)) i j =
entry (matrix_diag v) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkb9"><span class="nb">rewrite</span> <span class="mi">3</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta j i * Vector.entry v j =
kronecker_delta i j * Vector.entry v i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkba"><span class="nb">rewrite</span> kronecker_delta_symm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i j * Vector.entry v j =
kronecker_delta i j * Vector.entry v i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkbb"><span class="nb">unfold</span> kronecker_delta.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">if</span> dec (i = j) <span class="kr">then</span> <span class="mi">1</span> <span class="kr">else</span> <span class="mi">0</span>) * Vector.entry v j =
(<span class="kr">if</span> dec (i = j) <span class="kr">then</span> <span class="mi">1</span> <span class="kr">else</span> <span class="mi">0</span>) * Vector.entry v i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkbc"><span class="nb">destruct</span> (dec (i = j)) <span class="kr">as</span> [p|np].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> * Vector.entry v j = <span class="mi">1</span> * Vector.entry v i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chkbd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>i &lt;&gt; j</span></span></span><br></div><label class="goal-separator" for="matrix-v-chkbd"><hr></label><div class="goal-conclusion"><span class="mi">0</span> * Vector.entry v j = <span class="mi">0</span> * Vector.entry v i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkbe"><span class="mi">1</span>: f_ap; <span class="nb">symmetry</span>; <span class="bp">by</span> <span class="nb">apply</span> path_entry_vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>i &lt;&gt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> * Vector.entry v j = <span class="mi">0</span> * Vector.entry v i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !rng_mult_zero_l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The diagonal matrix construction is injective. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkbf"><span class="kn">Instance</span> <span class="nf">isinj_matrix_diag</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  : IsInjective (@matrix_diag R n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsInjective matrix_diag</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsInjective matrix_diag</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc1"><span class="nb">intros</span> v1 v2 p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v1, v2</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>matrix_diag v1 = matrix_diag v2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">v1 = v2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc2">snapply path_vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v1, v2</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>matrix_diag v1 = matrix_diag v2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> : nat) (<span class="nv">H</span> : (i &lt; n)%nat),
Vector.entry v1 i = Vector.entry v2 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc3"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v1, v2</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>matrix_diag v1 = matrix_diag v2</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector.entry v1 i = Vector.entry v2 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc4"><span class="nb">apply</span> (ap (<span class="kr">fun</span> <span class="nv">M</span> =&gt; entry M i i)) <span class="kr">in</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v1, v2</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>entry (matrix_diag v1) i i =
entry (matrix_diag v2) i i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector.entry v1 i = Vector.entry v2 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc5"><span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Matrix <span class="kr">in</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v1, v2</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>kronecker_delta i i * Vector.entry v1 i =
kronecker_delta i i * Vector.entry v2 i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector.entry v1 i = Vector.entry v2 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc6"><span class="nb">rewrite</span> kronecker_delta_refl <span class="kr">in</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v1, v2</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="mi">1</span> * Vector.entry v1 i = <span class="mi">1</span> * Vector.entry v2 i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector.entry v1 i = Vector.entry v2 i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">2</span> rng_mult_one_l <span class="kr">in</span> p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A matrix is diagonal if it is equal to a diagonal matrix. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsDiagonal</span>@{i} {R : Ring@{i}} {n : nat} (M : Matrix R n n) : <span class="kt">Type</span>@{i} := {
  isdiagonal_diag_vector : Vector R n;
  isdiagonal_diag : M = matrix_diag isdiagonal_diag_vector;
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> isdiagonal_diag_vector {R n} M {_}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> isdiagonal_diag {R n} M {_}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">issig_IsDiagonal</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} {<span class="nv">M</span> : Matrix R n n}
  : _ &lt;~&gt; IsDiagonal M
  := <span class="kp">ltac</span>:(issig).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A matrix is diagonal in a unique way. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc7"><span class="kn">Instance</span> <span class="nf">ishprop_isdiagonal</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">M</span> : Matrix R n n)
  : IsHProp (IsDiagonal M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsDiagonal M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsDiagonal M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkc9">snapply hprop_allpath.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : IsDiagonal M, x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkca"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkcb">snapply ((equiv_ap&#39; issig_IsDiagonal^-<span class="mi">1</span>%equiv _ _ )^-<span class="mi">1</span>%equiv).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">issig_IsDiagonal^-<span class="mi">1</span>%equiv x =
issig_IsDiagonal^-<span class="mi">1</span>%equiv y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkcc">rapply path_sigma_hprop; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isdiagonal_diag_vector M = isdiagonal_diag_vector M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkcd"><span class="nb">apply</span> isinj_matrix_diag.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_diag (isdiagonal_diag_vector M) =
matrix_diag (isdiagonal_diag_vector M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((isdiagonal_diag M)^ @ isdiagonal_diag M).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The zero matrix is diagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkce"><span class="kn">Instance</span> <span class="nf">isdiagonal_matrix_zero</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  : IsDiagonal (matrix_zero R n n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkcf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd0"><span class="kr">exists</span> (<span class="nv">vector_zero</span> <span class="nv">R</span> <span class="nv">n</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_zero R n n = matrix_diag (vector_zero R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd1">snapply path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry (matrix_zero R n n) i j =
entry (matrix_diag (vector_zero R n)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd2"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_zero R n n) i j =
entry (matrix_diag (vector_zero R n)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd3"><span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Matrix, entry_Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = kronecker_delta i j * <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> rng_mult_zero_r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The identity matrix is diagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd4"><span class="kn">Instance</span> <span class="nf">isdiagonal_identity_matrix</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  : IsDiagonal (identity_matrix R n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (identity_matrix R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (identity_matrix R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd6"><span class="kr">exists</span> (<span class="nv">Build_Vector</span> <span class="nv">R</span> <span class="nv">n</span> (<span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; <span class="mi">1</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">identity_matrix R n =
matrix_diag
  (Build_Vector R n
     (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">_</span> : (i &lt; n)%nat) =&gt; <span class="mi">1</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd7">snapply path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry (identity_matrix R n) i j =
entry
  (matrix_diag
     (Build_Vector R n
        (<span class="kr">fun</span> (<span class="nv">i0</span> : nat) (<span class="nv">_</span> : (i0 &lt; n)%nat) =&gt; <span class="mi">1</span>))) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd8"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (identity_matrix R n) i j =
entry
  (matrix_diag
     (Build_Vector R n
        (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">_</span> : (i &lt; n)%nat) =&gt; <span class="mi">1</span>))) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkd9"><span class="nb">rewrite</span> <span class="mi">2</span> entry_Build_Matrix, entry_Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i j = kronecker_delta i j * <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> rng_mult_one_r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The sum of two diagonal matrices is diagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkda"><span class="kn">Instance</span> <span class="nf">isdiagonal_matrix_plus</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> <span class="nv">N</span> : Matrix R n n) `{IsDiagonal R n M} `{IsDiagonal R n N}
  : IsDiagonal (matrix_plus M N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsDiagonal N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkdb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsDiagonal N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkdc"><span class="kr">exists</span> (<span class="nv">vector_plus</span> (isdiagonal_diag_vector M) (isdiagonal_diag_vector N)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsDiagonal N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_plus M N =
matrix_diag
  (vector_plus (isdiagonal_diag_vector M)
     (isdiagonal_diag_vector N))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkdd"><span class="nb">rewrite</span> (isdiagonal_diag M), (isdiagonal_diag N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsDiagonal N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_plus (matrix_diag (isdiagonal_diag_vector M))
  (matrix_diag (isdiagonal_diag_vector N)) =
matrix_diag
  (vector_plus (isdiagonal_diag_vector M)
     (isdiagonal_diag_vector N))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> matrix_diag_plus.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The negative of a diagonal matrix is diagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkde"><span class="kn">Instance</span> <span class="nf">isdiagonal_matrix_negate</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{IsDiagonal R n M}
  : IsDiagonal (matrix_negate M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkdf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke0"><span class="kr">exists</span> (<span class="nv">vector_neg</span> <span class="nv">_</span> <span class="nv">_</span> (isdiagonal_diag_vector M)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_negate M =
matrix_diag
  (vector_neg R n (isdiagonal_diag_vector M))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke1"><span class="nb">rewrite</span> (isdiagonal_diag M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_negate (matrix_diag (isdiagonal_diag_vector M)) =
matrix_diag
  (vector_neg R n (isdiagonal_diag_vector M))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke2">snapply path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry
  (matrix_negate
     (matrix_diag (isdiagonal_diag_vector M))) i j =
entry
  (matrix_diag
     (vector_neg R n (isdiagonal_diag_vector M))) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke3"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry
  (matrix_negate
     (matrix_diag (isdiagonal_diag_vector M))) i j =
entry
  (matrix_diag
     (vector_neg R n (isdiagonal_diag_vector M))) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke4"><span class="nb">rewrite</span> !entry_Build_Matrix, !entry_Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">-
(kronecker_delta i j *
 Vector.entry (isdiagonal_diag_vector M) i) =
kronecker_delta i j *
- Vector.entry (isdiagonal_diag_vector M) i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> rng_mult_negate_r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The product of two diagonal matrices is diagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke5"><span class="kn">Instance</span> <span class="nf">isdiagonal_matrix_mult</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> <span class="nv">N</span> : Matrix R n n) `{IsDiagonal R n M} `{IsDiagonal R n N}
  : IsDiagonal (matrix_mult M N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsDiagonal N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_mult M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsDiagonal N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_mult M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke7"><span class="kr">exists</span> (<span class="nv">vector_map2</span> (.*.) (isdiagonal_diag_vector M) (isdiagonal_diag_vector N)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsDiagonal N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_mult M N =
matrix_diag
  (vector_map2 mult (isdiagonal_diag_vector M)
     (isdiagonal_diag_vector N))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke8"><span class="nb">rewrite</span> (isdiagonal_diag M), (isdiagonal_diag N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsDiagonal N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_mult (matrix_diag (isdiagonal_diag_vector M))
  (matrix_diag (isdiagonal_diag_vector N)) =
matrix_diag
  (vector_map2 mult (isdiagonal_diag_vector M)
     (isdiagonal_diag_vector N))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> matrix_diag_mult.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The transpose of a diagonal matrix is diagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chke9"><span class="kn">Instance</span> <span class="nf">isdiagonal_matrix_transpose</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{IsDiagonal R n M}
  : IsDiagonal (matrix_transpose M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkea"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkeb"><span class="kr">exists</span> (<span class="nv">isdiagonal_diag_vector</span> <span class="nv">M</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose M =
matrix_diag (isdiagonal_diag_vector M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkec"><span class="nb">rewrite</span> (isdiagonal_diag M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsDiagonal M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose
  (matrix_diag (isdiagonal_diag_vector M)) =
matrix_diag (isdiagonal_diag_vector M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> matrix_transpose_diag.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Given a square matrix, we can extract the diagonal as a vector. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_diag_vector</span> {<span class="nv">R</span> : Ring} {<span class="nv">n</span> : nat} (<span class="nv">M</span> : Matrix R n n)
  : Vector R n
  := Build_Vector R n (<span class="kr">fun</span> <span class="nv">i</span> <span class="nv">_</span> =&gt; entry M i i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Diagonal matrices form a subring of the ring of square matrices. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chked"><span class="kn">Definition</span> <span class="nf">matrix_diag_ring</span>@{i} (R : Ring@{i}) (n : nat)
  : Subring@{i i} (matrix_ring R n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subring (matrix_ring R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkee"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subring (matrix_ring R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkef">snapply (Build_Subring&#39; (<span class="kr">fun</span> <span class="nv">M</span> : matrix_ring R n =&gt; IsDiagonal M) _); <span class="nb">hnf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : matrix_ring R n, IsHProp (IsDiagonal x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chkf0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chkf0"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsDiagonal x -&gt; IsDiagonal y -&gt; IsDiagonal (x - y)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chkf1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chkf1"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsDiagonal x -&gt; IsDiagonal y -&gt; IsDiagonal (x * y)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chkf2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chkf2"><hr></label><div class="goal-conclusion">IsDiagonal <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkf3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : matrix_ring R n, IsHProp (IsDiagonal x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span>; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkf4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsDiagonal x -&gt; IsDiagonal y -&gt; IsDiagonal (x - y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkf5"><span class="nb">intros</span> x y dx dy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>matrix_ring R n</span></span></span><br><span><var>dx</var><span class="hyp-type"><b>: </b><span>IsDiagonal x</span></span></span><br><span><var>dy</var><span class="hyp-type"><b>: </b><span>IsDiagonal y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (x - y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkf6">napply isdiagonal_matrix_plus; <span class="nb">trivial</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>matrix_ring R n</span></span></span><br><span><var>dx</var><span class="hyp-type"><b>: </b><span>IsDiagonal x</span></span></span><br><span><var>dy</var><span class="hyp-type"><b>: </b><span>IsDiagonal y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (- y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> napply isdiagonal_matrix_negate.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkf7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsDiagonal x -&gt; IsDiagonal y -&gt; IsDiagonal (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">napply isdiagonal_matrix_mult.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkf8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">napply isdiagonal_identity_matrix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Trace *)</span>

<span class="sd">(** The trace of a square matrix is the sum of the diagonal entries. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_trace</span> {<span class="nv">R</span> : Ring} {<span class="nv">n</span>} (<span class="nv">M</span> : Matrix R n n) : R
  := ab_sum n (<span class="kr">fun</span> <span class="nv">i</span> <span class="nv">Hi</span> =&gt; entry M i i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The trace of a matrix preserves addition. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkf9"><span class="kn">Definition</span> <span class="nf">matrix_trace_plus</span> {<span class="nv">R</span> : Ring} {<span class="nv">n</span>} (<span class="nv">M</span> <span class="nv">N</span> : Matrix R n n)
  : matrix_trace (matrix_plus M N) = (matrix_trace M) + (matrix_trace N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_trace (matrix_plus M N) =
matrix_trace M + matrix_trace N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkfa"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_trace (matrix_plus M N) =
matrix_trace M + matrix_trace N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkfb"><span class="nb">unfold</span> matrix_trace.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt;
   entry (matrix_plus M N) i i) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt; entry M i i) +
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt; entry N i i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkfc">lhs napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry (matrix_plus M N) k k = <span class="nl">?Goal</span> k Hk</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chkfd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><label class="goal-separator" for="matrix-v-chkfd"><hr></label><div class="goal-conclusion">ab_sum n <span class="nl">?Goal</span> =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt; entry M i i) +
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt; entry N i i)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkfe">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry (matrix_plus M N) k k = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chkff"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_plus M N) i i = <span class="nl">?Goal</span> i Hi</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> entry_Build_Matrix.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk100">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt;
   Vector.entry (Vector.entry M i) i +
   Vector.entry (Vector.entry N i) i) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt; entry M i i) +
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt; entry N i i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ab_sum_plus.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The trace of a matrix preserves scalar multiplication. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk101"><span class="kn">Definition</span> <span class="nf">matrix_trace_lact</span> {<span class="nv">R</span> : Ring} {<span class="nv">n</span>} (<span class="nv">r</span> : R) (<span class="nv">M</span> : Matrix R n n)
  : matrix_trace (matrix_lact r M) = r * matrix_trace M.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_trace (matrix_lact r M) = r * matrix_trace M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk102"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_trace (matrix_lact r M) = r * matrix_trace M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk103"><span class="nb">unfold</span> matrix_trace.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt;
   entry (matrix_lact r M) i i) =
r *
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt; entry M i i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk104"><span class="nb">rewrite</span> rng_sum_dist_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat) =&gt;
   entry (matrix_lact r M) i i) =
ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt; r * entry M k k)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk105"><span class="nb">apply</span> path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry (matrix_lact r M) k k = r * entry M k k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk106"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_lact r M) i i = r * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> entry_Build_Matrix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The trace of a matrix multiplication is the same as the trace of the reverse multiplication. This holds only in a commutative ring. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk107"><span class="kn">Definition</span> <span class="nf">matrix_trace_mult</span> {<span class="nv">R</span> : CRing} {<span class="nv">m</span> <span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R m n) (<span class="nv">N</span> : Matrix R n m)
  : matrix_trace (matrix_mult M N) = matrix_trace (matrix_mult N M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_trace (matrix_mult M N) =
matrix_trace (matrix_mult N M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk108"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_trace (matrix_mult M N) =
matrix_trace (matrix_mult N M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk109">lhs napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; m)%nat),
entry (matrix_mult M N) k k = <span class="nl">?Goal</span> k Hk</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk10a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk10a"><hr></label><div class="goal-conclusion">ab_sum m <span class="nl">?Goal</span> = matrix_trace (matrix_mult N M)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk10b">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; m)%nat),
entry (matrix_mult M N) k k = <span class="nl">?Goal</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk10c"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_mult M N) i i = <span class="nl">?Goal</span> i Hi</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk10d">lhs napply entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry N k i) = <span class="nl">?Goal</span> i Hi</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk10e">napply path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry M i k * entry N k i = <span class="nl">?Goal0</span> k Hk</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk10f"><span class="nb">intros</span> j Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; m)%nat</span></span></span><br><span><var>j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j * entry N j i = <span class="nl">?Goal0</span> j Hj</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> rng_mult_comm.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk110">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum m
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat) =&gt;
   ab_sum n
     (<span class="kr">fun</span> (<span class="nv">j</span> : nat) (<span class="nv">Hj</span> : (j &lt; n)%nat) =&gt;
      entry N j i * entry M i j)) =
matrix_trace (matrix_mult N M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk111">lhs napply ab_sum_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">j</span> : nat) (<span class="nv">Hj</span> : (j &lt; n)%nat) =&gt;
   ab_sum m
     (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat) =&gt;
      entry N j i * entry M i j)) =
matrix_trace (matrix_mult N M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk112"><span class="nb">apply</span> path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
ab_sum m
  (<span class="kr">fun</span> (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; m)%nat) =&gt;
   entry N k i * entry M i k) =
entry (matrix_mult N M) k k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk113"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum m
  (<span class="kr">fun</span> (<span class="nv">i0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; m)%nat) =&gt;
   entry N i i0 * entry M i0 i) =
entry (matrix_mult N M) i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk114">rhs napply entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>CRing</span></span></span><br><span><var>m, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R m n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>Matrix R n m</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum m
  (<span class="kr">fun</span> (<span class="nv">i0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; m)%nat) =&gt;
   entry N i i0 * entry M i0 i) =
ab_sum m
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; m)%nat) =&gt;
   entry N i k * entry M k i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The trace of the transpose of a matrix is the same as the trace of the matrix. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk115"><span class="kn">Definition</span> <span class="nf">trace_transpose</span> {<span class="nv">R</span> : Ring} {<span class="nv">n</span>} (<span class="nv">M</span> : Matrix R n n)
  : matrix_trace (matrix_transpose M) = matrix_trace M.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_trace (matrix_transpose M) = matrix_trace M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk116"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_trace (matrix_transpose M) = matrix_trace M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk117"><span class="nb">apply</span> path_ab_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry (matrix_transpose M) k k = entry M k k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk118"><span class="nb">intros</span> i Hi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose M) i i = entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">napply entry_Build_Matrix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Matrix minors *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">skip</span> (<span class="nv">n</span> : nat) : nat -&gt; nat
  := <span class="kr">fun</span> <span class="nv">i</span> =&gt; <span class="kr">if</span> dec (i &lt; n)%nat <span class="kr">then</span> i <span class="kr">else</span> i.+<span class="mi">1</span>%nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk119"><span class="kn">Instance</span> <span class="nf">isinjective_skip</span> <span class="nv">n</span> : IsInjective (skip n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsInjective (skip n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk11a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsInjective (skip n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk11b"><span class="nb">hnf</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : nat, skip n x = skip n y -&gt; x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk11c"><span class="nb">intros</span> x y p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>skip n x = skip n y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk11d"><span class="nb">unfold</span> skip <span class="kr">in</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(<span class="kr">if</span> dec (x &lt; n)%nat <span class="kr">then</span> x <span class="kr">else</span> x.+<span class="mi">1</span>%nat) =
(<span class="kr">if</span> dec (y &lt; n)%nat <span class="kr">then</span> y <span class="kr">else</span> y.+<span class="mi">1</span>%nat)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk11e"><span class="nb">destruct</span> (dec (x &lt; n)%nat) <span class="kr">as</span> [H|H], (dec (y &lt; n)%nat) <span class="kr">as</span> [H&#39;|H&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(x &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(y &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk11f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(x &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~ (y &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y.+<span class="mi">1</span>%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk11f"><hr></label><div class="goal-conclusion">x = y</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk120" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ (x &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(y &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x.+<span class="mi">1</span>%nat = y</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk120"><hr></label><div class="goal-conclusion">x = y</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk121" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ (x &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~ (y &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x.+<span class="mi">1</span>%nat = y.+<span class="mi">1</span>%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk121"><hr></label><div class="goal-conclusion">x = y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk122">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(x &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(y &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk123">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(x &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~ (y &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y.+<span class="mi">1</span>%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk124"><span class="nb">symmetry in</span> p; <span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(y.+<span class="mi">1</span> &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~ (y &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">y.+<span class="mi">1</span>%nat = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span> (H&#39; (leq_trans _ H)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk125">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ (x &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(y &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x.+<span class="mi">1</span>%nat = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk126"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ (x &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(x.+<span class="mi">1</span> &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = x.+<span class="mi">1</span>%nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span> (H (leq_trans _ H&#39;)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk127">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, x, y</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>~ (x &lt; n)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~ (y &lt; n)%nat</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x.+<span class="mi">1</span>%nat = y.+<span class="mi">1</span>%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> path_nat_succ.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk128"><span class="kn">Local Instance</span> <span class="nf">lt_n1_skip</span> <span class="nv">k</span> <span class="nv">i</span> <span class="nv">n</span> (<span class="nv">H</span> : (i &lt; n.+<span class="mi">1</span>)%nat) (<span class="nv">H&#39;</span> : (k &lt; n)%nat)
  : (skip i k &lt; n.+<span class="mi">1</span>)%nat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k, i, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(skip i k &lt; n.+<span class="mi">1</span>)%nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk129"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k, i, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(skip i k &lt; n.+<span class="mi">1</span>)%nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk12a"><span class="nb">unfold</span> skip.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k, i, n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">if</span> dec (k &lt; i) <span class="kr">then</span> k <span class="kr">else</span> k.+<span class="mi">1</span>) &lt; n.+<span class="mi">1</span>)%nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (dec (k &lt; i))%nat <span class="kr">as</span> [H&#39;&#39;|H&#39;&#39;]; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">matrix_minor</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">i</span> <span class="nv">j</span> : nat)
  {<span class="nv">Hi</span> : (i &lt; n.+<span class="mi">1</span>)%nat} {<span class="nv">Hj</span> : (j &lt; n.+<span class="mi">1</span>)%nat} (<span class="nv">M</span> : Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span>)
  : Matrix R n n
  := Build_Matrix R n n (<span class="kr">fun</span> <span class="nv">k</span> <span class="nv">l</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; entry M (skip i k) (skip j l)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A minor of the zero matrix is again the zero matrix. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk12b"><span class="kn">Definition</span> <span class="nf">matrix_minor_zero</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">i</span> <span class="nv">j</span> : nat)
  (<span class="nv">Hi</span> : (i &lt; n.+<span class="mi">1</span>)%nat) (<span class="nv">Hj</span> : (j &lt; n.+<span class="mi">1</span>)%nat)
  : matrix_minor i j (matrix_zero R n.+<span class="mi">1</span> n.+<span class="mi">1</span>) = matrix_zero R n n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor i j (matrix_zero R n.+<span class="mi">1</span> n.+<span class="mi">1</span>) =
matrix_zero R n n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk12c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor i j (matrix_zero R n.+<span class="mi">1</span> n.+<span class="mi">1</span>) =
matrix_zero R n n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk12d"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i0</span> <span class="nv">j0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat)
(<span class="nv">Hj0</span> : (j0 &lt; n)%nat),
entry (matrix_minor i j (matrix_zero R n.+<span class="mi">1</span> n.+<span class="mi">1</span>)) i0
  j0 = entry (matrix_zero R n n) i0 j0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk12e"><span class="nb">intros</span> k l Hk Hl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>(l &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_minor i j (matrix_zero R n.+<span class="mi">1</span> n.+<span class="mi">1</span>)) k l =
entry (matrix_zero R n n) k l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !entry_Build_Matrix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk12f"><span class="kn">Definition</span> <span class="nf">matrix_minor_identity</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">i</span> : nat) (<span class="nv">Hi</span> : (i &lt; n.+<span class="mi">1</span>)%nat)
  : matrix_minor i i (identity_matrix R n.+<span class="mi">1</span>) = identity_matrix R n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor i i (identity_matrix R n.+<span class="mi">1</span>) =
identity_matrix R n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk130"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor i i (identity_matrix R n.+<span class="mi">1</span>) =
identity_matrix R n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk131"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i0</span> <span class="nv">j</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry (matrix_minor i i (identity_matrix R n.+<span class="mi">1</span>)) i0 j =
entry (identity_matrix R n) i0 j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk132"><span class="nb">intros</span> j k Hj Hk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>j, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_minor i i (identity_matrix R n.+<span class="mi">1</span>)) j k =
entry (identity_matrix R n) j k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk133"><span class="nb">rewrite</span> <span class="mi">3</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>j, k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta (skip i j) (skip i k) =
kronecker_delta j k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">rapply kronecker_delta_map_inj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk134"><span class="kn">Definition</span> <span class="nf">matrix_minor_plus</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">i</span> <span class="nv">j</span> : nat)
  (<span class="nv">Hi</span> : (i &lt; n.+<span class="mi">1</span>)%nat) (<span class="nv">Hj</span> : (j &lt; n.+<span class="mi">1</span>)%nat) (<span class="nv">M</span> <span class="nv">N</span> : Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span>)
  : matrix_minor i j (matrix_plus M N)
    = matrix_plus (matrix_minor i j M) (matrix_minor i j N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor i j (matrix_plus M N) =
matrix_plus (matrix_minor i j M) (matrix_minor i j N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk135"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor i j (matrix_plus M N) =
matrix_plus (matrix_minor i j M) (matrix_minor i j N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk136"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i0</span> <span class="nv">j0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat)
(<span class="nv">Hj0</span> : (j0 &lt; n)%nat),
entry (matrix_minor i j (matrix_plus M N)) i0 j0 =
entry
  (matrix_plus (matrix_minor i j M)
     (matrix_minor i j N)) i0 j0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk137"><span class="nb">intros</span> k l Hk Hl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>(l &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_minor i j (matrix_plus M N)) k l =
entry
  (matrix_plus (matrix_minor i j M)
     (matrix_minor i j N)) k l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !entry_Build_Matrix, !entry_Build_Vector.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk138"><span class="kn">Definition</span> <span class="nf">matrix_minor_scale</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">i</span> <span class="nv">j</span> : nat)
  (<span class="nv">Hi</span> : (i &lt; n.+<span class="mi">1</span>)%nat) (<span class="nv">Hj</span> : (j &lt; n.+<span class="mi">1</span>)%nat) (<span class="nv">r</span> : R) (<span class="nv">M</span> : Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span>)
  : matrix_minor i j (matrix_lact r M) = matrix_lact r (matrix_minor i j M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor i j (matrix_lact r M) =
matrix_lact r (matrix_minor i j M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk139"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor i j (matrix_lact r M) =
matrix_lact r (matrix_minor i j M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk13a"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i0</span> <span class="nv">j0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat)
(<span class="nv">Hj0</span> : (j0 &lt; n)%nat),
entry (matrix_minor i j (matrix_lact r M)) i0 j0 =
entry (matrix_lact r (matrix_minor i j M)) i0 j0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk13b"><span class="nb">intros</span> k l Hk Hl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>(l &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_minor i j (matrix_lact r M)) k l =
entry (matrix_lact r (matrix_minor i j M)) k l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> !entry_Build_Matrix, !entry_Build_Vector.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk13c"><span class="kn">Definition</span> <span class="nf">matrix_minor_transpose</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">i</span> <span class="nv">j</span> : nat)
  (<span class="nv">Hi</span> : (i &lt; n.+<span class="mi">1</span>)%nat) (<span class="nv">Hj</span> : (j &lt; n.+<span class="mi">1</span>)%nat) (<span class="nv">M</span> : Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span>)
  : matrix_minor j i (matrix_transpose M)
    = matrix_transpose (matrix_minor i j M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor j i (matrix_transpose M) =
matrix_transpose (matrix_minor i j M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk13d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_minor j i (matrix_transpose M) =
matrix_transpose (matrix_minor i j M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk13e"><span class="nb">apply</span> path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i0</span> <span class="nv">j0</span> : nat) (<span class="nv">Hi0</span> : (i0 &lt; n)%nat)
(<span class="nv">Hj0</span> : (j0 &lt; n)%nat),
entry (matrix_minor j i (matrix_transpose M)) i0 j0 =
entry (matrix_transpose (matrix_minor i j M)) i0 j0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk13f"><span class="nb">intros</span> k l Hk Hl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n.+<span class="mi">1</span>)%nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n.+<span class="mi">1</span> n.+<span class="mi">1</span></span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>Hl</var><span class="hyp-type"><b>: </b><span>(l &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_minor j i (matrix_transpose M)) k l =
entry (matrix_transpose (matrix_minor i j M)) k l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> <span class="mi">4</span> entry_Build_Matrix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Triangular matrices *)</span>

<span class="sd">(** A matrix is upper triangular if all the entries below the diagonal are zero. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsUpperTriangular</span>@{i} {R : Ring@{i}} {n : nat} (M : Matrix@{i} R n n) : <span class="kt">Type</span>@{i}
  := upper_triangular
  : merely@{i} (<span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> (<span class="nv">Hi</span> : (i &lt; n)%nat) (<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk140"><span class="kn">Instance</span> <span class="nf">ishprop_isuppertriangular</span>@{i} {R : Ring@{i}} {n : nat} (M : Matrix R n n)
  : IsHProp (IsUpperTriangular M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsUpperTriangular M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk141"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsUpperTriangular M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> istrunc_truncation@{i}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A matrix is lower triangular if all the entries above the diagonal are zero. We define it as the transpose being upper triangular. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsLowerTriangular</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">M</span> : Matrix@{i} R n n) : <span class="kt">Type</span>@{i}
  := upper_triangular_transpose :: IsUpperTriangular (matrix_transpose M).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk142"><span class="kn">Instance</span> <span class="nf">ishprop_islowertriangular</span>@{i} {R : Ring@{i}} {n : nat}
  (M : Matrix R n n)
  : IsHProp (IsLowerTriangular M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsLowerTriangular M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk143"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsLowerTriangular M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> istrunc_truncation@{i}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The transpose of a matrix is lower triangular if and only if the matrix is upper triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk144"><span class="kn">Instance</span> <span class="nf">lower_triangular_transpose</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{!IsUpperTriangular M}
  : IsLowerTriangular (matrix_transpose M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsUpperTriangular0</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk145"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsUpperTriangular0</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk146"><span class="nb">unfold</span> IsLowerTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsUpperTriangular0</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular
  (matrix_transpose (matrix_transpose M))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> matrix_transpose_transpose.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The sum of two upper triangular matrices is upper triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk147"><span class="kn">Instance</span> <span class="nf">upper_triangular_plus</span>@{i} {R : Ring@{i}} {n : nat} (M N : Matrix R n n)
  {H1 : IsUpperTriangular M} {H2 : IsUpperTriangular N}
  : IsUpperTriangular (matrix_plus M N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk148"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk149"><span class="nb">unfold</span> IsUpperTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely
  (<span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
   (<span class="nv">Hj</span> : (j &lt; n)%nat),
   (i &lt; j)%nat -&gt; entry (matrix_plus M N) i j = <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* We use [strip_reflections] rather than [strip_truncations] here and below because it generates fewer universe variables in some versions of Coq. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk14a">strip_reflections; <span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry (matrix_plus M N) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk14b"><span class="nb">intros</span> i j Hi Hj lt_i_j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_plus M N) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk14c"><span class="nb">specialize</span> (H1 i j Hi Hj lt_i_j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>entry M i j = <span class="mi">0</span></span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_plus M N) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk14d"><span class="nb">specialize</span> (H2 i j Hi Hj lt_i_j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>entry M i j = <span class="mi">0</span></span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_plus M N) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk14e"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>entry M i j = <span class="mi">0</span></span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector.entry (Vector.entry M i) j +
Vector.entry (Vector.entry N i) j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk14f"><span class="nb">change</span> (Vector.entry (Vector.entry <span class="nl">?M</span> <span class="nl">?i</span>) <span class="nl">?j</span>) <span class="kr">with</span> (entry M i j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>entry M i j = <span class="mi">0</span></span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j + entry N i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk150"><span class="nb">rewrite</span> H1, H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>entry M i j = <span class="mi">0</span></span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> + <span class="mi">0</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> rng_plus_zero_l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The sum of two lower triangular matrices is lower triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk151"><span class="kn">Instance</span> <span class="nf">lower_triangular_plus</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> <span class="nv">N</span> : Matrix R n n) `{!IsLowerTriangular M} `{!IsLowerTriangular N}
  : IsLowerTriangular (matrix_plus M N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br><span><var>IsLowerTriangular1</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk152"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br><span><var>IsLowerTriangular1</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk153"><span class="nb">unfold</span> IsLowerTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br><span><var>IsLowerTriangular1</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_transpose (matrix_plus M N))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk154"><span class="nb">rewrite</span> matrix_transpose_plus.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br><span><var>IsLowerTriangular1</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular
  (matrix_plus (matrix_transpose M)
     (matrix_transpose N))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> upper_triangular_plus.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The negation of an upper triangular matrix is upper triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk155"><span class="kn">Instance</span> <span class="nf">upper_triangular_negate</span>@{i} {R : Ring@{i}} {n : nat} (M : Matrix R n n)
  {H : IsUpperTriangular M}
  : IsUpperTriangular (matrix_negate M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk156"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk157"><span class="nb">unfold</span> IsUpperTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely
  (<span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
   (<span class="nv">Hj</span> : (j &lt; n)%nat),
   (i &lt; j)%nat -&gt; entry (matrix_negate M) i j = <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk158">strip_reflections; <span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry (matrix_negate M) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk159"><span class="nb">intros</span> i j Hi Hj lt_i_j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_negate M) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk15a"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">- Vector.entry (Vector.entry M i) j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk15b"><span class="nb">rewrite</span> &lt;- rng_negate_zero; f_ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Vector.entry (Vector.entry M i) j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> napply H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The negation of a lower triangular matrix is lower triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk15c"><span class="kn">Instance</span> <span class="nf">lower_triangular_negate</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{!IsLowerTriangular M}
  : IsLowerTriangular (matrix_negate M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk15d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk15e"><span class="nb">unfold</span> IsLowerTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_transpose (matrix_negate M))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk15f"><span class="nb">rewrite</span> matrix_transpose_negate.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_negate (matrix_transpose M))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> upper_triangular_negate.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The product of two upper triangular matrices is upper triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk160"><span class="kn">Instance</span> <span class="nf">upper_triangular_mult</span>@{i} {R : Ring@{i}} {n : nat}
  (M N : Matrix R n n) {H1 : IsUpperTriangular M} {H2 : IsUpperTriangular N}
  : IsUpperTriangular (matrix_mult M N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_mult M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk161"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_mult M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk162"><span class="nb">unfold</span> IsUpperTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely
  (<span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
   (<span class="nv">Hj</span> : (j &lt; n)%nat),
   (i &lt; j)%nat -&gt; entry (matrix_mult M N) i j = <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk163">strip_reflections; <span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry (matrix_mult M N) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk164"><span class="nb">intros</span> i j Hi Hj lt_i_j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_mult M N) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk165"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_sum n
  (<span class="kr">fun</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat) =&gt;
   entry M i k * entry N k j) = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk166"><span class="nb">apply</span> ab_sum_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">k</span> : nat) (<span class="nv">Hk</span> : (k &lt; n)%nat),
entry M i k * entry N k j = mon_unit</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk167"><span class="nb">intros</span> k Hk.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k * entry N k j = mon_unit</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk168"><span class="nb">destruct</span> (dec (k &lt;= i)%nat) <span class="kr">as</span> [leq_k_i|gt_k_i].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>leq_k_i</var><span class="hyp-type"><b>: </b><span>(k &lt;= i)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k * entry N k j = mon_unit</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk169" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>gt_k_i</var><span class="hyp-type"><b>: </b><span>~ (k &lt;= i)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk169"><hr></label><div class="goal-conclusion">entry M i k * entry N k j = mon_unit</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk16a">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>leq_k_i</var><span class="hyp-type"><b>: </b><span>(k &lt;= i)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k * entry N k j = mon_unit</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk16b"><span class="nb">rewrite</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>leq_k_i</var><span class="hyp-type"><b>: </b><span>(k &lt;= i)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k * <span class="mi">0</span> = mon_unit</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk16c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>leq_k_i</var><span class="hyp-type"><b>: </b><span>(k &lt;= i)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk16c"><hr></label><div class="goal-conclusion">(k &lt; j)%nat</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk16d"><span class="mi">1</span>: <span class="bp">by</span> <span class="nb">rewrite</span> rng_mult_zero_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>leq_k_i</var><span class="hyp-type"><b>: </b><span>(k &lt;= i)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(k &lt; j)%nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">rapply lt_leq_lt_trans.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk16e">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>gt_k_i</var><span class="hyp-type"><b>: </b><span>~ (k &lt;= i)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k * entry N k j = mon_unit</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk16f"><span class="nb">apply</span> gt_iff_not_leq <span class="kr">in</span> gt_k_i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>gt_k_i</var><span class="hyp-type"><b>: </b><span>(k &gt; i)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i k * entry N k j = mon_unit</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk170"><span class="nb">rewrite</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>gt_k_i</var><span class="hyp-type"><b>: </b><span>(k &gt; i)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> * entry N k j = mon_unit</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk171" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>gt_k_i</var><span class="hyp-type"><b>: </b><span>(k &gt; i)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk171"><hr></label><div class="goal-conclusion">(i &lt; k)%nat</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk172"><span class="mi">1</span>: <span class="bp">by</span> <span class="nb">rewrite</span> rng_mult_zero_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry N i j = <span class="mi">0</span></span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hk</var><span class="hyp-type"><b>: </b><span>(k &lt; n)%nat</span></span></span><br><span><var>gt_k_i</var><span class="hyp-type"><b>: </b><span>(k &gt; i)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i &lt; k)%nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The product of two lower triangular matrices is lower triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk173"><span class="kn">Instance</span> <span class="nf">lower_triangular_mult</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> <span class="nv">N</span> : Matrix R n n) {<span class="nv">H1</span> : IsLowerTriangular M} {<span class="nv">H2</span> : IsLowerTriangular N}
  : IsLowerTriangular (matrix_mult M N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_mult M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk174"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_mult M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk175"><span class="nb">unfold</span> IsLowerTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_transpose (matrix_mult M N))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk176"><span class="nb">rewrite</span> matrix_transpose_mult.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular
  (matrix_mult (matrix_transpose N)
     (matrix_transpose M))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">napply (upper_triangular_mult (R:=rng_op R)); <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The zero matrix is upper triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk177"><span class="kn">Instance</span> <span class="nf">upper_triangular_zero</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  : IsUpperTriangular (matrix_zero R n n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk178"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk179" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk179"><span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry (matrix_zero R n n) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">hnf</span>; <span class="nb">intros</span>; <span class="nb">rewrite</span> entry_Build_Matrix.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The zero matrix is lower triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk17a"><span class="kn">Instance</span> <span class="nf">lower_triangular_zero</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  : IsLowerTriangular (matrix_zero R n n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk17b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk17c"><span class="nb">unfold</span> IsLowerTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular
  (matrix_transpose (matrix_zero R n n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk17d"><span class="nb">rewrite</span> matrix_transpose_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The identity matrix is upper triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk17e"><span class="kn">Instance</span> <span class="nf">upper_triangular_identity</span>@{i} {R : Ring@{i}} {n : nat}
  : IsUpperTriangular (identity_matrix R n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (identity_matrix R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk17f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (identity_matrix R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk180"><span class="nb">unfold</span> IsUpperTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely
  (<span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
   (<span class="nv">Hj</span> : (j &lt; n)%nat),
   (i &lt; j)%nat -&gt; entry (identity_matrix R n) i j = <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk181"><span class="nb">apply</span> tr@{i}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry (identity_matrix R n) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk182"><span class="nb">intros</span> i j Hi Hj lt_i_j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (identity_matrix R n) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk183"><span class="nb">rewrite</span> entry_Build_Matrix@{i}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n, i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> kronecker_delta_lt.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The identity matrix is lower triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk184"><span class="kn">Instance</span> <span class="nf">lower_triangular_identity</span>@{i} {R : Ring@{i}} {n : nat}
  : IsLowerTriangular (identity_matrix R n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (identity_matrix R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk185"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (identity_matrix R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk186"><span class="nb">unfold</span> IsLowerTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular
  (matrix_transpose (identity_matrix R n))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk187"><span class="nb">rewrite</span> matrix_transpose_identity.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (identity_matrix R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A diagonal matrix is upper triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk188"><span class="kn">Instance</span> <span class="nf">upper_triangular_diag</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">v</span> : Vector R n)
  : IsUpperTriangular (matrix_diag v).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_diag v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk189"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_diag v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk18a"><span class="nb">unfold</span> IsUpperTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely
  (<span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
   (<span class="nv">Hj</span> : (j &lt; n)%nat),
   (i &lt; j)%nat -&gt; entry (matrix_diag v) i j = <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk18b"><span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
(i &lt; j)%nat -&gt; entry (matrix_diag v) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk18c"><span class="nb">intros</span> i j Hi Hj lt_i_j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_diag v) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk18d"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">kronecker_delta i j * Vector.entry v i = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk18e"><span class="nb">rewrite</span> kronecker_delta_lt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> * Vector.entry v i = <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk18f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk18f"><hr></label><div class="goal-conclusion">(i &lt; j)%nat</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk190"><span class="mi">1</span>: <span class="bp">by</span> <span class="nb">rewrite</span> rng_mult_zero_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>lt_i_j</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i &lt; j)%nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A diagonal matrix is lower triangular. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk191"><span class="kn">Instance</span> <span class="nf">lower_triangular_diag</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">v</span> : Vector R n)
  : IsLowerTriangular (matrix_diag v).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_diag v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk192"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular (matrix_diag v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk193"><span class="nb">unfold</span> IsLowerTriangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_transpose (matrix_diag v))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk194"><span class="nb">rewrite</span> matrix_transpose_diag.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Vector R n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular (matrix_diag v)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> upper_triangular_diag.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Upper triangular matrices are a subring of the ring of matrices. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk195"><span class="kn">Definition</span> <span class="nf">upper_triangular_matrix_ring</span>@{i} (R : Ring@{i}) (n : nat)
  : Subring@{i i} (matrix_ring@{i} R n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subring (matrix_ring R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk196"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subring (matrix_ring R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk197">napply (Build_Subring&#39; (<span class="kr">fun</span> <span class="nv">M</span> : matrix_ring R n =&gt; IsUpperTriangular M)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : matrix_ring R n,
IsHProp (IsUpperTriangular x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk198" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk198"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsUpperTriangular x -&gt;
IsUpperTriangular y -&gt; IsUpperTriangular (x - y)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk199" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk199"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsUpperTriangular x -&gt;
IsUpperTriangular y -&gt; IsUpperTriangular (x * y)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk19a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk19a"><hr></label><div class="goal-conclusion">IsUpperTriangular <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk19b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : matrix_ring R n,
IsHProp (IsUpperTriangular x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* These can all be found by typeclass search, but being explicit makes this faster. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk19c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsUpperTriangular x -&gt;
IsUpperTriangular y -&gt; IsUpperTriangular (x - y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x y ? ?; <span class="bp">exact</span> (upper_triangular_plus x (-y)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk19d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsUpperTriangular x -&gt;
IsUpperTriangular y -&gt; IsUpperTriangular (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> upper_triangular_mult.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk19e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsUpperTriangular <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> upper_triangular_identity.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Lower triangular matrices are a subring of the ring of matrices. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk19f"><span class="kn">Definition</span> <span class="nf">lower_triangular_matrix_ring</span>@{i} (R : Ring@{i}) (n : nat)
  : Subring@{i i} (matrix_ring R n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subring (matrix_ring R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1a0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Subring (matrix_ring R n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1a1">napply (Build_Subring&#39;@{i i} (<span class="kr">fun</span> <span class="nv">M</span> : matrix_ring R n =&gt; IsLowerTriangular M)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : matrix_ring R n,
IsHProp (IsLowerTriangular x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1a2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1a2"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsLowerTriangular x -&gt;
IsLowerTriangular y -&gt; IsLowerTriangular (x - y)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1a3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1a3"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsLowerTriangular x -&gt;
IsLowerTriangular y -&gt; IsLowerTriangular (x * y)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1a4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1a4"><hr></label><div class="goal-conclusion">IsLowerTriangular <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1a5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : matrix_ring R n,
IsHProp (IsLowerTriangular x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* These can all be found by typeclass search, but being explicit makes this faster. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1a6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsLowerTriangular x -&gt;
IsLowerTriangular y -&gt; IsLowerTriangular (x - y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x y ? ?; <span class="bp">exact</span> (lower_triangular_plus x (-y)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1a7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : matrix_ring R n,
IsLowerTriangular x -&gt;
IsLowerTriangular y -&gt; IsLowerTriangular (x * y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> lower_triangular_mult.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1a8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsLowerTriangular <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> lower_triangular_identity.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Symmetric Matrices *)</span>

<span class="sd">(** A matrix is symmetric when it is equal to its transpose. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsSymmetric</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">M</span> : Matrix@{i} R n n) : <span class="kt">Type</span>@{i}
  := matrix_transpose_issymmetric : matrix_transpose M = M.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> matrix_transpose_issymmetric {R n} M {_}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The zero matrix is symmetric. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">issymmetric_matrix_zero</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  : IsSymmetric (matrix_zero R n n)
  := matrix_transpose_zero.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The identity matrix is symmetric. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">issymmetric_matrix_identity</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  : IsSymmetric (identity_matrix R n)
  := matrix_transpose_identity.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The sum of two symmetric matrices is symmetric. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1a9"><span class="kn">Instance</span> <span class="nf">issymmetric_matrix_plus</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> <span class="nv">N</span> : Matrix R n n) `{!IsSymmetric M} `{!IsSymmetric N}
  : IsSymmetric (matrix_plus M N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>IsSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSymmetric (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1aa"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>IsSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSymmetric (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ab"><span class="nb">unfold</span> IsSymmetric.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>IsSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_plus M N) = matrix_plus M N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ac"><span class="nb">rewrite</span> matrix_transpose_plus.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>IsSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_plus (matrix_transpose M) (matrix_transpose N) =
matrix_plus M N</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">f_ap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The negation of a symmetric matrix is symmetric. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ad"><span class="kn">Instance</span> <span class="nf">issymmetric_matrix_negate</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{!IsSymmetric M}
  : IsSymmetric (matrix_negate M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSymmetric (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ae"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSymmetric (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1af"><span class="nb">unfold</span> IsSymmetric.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_negate M) = matrix_negate M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b0"><span class="nb">rewrite</span> matrix_transpose_negate.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_negate (matrix_transpose M) = matrix_negate M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">f_ap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A scalar multiple of a symmetric matrix is symmetric. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b1"><span class="kn">Instance</span> <span class="nf">issymmetric_matrix_scale</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">r</span> : R) (<span class="nv">M</span> : Matrix R n n) `{!IsSymmetric M}
  : IsSymmetric (matrix_lact r M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSymmetric (matrix_lact r M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSymmetric (matrix_lact r M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b3"><span class="nb">unfold</span> IsSymmetric.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_lact r M) = matrix_lact r M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b4"><span class="nb">rewrite</span> matrix_transpose_lact.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_lact r (matrix_transpose M) = matrix_lact r M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">f_ap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The transpose of a symmetric matrix is symmetric. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b5"><span class="kn">Instance</span> <span class="nf">issymmetric_matrix_transpose</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{!IsSymmetric M}
  : IsSymmetric (matrix_transpose M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSymmetric (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSymmetric (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b7"><span class="nb">unfold</span> IsSymmetric.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_transpose M) =
matrix_transpose M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b8"><span class="nb">rewrite</span> matrix_transpose_transpose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">M = matrix_transpose M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">symmetry</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A symmetric upper triangular matrix is diagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1b9"><span class="kn">Instance</span> <span class="nf">isdiagonal_upper_triangular_issymmetric</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{!IsSymmetric M} {H : IsUpperTriangular M}
  : IsDiagonal M.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ba"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1bb"><span class="kr">exists</span> (<span class="nv">matrix_diag_vector</span> <span class="nv">M</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">M = matrix_diag (matrix_diag_vector M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1bc">snapply path_matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat),
entry M i j =
entry (matrix_diag (matrix_diag_vector M)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1bd"><span class="nb">intros</span> i j Hi Hj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j =
entry (matrix_diag (matrix_diag_vector M)) i j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1be"><span class="nb">rewrite</span> entry_Build_Matrix, entry_Build_Vector.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsUpperTriangular M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1bf">strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1c0"><span class="nb">destruct</span> (dec (i = j)) <span class="kr">as</span> [p|np].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1c1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>i &lt;&gt; j</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1c1"><hr></label><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1c2">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1c3"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi, Hj</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i i = kronecker_delta i i * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1c4"><span class="nb">rewrite</span> kronecker_delta_refl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi, Hj</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i i = <span class="mi">1</span> * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1c5"><span class="nb">rewrite</span> rng_mult_one_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi, Hj</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i i = entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">f_ap; <span class="nb">apply</span> path_ishprop.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1c6">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>i &lt;&gt; j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1c7"><span class="nb">apply</span> neq_iff_lt_or_gt <span class="kr">in</span> np.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>((i &lt; j)%nat + (i &gt; j)%nat)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1c8"><span class="nb">destruct</span> np <span class="kr">as</span> [l | l].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1c9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &gt; j)%nat</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1c9"><hr></label><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ca">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1cb"><span class="nb">rewrite</span> (kronecker_delta_lt l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = <span class="mi">0</span> * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1cc" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1cc"><span class="nb">rewrite</span> rng_mult_zero_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &lt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1cd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &gt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = kronecker_delta i j * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ce"><span class="nb">rewrite</span> (kronecker_delta_gt l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &gt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = <span class="mi">0</span> * entry M i i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1cf" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1cf"><span class="nb">rewrite</span> rng_mult_zero_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &gt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d0"><span class="nb">rewrite</span> &lt;- (matrix_transpose_issymmetric M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &gt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry (matrix_transpose M) i j = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d1"><span class="nb">rewrite</span> entry_Build_Matrix.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>Hi</var><span class="hyp-type"><b>: </b><span>(i &lt; n)%nat</span></span></span><br><span><var>Hj</var><span class="hyp-type"><b>: </b><span>(j &lt; n)%nat</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">i</span> <span class="nv">j</span> : nat) (<span class="nv">Hi</span> : (i &lt; n)%nat)
(<span class="nv">Hj</span> : (j &lt; n)%nat), (i &lt; j)%nat -&gt; entry M i j = <span class="mi">0</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>(i &gt; j)%nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">entry M j i = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A symmetric lower triangular matrix is diagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d2"><span class="kn">Instance</span> <span class="nf">isdiagonal_lower_triangular_issymmetric</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{!IsSymmetric M} `{!IsLowerTriangular M}
  : IsDiagonal M.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal M</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d4"><span class="nb">rewrite</span> &lt;- (matrix_transpose_issymmetric M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSymmetric M</span></span></span><br><span><var>IsLowerTriangular0</var><span class="hyp-type"><b>: </b><span>IsLowerTriangular M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsDiagonal (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">rapply isdiagonal_upper_triangular_issymmetric.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Note that symmetric matrices do not form a subring (or subalgebra) but they do form a submodule of the module of matrices. *)</span>

<span class="sd">(** ** Skew-symmetric Matrices *)</span>

<span class="sd">(** A matrix is skew-symmetric when it is equal to the negation of its transpose. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsSkewSymmetric</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat} (<span class="nv">M</span> : Matrix@{i} R n n) : <span class="kt">Type</span>@{i}
  := matrix_transpose_isskewsymmetric : matrix_transpose M = matrix_negate M.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> matrix_transpose_isskewsymmetric {R n} M {_}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The zero matrix is skew-symmetric. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d5"><span class="kn">Instance</span> <span class="nf">isskewsymmetric_matrix_zero</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  : IsSkewSymmetric (matrix_zero R n n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d7"><span class="nb">unfold</span> IsSkewSymmetric.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_zero R n n) =
matrix_negate (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d8"><span class="nb">rewrite</span> matrix_transpose_zero.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_zero R n n = matrix_negate (matrix_zero R n n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1d9"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_negate (matrix_zero R n n) = matrix_zero R n n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">napply (rng_negate_zero (A:=matrix_ring R n)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The negation of a skew-symmetric matrix is skew-symmetric. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1da"><span class="kn">Instance</span> <span class="nf">isskewsymmetric_matrix_negate</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{!IsSkewSymmetric M}
  : IsSkewSymmetric (matrix_negate M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1db"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1dc"><span class="nb">unfold</span> IsSkewSymmetric.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_negate M) =
matrix_negate (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1dd"><span class="nb">rewrite</span> matrix_transpose_negate.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_negate (matrix_transpose M) =
matrix_negate (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">f_ap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A scalar multiple of a skew-symmetric matrix is skew-symmetric. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1de"><span class="kn">Instance</span> <span class="nf">isskewsymmetric_matrix_scale</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">r</span> : R) (<span class="nv">M</span> : Matrix R n n) `{!IsSkewSymmetric M}
  : IsSkewSymmetric (matrix_lact r M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_lact r M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1df" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1df"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_lact r M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e0"><span class="nb">unfold</span> IsSkewSymmetric.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_lact r M) =
matrix_negate (matrix_lact r M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e1"><span class="nb">rewrite</span> matrix_transpose_lact.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_lact r (matrix_transpose M) =
matrix_negate (matrix_lact r M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e2">rhs_V napply (lm_neg (M:=Build_LeftModule _ (abgroup_matrix R n n) _) r M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_lact r (matrix_transpose M) = lact r (- M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">f_ap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The transpose of a skew-symmetric matrix is skew-symmetric. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e3"><span class="kn">Instance</span> <span class="nf">isskewsymmetric_matrix_transpose</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> : Matrix R n n) `{!IsSkewSymmetric M}
  : IsSkewSymmetric (matrix_transpose M).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e5"><span class="nb">unfold</span> IsSkewSymmetric.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_transpose M) =
matrix_negate (matrix_transpose M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e6"><span class="nb">rewrite</span> &lt;- matrix_transpose_negate.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_transpose M) =
matrix_transpose (matrix_negate M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">f_ap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The sum of two skew-symmetric matrices is skew-symmetric. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e7"><span class="kn">Instance</span> <span class="nf">isskewsymmetric_matrix_plus</span> {<span class="nv">R</span> : Ring@{i}} {<span class="nv">n</span> : nat}
  (<span class="nv">M</span> <span class="nv">N</span> : Matrix R n n) `{!IsSkewSymmetric M} `{!IsSkewSymmetric N}
  : IsSkewSymmetric (matrix_plus M N).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br><span><var>IsSkewSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br><span><var>IsSkewSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSkewSymmetric (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1e9"><span class="nb">unfold</span> IsSkewSymmetric.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br><span><var>IsSkewSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_transpose (matrix_plus M N) =
matrix_negate (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ea"><span class="nb">rewrite</span> matrix_transpose_plus.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br><span><var>IsSkewSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_plus (matrix_transpose M) (matrix_transpose N) =
matrix_negate (matrix_plus M N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1eb">rhs napply (grp_inv_op (G:=abgroup_matrix R n n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br><span><var>IsSkewSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_plus (matrix_transpose M) (matrix_transpose N) =
sg_op (inv N) (inv M)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ec">rhs_V rapply AbelianGroup.abgroup_commutative.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>M, N</var><span class="hyp-type"><b>: </b><span>Matrix R n n</span></span></span><br><span><var>IsSkewSymmetric0</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric M</span></span></span><br><span><var>IsSkewSymmetric1</var><span class="hyp-type"><b>: </b><span>IsSkewSymmetric N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">matrix_plus (matrix_transpose M) (matrix_transpose N) =
sg_op (inv M) (inv N)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">f_ap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Skew-symmetric matrices degenerate to symmetric matrices in rings with characteristic 2. In odd characteristic the module of matrices can be decomposed into the direct sum of symmetric and skew-symmetric matrices. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">MatrixCat</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** The wild category [MatrixCat R] of [R]-valued matrices. This category has natural numbers as objects and m x n matrices as the arrows between [m] and [n]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">MatrixCat</span> (<span class="nv">R</span> : Ring) := nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">isgraph_matrixcat</span> {<span class="nv">R</span> : Ring} : IsGraph (MatrixCat R)
    := {| Hom := Matrix R |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ed">#[export] <span class="kn">Instance</span> <span class="nf">is01cat_matrixcat</span> {<span class="nv">R</span> : Ring} : Is01Cat (MatrixCat R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Is01Cat (MatrixCat R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ee"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Is01Cat (MatrixCat R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1ef">snapply Build_Is01Cat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : MatrixCat R, a $-&gt; a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1f0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1f0"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : MatrixCat R,
(b $-&gt; c) -&gt; (a $-&gt; b) -&gt; a $-&gt; c</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1f1" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1f1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : MatrixCat R, a $-&gt; a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (identity_matrix R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1f2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : MatrixCat R,
(b $-&gt; c) -&gt; (a $-&gt; b) -&gt; a $-&gt; c</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1f3"><span class="nb">intros</span> l m n M N.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>l, m, n</var><span class="hyp-type"><b>: </b><span>MatrixCat R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>m $-&gt; n</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>l $-&gt; m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">l $-&gt; n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (matrix_mult N M).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">is2graph_matrixcat</span> {<span class="nv">R</span> : Ring} : Is2Graph (MatrixCat R)
    := is2graph_paths _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** [MatrixCat R] forms a strong 1-category. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1f4">#[export] <span class="kn">Instance</span> <span class="nf">is1catstrong_matrixcat</span> {<span class="nv">R</span> : Ring} : Is1Cat_Strong (MatrixCat R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Is1Cat_Strong (MatrixCat R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1f5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Is1Cat_Strong (MatrixCat R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1f6">snapply Build_Is1Cat_Strong.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : MatrixCat R, Is01Cat (a $-&gt; b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1f7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1f7"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : MatrixCat R, Is0Gpd (a $-&gt; b)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1f8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1f8"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : MatrixCat R) (<span class="nv">g</span> : b $-&gt; c),
Is0Functor (cat_postcomp a g)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1f9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1f9"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b),
Is0Functor (cat_precomp c f)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1fa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1fa"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b)
(<span class="nv">g</span> : b $-&gt; c) (<span class="nv">h</span> : c $-&gt; d),
h $o g $o f = h $o (g $o f)</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1fb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1fb"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b)
(<span class="nv">g</span> : b $-&gt; c) (<span class="nv">h</span> : c $-&gt; d),
h $o (g $o f) = h $o g $o f</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1fc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1fc"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b),
Id b $o f = f</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1fd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1fd"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b),
f $o Id a = f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Most of the structure comes from typeclasses in WildCat.Paths. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk1fe"><span class="mi">1</span>-<span class="mi">4</span>: <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b)
(<span class="nv">g</span> : b $-&gt; c) (<span class="nv">h</span> : c $-&gt; d),
h $o g $o f = h $o (g $o f)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="matrix-v-chk1ff" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk1ff"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b)
(<span class="nv">g</span> : b $-&gt; c) (<span class="nv">h</span> : c $-&gt; d),
h $o (g $o f) = h $o g $o f</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk200" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk200"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b),
Id b $o f = f</div></blockquote><input class="alectryon-extra-goal-toggle" id="matrix-v-chk201" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><label class="goal-separator" for="matrix-v-chk201"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b),
f $o Id a = f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk202" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk202">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b)
(<span class="nv">g</span> : b $-&gt; c) (<span class="nv">h</span> : c $-&gt; d),
h $o g $o f = h $o (g $o f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (associative_matrix_mult R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk203">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b)
(<span class="nv">g</span> : b $-&gt; c) (<span class="nv">h</span> : c $-&gt; d),
h $o (g $o f) = h $o g $o f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk204"><span class="nb">intros</span> k l m n M N P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>k, l, m, n</var><span class="hyp-type"><b>: </b><span>MatrixCat R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>k $-&gt; l</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>l $-&gt; m</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>m $-&gt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P $o (N $o M) = P $o N $o M</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk205"><span class="nb">apply</span> inverse.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br><span><var>k, l, m, n</var><span class="hyp-type"><b>: </b><span>MatrixCat R</span></span></span><br><span><var>M</var><span class="hyp-type"><b>: </b><span>k $-&gt; l</span></span></span><br><span><var>N</var><span class="hyp-type"><b>: </b><span>l $-&gt; m</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>m $-&gt; n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P $o N $o M = P $o (N $o M)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (associative_matrix_mult R).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk206">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b),
Id b $o f = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> right_identity_matrix_mult.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="matrix-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="matrix-v-chk207">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>R</var><span class="hyp-type"><b>: </b><span>Ring</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : MatrixCat R) (<span class="nv">f</span> : a $-&gt; b),
f $o Id a = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> left_identity_matrix_mult.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** TODO: Define [HasEquivs] for [MatrixCat].  *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">MatrixCat</span>.</span></span></pre>
</div>
</div></body>
</html>
