<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Core.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkac0" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkac0"><span class="kn">Require Import</span> Basics.Overture Basics.Tactics Basics.Decidable
  Spaces.Nat.Core.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Set Universe Minimization ToSet</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Binary Positive Integers *)</span>

<span class="sd">(** Most of this file has been adapted from the Coq standard library for positive binary integers. *)</span>

<span class="sd">(** Here we define the inductive type of positive binary numbers. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">Pos</span> : Type0 :=
  | xH : Pos
  | x0 : Pos -&gt; Pos
  | x1 : Pos -&gt; Pos.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Declare Scope</span> positive_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Delimit Scope</span> positive_scope <span class="kr">with</span> pos.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Here are some notations that let us write binary positive integers more easily. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;1&quot;</span> := xH : positive_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;p ~ 1&quot;</span> := (x1 p) : positive_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;p ~ 0&quot;</span> := (x0 p) : positive_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> positive_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Successor *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_succ</span> <span class="nv">x</span> :=
  <span class="kr">match</span> x <span class="kr">with</span>
    | p~<span class="mi">1</span> =&gt; (pos_succ p)~<span class="mi">0</span>
    | p~<span class="mi">0</span> =&gt; p~<span class="mi">1</span>
    | <span class="mi">1</span> =&gt; <span class="mi">1</span>~<span class="mi">0</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Peano induction (due to Daniel Schepler) *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_peano_ind</span> (<span class="nv">P</span> : Pos -&gt; <span class="kt">Type</span>) (<span class="nv">a</span> : P <span class="mi">1</span>)
  (<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">p</span>, P p -&gt; P (pos_succ p)) (<span class="nv">p</span> : Pos) : P p
  := <span class="kr">let</span> <span class="nv">f2</span> := pos_peano_ind (<span class="kr">fun</span> <span class="nv">p</span> =&gt; P (p~<span class="mi">0</span>))
    (f _ a) (<span class="kr">fun</span> <span class="nv">p</span> (<span class="nv">x</span> : P p~<span class="mi">0</span>) =&gt; f _ (f _ x))
  <span class="kr">in</span> <span class="kr">match</span> p <span class="kr">with</span>
      | q~<span class="mi">1</span> =&gt; f _ (f2 q)
      | q~<span class="mi">0</span> =&gt; f2 q
      | <span class="mi">1</span> =&gt; a
     <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Computation rules for Peano induction *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_peano_ind_beta_1</span> (<span class="nv">P</span> : Pos -&gt; <span class="kt">Type</span>) (<span class="nv">a</span> : P <span class="mi">1</span>)
  (<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">p</span>, P p -&gt; P (pos_succ p))
  : pos_peano_ind P a f <span class="mi">1</span> = a := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkac1" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkac1"><span class="kn">Definition</span> <span class="nf">pos_peano_ind_beta_pos_succ</span> (<span class="nv">P</span> : Pos -&gt; <span class="kt">Type</span>) (<span class="nv">a</span> : P <span class="mi">1</span>)
  (<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">p</span>, P p -&gt; P (pos_succ p)) (<span class="nv">p</span> : Pos)
  : pos_peano_ind P a f (pos_succ p) = f _ (pos_peano_ind P a f p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>Pos -&gt; <span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">p</span> : Pos, P p -&gt; P (pos_succ p)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pos_peano_ind P a f (pos_succ p) =
f p (pos_peano_ind P a f p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkac2" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkac2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>Pos -&gt; <span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">p</span> : Pos, P p -&gt; P (pos_succ p)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pos_peano_ind P a f (pos_succ p) =
f p (pos_peano_ind P a f p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkac3" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkac3"><span class="nb">revert</span> P a f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : Pos -&gt; <span class="kt">Type</span>) (<span class="nv">a</span> : P <span class="mi">1</span>)
(<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">p</span> : Pos, P p -&gt; P (pos_succ p)),
pos_peano_ind P a f (pos_succ p) =
f p (pos_peano_ind P a f p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkac4" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkac4"><span class="nb">induction</span> p; <span class="nb">trivial</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHp</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : Pos -&gt; <span class="kt">Type</span>) (<span class="nv">a</span> : P <span class="mi">1</span>)
(<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">p</span> : Pos, P p -&gt; P (pos_succ p)),
pos_peano_ind P a f (pos_succ p) = f p (pos_peano_ind P a f p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">P</span> : Pos -&gt; <span class="kt">Type</span>) (<span class="nv">a</span> : P <span class="mi">1</span>)
(<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">p</span> : Pos, P p -&gt; P (pos_succ p)),
pos_peano_ind P a f (pos_succ p~<span class="mi">1</span>) =
f p~<span class="mi">1</span> (pos_peano_ind P a f p~<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkac5" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkac5"><span class="nb">intros</span> P a f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHp</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : Pos -&gt; <span class="kt">Type</span>) (<span class="nv">a</span> : P <span class="mi">1</span>)
(<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">p</span> : Pos, P p -&gt; P (pos_succ p)),
pos_peano_ind P a f (pos_succ p) = f p (pos_peano_ind P a f p)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Pos -&gt; <span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">p</span> : Pos, P p -&gt; P (pos_succ p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pos_peano_ind P a f (pos_succ p~<span class="mi">1</span>) =
f p~<span class="mi">1</span> (pos_peano_ind P a f p~<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">srapply IHp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_peano_rec</span> (<span class="nv">P</span> : <span class="kt">Type</span>)
  : P -&gt; (Pos -&gt; P -&gt; P) -&gt; Pos -&gt; P
  := pos_peano_ind (<span class="kr">fun</span> <span class="nv">_</span> =&gt; P).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_peano_rec_beta_pos_succ</span> (<span class="nv">P</span> : <span class="kt">Type</span>)
  (<span class="nv">a</span> : P) (<span class="nv">f</span> : Pos -&gt; P -&gt; P) (<span class="nv">p</span> : Pos)
  : pos_peano_rec P a f (pos_succ p) = f p (pos_peano_rec P a f p)
  := pos_peano_ind_beta_pos_succ (<span class="kr">fun</span> <span class="nv">_</span> =&gt; P) a f p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Properties of constructors *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">x0_inj</span> {<span class="nv">z</span> <span class="nv">w</span> : Pos} (<span class="nv">p</span> : x0 z = x0 w) : z = w
  := transport (<span class="kr">fun</span> <span class="nv">s</span> =&gt; z = (
    <span class="kr">match</span> s <span class="kr">with</span> xH =&gt; w | x0 a =&gt; a | x1 a =&gt; w <span class="kr">end</span>)) p idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">x1_inj</span> {<span class="nv">z</span> <span class="nv">w</span> : Pos} (<span class="nv">p</span> : x1 z = x1 w) : z = w
  := transport (<span class="kr">fun</span> <span class="nv">s</span> =&gt; z = (
    <span class="kr">match</span> s <span class="kr">with</span> xH =&gt; w | x0 a =&gt; w | x1 a =&gt; a <span class="kr">end</span>)) p idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">x0_neq_xH</span> {<span class="nv">z</span> : Pos} : x0 z &lt;&gt; xH
  := <span class="kr">fun</span> <span class="nv">p</span> =&gt; transport (<span class="kr">fun</span> <span class="nv">s</span> =&gt;
    <span class="kr">match</span> s <span class="kr">with</span> xH =&gt; Empty | x0 a =&gt; z = a | x1 a =&gt; Empty <span class="kr">end</span>) p idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">x1_neq_xH</span> {<span class="nv">z</span> : Pos} : x1 z &lt;&gt; xH
  := <span class="kr">fun</span> <span class="nv">p</span> =&gt; transport (<span class="kr">fun</span> <span class="nv">s</span> =&gt;
    <span class="kr">match</span> s <span class="kr">with</span> xH =&gt; Empty | x0 a =&gt; Empty | x1 a =&gt; z = a <span class="kr">end</span>) p idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">x0_neq_x1</span> {<span class="nv">z</span> <span class="nv">w</span> : Pos} : x0 z &lt;&gt; x1 w
  := <span class="kr">fun</span> <span class="nv">p</span> =&gt; transport (<span class="kr">fun</span> <span class="nv">s</span> =&gt;
    <span class="kr">match</span> s <span class="kr">with</span> xH =&gt; Empty | x0 a =&gt; z = a | x1 _ =&gt; Empty <span class="kr">end</span>) p idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">xH_neq_x0</span> {<span class="nv">z</span> : Pos} : xH &lt;&gt; x0 z
  := x0_neq_xH o <span class="nb">symmetry</span> _ _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">xH_neq_x1</span> {<span class="nv">z</span> : Pos} : xH &lt;&gt; x1 z
  := x1_neq_xH o <span class="nb">symmetry</span> _ _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">x1_neq_x0</span> {<span class="nv">z</span> <span class="nv">w</span> : Pos} : x1 z &lt;&gt; x0 w
  := x0_neq_x1 o <span class="nb">symmetry</span> _ _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Positive binary integers have decidable paths *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkac6" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkac6"><span class="kn">Instance</span> <span class="nf">decpaths_pos</span> : DecidablePaths Pos.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">DecidablePaths Pos</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkac7" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkac7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">DecidablePaths Pos</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkac8" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkac8"><span class="nb">intros</span> n; <span class="nb">induction</span> n <span class="kr">as</span> [|zn|on];
  <span class="nb">intros</span> m; <span class="nb">induction</span> m <span class="kr">as</span> [|zm|om].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (<span class="mi">1</span> = <span class="mi">1</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="core-v-chkac9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (<span class="mi">1</span> = zm)</span></span></span><br></div><label class="goal-separator" for="core-v-chkac9"><hr></label><div class="goal-conclusion">Decidable (<span class="mi">1</span> = zm~<span class="mi">0</span>)</div></blockquote><input class="alectryon-extra-goal-toggle" id="core-v-chkaca" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (<span class="mi">1</span> = om)</span></span></span><br></div><label class="goal-separator" for="core-v-chkaca"><hr></label><div class="goal-conclusion">Decidable (<span class="mi">1</span> = om~<span class="mi">1</span>)</div></blockquote><input class="alectryon-extra-goal-toggle" id="core-v-chkacb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br></div><label class="goal-separator" for="core-v-chkacb"><hr></label><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = <span class="mi">1</span>)</div></blockquote><input class="alectryon-extra-goal-toggle" id="core-v-chkacc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (zn~<span class="mi">0</span> = zm)</span></span></span><br></div><label class="goal-separator" for="core-v-chkacc"><hr></label><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = zm~<span class="mi">0</span>)</div></blockquote><input class="alectryon-extra-goal-toggle" id="core-v-chkacd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (zn~<span class="mi">0</span> = om)</span></span></span><br></div><label class="goal-separator" for="core-v-chkacd"><hr></label><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = om~<span class="mi">1</span>)</div></blockquote><input class="alectryon-extra-goal-toggle" id="core-v-chkace" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br></div><label class="goal-separator" for="core-v-chkace"><hr></label><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = <span class="mi">1</span>)</div></blockquote><input class="alectryon-extra-goal-toggle" id="core-v-chkacf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (on~<span class="mi">1</span> = zm)</span></span></span><br></div><label class="goal-separator" for="core-v-chkacf"><hr></label><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = zm~<span class="mi">0</span>)</div></blockquote><input class="alectryon-extra-goal-toggle" id="core-v-chkad0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (on~<span class="mi">1</span> = om)</span></span></span><br></div><label class="goal-separator" for="core-v-chkad0"><hr></label><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = om~<span class="mi">1</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkad1" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkad1">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (<span class="mi">1</span> = <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl idpath).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkad2" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkad2">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (<span class="mi">1</span> = zm)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (<span class="mi">1</span> = zm~<span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr xH_neq_x0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkad3" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkad3">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (<span class="mi">1</span> = om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (<span class="mi">1</span> = om~<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr xH_neq_x1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkad4" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkad4">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr x0_neq_xH).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkad5" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkad5">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (zn~<span class="mi">0</span> = zm)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = zm~<span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkad6" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkad6"><span class="nb">destruct</span> (IHzn zm) <span class="kr">as</span> [p|q].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (zn~<span class="mi">0</span> = zm)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>zn = zm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = zm~<span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="core-v-chkad7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (zn~<span class="mi">0</span> = zm)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>zn &lt;&gt; zm</span></span></span><br></div><label class="goal-separator" for="core-v-chkad7"><hr></label><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = zm~<span class="mi">0</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkad8" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkad8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (zn~<span class="mi">0</span> = zm)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>zn = zm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = zm~<span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> inl, ap, p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkad9" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkad9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (zn~<span class="mi">0</span> = zm)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>zn &lt;&gt; zm</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = zm~<span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkada" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkada"><span class="nb">apply</span> inr; <span class="nb">intro</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (zn~<span class="mi">0</span> = zm)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>zn &lt;&gt; zm</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>zn~<span class="mi">0</span> = zm~<span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> q, x0_inj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkadb" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkadb">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>zn</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (zn = y)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (zn~<span class="mi">0</span> = om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (zn~<span class="mi">0</span> = om~<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr x0_neq_x1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkadc" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkadc">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr x1_neq_xH).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkadd" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkadd">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br><span><var>zm</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHzm</var><span class="hyp-type"><b>: </b><span>Decidable (on~<span class="mi">1</span> = zm)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = zm~<span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr x1_neq_x0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkade" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkade">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (on~<span class="mi">1</span> = om)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = om~<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkadf" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkadf"><span class="nb">destruct</span> (IHon om) <span class="kr">as</span> [p|q].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (on~<span class="mi">1</span> = om)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>on = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = om~<span class="mi">1</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="core-v-chkae0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (on~<span class="mi">1</span> = om)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>on &lt;&gt; om</span></span></span><br></div><label class="goal-separator" for="core-v-chkae0"><hr></label><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = om~<span class="mi">1</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkae1" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkae1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (on~<span class="mi">1</span> = om)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>on = om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = om~<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> inl, ap, p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkae2" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkae2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (on~<span class="mi">1</span> = om)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>on &lt;&gt; om</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (on~<span class="mi">1</span> = om~<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkae3" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkae3"><span class="nb">apply</span> inr; <span class="nb">intro</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>on</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHon</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Pos, Decidable (on = y)</span></span></span><br><span><var>om</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHom</var><span class="hyp-type"><b>: </b><span>Decidable (on~<span class="mi">1</span> = om)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>on &lt;&gt; om</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>on~<span class="mi">1</span> = om~<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> q, x1_inj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Decidable paths imply [Pos] is a hSet *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">ishset_pos</span> : IsHSet Pos := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Operations over positive numbers *)</span>

<span class="sd">(** ** Addition *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_add</span> <span class="nv">x</span> <span class="nv">y</span> :=
  <span class="kr">match</span> x, y <span class="kr">with</span>
    | p~<span class="mi">1</span>, q~<span class="mi">1</span> =&gt; (pos_add_carry p q)~<span class="mi">0</span>
    | p~<span class="mi">1</span>, q~<span class="mi">0</span> =&gt; (pos_add p q)~<span class="mi">1</span>
    | p~<span class="mi">1</span>, <span class="mi">1</span> =&gt; (pos_succ p)~<span class="mi">0</span>
    | p~<span class="mi">0</span>, q~<span class="mi">1</span> =&gt; (pos_add p q)~<span class="mi">1</span>
    | p~<span class="mi">0</span>, q~<span class="mi">0</span> =&gt; (pos_add p q)~<span class="mi">0</span>
    | p~<span class="mi">0</span>, <span class="mi">1</span> =&gt; p~<span class="mi">1</span>
    | <span class="mi">1</span>, q~<span class="mi">1</span> =&gt; (pos_succ q)~<span class="mi">0</span>
    | <span class="mi">1</span>, q~<span class="mi">0</span> =&gt; q~<span class="mi">1</span>
    | <span class="mi">1</span>, <span class="mi">1</span> =&gt; <span class="mi">1</span>~<span class="mi">0</span>
  <span class="kr">end</span>

<span class="kr">with</span> pos_add_carry x y :=
  <span class="kr">match</span> x, y <span class="kr">with</span>
    | p~<span class="mi">1</span>, q~<span class="mi">1</span> =&gt; (pos_add_carry p q)~<span class="mi">1</span>
    | p~<span class="mi">1</span>, q~<span class="mi">0</span> =&gt; (pos_add_carry p q)~<span class="mi">0</span>
    | p~<span class="mi">1</span>, <span class="mi">1</span> =&gt; (pos_succ p)~<span class="mi">1</span>
    | p~<span class="mi">0</span>, q~<span class="mi">1</span> =&gt; (pos_add_carry p q)~<span class="mi">0</span>
    | p~<span class="mi">0</span>, q~<span class="mi">0</span> =&gt; (pos_add p q)~<span class="mi">1</span>
    | p~<span class="mi">0</span>, <span class="mi">1</span> =&gt; (pos_succ p)~<span class="mi">0</span>
    | <span class="mi">1</span>, q~<span class="mi">1</span> =&gt; (pos_succ q)~<span class="mi">1</span>
    | <span class="mi">1</span>, q~<span class="mi">0</span> =&gt; (pos_succ q)~<span class="mi">0</span>
    | <span class="mi">1</span>, <span class="mi">1</span> =&gt; <span class="mi">1</span>~<span class="mi">1</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Infix</span> <span class="s2">&quot;+&quot;</span> := pos_add : positive_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Operation [x -&gt; 2*x-1] *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_pred_double</span> <span class="nv">x</span> :=
  <span class="kr">match</span> x <span class="kr">with</span>
    | p~<span class="mi">1</span> =&gt; p~<span class="mi">0</span>~<span class="mi">1</span>
    | p~<span class="mi">0</span> =&gt; (pos_pred_double p)~<span class="mi">1</span>
    | <span class="mi">1</span> =&gt; <span class="mi">1</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Predecessor *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_pred</span> <span class="nv">x</span> :=
  <span class="kr">match</span> x <span class="kr">with</span>
    | p~<span class="mi">1</span> =&gt; p~<span class="mi">0</span>
    | p~<span class="mi">0</span> =&gt; pos_pred_double p
    | <span class="mi">1</span> =&gt; <span class="mi">1</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** An auxiliary type for subtraction *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Inductive</span> <span class="nf">Pos_mask</span> : <span class="kt">Set</span> :=
  | IsNul : Pos_mask
  | IsPos : Pos -&gt; Pos_mask
  | IsNeg : Pos_mask.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Operation [x -&gt; 2*x+1] *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_mask_succ_double</span> (<span class="nv">x</span> : Pos_mask) : Pos_mask :=
  <span class="kr">match</span> x <span class="kr">with</span>
    | IsNul =&gt; IsPos <span class="mi">1</span>
    | IsNeg =&gt; IsNeg
    | IsPos p =&gt; IsPos p~<span class="mi">1</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Operation [x -&gt; 2*x] *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_mask_double</span> (<span class="nv">x</span> : Pos_mask) : Pos_mask :=
  <span class="kr">match</span> x <span class="kr">with</span>
    | IsNul =&gt; IsNul
    | IsNeg =&gt; IsNeg
    | IsPos p =&gt; IsPos p~<span class="mi">0</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Operation [x -&gt; 2*x-2] *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_mask_double_pred</span> <span class="nv">x</span> : Pos_mask :=
  <span class="kr">match</span> x <span class="kr">with</span>
    | p~<span class="mi">1</span> =&gt; IsPos p~<span class="mi">0</span>~<span class="mi">0</span>
    | p~<span class="mi">0</span> =&gt; IsPos (pos_pred_double p)~<span class="mi">0</span>
    | <span class="mi">1</span> =&gt; IsNul
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Predecessor with mask *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_mask_pred</span> (<span class="nv">p</span> : Pos_mask) : Pos_mask :=
  <span class="kr">match</span> p <span class="kr">with</span>
    | IsPos <span class="mi">1</span> =&gt; IsNul
    | IsPos q =&gt; IsPos (pos_pred q)
    | IsNul =&gt; IsNeg
    | IsNeg =&gt; IsNeg
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Subtraction, result as a mask *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_mask_sub</span> (<span class="nv">x</span> <span class="nv">y</span> : Pos) {<span class="nv">struct</span> <span class="nv">y</span>} : Pos_mask :=
  <span class="kr">match</span> x, y <span class="kr">with</span>
    | p~<span class="mi">1</span>, q~<span class="mi">1</span> =&gt; pos_mask_double (pos_mask_sub p q)
    | p~<span class="mi">1</span>, q~<span class="mi">0</span> =&gt; pos_mask_succ_double (pos_mask_sub p q)
    | p~<span class="mi">1</span>, <span class="mi">1</span> =&gt; IsPos p~<span class="mi">0</span>
    | p~<span class="mi">0</span>, q~<span class="mi">1</span> =&gt; pos_mask_succ_double (pos_mask_sub_carry p q)
    | p~<span class="mi">0</span>, q~<span class="mi">0</span> =&gt; pos_mask_double (pos_mask_sub p q)
    | p~<span class="mi">0</span>, <span class="mi">1</span> =&gt; IsPos (pos_pred_double p)
    | <span class="mi">1</span>, <span class="mi">1</span> =&gt; IsNul
    | <span class="mi">1</span>, _ =&gt; IsNeg
  <span class="kr">end</span>

<span class="kr">with</span> pos_mask_sub_carry (x y : Pos) {<span class="kr">struct</span> y} : Pos_mask :=
  <span class="kr">match</span> x, y <span class="kr">with</span>
    | p~<span class="mi">1</span>, q~<span class="mi">1</span> =&gt; pos_mask_succ_double (pos_mask_sub_carry p q)
    | p~<span class="mi">1</span>, q~<span class="mi">0</span> =&gt; pos_mask_double (pos_mask_sub p q)
    | p~<span class="mi">1</span>, <span class="mi">1</span> =&gt; IsPos (pos_pred_double p)
    | p~<span class="mi">0</span>, q~<span class="mi">1</span> =&gt; pos_mask_double (pos_mask_sub_carry p q)
    | p~<span class="mi">0</span>, q~<span class="mi">0</span> =&gt; pos_mask_succ_double (pos_mask_sub_carry p q)
    | p~<span class="mi">0</span>, <span class="mi">1</span> =&gt; pos_mask_double_pred p
    | <span class="mi">1</span>, _ =&gt; IsNeg
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Subtraction, result as a positive, returning 1 if [x&lt;=y] *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_sub</span> <span class="nv">x</span> <span class="nv">y</span> :=
  <span class="kr">match</span> pos_mask_sub x y <span class="kr">with</span>
    | IsPos z =&gt; z
    | _ =&gt; <span class="mi">1</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Infix</span> <span class="s2">&quot;-&quot;</span> := pos_sub : positive_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Multiplication *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_mul</span> <span class="nv">x</span> <span class="nv">y</span> :=
  <span class="kr">match</span> x <span class="kr">with</span>
    | p~<span class="mi">1</span> =&gt; y + (pos_mul p y)~<span class="mi">0</span>
    | p~<span class="mi">0</span> =&gt; (pos_mul p y)~<span class="mi">0</span>
    | <span class="mi">1</span> =&gt; y
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Infix</span> <span class="s2">&quot;*&quot;</span> := pos_mul : positive_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Iteration over a positive number *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkae4" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkae4"><span class="kn">Definition</span> <span class="nf">pos_iter</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; A)
  : Pos -&gt; A -&gt; A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Pos -&gt; A -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkae5" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkae5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Pos -&gt; A -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkae6" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkae6"><span class="nb">apply</span> (pos_peano_rec (A -&gt; A) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Pos -&gt; (A -&gt; A) -&gt; A -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkae7" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkae7"><span class="nb">intros</span> n g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (f o g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Iteration of a two-variable function, with nesting reflecting the bits *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_iter_op</span> {<span class="nv">A</span>} (<span class="nv">op</span> : A -&gt; A -&gt; A)
  := <span class="kr">fix</span> p_iter (p : Pos) (a : A) : A
    := <span class="kr">match</span> p <span class="kr">with</span>
        | <span class="mi">1</span> =&gt; a
        | p~<span class="mi">0</span> =&gt; p_iter p (op a a)
        | p~<span class="mi">1</span> =&gt; op a (p_iter p (op a a))
       <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Power *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_pow</span> (<span class="nv">x</span> : Pos) := pos_iter (pos_mul x) <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Square *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_square</span> <span class="nv">p</span> :=
  <span class="kr">match</span> p <span class="kr">with</span>
    | p~<span class="mi">1</span> =&gt; (pos_square p + p)~<span class="mi">0</span>~<span class="mi">1</span>
    | p~<span class="mi">0</span> =&gt; (pos_square p)~<span class="mi">0</span>~<span class="mi">0</span>
    | <span class="mi">1</span> =&gt; <span class="mi">1</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Division by 2 rounded below but for 1 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_div2</span> <span class="nv">p</span> :=
  <span class="kr">match</span> p <span class="kr">with</span>
    | <span class="mi">1</span> =&gt; <span class="mi">1</span>
    | p~<span class="mi">0</span> =&gt; p
    | p~<span class="mi">1</span> =&gt; p
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Division by 2 rounded up *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_div2_up</span> <span class="nv">p</span> :=
 <span class="kr">match</span> p <span class="kr">with</span>
   | <span class="mi">1</span> =&gt; <span class="mi">1</span>
   | p~<span class="mi">0</span> =&gt; p
   | p~<span class="mi">1</span> =&gt; pos_succ p
 <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Number of digits in a positive number *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">nat_pos_size</span> <span class="nv">p</span> : nat :=
  <span class="kr">match</span> p <span class="kr">with</span>
    | <span class="mi">1</span> =&gt; S O
    | p~<span class="mi">1</span> =&gt; S (nat_pos_size p)
    | p~<span class="mi">0</span> =&gt; S (nat_pos_size p)
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Same, with positive output *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_size</span> <span class="nv">p</span> :=
  <span class="kr">match</span> p <span class="kr">with</span>
    | <span class="mi">1</span> =&gt; <span class="mi">1</span>
    | p~<span class="mi">1</span> =&gt; pos_succ (pos_size p)
    | p~<span class="mi">0</span> =&gt; pos_succ (pos_size p)
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** From binary positive numbers to Peano natural numbers *)</span>

<span class="sd">(** Sends [n] to [n], missing [0]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">nat_of_pos</span> (<span class="nv">p</span> : Pos) : nat
  := pos_iter S p <span class="mi">0</span>%nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** From Peano natural numbers to binary positive numbers *)</span>

<span class="sd">(** A version preserving positive numbers, and sending 0 to 1. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_of_nat</span> (<span class="nv">n</span> : nat) : Pos :=
 <span class="kr">match</span> n <span class="kr">with</span>
   | O =&gt; <span class="mi">1</span>
   | S O =&gt; <span class="mi">1</span>
   | S x =&gt; pos_succ (pos_of_nat x)
 <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Another version that converts [n] into [n+1] *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_of_succ_nat</span> (<span class="nv">n</span> : nat) : Pos :=
  <span class="kr">match</span> n <span class="kr">with</span>
    | O =&gt; <span class="mi">1</span>
    | S x =&gt; pos_succ (pos_of_succ_nat x)
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Conversion with a decimal representation for printing/parsing *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">ten</span> := <span class="mi">1</span>~<span class="mi">0</span>~<span class="mi">1</span>~<span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_of_uint_acc</span> (<span class="nv">d</span> : Decimal.uint) (<span class="nv">acc</span> : Pos) :=
  <span class="kr">match</span> d <span class="kr">with</span>
  | Decimal.Nil =&gt; acc
  | Decimal.D0 l =&gt; pos_of_uint_acc l (pos_mul ten acc)
  | Decimal.D1 l =&gt; pos_of_uint_acc l (pos_add <span class="mi">1</span> (pos_mul ten acc))
  | Decimal.D2 l =&gt; pos_of_uint_acc l (pos_add <span class="mi">1</span>~<span class="mi">0</span> (pos_mul ten acc))
  | Decimal.D3 l =&gt; pos_of_uint_acc l (pos_add <span class="mi">1</span>~<span class="mi">1</span> (pos_mul ten acc))
  | Decimal.D4 l =&gt; pos_of_uint_acc l (pos_add <span class="mi">1</span>~<span class="mi">0</span>~<span class="mi">0</span> (pos_mul ten acc))
  | Decimal.D5 l =&gt; pos_of_uint_acc l (pos_add <span class="mi">1</span>~<span class="mi">0</span>~<span class="mi">1</span> (pos_mul ten acc))
  | Decimal.D6 l =&gt; pos_of_uint_acc l (pos_add <span class="mi">1</span>~<span class="mi">1</span>~<span class="mi">0</span> (pos_mul ten acc))
  | Decimal.D7 l =&gt; pos_of_uint_acc l (pos_add <span class="mi">1</span>~<span class="mi">1</span>~<span class="mi">1</span> (pos_mul ten acc))
  | Decimal.D8 l =&gt; pos_of_uint_acc l (pos_add <span class="mi">1</span>~<span class="mi">0</span>~<span class="mi">0</span>~<span class="mi">0</span> (pos_mul ten acc))
  | Decimal.D9 l =&gt; pos_of_uint_acc l (pos_add <span class="mi">1</span>~<span class="mi">0</span>~<span class="mi">0</span>~<span class="mi">1</span> (pos_mul ten acc))
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_of_uint</span> (<span class="nv">d</span> : Decimal.uint) : option Pos :=
  <span class="kr">match</span> d <span class="kr">with</span>
    | Decimal.Nil =&gt; None
    | Decimal.D0 l =&gt; pos_of_uint l
    | Decimal.D1 l =&gt; Some (pos_of_uint_acc l <span class="mi">1</span>)
    | Decimal.D2 l =&gt; Some (pos_of_uint_acc l <span class="mi">1</span>~<span class="mi">0</span>)
    | Decimal.D3 l =&gt; Some (pos_of_uint_acc l <span class="mi">1</span>~<span class="mi">1</span>)
    | Decimal.D4 l =&gt; Some (pos_of_uint_acc l <span class="mi">1</span>~<span class="mi">0</span>~<span class="mi">0</span>)
    | Decimal.D5 l =&gt; Some (pos_of_uint_acc l <span class="mi">1</span>~<span class="mi">0</span>~<span class="mi">1</span>)
    | Decimal.D6 l =&gt; Some (pos_of_uint_acc l <span class="mi">1</span>~<span class="mi">1</span>~<span class="mi">0</span>)
    | Decimal.D7 l =&gt; Some (pos_of_uint_acc l <span class="mi">1</span>~<span class="mi">1</span>~<span class="mi">1</span>)
    | Decimal.D8 l =&gt; Some (pos_of_uint_acc l <span class="mi">1</span>~<span class="mi">0</span>~<span class="mi">0</span>~<span class="mi">0</span>)
    | Decimal.D9 l =&gt; Some (pos_of_uint_acc l <span class="mi">1</span>~<span class="mi">0</span>~<span class="mi">0</span>~<span class="mi">1</span>)
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_of_decimal_int</span> (<span class="nv">d</span>:Decimal.int) : option Pos :=
  <span class="kr">match</span> d <span class="kr">with</span>
  | Decimal.Pos d =&gt; pos_of_uint d
  | Decimal.Neg _ =&gt; None
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_of_number_uint</span> (<span class="nv">d</span>:Numeral.int) : option Pos :=
  <span class="kr">match</span> d <span class="kr">with</span>
  | Numeral.IntDec d =&gt; pos_of_decimal_int d
  | Numeral.IntHex _ =&gt; None
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">pos_to_little_uint</span> <span class="nv">p</span> :=
  <span class="kr">match</span> p <span class="kr">with</span>
  | <span class="mi">1</span> =&gt; Decimal.D1 Decimal.Nil
  | p~<span class="mi">1</span> =&gt; Decimal.Little.succ_double (pos_to_little_uint p)
  | p~<span class="mi">0</span> =&gt; Decimal.Little.double (pos_to_little_uint p)
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_to_uint</span> <span class="nv">p</span> := Decimal.rev (pos_to_little_uint p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_to_decimal_int</span> <span class="nv">n</span> := Decimal.Pos (pos_to_uint n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pos_to_number_uint</span> <span class="nv">p</span> := Numeral.UIntDec (pos_to_uint p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkae8" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkae8"><span class="kn">Definition</span> <span class="nf">pos_to_nat</span> : Pos -&gt; nat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Pos -&gt; nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkae9" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkae9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Pos -&gt; nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkaea" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkaea"><span class="nb">intro</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkaeb" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkaeb"><span class="nb">induction</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="core-v-chkaec" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHp</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="core-v-chkaec"><hr></label><div class="goal-conclusion">nat</div></blockquote><input class="alectryon-extra-goal-toggle" id="core-v-chkaed" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHp</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="core-v-chkaed"><hr></label><div class="goal-conclusion">nat</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkaee" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkaee">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (S O).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkaef" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkaef">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHp</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (nat_add IHp IHp).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="core-v-chkaf0" style="display: none" type="checkbox"><label class="alectryon-input" for="core-v-chkaf0">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>p</var><span class="hyp-type"><b>: </b><span>Pos</span></span></span><br><span><var>IHp</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (S (nat_add IHp IHp)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">Number <span class="kn">Notation</span> <span class="nf">Pos</span> pos_of_number_uint pos_to_number_uint : positive_scope.</span></span></pre>
</div>
</div></body>
</html>
