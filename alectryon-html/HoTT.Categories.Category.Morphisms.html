<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Morphisms.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="sd">(** * Definitions and theorems about {iso,epi,mono,}morphisms in a precategory *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk5"><span class="kn">Require Import</span> Category.Core Functor.Core.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> HoTT.Tactics Basics.Trunc Basics.Tactics Types.Sigma Equivalences.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Universe Polymorphism</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Implicit Arguments</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Generalizable All Variables</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Asymmetric Patterns</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> category_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> morphism_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Definition of isomorphism *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsIsomorphism</span> {<span class="nv">C</span> : PreCategory} {<span class="nv">s</span> <span class="nv">d</span>} (<span class="nv">m</span> : morphism C s d) :=
  {
    morphism_inverse : morphism C d s;
    left_inverse : morphism_inverse o m = identity _;
    right_inverse : m o morphism_inverse = identity _
  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> morphism_inverse {C s d} m {_}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;m ^-1&quot;</span> := (morphism_inverse m) : morphism_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export]
<span class="kn">Hint Resolve</span> left_inverse right_inverse : category morphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export]
<span class="kn">Hint Rewrite</span> @left_inverse @right_inverse : category.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input">#[export]
<span class="kn">Hint Rewrite</span> @left_inverse @right_inverse : morphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">Isomorphic</span> {<span class="nv">C</span> : PreCategory} <span class="nv">s</span> <span class="nv">d</span> :=
  {
    morphism_isomorphic : morphism C s d;
    isisomorphism_isomorphic :: IsIsomorphism morphism_isomorphic
  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(*Coercion Build_Isomorphic : IsIsomorphism &gt;-&gt; Isomorphic.*)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">morphism_isomorphic</span> : Isomorphic &gt;-&gt; morphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">isisomorphism_isomorphic</span> : Isomorphic &gt;-&gt; IsIsomorphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Infix</span> <span class="s2">&quot;&lt;~=~&gt;&quot;</span> := Isomorphic : category_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Theorems about isomorphisms *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">iso_contr</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">C</span> : PreCategory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">


</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> <span class="nv">s</span> <span class="nv">d</span> : C.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">IsIsomorphism_sig_T</span> m :=
    { inverse : morphism C d s
    | { _ : inverse o m = identity _
      | m o inverse = identity _ } } (<span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">IsIsomorphism</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">m</span> : morphism C s d.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** The inverse of a morphism is unique *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk6"><span class="kn">Lemma</span> <span class="nf">inverse_unique</span> (<span class="nv">m_inv0</span> <span class="nv">m_inv1</span> : morphism C d s)
          (<span class="nv">left_inverse_0</span> : m_inv0 o m = identity _)
          (<span class="nv">right_inverse_1</span> : m o m_inv1 = identity _)
    : m_inv0 = m_inv1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>m_inv0, m_inv1</var><span class="hyp-type"><b>: </b><span>morphism C d s</span></span></span><br><span><var>left_inverse_0</var><span class="hyp-type"><b>: </b><span>m_inv0 o m = <span class="mi">1</span></span></span></span><br><span><var>right_inverse_1</var><span class="hyp-type"><b>: </b><span>m o m_inv1 = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m_inv0 = m_inv1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>m_inv0, m_inv1</var><span class="hyp-type"><b>: </b><span>morphism C d s</span></span></span><br><span><var>left_inverse_0</var><span class="hyp-type"><b>: </b><span>m_inv0 o m = <span class="mi">1</span></span></span></span><br><span><var>right_inverse_1</var><span class="hyp-type"><b>: </b><span>m o m_inv1 = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m_inv0 = m_inv1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">transitivity</span> (m_inv0 o m o m_inv1);
      <span class="kp">try</span> <span class="kp">solve</span> [ <span class="bp">by</span> (<span class="nb">rewrite</span> -&gt; <span class="nl">?associativity</span>; rewrite_hyp;
                      <span class="nb">autorewrite with</span> morphism)
                | <span class="bp">by</span> (<span class="nb">rewrite</span> &lt;- <span class="nl">?associativity</span>; rewrite_hyp;
                      <span class="nb">autorewrite with</span> morphism) ].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Equivalence between the record and sigma versions of [IsIsomorphism] *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk8"><span class="kn">Lemma</span> <span class="nf">issig_isisomorphism</span>
    : IsIsomorphism_sig_T m &lt;~&gt; IsIsomorphism m.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{inverse : morphism C d s &amp;
{_ : inverse o m = <span class="mi">1</span> &amp; m o inverse = <span class="mi">1</span>}} &lt;~&gt;
IsIsomorphism m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{inverse : morphism C d s &amp;
{_ : inverse o m = <span class="mi">1</span> &amp; m o inverse = <span class="mi">1</span>}} &lt;~&gt;
IsIsomorphism m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input">issig.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Being an isomorphism is a mere proposition *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chka">#[export] <span class="kn">Instance</span> <span class="nf">istrunc_isisomorphism</span> : IsHProp (IsIsomorphism m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsIsomorphism m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chkb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsIsomorphism m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chkc"><span class="nb">eapply</span> istrunc_equiv_istrunc; [ <span class="bp">exact</span> issig_isisomorphism | ].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp
  {inverse : morphism C d s &amp;
  {_ : inverse o m = <span class="mi">1</span> &amp; m o inverse = <span class="mi">1</span>}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chkd"><span class="nb">apply</span> hprop_allpath.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">x</span>
 <span class="nv">y</span> : {inverse : morphism C d s &amp;
     {_ : inverse o m = <span class="mi">1</span> &amp; m o inverse = <span class="mi">1</span>}}, x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chke"><span class="nb">intros</span> [x [? ?]] [y [? ?]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>morphism C d s</span></span></span><br><span><var>proj1</var><span class="hyp-type"><b>: </b><span>x o m = <span class="mi">1</span></span></span></span><br><span><var>proj2</var><span class="hyp-type"><b>: </b><span>m o x = <span class="mi">1</span></span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>morphism C d s</span></span></span><br><span><var>proj0</var><span class="hyp-type"><b>: </b><span>y o m = <span class="mi">1</span></span></span></span><br><span><var>proj3</var><span class="hyp-type"><b>: </b><span>m o y = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x; proj1; proj2) = (y; proj0; proj3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chkf"><span class="kr">let</span> <span class="nv">H</span> := <span class="kp">fresh</span> <span class="kr">in</span>
      <span class="nb">assert</span> (H : x = y) <span class="bp">by</span> (<span class="nb">apply</span> inverse_unique; <span class="bp">assumption</span>);
        <span class="nb">destruct</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>morphism C d s</span></span></span><br><span><var>proj1</var><span class="hyp-type"><b>: </b><span>x o m = <span class="mi">1</span></span></span></span><br><span><var>proj2</var><span class="hyp-type"><b>: </b><span>m o x = <span class="mi">1</span></span></span></span><br><span><var>proj0</var><span class="hyp-type"><b>: </b><span>x o m = <span class="mi">1</span></span></span></span><br><span><var>proj3</var><span class="hyp-type"><b>: </b><span>m o x = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(x; proj1; proj2) = (x; proj0; proj3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">repeat</span> <span class="kr">match goal with</span>
               | _ =&gt; <span class="kp">progress</span> <span class="nb">simpl</span>
               | _ =&gt; <span class="bp">exact</span> (center _)
               | _ =&gt; (<span class="kr">exists</span> <span class="nv">idpath</span>)
               | _ =&gt; <span class="nb">apply</span> path_sigma_uncurried
             <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">IsIsomorphism</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">Isomorphic_sig_T</span> :=
    { m : morphism C s d
    | IsIsomorphism m } (<span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Equivalence between record and sigma versions of [Isomorphic] *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk10"><span class="kn">Lemma</span> <span class="nf">issig_isomorphic</span>
  : Isomorphic_sig_T &lt;~&gt; Isomorphic s d.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{m : morphism C s d &amp; IsIsomorphism m} &lt;~&gt; s &lt;~=~&gt; d</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk11"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{m : morphism C s d &amp; IsIsomorphism m} &lt;~&gt; s &lt;~=~&gt; d</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">issig.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="nf">Isomorphic_full_sig_T</span> :=
    { m : morphism C s d
    | IsIsomorphism_sig_T m } (<span class="kn">only parsing</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Equivalence between record and fully sigma versions of [Isomorphic] *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">issig_full_isomorphic</span>
  : Isomorphic_full_sig_T &lt;~&gt; Isomorphic s d
    := (issig_isomorphic oE equiv_functor_sigma_id issig_isisomorphism).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Isomorphisms form an hSet *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk12">#[export] <span class="kn">Instance</span> <span class="nf">trunc_Isomorphic</span> : IsHSet (Isomorphic s d).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet (s &lt;~=~&gt; d)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk13"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet (s &lt;~=~&gt; d)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk14"><span class="nb">eapply</span> istrunc_equiv_istrunc; [ <span class="bp">exact</span> issig_isomorphic | ].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet {m : morphism C s d &amp; IsIsomorphism m}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Equality between isomorphisms is determined by equality between their forward components *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk15"><span class="kn">Definition</span> <span class="nf">path_isomorphic</span> (<span class="nv">i</span> <span class="nv">j</span> : Isomorphic s d)
  : @morphism_isomorphic _ _ _ i = @morphism_isomorphic _ _ _ j
    -&gt; i = j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = j -&gt; i = j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk16"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i = j -&gt; i = j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk17"><span class="nb">destruct</span> i, j; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>morphism_isomorphic0</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>isisomorphism_isomorphic0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism
  morphism_isomorphic0</span></span></span><br><span><var>morphism_isomorphic1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>isisomorphism_isomorphic1</var><span class="hyp-type"><b>: </b><span>IsIsomorphism
  morphism_isomorphic1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">morphism_isomorphic0 = morphism_isomorphic1 -&gt;
{|
  morphism_isomorphic := morphism_isomorphic0;
  isisomorphism_isomorphic :=
    isisomorphism_isomorphic0
|} =
{|
  morphism_isomorphic := morphism_isomorphic1;
  isisomorphism_isomorphic :=
    isisomorphism_isomorphic1
|}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk18"><span class="nb">intro</span>; path_induction.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>morphism_isomorphic0</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>isisomorphism_isomorphic0, isisomorphism_isomorphic1</var><span class="hyp-type"><b>: </b><span>IsIsomorphism
  morphism_isomorphic0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{|
  morphism_isomorphic := morphism_isomorphic0;
  isisomorphism_isomorphic :=
    isisomorphism_isomorphic0
|} =
{|
  morphism_isomorphic := morphism_isomorphic0;
  isisomorphism_isomorphic :=
    isisomorphism_isomorphic1
|}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk19">f_ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>morphism_isomorphic0</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>isisomorphism_isomorphic0, isisomorphism_isomorphic1</var><span class="hyp-type"><b>: </b><span>IsIsomorphism
  morphism_isomorphic0</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isisomorphism_isomorphic0 = isisomorphism_isomorphic1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (center _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Relations between [path_isomorphic], [ap morphism_inverse], and [ap morphism_isomorphic] *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk1a"><span class="kn">Definition</span> <span class="nf">ap_morphism_isomorphic_path_isomorphic</span> (<span class="nv">i</span> <span class="nv">j</span> : Isomorphic s d) <span class="nv">p</span>
  : ap (@morphism_isomorphic _ _ _) (path_isomorphic i j p) = p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (@morphism_isomorphic C s d)
  (path_isomorphic i j p) = p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk1b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (@morphism_isomorphic C s d)
  (path_isomorphic i j p) = p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk1c"><span class="nb">unfold</span> path_isomorphic.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (@morphism_isomorphic C s d)
  (paths_rect (morphism C s d) i
     (<span class="kr">fun</span> (<span class="nv">morphism_isomorphic1</span> : morphism C s d)
        (<span class="nv">_</span> : i = morphism_isomorphic1) =&gt;
      <span class="kr">forall</span>
      <span class="nv">isisomorphism_isomorphic1</span> : IsIsomorphism
                                    morphism_isomorphic1,
      {|
        morphism_isomorphic := i;
        isisomorphism_isomorphic := i
      |} =
      {|
        morphism_isomorphic := morphism_isomorphic1;
        isisomorphism_isomorphic :=
          isisomorphism_isomorphic1
      |})
     (<span class="kr">fun</span> <span class="nv">isisomorphism_isomorphic1</span> : IsIsomorphism i
      =&gt;
      ap11 <span class="mi">1</span> (center (i = isisomorphism_isomorphic1)))
     j p j) = p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk1d"><span class="nb">destruct</span> i, j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>morphism_isomorphic0</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>isisomorphism_isomorphic0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism
  morphism_isomorphic0</span></span></span><br><span><var>morphism_isomorphic1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>isisomorphism_isomorphic1</var><span class="hyp-type"><b>: </b><span>IsIsomorphism
  morphism_isomorphic1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>{|
  morphism_isomorphic := morphism_isomorphic0;
  isisomorphism_isomorphic :=
    isisomorphism_isomorphic0
|} =
{|
  morphism_isomorphic := morphism_isomorphic1;
  isisomorphism_isomorphic :=
    isisomorphism_isomorphic1
|}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (@morphism_isomorphic C s d)
  (paths_rect (morphism C s d) morphism_isomorphic0
     (<span class="kr">fun</span> (<span class="nv">morphism_isomorphic1</span> : morphism C s d)
        (<span class="nv">_</span> : morphism_isomorphic0 =
             morphism_isomorphic1) =&gt;
      <span class="kr">forall</span>
      <span class="nv">isisomorphism_isomorphic1</span> : IsIsomorphism
                                    morphism_isomorphic1,
      {|
        morphism_isomorphic := morphism_isomorphic0;
        isisomorphism_isomorphic :=
          isisomorphism_isomorphic0
      |} =
      {|
        morphism_isomorphic := morphism_isomorphic1;
        isisomorphism_isomorphic :=
          isisomorphism_isomorphic1
      |})
     (<span class="kr">fun</span>
        <span class="nv">isisomorphism_isomorphic1</span> : IsIsomorphism
                                      morphism_isomorphic0
      =&gt;
      ap11 <span class="mi">1</span>
        (center
           (isisomorphism_isomorphic0 =
            isisomorphism_isomorphic1)))
     morphism_isomorphic1 p isisomorphism_isomorphic1) =
p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">path_induction_hammer.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk1e"><span class="kn">Definition</span> <span class="nf">ap_morphism_inverse_path_isomorphic</span> (<span class="nv">i</span> <span class="nv">j</span> : Isomorphic s d) <span class="nv">p</span> <span class="nv">q</span>
  : ap (<span class="kr">fun</span> <span class="nv">e</span> : Isomorphic s d =&gt; e^-<span class="mi">1</span>)%morphism (path_isomorphic i j p) = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">e</span> : s &lt;~=~&gt; d =&gt; e^-<span class="mi">1</span>) i =
(<span class="kr">fun</span> <span class="nv">e</span> : s &lt;~=~&gt; d =&gt; e^-<span class="mi">1</span>) j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (<span class="kr">fun</span> <span class="nv">e</span> : s &lt;~=~&gt; d =&gt; e^-<span class="mi">1</span>) (path_isomorphic i j p) =
q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk1f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>i = j</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">e</span> : s &lt;~=~&gt; d =&gt; e^-<span class="mi">1</span>) i =
(<span class="kr">fun</span> <span class="nv">e</span> : s &lt;~=~&gt; d =&gt; e^-<span class="mi">1</span>) j</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (<span class="kr">fun</span> <span class="nv">e</span> : s &lt;~=~&gt; d =&gt; e^-<span class="mi">1</span>) (path_isomorphic i j p) =
q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_ishprop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Equality between isomorphisms is equivalent to by equality between their forward components *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk20">#[export] <span class="kn">Instance</span> <span class="nf">isequiv_path_isomorphic</span> {<span class="nv">i</span> <span class="nv">j</span>}
  : IsEquiv (path_isomorphic i j).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (path_isomorphic i j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk21"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (path_isomorphic i j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk22"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>i, j</var><span class="hyp-type"><b>: </b><span>s &lt;~=~&gt; d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (path_isomorphic i j)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (isequiv_adjointify
             (path_isomorphic i j)
             (ap (@morphism_isomorphic _ _ _)));
      <span class="nb">intro</span>; [ <span class="nb">destruct</span> i | <span class="nb">destruct</span> i, j ];
      path_induction_hammer.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">iso_contr</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">iso_equiv_relation</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">C</span> : PreCategory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** The identity is an isomorphism *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">isisomorphism_identity</span> (<span class="nv">x</span> : C) : IsIsomorphism (identity x)
    := {| morphism_inverse := identity x;
          left_inverse := left_identity C x x (identity x);
          right_inverse := right_identity C x x (identity x) |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Inverses of isomorphisms are isomorphisms *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">isisomorphism_inverse</span> `(@IsIsomorphism C x y m) : IsIsomorphism m^-<span class="mi">1</span>
    := {| morphism_inverse := m;
          left_inverse := right_inverse;
          right_inverse := left_inverse |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Ltac</span> <span class="nf">iso_comp_t</span> inv_lemma :=
    <span class="nb">etransitivity</span>; [ | <span class="nb">apply</span> inv_lemma ];
    <span class="kp">first</span> [ <span class="nb">rewrite</span> -&gt; <span class="nl">?associativity</span>; <span class="nb">apply</span> ap
          | <span class="nb">rewrite</span> &lt;- <span class="nl">?associativity</span>; <span class="nb">apply</span> ap ];
    <span class="kp">first</span> [ <span class="nb">rewrite</span> -&gt; <span class="nl">?associativity</span>; <span class="nb">rewrite</span> inv_lemma
          | <span class="nb">rewrite</span> &lt;- <span class="nl">?associativity</span>; <span class="nb">rewrite</span> inv_lemma ];
    <span class="nb">auto with</span> morphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Composition of isomorphisms gives an isomorphism *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk23">#[export] <span class="kn">Instance</span> <span class="nf">isisomorphism_compose</span> `(@IsIsomorphism C y z m0) `(@IsIsomorphism C x y m1)
  : IsIsomorphism (m0 o m1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m0</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsIsomorphism (m0 o m1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk24"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m0</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsIsomorphism (m0 o m1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> (<span class="nv">m1</span>^-<span class="mi">1</span> o m0^-<span class="mi">1</span>);
    [ <span class="kp">abstract</span> iso_comp_t @left_inverse
    | <span class="kp">abstract</span> iso_comp_t @right_inverse ].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[local]
  <span class="kn">Hint Immediate</span> isisomorphism_inverse : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Being isomorphic is a reflexive relation *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">isomorphic_refl</span> : Reflexive (@Isomorphic C)
    := <span class="kr">fun</span> <span class="nv">x</span> : C =&gt; {| morphism_isomorphic := identity x |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Being isomorphic is a symmetric relation *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">isomorphic_sym</span> : Symmetric (@Isomorphic C)
    := <span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">X</span> =&gt; {| morphism_isomorphic := X^-<span class="mi">1</span> |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Being isomorphic is a transitive relation *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">isomorphic_trans</span> : Transitive (@Isomorphic C)
    := <span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> <span class="nv">X</span> <span class="nv">Y</span> =&gt; {| morphism_isomorphic := @morphism_isomorphic _ _ _ Y o @morphism_isomorphic _ _ _ X |}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Equality gives rise to isomorphism *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">idtoiso</span> (<span class="nv">x</span> <span class="nv">y</span> : C) (<span class="nv">H</span> : x = y) : Isomorphic x y
    := <span class="kr">match</span> H <span class="kr">in</span> (_ = y0) <span class="kr">return</span> (x &lt;~=~&gt; y0) <span class="kr">with</span>
         | <span class="mi">1</span>%path =&gt; <span class="bp">reflexivity</span> x
       <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">iso_equiv_relation</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export]
<span class="kn">Hint Immediate</span> isisomorphism_inverse : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Epimorphisms and Monomorphisms *)</span>
<span class="sd">(** Quoting Wikipedia:</span>

<span class="sd">    In category theory, an epimorphism (also called an epic morphism</span>
<span class="sd">    or, colloquially, an epi) is a morphism [f : X ‚Üí Y] which is</span>
<span class="sd">    right-cancellative in the sense that, for all morphisms [g, g&#39; : Y</span>
<span class="sd">    ‚Üí Z], [g ‚àò f = g&#39; ‚àò f ‚Üí g = g&#39;]</span>

<span class="sd">    Epimorphisms are analogues of surjective functions, but they are</span>
<span class="sd">    not exactly the same. The dual of an epimorphism is a monomorphism</span>
<span class="sd">    (i.e. an epimorphism in a category [C] is a monomorphism in the</span>
<span class="sd">    dual category [C·µí·µñ]).  *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsEpimorphism</span> {<span class="nv">C</span>} {<span class="nv">x</span> <span class="nv">y</span>} (<span class="nv">m</span> : morphism C x y) :=
  is_epimorphism : <span class="kr">forall</span> <span class="nv">z</span> (<span class="nv">m1</span> <span class="nv">m2</span> : morphism C y z),
                     m1 o m = m2 o m
                     -&gt; m1 = m2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsMonomorphism</span> {<span class="nv">C</span>} {<span class="nv">x</span> <span class="nv">y</span>} (<span class="nv">m</span> : morphism C x y) :=
  is_monomorphism : <span class="kr">forall</span> <span class="nv">z</span> (<span class="nv">m1</span> <span class="nv">m2</span> : morphism C z x),
                      m o m1 = m o m2
                      -&gt; m1 = m2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** We make [IsEpimorphism] and [IsMonomorphism] transparent to</span>
<span class="sd">    typeclass search so that we can infer things like [IsHProp]</span>
<span class="sd">    automatically. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input">#[<span class="kn">global</span>] <span class="kn">Typeclasses Transparent</span> IsEpimorphism IsMonomorphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">Epimorphism</span> {<span class="nv">C</span>} <span class="nv">x</span> <span class="nv">y</span> :=
  {
    Epimorphism_morphism :&gt; morphism C x y;
    Epimorphism_IsEpimorphism :&gt; IsEpimorphism Epimorphism_morphism
  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">Monomorphism</span> {<span class="nv">C</span>} <span class="nv">x</span> <span class="nv">y</span> :=
  {
    Monomorphism_morphism :&gt; morphism C x y;
    Monomorphism_IsMonomorphism :&gt; IsMonomorphism Monomorphism_morphism
  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">Existing Instances Epimorphism_IsEpimorphism Monomorphism_IsMonomorphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;x -&gt;&gt; y&quot;</span> := (Epimorphism x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;x (-&gt; y&quot;</span> := (Monomorphism x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">IsSectionOf</span> <span class="nv">C</span> <span class="nv">x</span> <span class="nv">y</span> (<span class="nv">s</span> : morphism C x y) (<span class="nv">r</span> : morphism C y x)
  := is_sect_morphism : r o s = identity _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> IsSectionOf [C x y] s r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">EpiMono</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">C</span> : PreCategory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">properties</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="sd">(** *** The identity is an epimorphism *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk25">#[export] <span class="kn">Instance</span> <span class="nf">isepimorphism_identity</span> (<span class="nv">x</span> : C)
    : IsEpimorphism (identity x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEpimorphism <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk26"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEpimorphism <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">repeat</span> <span class="nb">intro</span>; <span class="nb">autorewrite with</span> morphism <span class="kr">in</span> *; <span class="nb">trivial</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** The identity is a monomorphism *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk27">#[export] <span class="kn">Instance</span> <span class="nf">ismonomorphism_identity</span> (<span class="nv">x</span> : C)
    : IsMonomorphism (identity x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsMonomorphism <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk28"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsMonomorphism <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">repeat</span> <span class="nb">intro</span>; <span class="nb">autorewrite with</span> morphism <span class="kr">in</span> *; <span class="nb">trivial</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Composition of epimorphisms gives an epimorphism *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk29">#[export] <span class="kn">Instance</span> <span class="nf">isepimorphism_compose</span> <span class="nv">s</span> <span class="nv">d</span> <span class="nv">d&#39;</span> <span class="nv">m0</span> <span class="nv">m1</span>
    : IsEpimorphism m0
      -&gt; IsEpimorphism m1
      -&gt; IsEpimorphism (@compose C s d d&#39; m0 m1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C d d&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEpimorphism m0 -&gt;
IsEpimorphism m1 -&gt; IsEpimorphism (m0 o m1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk2a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C d d&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEpimorphism m0 -&gt;
IsEpimorphism m1 -&gt; IsEpimorphism (m0 o m1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk2b"><span class="kp">repeat</span> <span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C d d&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsEpimorphism m0</span></span></span><br><span><var>X0</var><span class="hyp-type"><b>: </b><span>IsEpimorphism m1</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m2, m3</var><span class="hyp-type"><b>: </b><span>morphism C d&#39; z</span></span></span><br><span><var>X1</var><span class="hyp-type"><b>: </b><span>m2 o (m0 o m1) = m3 o (m0 o m1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m2 = m3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk2c"><span class="nb">rewrite</span> &lt;- !associativity <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C d d&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsEpimorphism m0</span></span></span><br><span><var>X0</var><span class="hyp-type"><b>: </b><span>IsEpimorphism m1</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m2, m3</var><span class="hyp-type"><b>: </b><span>morphism C d&#39; z</span></span></span><br><span><var>X1</var><span class="hyp-type"><b>: </b><span>m2 o m0 o m1 = m3 o m0 o m1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m2 = m3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input">apply_hyp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Composition of monomorphisms gives a monomorphism *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk2d">#[export] <span class="kn">Instance</span> <span class="nf">ismonomorphism_compose</span> <span class="nv">s</span> <span class="nv">d</span> <span class="nv">d&#39;</span> <span class="nv">m0</span> <span class="nv">m1</span>
    : IsMonomorphism m0
      -&gt; IsMonomorphism m1
      -&gt; IsMonomorphism (@compose C s d d&#39; m0 m1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C d d&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsMonomorphism m0 -&gt;
IsMonomorphism m1 -&gt; IsMonomorphism (m0 o m1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk2e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C d d&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsMonomorphism m0 -&gt;
IsMonomorphism m1 -&gt; IsMonomorphism (m0 o m1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk2f"><span class="kp">repeat</span> <span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C d d&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsMonomorphism m0</span></span></span><br><span><var>X0</var><span class="hyp-type"><b>: </b><span>IsMonomorphism m1</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m2, m3</var><span class="hyp-type"><b>: </b><span>morphism C z s</span></span></span><br><span><var>X1</var><span class="hyp-type"><b>: </b><span>m0 o m1 o m2 = m0 o m1 o m3</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m2 = m3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk30"><span class="nb">rewrite</span> !associativity <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>morphism C d d&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsMonomorphism m0</span></span></span><br><span><var>X0</var><span class="hyp-type"><b>: </b><span>IsMonomorphism m1</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m2, m3</var><span class="hyp-type"><b>: </b><span>morphism C z s</span></span></span><br><span><var>X1</var><span class="hyp-type"><b>: </b><span>m0 o (m1 o m2) = m0 o (m1 o m3)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m2 = m3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input">apply_hyp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">properties</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Existence of {epi,mono}morphisms are a preorder *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">equiv</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">reflexive_epimorphism</span> : Reflexive (@Epimorphism C)
      := <span class="kr">fun</span> <span class="nv">x</span> =&gt; Build_Epimorphism (isepimorphism_identity x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">reflexive_monomorphism</span> : Reflexive (@Monomorphism C)
      := <span class="kr">fun</span> <span class="nv">x</span> =&gt; Build_Monomorphism (ismonomorphism_identity x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">transitive_epimorphism</span> : Transitive (@Epimorphism C)
      := <span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> <span class="nv">_</span> <span class="nv">m0</span> <span class="nv">m1</span> =&gt; Build_Epimorphism (isepimorphism_compose m1 m0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">transitive_monomorphism</span> : Transitive (@Monomorphism C)
      := <span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> <span class="nv">_</span> <span class="nv">m0</span> <span class="nv">m1</span> =&gt; Build_Monomorphism (ismonomorphism_compose m1 m0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">equiv</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">sect</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Ltac</span> <span class="nf">epi_mono_sect_t</span> :=
      <span class="kr">let</span> <span class="nv">t</span> :=
          (<span class="kp">solve</span> [ <span class="nb">autorewrite with</span> morphism;
                   <span class="bp">reflexivity</span>
                 | rewrite_hyp;
                   <span class="nb">autorewrite with</span> morphism;
                   <span class="bp">reflexivity</span> ]) <span class="kr">in</span>
      <span class="kp">first</span> [ <span class="nb">rewrite</span> -&gt; <span class="nl">?associativity</span>; t
            | <span class="nb">rewrite</span> &lt;- <span class="nl">?associativity</span>; t].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Retractions are epimorphisms *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk31">#[export] <span class="kn">Instance</span> <span class="nf">isepimorphism_retr</span> `(@IsSectionOf C x y s r)
    : IsEpimorphism r | <span class="mi">1000</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsSectionOf s r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEpimorphism r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk32"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsSectionOf s r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEpimorphism r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk33">(<span class="nb">intros</span> ? m1 m2 ?).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsSectionOf s r</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m1, m2</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>m1 o r = m2 o r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m1 = m2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk34"><span class="nb">unfold</span> IsSectionOf <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>r o s = <span class="mi">1</span></span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m1, m2</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>m1 o r = m2 o r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m1 = m2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">transitivity</span> ((m1 o r) o s);
        [ | <span class="nb">transitivity</span> ((m2 o r) o s) ];
        epi_mono_sect_t.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Sections are monomorphisms *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk35">#[export] <span class="kn">Instance</span> <span class="nf">ismonomorphism_sect</span> `(@IsSectionOf C x y s r)
    : IsMonomorphism s | <span class="mi">1000</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsSectionOf s r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsMonomorphism s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk36"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsSectionOf s r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsMonomorphism s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk37">(<span class="nb">intros</span> ? m1 m2 ?).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsSectionOf s r</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m1, m2</var><span class="hyp-type"><b>: </b><span>morphism C z x</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>s o m1 = s o m2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">m1 = m2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">transitivity</span> (r o (s o m1));
        [ | <span class="nb">transitivity</span> (r o (s o m2)) ];
        epi_mono_sect_t.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
    <span class="sd">(** *** Isomorphisms are both sections and retractions *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">issect_isisomorphism</span> `(@IsIsomorphism C x y m)
    : IsSectionOf m m^-<span class="mi">1</span> | <span class="mi">1000</span>
      := left_inverse.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">isretr_isisomorphism</span> `(@IsIsomorphism C x y m)
    : IsSectionOf m^-<span class="mi">1</span> m | <span class="mi">1000</span>
      := right_inverse.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">sect</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Isomorphisms are therefore epimorphisms and monomorphisms *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">iso</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">isepimorphism_isisomorphism</span> `(@IsIsomorphism C s d m)
    : IsEpimorphism m | <span class="mi">1000</span>
      := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">ismonomorphism_isisomorphism</span> `(@IsIsomorphism C s d m)
    : IsMonomorphism m | <span class="mi">1000</span>
      := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">iso</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">EpiMono</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Hint Immediate</span> isisomorphism_inverse : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export]
<span class="kn">Hint Immediate</span>
  isepimorphism_identity ismonomorphism_identity
  ismonomorphism_compose isepimorphism_compose
  : category morphism.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Lemmas about [idtoiso] *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">iso_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Ltac</span> <span class="nf">idtoiso_t</span> :=
    path_induction; <span class="nb">simpl</span>; <span class="nb">autorewrite with</span> morphism; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** [transport]ing across an equality of morphisms is the same as conjugating with [idtoiso] *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk38"><span class="kn">Lemma</span> <span class="nf">idtoiso_of_transport</span> (<span class="nv">C</span> <span class="nv">D</span> : PreCategory) <span class="nv">s</span> <span class="nv">d</span>
        (<span class="nv">m1</span> <span class="nv">m2</span> : morphism C s d)
        (<span class="nv">p</span> : m1 = m2)
        (<span class="nv">s&#39;</span> <span class="nv">d&#39;</span> : morphism C s d -&gt; D) <span class="nv">u</span>
  : @transport _ (<span class="kr">fun</span> <span class="nv">m</span> =&gt; morphism D (s&#39; m) (d&#39; m)) _ _ p u
    = idtoiso _ (ap d&#39; p) o u o (idtoiso _ (ap s&#39; p))^-<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m1, m2</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>m1 = m2</span></span></span><br><span><var>s', d'</var><span class="hyp-type"><b>: </b><span>morphism C s d -&gt; D</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>morphism D (s&#39; m1) (d&#39; m1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport
  (<span class="kr">fun</span> <span class="nv">m</span> : morphism C s d =&gt; morphism D (s&#39; m) (d&#39; m))
  p u =
idtoiso D (ap d&#39; p) o u o (idtoiso D (ap s&#39; p))^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk39"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m1, m2</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>m1 = m2</span></span></span><br><span><var>s', d'</var><span class="hyp-type"><b>: </b><span>morphism C s d -&gt; D</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>morphism D (s&#39; m1) (d&#39; m1)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport
  (<span class="kr">fun</span> <span class="nv">m</span> : morphism C s d =&gt; morphism D (s&#39; m) (d&#39; m))
  p u =
idtoiso D (ap d&#39; p) o u o (idtoiso D (ap s&#39; p))^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">idtoiso_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** [idtoiso] respects inverse *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk3a"><span class="kn">Lemma</span> <span class="nf">idtoiso_inv</span> (<span class="nv">C</span> : PreCategory) (<span class="nv">s</span> <span class="nv">d</span> : C) (<span class="nv">p</span> : s = d)
  : (idtoiso _ p)^-<span class="mi">1</span> = idtoiso _ (p^)%path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(idtoiso C p)^-<span class="mi">1</span> = idtoiso C p^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk3b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(idtoiso C p)^-<span class="mi">1</span> = idtoiso C p^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">path_induction; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** [idtoiso] respects composition *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk3c"><span class="kn">Lemma</span> <span class="nf">idtoiso_comp</span> (<span class="nv">C</span> : PreCategory) (<span class="nv">s</span> <span class="nv">d</span> <span class="nv">d&#39;</span> : C)
        (<span class="nv">m1</span> : d = d&#39;) (<span class="nv">m2</span> : s = d)
  : idtoiso _ m1 o idtoiso _ m2 = idtoiso _ (m2 @ m1)%path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m1 o idtoiso C m2 = idtoiso C (m2 @ m1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk3d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d'</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m1 o idtoiso C m2 = idtoiso C (m2 @ m1)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">idtoiso_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** These are useful when tactics are too slow and [rewrite] doesn&#39;t</span>
<span class="sd">      work. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk3e"><span class="kn">Lemma</span> <span class="nf">idtoiso_comp3</span> (<span class="nv">C</span> : PreCategory) (<span class="nv">s</span> <span class="nv">d</span> <span class="nv">d&#39;</span> <span class="nv">d&#39;&#39;</span> : C)
        (<span class="nv">m0</span> : d&#39; = d&#39;&#39;) (<span class="nv">m1</span> : d = d&#39;) (<span class="nv">m2</span> : s = d)
  : idtoiso _ m0 o (idtoiso _ m1 o idtoiso _ m2) = idtoiso _ ((m2 @ m1) @ m0)%path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0 o (idtoiso C m1 o idtoiso C m2) =
idtoiso C ((m2 @ m1) @ m0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk3f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0 o (idtoiso C m1 o idtoiso C m2) =
idtoiso C ((m2 @ m1) @ m0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">idtoiso_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk40"><span class="kn">Lemma</span> <span class="nf">idtoiso_comp3&#39;</span> (<span class="nv">C</span> : PreCategory) (<span class="nv">s</span> <span class="nv">d</span> <span class="nv">d&#39;</span> <span class="nv">d&#39;&#39;</span> : C)
        (<span class="nv">m0</span> : d&#39; = d&#39;&#39;) (<span class="nv">m1</span> : d = d&#39;) (<span class="nv">m2</span> : s = d)
  : (idtoiso _ m0 o idtoiso _ m1) o idtoiso _ m2 = idtoiso _ (m2 @ (m1 @ m0))%path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0 o idtoiso C m1 o idtoiso C m2 =
idtoiso C (m2 @ (m1 @ m0))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk41"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0 o idtoiso C m1 o idtoiso C m2 =
idtoiso C (m2 @ (m1 @ m0))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">idtoiso_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk42"><span class="kn">Lemma</span> <span class="nf">idtoiso_comp4</span> (<span class="nv">C</span> : PreCategory) (<span class="nv">s</span> <span class="nv">d</span> <span class="nv">d&#39;</span> <span class="nv">d&#39;&#39;</span> <span class="nv">d&#39;&#39;&#39;</span> : C)
        (<span class="nv">m0</span> : d&#39;&#39; = d&#39;&#39;&#39;) (<span class="nv">m1</span> : d&#39; = d&#39;&#39;) (<span class="nv">m2</span> : d = d&#39;) (<span class="nv">m3</span> : s = d)
  : idtoiso _ m0 o (idtoiso _ m1 o (idtoiso _ m2 o idtoiso _ m3)) = idtoiso _ (((m3 @ m2) @ m1) @ m0)%path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d'', d'''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39;&#39; = d&#39;&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m3</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0
o (idtoiso C m1 o (idtoiso C m2 o idtoiso C m3)) =
idtoiso C (((m3 @ m2) @ m1) @ m0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk43"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d'', d'''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39;&#39; = d&#39;&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m3</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0
o (idtoiso C m1 o (idtoiso C m2 o idtoiso C m3)) =
idtoiso C (((m3 @ m2) @ m1) @ m0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">idtoiso_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk44"><span class="kn">Lemma</span> <span class="nf">idtoiso_comp4&#39;</span> (<span class="nv">C</span> : PreCategory) (<span class="nv">s</span> <span class="nv">d</span> <span class="nv">d&#39;</span> <span class="nv">d&#39;&#39;</span> <span class="nv">d&#39;&#39;&#39;</span> : C)
        (<span class="nv">m0</span> : d&#39;&#39; = d&#39;&#39;&#39;) (<span class="nv">m1</span> : d&#39; = d&#39;&#39;) (<span class="nv">m2</span> : d = d&#39;) (<span class="nv">m3</span> : s = d)
  : ((idtoiso _ m0 o idtoiso _ m1) o idtoiso _ m2) o idtoiso _ m3 = idtoiso _ (m3 @ (m2 @ (m1 @ m0)))%path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d'', d'''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39;&#39; = d&#39;&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m3</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0 o idtoiso C m1 o idtoiso C m2
o idtoiso C m3 = idtoiso C (m3 @ (m2 @ (m1 @ m0)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk45"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d'', d'''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39;&#39; = d&#39;&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m3</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0 o idtoiso C m1 o idtoiso C m2
o idtoiso C m3 = idtoiso C (m3 @ (m2 @ (m1 @ m0)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">idtoiso_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk46"><span class="kn">Lemma</span> <span class="nf">idtoiso_comp5</span> (<span class="nv">C</span> : PreCategory) (<span class="nv">s</span> <span class="nv">d</span> <span class="nv">d&#39;</span> <span class="nv">d&#39;&#39;</span> <span class="nv">d&#39;&#39;&#39;</span> <span class="nv">d&#39;&#39;&#39;&#39;</span> : C)
        (<span class="nv">m0</span> : d&#39;&#39;&#39; = d&#39;&#39;&#39;&#39;) (<span class="nv">m1</span> : d&#39;&#39; = d&#39;&#39;&#39;) (<span class="nv">m2</span> : d&#39; = d&#39;&#39;) (<span class="nv">m3</span> : d = d&#39;) (<span class="nv">m4</span> : s = d)
  : idtoiso _ m0 o (idtoiso _ m1 o (idtoiso _ m2 o (idtoiso _ m3 o idtoiso _ m4)))
    = idtoiso _ ((((m4 @ m3) @ m2) @ m1) @ m0)%path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d'', d''', d''''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39;&#39;&#39; = d&#39;&#39;&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d&#39;&#39; = d&#39;&#39;&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m3</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m4</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0
o (idtoiso C m1
   o (idtoiso C m2 o (idtoiso C m3 o idtoiso C m4))) =
idtoiso C ((((m4 @ m3) @ m2) @ m1) @ m0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk47"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d'', d''', d''''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39;&#39;&#39; = d&#39;&#39;&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d&#39;&#39; = d&#39;&#39;&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m3</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m4</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0
o (idtoiso C m1
   o (idtoiso C m2 o (idtoiso C m3 o idtoiso C m4))) =
idtoiso C ((((m4 @ m3) @ m2) @ m1) @ m0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">idtoiso_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk48"><span class="kn">Lemma</span> <span class="nf">idtoiso_comp5&#39;</span> (<span class="nv">C</span> : PreCategory) (<span class="nv">s</span> <span class="nv">d</span> <span class="nv">d&#39;</span> <span class="nv">d&#39;&#39;</span> <span class="nv">d&#39;&#39;&#39;</span> <span class="nv">d&#39;&#39;&#39;&#39;</span> : C)
        (<span class="nv">m0</span> : d&#39;&#39;&#39; = d&#39;&#39;&#39;&#39;) (<span class="nv">m1</span> : d&#39;&#39; = d&#39;&#39;&#39;) (<span class="nv">m2</span> : d&#39; = d&#39;&#39;) (<span class="nv">m3</span> : d = d&#39;) (<span class="nv">m4</span> : s = d)
  : (((idtoiso _ m0 o idtoiso _ m1) o idtoiso _ m2) o idtoiso _ m3) o idtoiso _ m4
    = idtoiso _ (m4 @ (m3 @ (m2 @ (m1 @ m0))))%path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d'', d''', d''''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39;&#39;&#39; = d&#39;&#39;&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d&#39;&#39; = d&#39;&#39;&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m3</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m4</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0 o idtoiso C m1 o idtoiso C m2
o idtoiso C m3 o idtoiso C m4 =
idtoiso C (m4 @ (m3 @ (m2 @ (m1 @ m0))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk49"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d, d', d'', d''', d''''</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m0</var><span class="hyp-type"><b>: </b><span>d&#39;&#39;&#39; = d&#39;&#39;&#39;&#39;</span></span></span><br><span><var>m1</var><span class="hyp-type"><b>: </b><span>d&#39;&#39; = d&#39;&#39;&#39;</span></span></span><br><span><var>m2</var><span class="hyp-type"><b>: </b><span>d&#39; = d&#39;&#39;</span></span></span><br><span><var>m3</var><span class="hyp-type"><b>: </b><span>d = d&#39;</span></span></span><br><span><var>m4</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">idtoiso C m0 o idtoiso C m1 o idtoiso C m2
o idtoiso C m3 o idtoiso C m4 =
idtoiso C (m4 @ (m3 @ (m2 @ (m1 @ m0))))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">idtoiso_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** [idtoiso] respects application of functors on morphisms and objects *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk4a"><span class="kn">Lemma</span> <span class="nf">idtoiso_functor</span> (<span class="nv">C</span> <span class="nv">D</span> : PreCategory) (<span class="nv">s</span> <span class="nv">d</span> : C) (<span class="nv">m</span> : s = d)
        (<span class="nv">F</span> : Functor C D)
  : F _1 (idtoiso _ m) = idtoiso _ (ap (object_of F) m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Functor C D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F _1 (idtoiso C m) = idtoiso D (ap F m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk4b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>s = d</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Functor C D</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F _1 (idtoiso C m) = idtoiso D (ap F m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">path_induction; <span class="nb">simpl</span>; <span class="nb">apply</span> identity_of.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** *** Functors preserve isomorphisms *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk4c">#[export] <span class="kn">Instance</span> <span class="nf">iso_functor</span> <span class="nv">C</span> <span class="nv">D</span> (<span class="nv">F</span> : Functor C D) `(@IsIsomorphism C s d m)
  : IsIsomorphism (F _1 m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Functor C D</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsIsomorphism (F _1 m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk4d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Functor C D</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsIsomorphism (F _1 m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk4e"><span class="nb">refine</span> ({| morphism_inverse := F _1 m^-<span class="mi">1</span> |}).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Functor C D</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F _1 m^-<span class="mi">1</span> o F _1 m = <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="morphisms-v-chk4f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Functor C D</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m</span></span></span><br></div><label class="goal-separator" for="morphisms-v-chk4f"><hr></label><div class="goal-conclusion">F _1 m o F _1 m^-<span class="mi">1</span> = <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk50">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Functor C D</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F _1 m^-<span class="mi">1</span> o F _1 m = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">abstract</span> (<span class="nb">rewrite</span> &lt;- composition_of, <span class="nl">?left_inverse</span>, <span class="nl">?right_inverse</span>, identity_of; <span class="bp">reflexivity</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk51">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C, D</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Functor C D</span></span></span><br><span><var>s, d</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>morphism C s d</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F _1 m o F _1 m^-<span class="mi">1</span> = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">abstract</span> (<span class="nb">rewrite</span> &lt;- composition_of, <span class="nl">?left_inverse</span>, <span class="nl">?right_inverse</span>, identity_of; <span class="bp">reflexivity</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">iso_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export]
<span class="kn">Hint Extern</span> <span class="mi">1</span> (@IsIsomorphism _ _ _ (@morphism_of <span class="nl">?C</span> <span class="nl">?D</span> <span class="nl">?F</span> <span class="nl">?s</span> <span class="nl">?d</span> <span class="nl">?m</span>))
=&gt; <span class="nb">apply</span> (@iso_functor C D F s d m) : typeclass_instances.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input">#[export]
<span class="kn">Hint Rewrite</span> idtoiso_of_transport idtoiso_inv idtoiso_comp idtoiso_functor.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Lemmas about how to move isomorphisms around equalities, following [HoTT.PathGroupoids] *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">iso_concat_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">C</span> : PreCategory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Ltac</span> <span class="nf">iso_concat_t&#39;</span> :=
    <span class="nb">intros</span>;
    <span class="kp">repeat</span> <span class="kr">match goal with</span>
             | [ H : <span class="nl">?x</span> = <span class="nl">?y</span> |- _ ] =&gt; atomic y; <span class="nb">induction</span> H
             | [ H : <span class="nl">?x</span> = <span class="nl">?y</span> |- _ ] =&gt; atomic x; <span class="nb">symmetry in</span> H; <span class="nb">induction</span> H
           <span class="kr">end</span>;
    <span class="kp">repeat</span> <span class="kp">first</span> [ <span class="bp">done</span>
                 | <span class="nb">rewrite</span> -&gt; <span class="nl">?associativity</span>;
                   <span class="kp">progress</span> <span class="nb">rewrite</span> <span class="nl">?left_identity</span>, <span class="nl">?right_identity</span>, <span class="nl">?left_inverse</span>, <span class="nl">?right_inverse</span>
                 | <span class="nb">rewrite</span> &lt;- <span class="nl">?associativity</span>;
                   <span class="kp">progress</span> <span class="nb">rewrite</span> <span class="nl">?left_identity</span>, <span class="nl">?right_identity</span>, <span class="nl">?left_inverse</span>, <span class="nl">?right_inverse</span>
                 | <span class="nb">rewrite</span> -&gt; <span class="nl">?associativity</span>; <span class="kp">progress</span> f_ap; []
                 | <span class="nb">rewrite</span> &lt;- <span class="nl">?associativity</span>; <span class="kp">progress</span> f_ap; [] ].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Ltac</span> <span class="nf">iso_concat_t_id_fin</span> :=
    <span class="kr">match goal with</span>
      | [ |- <span class="kp">context</span>[@identity <span class="nl">?C</span> <span class="nl">?x</span>] ]
        =&gt; <span class="nb">generalize dependent</span> (identity x)
    <span class="kr">end</span>;
    iso_concat_t&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Ltac</span> <span class="nf">iso_concat_t_id</span> lem :=
    <span class="kp">first</span> [ <span class="kp">solve</span> [
                <span class="nb">etransitivity</span>; [ | <span class="nb">eapply</span> lem ];
                iso_concat_t_id_fin
              ]
          | <span class="kp">solve</span> [
                <span class="nb">etransitivity</span>; [ <span class="nb">symmetry</span>; <span class="nb">eapply</span> lem | ];
                iso_concat_t_id_fin
          ] ].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Ltac</span> <span class="nf">iso_concat_t</span> :=
    iso_concat_t&#39;;
    <span class="kp">try</span> <span class="kp">first</span> [ <span class="kp">solve</span> [ iso_concat_t_id @left_identity ]
              | <span class="kp">solve</span> [ iso_concat_t_id @right_identity ] ].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">iso_compose_pV</span> `(@IsIsomorphism C x y p)
  : p o p^-<span class="mi">1</span> = identity _
    := right_inverse.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">iso_compose_Vp</span> `(@IsIsomorphism C x y p)
  : p^-<span class="mi">1</span> o p = identity _
    := left_inverse.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk52"><span class="kn">Definition</span> <span class="nf">iso_compose_V_pp</span> `(@IsIsomorphism C y z p) `(q : morphism C x y)
  : p^-<span class="mi">1</span> o (p o q) = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p^-<span class="mi">1</span> o (p o q) = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk53"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p^-<span class="mi">1</span> o (p o q) = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk54"><span class="kn">Definition</span> <span class="nf">iso_compose_p_Vp</span> `(@IsIsomorphism C x z p) `(q : morphism C y z)
  : p o (p^-<span class="mi">1</span> o q) = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o (p^-<span class="mi">1</span> o q) = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk55"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o (p^-<span class="mi">1</span> o q) = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk56"><span class="kn">Definition</span> <span class="nf">iso_compose_pp_V</span> `(p : morphism C y z) `(@IsIsomorphism C x y q)
  : (p o q) o q^-<span class="mi">1</span> = p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o q o q^-<span class="mi">1</span> = p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk57"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o q o q^-<span class="mi">1</span> = p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk58"><span class="kn">Definition</span> <span class="nf">iso_compose_pV_p</span> `(p : morphism C x z) `(@IsIsomorphism C x y q)
  : (p o q^-<span class="mi">1</span>) o q = p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o q^-<span class="mi">1</span> o q = p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk59"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o q^-<span class="mi">1</span> o q = p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk5a"><span class="kn">Definition</span> <span class="nf">iso_inv_pp</span> `(@IsIsomorphism C y z p) `(@IsIsomorphism C x y q)
  : (p o q)^-<span class="mi">1</span> = q^-<span class="mi">1</span> o p^-<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(p o q)^-<span class="mi">1</span> = q^-<span class="mi">1</span> o p^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk5b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(p o q)^-<span class="mi">1</span> = q^-<span class="mi">1</span> o p^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk5c"><span class="kn">Definition</span> <span class="nf">iso_inv_Vp</span> `(@IsIsomorphism C y z p) `(@IsIsomorphism C x z q)
  : (p^-<span class="mi">1</span> o q)^-<span class="mi">1</span> = q^-<span class="mi">1</span> o p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(p^-<span class="mi">1</span> o q)^-<span class="mi">1</span> = q^-<span class="mi">1</span> o p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk5d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>y, z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(p^-<span class="mi">1</span> o q)^-<span class="mi">1</span> = q^-<span class="mi">1</span> o p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk5e"><span class="kn">Definition</span> <span class="nf">iso_inv_pV</span> `(@IsIsomorphism C x y p) `(@IsIsomorphism C x z q)
  : (p o q^-<span class="mi">1</span>)^-<span class="mi">1</span> = q o p^-<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(p o q^-<span class="mi">1</span>)^-<span class="mi">1</span> = q o p^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk5f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(p o q^-<span class="mi">1</span>)^-<span class="mi">1</span> = q o p^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk60"><span class="kn">Definition</span> <span class="nf">iso_inv_VV</span> `(@IsIsomorphism C x y p) `(@IsIsomorphism C y z q)
  : (p^-<span class="mi">1</span> o q^-<span class="mi">1</span>)^-<span class="mi">1</span> = q o p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(p^-<span class="mi">1</span> o q^-<span class="mi">1</span>)^-<span class="mi">1</span> = q o p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk61"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(p^-<span class="mi">1</span> o q^-<span class="mi">1</span>)^-<span class="mi">1</span> = q o p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk62"><span class="kn">Definition</span> <span class="nf">iso_moveR_Mp</span> `(p : morphism C x y) `(q : morphism C x z) `(@IsIsomorphism C y z r)
  : p = (r^-<span class="mi">1</span> o q) -&gt; (r o p) = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = r^-<span class="mi">1</span> o q -&gt; r o p = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk63"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = r^-<span class="mi">1</span> o q -&gt; r o p = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk64"><span class="kn">Definition</span> <span class="nf">iso_moveR_pM</span> `(@IsIsomorphism C x y p) `(q : morphism C x z) `(r : morphism C y z)
  : r = (q o p^-<span class="mi">1</span>) -&gt; (r o p) = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r = q o p^-<span class="mi">1</span> -&gt; r o p = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk65"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r = q o p^-<span class="mi">1</span> -&gt; r o p = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk66"><span class="kn">Definition</span> <span class="nf">iso_moveR_Vp</span> `(p : morphism C x y) `(q : morphism C x z) `(@IsIsomorphism C z y r)
  : p = (r o q) -&gt; (r^-<span class="mi">1</span> o p) = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C z y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = r o q -&gt; r^-<span class="mi">1</span> o p = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk67"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C z y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = r o q -&gt; r^-<span class="mi">1</span> o p = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk68"><span class="kn">Definition</span> <span class="nf">iso_moveR_pV</span> `(@IsIsomorphism C x y p) `(q : morphism C y z) `(r : morphism C x z)
  : r = (q o p) -&gt; (r o p^-<span class="mi">1</span>) = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r = q o p -&gt; r o p^-<span class="mi">1</span> = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk69"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r = q o p -&gt; r o p^-<span class="mi">1</span> = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk6a"><span class="kn">Definition</span> <span class="nf">iso_moveL_Mp</span> `(p : morphism C x y) `(q : morphism C x z) `(@IsIsomorphism C y z r)
  : (r^-<span class="mi">1</span> o q) = p -&gt; q = (r o p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r^-<span class="mi">1</span> o q = p -&gt; q = r o p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk6b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r^-<span class="mi">1</span> o q = p -&gt; q = r o p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk6c"><span class="kn">Definition</span> <span class="nf">iso_moveL_pM</span> `(@IsIsomorphism C x y p) `(q : morphism C x z) `(r : morphism C y z)
  : (q o p^-<span class="mi">1</span>) = r -&gt; q = (r o p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q o p^-<span class="mi">1</span> = r -&gt; q = r o p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk6d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q o p^-<span class="mi">1</span> = r -&gt; q = r o p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk6e"><span class="kn">Definition</span> <span class="nf">iso_moveL_Vp</span> `(p : morphism C x y) `(q : morphism C x z) `(@IsIsomorphism C _ _ r)
  : (r o q) = p -&gt; q = (r^-<span class="mi">1</span> o p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C z y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r o q = p -&gt; q = r^-<span class="mi">1</span> o p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk6f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C z y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism r</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r o q = p -&gt; q = r^-<span class="mi">1</span> o p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk70"><span class="kn">Definition</span> <span class="nf">iso_moveL_pV</span> `(@IsIsomorphism C x y p) `(q : morphism C y z) r
  : (q o p) = r -&gt; q = (r o p^-<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q o p = r -&gt; q = r o p^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk71"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y z</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>morphism C x z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q o p = r -&gt; q = r o p^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk72"><span class="kn">Definition</span> <span class="nf">iso_moveL_1M</span> `(p : morphism C x y) `(@IsIsomorphism C x y q)
  : p o q^-<span class="mi">1</span> = identity _ -&gt; p = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o q^-<span class="mi">1</span> = <span class="mi">1</span> -&gt; p = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk73"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o q^-<span class="mi">1</span> = <span class="mi">1</span> -&gt; p = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk74"><span class="kn">Definition</span> <span class="nf">iso_moveL_M1</span> `(p : morphism C x y) `(@IsIsomorphism C x y q)
  : q^-<span class="mi">1</span> o p = identity _ -&gt; p = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q^-<span class="mi">1</span> o p = <span class="mi">1</span> -&gt; p = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk75"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q^-<span class="mi">1</span> o p = <span class="mi">1</span> -&gt; p = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk76"><span class="kn">Definition</span> <span class="nf">iso_moveL_1V</span> `(p : morphism C x y) `(@IsIsomorphism C y x q)
  : p o q = identity _ -&gt; p = q^-<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o q = <span class="mi">1</span> -&gt; p = q^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk77"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o q = <span class="mi">1</span> -&gt; p = q^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk78"><span class="kn">Definition</span> <span class="nf">iso_moveL_V1</span> `(p : morphism C x y) `(@IsIsomorphism C y x q)
  : q o p = identity _ -&gt; p = q^-<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q o p = <span class="mi">1</span> -&gt; p = q^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk79"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism q</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q o p = <span class="mi">1</span> -&gt; p = q^-<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk7a"><span class="kn">Definition</span> <span class="nf">iso_moveR_M1</span> `(@IsIsomorphism C x y p) q
  : identity _ = p^-<span class="mi">1</span> o q -&gt; p = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = p^-<span class="mi">1</span> o q -&gt; p = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk7b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = p^-<span class="mi">1</span> o q -&gt; p = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk7c"><span class="kn">Definition</span> <span class="nf">iso_moveR_1M</span> `(@IsIsomorphism C x y p) q
  : identity _ = q o p^-<span class="mi">1</span> -&gt; p = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = q o p^-<span class="mi">1</span> -&gt; p = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk7d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = q o p^-<span class="mi">1</span> -&gt; p = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk7e"><span class="kn">Definition</span> <span class="nf">iso_moveR_1V</span> `(@IsIsomorphism C x y p) q
  : identity _ = q o p -&gt; p^-<span class="mi">1</span> = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = q o p -&gt; p^-<span class="mi">1</span> = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk7f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = q o p -&gt; p^-<span class="mi">1</span> = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk80"><span class="kn">Definition</span> <span class="nf">iso_moveR_V1</span> `(@IsIsomorphism C x y p) q
  : identity _ = p o q -&gt; p^-<span class="mi">1</span> = q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = p o q -&gt; p^-<span class="mi">1</span> = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk81"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>morphism C x y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsIsomorphism p</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>morphism C y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = p o q -&gt; p^-<span class="mi">1</span> = q</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">iso_concat_t.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">iso_concat_lemmas</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Tactics for moving inverses around *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">iso_move_inverse&#39;</span> :=
  <span class="kr">match goal with</span>
    | [ |- _^-<span class="mi">1</span> o _ = _ ] =&gt; <span class="nb">apply</span> iso_moveR_Vp
    | [ |- _ = _^-<span class="mi">1</span> o _ ] =&gt; <span class="nb">apply</span> iso_moveL_Vp
    | [ |- _ o _^-<span class="mi">1</span> = _ ] =&gt; <span class="nb">apply</span> iso_moveR_pV
    | [ |- _ = _ o _^-<span class="mi">1</span> ] =&gt; <span class="nb">apply</span> iso_moveL_pV
    | [ |- _ o (_ o _^-<span class="mi">1</span>) = _ ] =&gt; <span class="nb">rewrite</span> &lt;- associativity
    | [ |- _ = _ o (_ o _^-<span class="mi">1</span>) ] =&gt; <span class="nb">rewrite</span> &lt;- associativity
    | [ |- (_^-<span class="mi">1</span> o _) o _ = _ ] =&gt; <span class="nb">rewrite</span> -&gt; associativity
    | [ |- _ = (_^-<span class="mi">1</span> o _) o _ ] =&gt; <span class="nb">rewrite</span> -&gt; associativity
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">iso_move_inverse</span> := <span class="kp">progress</span> <span class="kp">repeat</span> iso_move_inverse&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Tactics for collapsing [p ‚àò p‚Åª¬π] and [p‚Åª¬π ‚àò p] *)</span>
<span class="sd">(** Now the tactics for collapsing [p ‚àò p‚Åª¬π] (and [p‚Åª¬π ‚àò p]) in the</span>
<span class="sd">    middle of a chain of compositions of isomorphisms. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">iso_collapse_inverse_left&#39;</span> :=
  <span class="kp">first</span> [ <span class="nb">apply</span> ap
        | <span class="kp">progress</span> <span class="nb">rewrite</span> <span class="nl">?iso_compose_p_Vp</span>, <span class="nl">?iso_compose_V_pp</span> ].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">iso_collapse_inverse_left</span> :=
  <span class="nb">rewrite</span> -&gt; <span class="nl">?Category</span>.Core.associativity;
  <span class="kp">progress</span> <span class="kp">repeat</span> iso_collapse_inverse_left&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">iso_collapse_inverse_right&#39;</span> :=
  <span class="kp">first</span> [ <span class="nb">apply</span> ap10; <span class="nb">apply</span> ap
        | <span class="kp">progress</span> <span class="nb">rewrite</span> <span class="nl">?iso_compose_pV_p</span>, <span class="nl">?iso_compose_pp_V</span> ].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">iso_collapse_inverse_right</span> :=
  <span class="nb">rewrite</span> &lt;- <span class="nl">?Category</span>.Core.associativity;
  <span class="kp">progress</span> <span class="kp">repeat</span> iso_collapse_inverse_right&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">iso_collapse_inverse</span> :=
  <span class="kp">progress</span> <span class="kp">repeat</span> <span class="kp">first</span> [ iso_collapse_inverse_left
                        | iso_collapse_inverse_right ].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">associativity_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">C</span> : PreCategory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> <span class="nv">x0</span> <span class="nv">x1</span> <span class="nv">x2</span> <span class="nv">x3</span> <span class="nv">x4</span> : C.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** This lemma is helpful for backwards reasoning. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk82"><span class="kn">Lemma</span> <span class="nf">compose4associativity_helper</span>
    (<span class="nv">a</span> : morphism C x3 x4) (<span class="nv">b</span> : morphism C x2 x3)
    (<span class="nv">c</span> : morphism C x1 x2) (<span class="nv">d</span> : morphism C x0 x1)
  : a o b o c o d = (a o ((b o c) o d)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x0, x1, x2, x3, x4</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>morphism C x3 x4</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>morphism C x2 x3</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>morphism C x1 x2</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>morphism C x0 x1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a o b o c o d = a o (b o c o d)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="morphisms-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="morphisms-v-chk83"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span>PreCategory</span></span></span><br><span><var>x0, x1, x2, x3, x4</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>morphism C x3 x4</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>morphism C x2 x3</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>morphism C x1 x2</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>morphism C x0 x1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a o b o c o d = a o (b o c o d)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> !associativity; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">associativity_composition</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Module</span> <span class="nf">Export</span> CategoryMorphismsNotations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;m ^-1&quot;</span> := (morphism_inverse m) : morphism_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Infix</span> <span class="s2">&quot;&lt;~=~&gt;&quot;</span> := Isomorphic : category_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x -&gt;&gt; y&quot;</span> := (Epimorphism x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;x (-&gt; y&quot;</span> := (Monomorphism x y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">CategoryMorphismsNotations</span>.</span></span></pre>
</div>
</div></body>
</html>
