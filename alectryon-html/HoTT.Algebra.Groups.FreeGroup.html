<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>FreeGroup.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk0"><span class="kn">From</span> HoTT <span class="kn">Require Import</span> Basics Types.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Group Subgroup
  WildCat.Core WildCat.<span class="kn">Universe</span> <span class="nf">Colimits</span>.Coeq
  Truncations.Core Truncations.SeparatedTrunc
  Spaces.List.Core Spaces.List.Theory.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> mc_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> mc_mult_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** [IsFreeGroup] is defined in Group.v. In this file we construct free groups and and prove properties about them. *)</span>

<span class="sd">(** We construct the free group on a type [A] as a higher inductive type. This construction is due to Kraus-Altenkirch 2018 arXiv:1805.02069. Their construction is actually more general, but we set-truncate it to suit our needs which is the free group as a set. This is a very simple HIT in a similar manner to the abelianization HIT used in Algebra.AbGroup.Abelianization. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Reduction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Universe</span> <span class="nf">u</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> (<span class="nv">A</span> : <span class="kt">Type</span>@{u}).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> list_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** We define words (with inverses) on A to be lists of marked elements of A *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Definition</span> <span class="nf">Words</span> : <span class="kt">Type</span>@{u} := list (A + A).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Given a marked element of A we can change its mark *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Definition</span> <span class="nf">change_sign</span> : A + A -&gt; A + A := equiv_sum_symm A A.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** We introduce a local notation for [change_sign]. It is only defined in this section however. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;a ^&#39;&quot;</span> := (change_sign a) (<span class="kn">at level</span> <span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Changing sign is an involution *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk1"><span class="kn">Local Definition</span> <span class="nf">change_sign_inv</span> <span class="nv">a</span> : a^&#39;^&#39; = a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a ^&#39;) ^&#39; = a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a ^&#39;) ^&#39; = a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> a.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Now we wish to define the free group on A as the following HIT: </span>

<span class="sd">    HIT N(A) : hSet</span>
<span class="sd">     | eta : Words -&gt; N(A)</span>
<span class="sd">     | tau (x : Words) (a : A + A) (y : Words)</span>
<span class="sd">         : eta (x ++ [a] ++ [a^] ++ y) = eta (x ++ y).</span>

<span class="sd">    Since we cannot write our HITs directly like this (without resorting to private inductive types), we will construct this HIT out of HITs we know. In fact, we can define N(A) as a coequalizer. *)</span>

</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk3"><span class="kn">Local Definition</span> <span class="nf">map1</span> : Words * (A + A) * Words -&gt; Words.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words * (A + A) * Words -&gt; Words</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words * (A + A) * Words -&gt; Words</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk5"><span class="nb">intros</span> [[x a] y].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (x ++ [a] ++ [a^&#39;] ++ y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> map1 _ /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk6"><span class="kn">Local Definition</span> <span class="nf">map2</span> : Words * (A + A) * Words -&gt; Words.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words * (A + A) * Words -&gt; Words</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words * (A + A) * Words -&gt; Words</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk8"><span class="nb">intros</span> [[x a] y].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (x ++ y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> map2 _ /.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Now we can define the underlying type of the free group as the 0-truncated coequalizer of these two maps *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">freegroup_type</span> : <span class="kt">Type</span> := Tr <span class="mi">0</span> (Coeq map1 map2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** This is the point constructor *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">freegroup_eta</span> : Words -&gt; freegroup_type := tr o coeq.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** This is the path constructor *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk9"><span class="kn">Definition</span> <span class="nf">freegroup_tau</span> (<span class="nv">x</span> : Words) (<span class="nv">a</span> : A + A) (<span class="nv">y</span> : Words)
    : freegroup_eta (x ++ [a] ++ [a^&#39;] ++ y) = freegroup_eta (x ++ y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (x ++ [a] ++ [a ^&#39;] ++ y) =
freegroup_eta (x ++ y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chka"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (x ++ [a] ++ [a ^&#39;] ++ y) =
freegroup_eta (x ++ y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb"><span class="nb">apply</span> path_Tr, tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">coeq (x ++ [a] ++ [a ^&#39;] ++ y) = coeq (x ++ y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((cglue (x, a, y))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** The group operation *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkc">#[export] <span class="kn">Instance</span> <span class="nf">sgop_freegroup</span> : SgOp freegroup_type.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">SgOp freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">SgOp freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chke"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>freegroup_type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf">strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>y, x</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk10"><span class="nb">revert</span> x; snapply Coeq_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words -&gt; freegroup_type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk11" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk11"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Words * (A + A) * Words,
<span class="nl">?coeq&#39;</span> (map1 b) = <span class="nl">?coeq&#39;</span> (map2 b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk12">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words -&gt; freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk13"><span class="nb">intros</span> x; <span class="nb">revert</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Coeq map1 map2 -&gt; freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk14">snapply Coeq_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words -&gt; freegroup_type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk15" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk15"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Words * (A + A) * Words,
<span class="nl">?coeq&#39;</span> (map1 b) = <span class="nl">?coeq&#39;</span> (map2 b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk16">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words -&gt; freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk17"><span class="nb">intros</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (freegroup_eta (x ++ y)).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk18">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Words * (A + A) * Words,
(<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt; freegroup_eta (x ++ y)) (map1 b) =
(<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt; freegroup_eta (x ++ y)) (map2 b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk19"><span class="nb">intros</span> [[y a] z]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (x ++ y ++ a :: a ^&#39; :: z) =
freegroup_eta (x ++ y ++ z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk1a"><span class="nb">change</span> (freegroup_eta (x ++ y ++ ([a] ++ [a^&#39;] ++ z))
        = freegroup_eta (x ++ y ++ z)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (x ++ y ++ [a] ++ [a ^&#39;] ++ z) =
freegroup_eta (x ++ y ++ z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk1b">rhs napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (x ++ y ++ [a] ++ [a ^&#39;] ++ z) =
freegroup_eta <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk1c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk1c"><hr></label><div class="goal-conclusion">x ++ y ++ z = <span class="nl">?Goal</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk1d"><span class="mi">2</span>: napply app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (x ++ y ++ [a] ++ [a ^&#39;] ++ z) =
freegroup_eta ((x ++ y) ++ z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk1e">lhs napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ++ y ++ [a] ++ [a ^&#39;] ++ z = <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk1f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk1f"><hr></label><div class="goal-conclusion">freegroup_eta <span class="nl">?Goal</span> = freegroup_eta ((x ++ y) ++ z)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk20"><span class="mi">1</span>: napply app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta ((x ++ y) ++ [a] ++ [a ^&#39;] ++ z) =
freegroup_eta ((x ++ y) ++ z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input">napply (freegroup_tau _ a).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk21">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Words * (A + A) * Words,
(<span class="kr">fun</span> <span class="nv">x</span> : Words =&gt;
 Coeq_rec freegroup_type
   (<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt; freegroup_eta (x ++ y))
   (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
    (<span class="kr">fun</span> <span class="nv">fst</span> : Words * (A + A) =&gt;
     (<span class="kr">fun</span> (<span class="nv">y</span> : Words) (<span class="nv">a</span> : A + A) (<span class="nv">z</span> : Words) =&gt;
      (ap freegroup_eta
         (app_assoc x y ([a] ++ [a ^&#39;] ++ z)) @
       freegroup_tau (x ++ y) a z) @
      (ap freegroup_eta (app_assoc x y z))^
      :
      freegroup_eta (x ++ map1 (y, a, z)) =
      freegroup_eta (x ++ map2 (y, a, z)))
       (Overture.fst fst) (snd fst)) (fst b0) (snd b0))
   y) (map1 b) =
(<span class="kr">fun</span> <span class="nv">x</span> : Words =&gt;
 Coeq_rec freegroup_type
   (<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt; freegroup_eta (x ++ y))
   (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
    (<span class="kr">fun</span> <span class="nv">fst</span> : Words * (A + A) =&gt;
     (<span class="kr">fun</span> (<span class="nv">y</span> : Words) (<span class="nv">a</span> : A + A) (<span class="nv">z</span> : Words) =&gt;
      (ap freegroup_eta
         (app_assoc x y ([a] ++ [a ^&#39;] ++ z)) @
       freegroup_tau (x ++ y) a z) @
      (ap freegroup_eta (app_assoc x y z))^
      :
      freegroup_eta (x ++ map1 (y, a, z)) =
      freegroup_eta (x ++ map2 (y, a, z)))
       (Overture.fst fst) (snd fst)) (fst b0) (snd b0))
   y) (map2 b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk22"><span class="nb">intros</span> [[c b] d].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Coeq_rec freegroup_type
  (<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt;
   freegroup_eta (map1 (c, b, d) ++ y))
  (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
   (ap freegroup_eta
      (app_assoc (map1 (c, b, d)) (fst (fst b0))
         ([snd (fst b0)] ++
          [(snd (fst b0)) ^&#39;] ++ snd b0)) @
    freegroup_tau (map1 (c, b, d) ++ fst (fst b0))
      (snd (fst b0)) (snd b0)) @
   (ap freegroup_eta
      (app_assoc (map1 (c, b, d)) (fst (fst b0))
         (snd b0)))^) y =
Coeq_rec freegroup_type
  (<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt;
   freegroup_eta (map2 (c, b, d) ++ y))
  (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
   (ap freegroup_eta
      (app_assoc (map2 (c, b, d)) (fst (fst b0))
         ([snd (fst b0)] ++
          [(snd (fst b0)) ^&#39;] ++ snd b0)) @
    freegroup_tau (map2 (c, b, d) ++ fst (fst b0))
      (snd (fst b0)) (snd b0)) @
   (ap freegroup_eta
      (app_assoc (map2 (c, b, d)) (fst (fst b0))
         (snd b0)))^) y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk23"><span class="nb">revert</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">y</span> : Coeq map1 map2,
Coeq_rec freegroup_type
  (<span class="kr">fun</span> <span class="nv">y0</span> : Words =&gt;
   freegroup_eta (map1 (c, b, d) ++ y0))
  (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
   (ap freegroup_eta
      (app_assoc (map1 (c, b, d)) (fst (fst b0))
         ([snd (fst b0)] ++
          [(snd (fst b0)) ^&#39;] ++ snd b0)) @
    freegroup_tau (map1 (c, b, d) ++ fst (fst b0))
      (snd (fst b0)) (snd b0)) @
   (ap freegroup_eta
      (app_assoc (map1 (c, b, d)) (fst (fst b0))
         (snd b0)))^) y =
Coeq_rec freegroup_type
  (<span class="kr">fun</span> <span class="nv">y0</span> : Words =&gt;
   freegroup_eta (map2 (c, b, d) ++ y0))
  (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
   (ap freegroup_eta
      (app_assoc (map2 (c, b, d)) (fst (fst b0))
         ([snd (fst b0)] ++
          [(snd (fst b0)) ^&#39;] ++ snd b0)) @
    freegroup_tau (map2 (c, b, d) ++ fst (fst b0))
      (snd (fst b0)) (snd b0)) @
   (ap freegroup_eta
      (app_assoc (map2 (c, b, d)) (fst (fst b0))
         (snd b0)))^) y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk24">srapply Coeq_ind_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Words,
(<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt;
 Coeq_rec freegroup_type
   (<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt;
    freegroup_eta (map1 (c, b, d) ++ y))
   (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
    (ap freegroup_eta
       (app_assoc (map1 (c, b, d)) (fst (fst b0))
          ([snd (fst b0)] ++
           [(snd (fst b0)) ^&#39;] ++ snd b0)) @
     freegroup_tau (map1 (c, b, d) ++ fst (fst b0))
       (snd (fst b0)) (snd b0)) @
    (ap freegroup_eta
       (app_assoc (map1 (c, b, d)) (fst (fst b0))
          (snd b0)))^) x =
 Coeq_rec freegroup_type
   (<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt;
    freegroup_eta (map2 (c, b, d) ++ y))
   (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
    (ap freegroup_eta
       (app_assoc (map2 (c, b, d)) (fst (fst b0))
          ([snd (fst b0)] ++
           [(snd (fst b0)) ^&#39;] ++ snd b0)) @
     freegroup_tau (map2 (c, b, d) ++ fst (fst b0))
       (snd (fst b0)) (snd b0)) @
    (ap freegroup_eta
       (app_assoc (map2 (c, b, d)) (fst (fst b0))
          (snd b0)))^) x) (coeq a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk25"><span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt;
 Coeq_rec freegroup_type
   (<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt;
    freegroup_eta (map1 (c, b, d) ++ y))
   (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
    (ap freegroup_eta
       (app_assoc (map1 (c, b, d)) (fst (fst b0))
          ([snd (fst b0)] ++
           [(snd (fst b0)) ^&#39;] ++ snd b0)) @
     freegroup_tau (map1 (c, b, d) ++ fst (fst b0))
       (snd (fst b0)) (snd b0)) @
    (ap freegroup_eta
       (app_assoc (map1 (c, b, d)) (fst (fst b0))
          (snd b0)))^) x =
 Coeq_rec freegroup_type
   (<span class="kr">fun</span> <span class="nv">y</span> : Words =&gt;
    freegroup_eta (map2 (c, b, d) ++ y))
   (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
    (ap freegroup_eta
       (app_assoc (map2 (c, b, d)) (fst (fst b0))
          ([snd (fst b0)] ++
           [(snd (fst b0)) ^&#39;] ++ snd b0)) @
     freegroup_tau (map2 (c, b, d) ++ fst (fst b0))
       (snd (fst b0)) (snd b0)) @
    (ap freegroup_eta
       (app_assoc (map2 (c, b, d)) (fst (fst b0))
          (snd b0)))^) x) (coeq a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk26"><span class="nb">change</span> (freegroup_eta ((c ++ [b] ++ [b^&#39;] ++ d) ++ a)
      = freegroup_eta ((c ++ d) ++ a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta ((c ++ [b] ++ [b ^&#39;] ++ d) ++ a) =
freegroup_eta ((c ++ d) ++ a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk27">lhs_V napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> = (c ++ [b] ++ [b ^&#39;] ++ d) ++ a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk28" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk28"><hr></label><div class="goal-conclusion">freegroup_eta <span class="nl">?Goal</span> = freegroup_eta ((c ++ d) ++ a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk29"><span class="mi">1</span>: napply app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (c ++ ([b] ++ [b ^&#39;] ++ d) ++ a) =
freegroup_eta ((c ++ d) ++ a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk2a">lhs_V napply (ap (<span class="kr">fun</span> <span class="nv">x</span> =&gt; freegroup_eta (c ++ x))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> = ([b] ++ [b ^&#39;] ++ d) ++ a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk2b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk2b"><hr></label><div class="goal-conclusion">freegroup_eta (c ++ <span class="nl">?Goal</span>) =
freegroup_eta ((c ++ d) ++ a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk2c"><span class="mi">1</span>: napply app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (c ++ [b] ++ ([b ^&#39;] ++ d) ++ a) =
freegroup_eta ((c ++ d) ++ a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk2d">lhs_V napply (ap (<span class="kr">fun</span> <span class="nv">x</span> =&gt; freegroup_eta (c ++ _ ++ x))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> = ([b ^&#39;] ++ d) ++ a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk2e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk2e"><hr></label><div class="goal-conclusion">freegroup_eta (c ++ [b] ++ <span class="nl">?Goal</span>) =
freegroup_eta ((c ++ d) ++ a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk2f"><span class="mi">1</span>: napply app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (c ++ [b] ++ [b ^&#39;] ++ d ++ a) =
freegroup_eta ((c ++ d) ++ a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk30">rhs_V napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (c ++ [b] ++ [b ^&#39;] ++ d ++ a) =
freegroup_eta <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk31" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk31"><hr></label><div class="goal-conclusion"><span class="nl">?Goal</span> = (c ++ d) ++ a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk32"><span class="mi">2</span>: napply app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>d, a</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (c ++ [b] ++ [b ^&#39;] ++ d ++ a) =
freegroup_eta (c ++ d ++ a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">napply freegroup_tau.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** The unit of the free group is the empty word *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">#[export] <span class="kn">Instance</span> <span class="nf">monunit_freegroup_type</span> : MonUnit freegroup_type
    := freegroup_eta nil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** We can change the sign of all the elements in a word and reverse the order. This will be the inversion in the group *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">word_change_sign</span> (<span class="nv">x</span> : Words) : Words
    := reverse (list_map change_sign x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Changing the sign changes the order of word concatenation *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk33"><span class="kn">Definition</span> <span class="nf">word_change_sign_ww</span> (<span class="nv">x</span> <span class="nv">y</span> : Words)
    : word_change_sign (x ++ y) = word_change_sign y ++ word_change_sign x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign (x ++ y) =
word_change_sign y ++ word_change_sign x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk34"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign (x ++ y) =
word_change_sign y ++ word_change_sign x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk35"><span class="nb">unfold</span> word_change_sign.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reverse (list_map change_sign (x ++ y)) =
reverse (list_map change_sign y) ++
reverse (list_map change_sign x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk36">lhs napply (ap reverse).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_map change_sign (x ++ y) = <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk37" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk37"><hr></label><div class="goal-conclusion">reverse <span class="nl">?Goal</span> =
reverse (list_map change_sign y) ++
reverse (list_map change_sign x)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk38"><span class="mi">1</span>: napply list_map_app.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reverse
  (list_map change_sign x ++ list_map change_sign y) =
reverse (list_map change_sign y) ++
reverse (list_map change_sign x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">napply reverse_app.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** This is also involutive *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk39"><span class="kn">Lemma</span> <span class="nf">word_change_sign_inv</span> <span class="nv">x</span> : word_change_sign (word_change_sign x) = x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign (word_change_sign x) = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk3a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign (word_change_sign x) = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk3b"><span class="nb">unfold</span> word_change_sign.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reverse
  (list_map change_sign
     (reverse (list_map change_sign x))) = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk3c">lhs_V napply list_map_reverse.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_map change_sign
  (reverse (reverse (list_map change_sign x))) = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk3d">lhs napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reverse (reverse (list_map change_sign x)) = <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk3e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk3e"><hr></label><div class="goal-conclusion">list_map change_sign <span class="nl">?Goal</span> = x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk3f"><span class="mi">1</span>: napply reverse_reverse.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_map change_sign (list_map change_sign x) = x</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk40">lhs_V napply list_map_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">list_map (<span class="kr">fun</span> <span class="nv">x</span> : A + A =&gt; (x ^&#39;) ^&#39;) x = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk41">snapply list_map_id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x0</span> : A + A,
InList x0 x -&gt; (<span class="kr">fun</span> <span class="nv">x</span> : A + A =&gt; (x ^&#39;) ^&#39;) x0 = x0</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk42"><span class="nb">intros</span> a ?.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>InList a x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A + A =&gt; (x ^&#39;) ^&#39;) a = a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> change_sign_inv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Changing the sign gives us left inverses *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk43"><span class="kn">Lemma</span> <span class="nf">word_concat_Vw</span> <span class="nv">x</span> : freegroup_eta (word_change_sign x ++ x) = mon_unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk44"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk45"><span class="nb">induction</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (word_change_sign nil ++ nil) = <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk46" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk46"><hr></label><div class="goal-conclusion">freegroup_eta (word_change_sign (a :: x) ++ a :: x) =
<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk47"><span class="mi">1</span>: <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (word_change_sign (a :: x) ++ a :: x) =
<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk48">lhs napply (ap (<span class="kr">fun</span> <span class="nv">x</span> =&gt; freegroup_eta (x ++ _))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign (a :: x) = <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk49" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk49"><hr></label><div class="goal-conclusion">freegroup_eta (<span class="nl">?Goal</span> ++ a :: x) = <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk4a"><span class="mi">1</span>: napply reverse_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  ((reverse
      ((<span class="kr">fix</span> list_map
          (A B : <span class="kt">Type</span>) (f : A -&gt; B) (l : list A)
          {<span class="kr">struct</span> l} : list B :=
          <span class="kr">match</span> l <span class="kr">with</span>
          | nil =&gt; nil
          | x :: l0 =&gt; f x :: list_map A B f l0
          <span class="kr">end</span>) (A + A)%type (A + A)%type change_sign x) ++
    [a ^&#39;]) ++ a :: x) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk4b"><span class="nb">change</span> (freegroup_eta ((word_change_sign x ++ [a^&#39;]) ++ [a] ++ x)
      = mon_unit).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  ((word_change_sign x ++ [a ^&#39;]) ++ [a] ++ x) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk4c">lhs_V napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> = (word_change_sign x ++ [a ^&#39;]) ++ [a] ++ x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk4d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk4d"><hr></label><div class="goal-conclusion">freegroup_eta <span class="nl">?Goal</span> = <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk4e"><span class="mi">1</span>: napply app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  (word_change_sign x ++ [a ^&#39;] ++ [a] ++ x) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk4f"><span class="nb">set</span> (a&#39; := a^&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br><span><var>a'</var><span><span class="hyp-body"><b>:= </b><span>a ^&#39;</span></span><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (word_change_sign x ++ [a&#39;] ++ [a] ++ x) =
<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk50"><span class="nb">rewrite</span> &lt;- (change_sign_inv a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br><span><var>a'</var><span><span class="hyp-body"><b>:= </b><span>a ^&#39;</span></span><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  (word_change_sign x ++ [a&#39;] ++ [(a ^&#39;) ^&#39;] ++ x) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk51">lhs napply freegroup_tau.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHx</var><span class="hyp-type"><b>: </b><span>freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></span></span></span><br><span><var>a'</var><span><span class="hyp-body"><b>:= </b><span>a ^&#39;</span></span><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (word_change_sign x ++ x) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> IHx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** And since changing the sign is involutive we get right inverses from left inverses *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk52"><span class="kn">Lemma</span> <span class="nf">word_concat_wV</span> <span class="nv">x</span> : freegroup_eta (x ++ word_change_sign x) = mon_unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (x ++ word_change_sign x) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk53"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (x ++ word_change_sign x) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk54"><span class="nb">set</span> (x&#39; := word_change_sign x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>x'</var><span><span class="hyp-body"><b>:= </b><span>word_change_sign x</span></span><span class="hyp-type"><b>: </b><span>Words</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (x ++ x&#39;) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk55"><span class="nb">rewrite</span> &lt;- (word_change_sign_inv x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>x'</var><span><span class="hyp-body"><b>:= </b><span>word_change_sign x</span></span><span class="hyp-type"><b>: </b><span>Words</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  (word_change_sign (word_change_sign x) ++ x&#39;) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk56"><span class="nb">change</span> (freegroup_eta (word_change_sign x&#39; ++ x&#39;) = mon_unit).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>x'</var><span><span class="hyp-body"><b>:= </b><span>word_change_sign x</span></span><span class="hyp-type"><b>: </b><span>Words</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (word_change_sign x&#39; ++ x&#39;) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> word_concat_Vw.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Inverses are defined by changing the order of a word that appears in eta. Most of the work here is checking that it is agreeable with the path constructor. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk57">#[export] <span class="kn">Instance</span> <span class="nf">inverse_freegroup_type</span> : Inverse freegroup_type.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Inverse freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk58"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Inverse freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk59"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>freegroup_type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk5a">strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk5b"><span class="nb">revert</span> x; srapply Coeq_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words -&gt; freegroup_type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk5c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk5c"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Words * (A + A) * Words,
<span class="nl">?coeq&#39;</span> (map1 b) = <span class="nl">?coeq&#39;</span> (map2 b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk5d">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words -&gt; freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk5e"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk5f"><span class="nb">apply</span> freegroup_eta.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (word_change_sign x).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk60">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Words * (A + A) * Words,
(<span class="kr">fun</span> <span class="nv">x</span> : Words =&gt; freegroup_eta (word_change_sign x))
  (map1 b) =
(<span class="kr">fun</span> <span class="nv">x</span> : Words =&gt; freegroup_eta (word_change_sign x))
  (map2 b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk61"><span class="nb">intros</span> [[b a] c].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta (word_change_sign (map1 (b, a, c))) =
freegroup_eta (word_change_sign (map2 (b, a, c)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk62"><span class="nb">unfold</span> map1, map2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  (word_change_sign (b ++ [a] ++ [a ^&#39;] ++ c)) =
freegroup_eta (word_change_sign (b ++ c))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk63">lhs napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign (b ++ [a] ++ [a ^&#39;] ++ c) = <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk64" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk64"><hr></label><div class="goal-conclusion">freegroup_eta <span class="nl">?Goal</span> =
freegroup_eta (word_change_sign (b ++ c))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk65">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign (b ++ [a] ++ [a ^&#39;] ++ c) = <span class="nl">?Goal</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk66">lhs napply word_change_sign_ww.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign ([a] ++ [a ^&#39;] ++ c) ++
word_change_sign b = <span class="nl">?Goal</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk67">napply (ap (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x ++ _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign ([a] ++ [a ^&#39;] ++ c) = <span class="nl">?Goal0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk68">lhs napply word_change_sign_ww.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign ([a ^&#39;] ++ c) ++ word_change_sign [a] =
<span class="nl">?Goal0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk69">napply (ap (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x ++ _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign ([a ^&#39;] ++ c) = <span class="nl">?Goal0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk6a">lhs napply word_change_sign_ww.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign c ++ word_change_sign [a ^&#39;] = <span class="nl">?Goal0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk6b">napply (ap (<span class="kr">fun</span> <span class="nv">x</span> =&gt; _ ++ x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_change_sign [a ^&#39;] = <span class="nl">?Goal0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (word_change_sign_inv [a]).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk6c">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  (((word_change_sign c ++ [a]) ++
    word_change_sign [a]) ++ word_change_sign b) =
freegroup_eta (word_change_sign (b ++ c))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk6d">lhs_V napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> =
((word_change_sign c ++ [a]) ++ word_change_sign [a]) ++
word_change_sign b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk6e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk6e"><hr></label><div class="goal-conclusion">freegroup_eta <span class="nl">?Goal</span> =
freegroup_eta (word_change_sign (b ++ c))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk6f"><span class="mi">1</span>: rhs_V napply app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> =
(word_change_sign c ++ [a]) ++
word_change_sign [a] ++ word_change_sign b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk70" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk70"><hr></label><div class="goal-conclusion">freegroup_eta <span class="nl">?Goal</span> =
freegroup_eta (word_change_sign (b ++ c))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk71"><span class="mi">1</span>: napply app_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  (word_change_sign c ++
   [a] ++ word_change_sign [a] ++ word_change_sign b) =
freegroup_eta (word_change_sign (b ++ c))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk72">rhs napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  (word_change_sign c ++
   [a] ++ word_change_sign [a] ++ word_change_sign b) =
freegroup_eta <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk73" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk73"><hr></label><div class="goal-conclusion">word_change_sign (b ++ c) = <span class="nl">?Goal</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk74"><span class="mi">2</span>: napply word_change_sign_ww.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">freegroup_eta
  (word_change_sign c ++
   [a] ++ word_change_sign [a] ++ word_change_sign b) =
freegroup_eta
  (word_change_sign c ++ word_change_sign b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">napply freegroup_tau.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Now we can start to prove the group laws. Since these are hprops we can ignore what happens with the path constructor. *)</span>

  <span class="sd">(** Our operation is associative *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk75">#[export] <span class="kn">Instance</span> <span class="nf">associative_freegroup_type</span> : Associative sg_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Associative sg_op</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk76"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Associative sg_op</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk77"><span class="nb">intros</span> x y z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>freegroup_type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x * (y * z) = x * y * z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk78">strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>z, y, x</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">tr x * (tr y * tr z) = tr x * tr y * tr z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk79"><span class="nb">revert</span> x; srapply Coeq_ind_hprop; <span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>z, y</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt;
 tr x * (tr y * tr z) = tr x * tr y * tr z) (coeq x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk7a"><span class="nb">revert</span> y; srapply Coeq_ind_hprop; <span class="nb">intro</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x0</span> : Coeq map1 map2 =&gt;
 (<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt;
  tr x * (tr x0 * tr z) = tr x * tr x0 * tr z)
   (coeq x)) (coeq y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk7b"><span class="nb">revert</span> z; srapply Coeq_ind_hprop; <span class="nb">intro</span> z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x0</span> : Coeq map1 map2 =&gt;
 (<span class="kr">fun</span> <span class="nv">x1</span> : Coeq map1 map2 =&gt;
  (<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt;
   tr x * (tr x1 * tr x0) = tr x * tr x1 * tr x0)
    (coeq x)) (coeq y)) (coeq z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk7c">napply (ap (tr o coeq)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ++ y ++ z = (x ++ y) ++ z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">napply app_assoc.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Left identity *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk7d">#[export] <span class="kn">Instance</span> <span class="nf">leftidentity_freegroup_type</span> : LeftIdentity sg_op mon_unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftIdentity sg_op <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk7e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftIdentity sg_op <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk7f">rapply Trunc_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Coeq map1 map2, <span class="mi">1</span> * tr a = tr a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk80">srapply Coeq_ind_hprop; <span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt; <span class="mi">1</span> * tr x = tr x) (coeq x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Right identity *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk81">#[export] <span class="kn">Instance</span> <span class="nf">rightidentity_freegroup_type</span> : RightIdentity sg_op mon_unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightIdentity sg_op <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk82"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightIdentity sg_op <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk83">rapply Trunc_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Coeq map1 map2, tr a * <span class="mi">1</span> = tr a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk84">srapply Coeq_ind_hprop; <span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt; tr x * <span class="mi">1</span> = tr x) (coeq x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk85"><span class="nb">apply</span> (ap tr), ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x ++ nil = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">napply app_nil.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Left inverse *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk86">#[export] <span class="kn">Instance</span> <span class="nf">leftinverse_freegroup_type</span> : LeftInverse (.*.) (^) mon_unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftInverse sg_op inv <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk87"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LeftInverse sg_op inv <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk88">rapply Trunc_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Coeq map1 map2, (tr a)^ * tr a = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk89">srapply Coeq_ind_hprop; <span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt; (tr x)^ * tr x = <span class="mi">1</span>)
  (coeq x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> word_concat_Vw.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Right inverse *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk8a">#[export] <span class="kn">Instance</span> <span class="nf">rightinverse_freegroup_type</span> : RightInverse (.*.) (^) mon_unit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightInverse sg_op inv <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk8b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">RightInverse sg_op inv <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk8c">rapply Trunc_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Coeq map1 map2, tr a * (tr a)^ = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk8d">srapply Coeq_ind_hprop; <span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt; tr x * (tr x)^ = <span class="mi">1</span>)
  (coeq x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> word_concat_wV.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Finally we have defined the free group on [A] *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk8e"><span class="kn">Definition</span> <span class="nf">FreeGroup</span> : Group.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Group</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk8f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Group</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">snapply (Build_Group freegroup_type); <span class="kp">repeat</span> <span class="nb">split</span>; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk90"><span class="kn">Definition</span> <span class="nf">word_rec</span> (<span class="nv">G</span> : Group) (<span class="nv">s</span> : A -&gt; G) : A + A -&gt; G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A + A -&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk91"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A + A -&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk92"><span class="nb">intros</span> [x|x].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk93" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk93"><hr></label><div class="goal-conclusion">G</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk94">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (s x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk95">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (s x)^.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** When we have a list of words we can recursively define a group element. The obvious choice would be to map [nil] to the identity and [x :: xs] to [x * words_rec xs]. This has the disadvantage that a single generating element gets mapped to [x * 1] instead of [x]. To fix this issue, we map [nil] to the identity, the singleton to the element we want, and do the rest recursively. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk96"><span class="kn">Definition</span> <span class="nf">words_rec</span> (<span class="nv">G</span> : Group) (<span class="nv">s</span> : A -&gt; G) : Words -&gt; G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words -&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk97"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words -&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk98"><span class="nb">intro</span> xs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk99"><span class="nb">induction</span> xs <span class="kr">as</span> [|x [|y xs] IHxs].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk9a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk9a"><hr></label><div class="goal-conclusion">G</div></blockquote><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk9b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk9b"><hr></label><div class="goal-conclusion">G</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk9c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> mon_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk9d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (word_rec G s x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk9e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span>G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (word_rec G s x * IHxs).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk9f"><span class="kn">Definition</span> <span class="nf">words_rec_cons</span> (<span class="nv">G</span> : Group) (<span class="nv">s</span> : A -&gt; G) (<span class="nv">x</span> : A + A) (<span class="nv">xs</span> : Words)
    : words_rec G s (x :: xs)%list = word_rec G s x * words_rec G s xs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (x :: xs) =
word_rec G s x * words_rec G s xs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chka0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (x :: xs) =
word_rec G s x * words_rec G s xs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chka1"><span class="nb">induction</span> xs <span class="kr">in</span> x |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s [x] = word_rec G s x * words_rec G s nil</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chka2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A + A,
words_rec G s (x :: xs) =
word_rec G s x * words_rec G s xs</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chka2"><hr></label><div class="goal-conclusion">words_rec G s (x :: a :: xs) =
word_rec G s x * words_rec G s (a :: xs)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chka3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s [x] = word_rec G s x * words_rec G s nil</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">symmetry</span>; napply grp_unit_r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chka4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x, a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A + A,
words_rec G s (x :: xs) =
word_rec G s x * words_rec G s xs</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (x :: a :: xs) =
word_rec G s x * words_rec G s (a :: xs)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chka5"><span class="kn">Lemma</span> <span class="nf">words_rec_pp</span> (<span class="nv">G</span> : Group) (<span class="nv">s</span> : A -&gt; G)  (<span class="nv">x</span> <span class="nv">y</span> : Words)
    : words_rec G s (x ++ y) = words_rec G s x * words_rec G s y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (x ++ y) =
words_rec G s x * words_rec G s y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chka6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (x ++ y) =
words_rec G s x * words_rec G s y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chka7"><span class="nb">induction</span> x <span class="kr">as</span> [|x xs IHxs] <span class="kr">in</span> y |- *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (nil ++ y) =
words_rec G s nil * words_rec G s y</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chka8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chka8"><hr></label><div class="goal-conclusion">words_rec G s ((x :: xs) ++ y) =
words_rec G s (x :: xs) * words_rec G s y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chka9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (nil ++ y) =
words_rec G s nil * words_rec G s y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">symmetry</span>; napply grp_unit_l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkaa">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s ((x :: xs) ++ y) =
words_rec G s (x :: xs) * words_rec G s y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkab"><span class="nb">change</span> ((<span class="nl">?x</span> :: <span class="nl">?xs</span>) ++ y) <span class="kr">with</span> (x :: xs ++ y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (x :: xs ++ y) =
words_rec G s (x :: xs) * words_rec G s y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkac">lhs napply words_rec_cons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_rec G s x * words_rec G s (xs ++ y) =
words_rec G s (x :: xs) * words_rec G s y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkad">lhs napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (xs ++ y) = <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkae" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkae"><hr></label><div class="goal-conclusion">word_rec G s x * <span class="nl">?Goal</span> =
words_rec G s (x :: xs) * words_rec G s y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkaf"><span class="mi">1</span>: napply IHxs.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_rec G s x * (words_rec G s xs * words_rec G s y) =
words_rec G s (x :: xs) * words_rec G s y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb0">lhs napply grp_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_rec G s x * words_rec G s xs * words_rec G s y =
words_rec G s (x :: xs) * words_rec G s y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb1">napply (ap (.* _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">word_rec G s x * words_rec G s xs =
words_rec G s (x :: xs)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb2"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>xs</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>IHxs</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> : Words,
words_rec G s (xs ++ y) =
words_rec G s xs * words_rec G s y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (x :: xs) =
word_rec G s x * words_rec G s xs</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> words_rec_cons.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb3"><span class="kn">Lemma</span> <span class="nf">words_rec_coh</span> (<span class="nv">G</span> : Group) (<span class="nv">s</span> : A -&gt; G) (<span class="nv">a</span> : A + A) (<span class="nv">b</span> <span class="nv">c</span> : Words)
    : words_rec G s (map1 (b, a, c)) = words_rec G s (map2 (b, a, c)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (map1 (b, a, c)) =
words_rec G s (map2 (b, a, c))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (map1 (b, a, c)) =
words_rec G s (map2 (b, a, c))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb5"><span class="nb">unfold</span> map1, map2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (b ++ [a] ++ [a ^&#39;] ++ c) =
words_rec G s (b ++ c)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb6">rhs napply (words_rec_pp G s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (b ++ [a] ++ [a ^&#39;] ++ c) =
words_rec G s b * words_rec G s c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb7">lhs napply words_rec_pp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s b * words_rec G s ([a] ++ [a ^&#39;] ++ c) =
words_rec G s b * words_rec G s c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb8">napply (ap (_ *.)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s ([a] ++ [a ^&#39;] ++ c) = words_rec G s c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkb9">lhs napply words_rec_pp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s [a] * words_rec G s ([a ^&#39;] ++ c) =
words_rec G s c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkba">lhs napply ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s ([a ^&#39;] ++ c) = <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkbb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkbb"><hr></label><div class="goal-conclusion">words_rec G s [a] * <span class="nl">?Goal</span> = words_rec G s c</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkbc"><span class="mi">1</span>: napply words_rec_pp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s [a] *
(words_rec G s [a ^&#39;] * words_rec G s c) =
words_rec G s c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkbd">lhs napply grp_assoc.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s [a] * words_rec G s [a ^&#39;] *
words_rec G s c = words_rec G s c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkbe">rhs_V napply grp_unit_l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s [a] * words_rec G s [a ^&#39;] *
words_rec G s c = <span class="mi">1</span> * words_rec G s c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkbf">napply (ap (.* _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s [a] * words_rec G s [a ^&#39;] = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkc0"><span class="nb">destruct</span> a; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s a * (s a)^ = <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkc1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkc1"><hr></label><div class="goal-conclusion">(s a)^ * s a = <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkc2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">s a * (s a)^ = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">napply grp_inv_r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkc3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b, c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(s a)^ * s a = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">napply grp_inv_l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Given a group [G] we can construct a group homomorphism [FreeGroup A $-&gt; G] if we have a map [A -&gt; G]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkc4"><span class="kn">Definition</span> <span class="nf">FreeGroup_rec</span> {<span class="nv">G</span> : Group} (<span class="nv">s</span> : A -&gt; G) : FreeGroup $-&gt; G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup $-&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkc5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup $-&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkc6">snapply Build_GroupHomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup -&gt; G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkc7"><hr></label><div class="goal-conclusion">IsSemiGroupPreserving <span class="nl">?grp_homo_map</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkc8">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup -&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkc9">rapply Trunc_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Coeq map1 map2 -&gt; G</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkca">srapply Coeq_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Words -&gt; G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkcb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkcb"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Words * (A + A) * Words,
<span class="nl">?coeq&#39;</span> (map1 b) = <span class="nl">?coeq&#39;</span> (map2 b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkcc"><span class="mi">1</span>: <span class="nb">apply</span> words_rec, s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Words * (A + A) * Words,
words_rec G s (map1 b) = words_rec G s (map2 b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkcd"><span class="nb">intros</span> [[b a] c].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (map1 (b, a, c)) =
words_rec G s (map2 (b, a, c))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> words_rec_coh.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkce">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSemiGroupPreserving
  (Trunc_rec
     (Coeq_rec G (words_rec G s)
        (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
         (<span class="kr">fun</span> <span class="nv">fst</span> : Words * (A + A) =&gt;
          (<span class="kr">fun</span> (<span class="nv">b</span> : Words) (<span class="nv">a</span> : A + A) (<span class="nv">c</span> : Words) =&gt;
           words_rec_coh G s a b c) (Overture.fst fst)
            (snd fst)) (fst b0) (snd b0))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkcf"><span class="nb">intros</span> x y; strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>y, x</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc_rec
  (Coeq_rec G (words_rec G s)
     (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
      words_rec_coh G s (snd (fst b0)) (fst (fst b0))
        (snd b0))) (tr x * tr y) =
Trunc_rec
  (Coeq_rec G (words_rec G s)
     (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
      words_rec_coh G s (snd (fst b0)) (fst (fst b0))
        (snd b0))) (tr x) *
Trunc_rec
  (Coeq_rec G (words_rec G s)
     (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
      words_rec_coh G s (snd (fst b0)) (fst (fst b0))
        (snd b0))) (tr y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd0"><span class="nb">revert</span> x; srapply Coeq_ind_hprop; <span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Coeq map1 map2</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt;
 Trunc_rec
   (Coeq_rec G (words_rec G s)
      (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
       words_rec_coh G s (snd (fst b0)) (fst (fst b0))
         (snd b0))) (tr x * tr y) =
 Trunc_rec
   (Coeq_rec G (words_rec G s)
      (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
       words_rec_coh G s (snd (fst b0)) (fst (fst b0))
         (snd b0))) (tr x) *
 Trunc_rec
   (Coeq_rec G (words_rec G s)
      (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
       words_rec_coh G s (snd (fst b0)) (fst (fst b0))
         (snd b0))) (tr y)) (coeq x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd1"><span class="nb">revert</span> y; srapply Coeq_ind_hprop; <span class="nb">intro</span> y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x0</span> : Coeq map1 map2 =&gt;
 (<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt;
  Trunc_rec
    (Coeq_rec G (words_rec G s)
       (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
        words_rec_coh G s (snd (fst b0))
          (fst (fst b0)) (snd b0))) (tr x * tr x0) =
  Trunc_rec
    (Coeq_rec G (words_rec G s)
       (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
        words_rec_coh G s (snd (fst b0))
          (fst (fst b0)) (snd b0))) (tr x) *
  Trunc_rec
    (Coeq_rec G (words_rec G s)
       (<span class="kr">fun</span> <span class="nv">b0</span> : Words * (A + A) * Words =&gt;
        words_rec_coh G s (snd (fst b0))
          (fst (fst b0)) (snd b0))) (tr x0)) (coeq x))
  (coeq y)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd2"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">words_rec G s (x ++ y) =
words_rec G s x * words_rec G s y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> words_rec_pp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">freegroup_in</span> : A -&gt; FreeGroup
    := freegroup_eta o (<span class="kr">fun</span> <span class="nv">x</span> =&gt; [ x ]) o inl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">FreeGroup_rec_beta</span> {<span class="nv">G</span> : Group} (<span class="nv">f</span> : A -&gt; G)
    : FreeGroup_rec f o freegroup_in == f
    := <span class="kr">fun</span> <span class="nv">_</span> =&gt; idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">freegroup_in</span> : A &gt;-&gt; group_type.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd3"><span class="kn">Definition</span> <span class="nf">FreeGroup_ind_hprop&#39;</span> (<span class="nv">P</span> : FreeGroup -&gt; <span class="kt">Type</span>)
    `{<span class="kr">forall</span> <span class="nv">x</span>, IsHProp (P x)}
    (H1 : <span class="kr">forall</span> <span class="nv">w</span>, P (freegroup_eta w))
    : <span class="kr">forall</span> <span class="nv">x</span>, P x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">w</span> : Words, P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">w</span> : Words, P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd5">rapply Trunc_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">w</span> : Words, P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Coeq map1 map2, P (tr a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd6">srapply Coeq_ind_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">w</span> : Words, P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Words,
(<span class="kr">fun</span> <span class="nv">x</span> : Coeq map1 map2 =&gt; P (tr x)) (coeq a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> H1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd7"><span class="kn">Definition</span> <span class="nf">FreeGroup_ind_hprop</span> (<span class="nv">P</span> : FreeGroup -&gt; <span class="kt">Type</span>)
    `{<span class="kr">forall</span> <span class="nv">x</span>, IsHProp (P x)}
    (H1 : P mon_unit)
    (Hin : <span class="kr">forall</span> <span class="nv">x</span>, P (freegroup_in x))
    (Hop : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, P x -&gt; P y -&gt; P (x^ * y))
    : <span class="kr">forall</span> <span class="nv">x</span>, P x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkd9">rapply FreeGroup_ind_hprop&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">w</span> : Words, P (freegroup_eta w)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkda"><span class="nb">intros</span> w.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>Words</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (freegroup_eta w)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkdb"><span class="nb">induction</span> w <span class="kr">as</span> [|a w IHw].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (freegroup_eta nil)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkdc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkdc"><hr></label><div class="goal-conclusion">P (freegroup_eta (a :: w))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkdd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (freegroup_eta nil)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> H1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkde">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>(A + A)%type</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (freegroup_eta (a :: w))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkdf"><span class="nb">destruct</span> a <span class="kr">as</span> [a|a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (freegroup_eta (inl a :: w))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chke0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chke0"><hr></label><div class="goal-conclusion">P (freegroup_eta (inr a :: w))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chke1">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (freegroup_eta (inl a :: w))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chke2"><span class="nb">change</span> (P ((freegroup_in a) * freegroup_eta w)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (a * freegroup_eta w)</div></blockquote></div></div></small><span class="alectryon-wsp">  
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chke3"><span class="nb">rewrite</span> &lt;- (grp_inv_inv a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P ((a^)^ * freegroup_eta w)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chke4"><span class="nb">apply</span> Hop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a^</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chke5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chke5"><hr></label><div class="goal-conclusion">P (freegroup_eta w)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chke6">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a^</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chke7"><span class="nb">rewrite</span> &lt;- grp_unit_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (a^ * <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">          </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Hop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chke8">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (freegroup_eta w)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chke9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (freegroup_eta (inr a :: w))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkea"><span class="nb">change</span> (P ((freegroup_in a)^ * freegroup_eta w)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>FreeGroup -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : FreeGroup, IsHProp (P x)</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>P <span class="mi">1</span></span></span></span><br><span><var>Hin</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P x</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup, P x -&gt; P y -&gt; P (x^ * y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>list (A + A)</span></span></span><br><span><var>IHw</var><span class="hyp-type"><b>: </b><span>P (freegroup_eta w)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (a^ * freegroup_eta w)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> Hop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkeb"><span class="kn">Definition</span> <span class="nf">FreeGroup_ind_homotopy</span> {<span class="nv">G</span> : Group} {<span class="nv">f</span> <span class="nv">f&#39;</span> : FreeGroup $-&gt; G}
    (<span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">x</span>, f (freegroup_in x) = f&#39; (freegroup_in x))
    : f $== f&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f $== f&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkec"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f $== f&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chked">rapply FreeGroup_ind_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f <span class="mi">1</span> = f&#39; <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkee" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkee"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</div></blockquote><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkef" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkef"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup,
f x = f&#39; x -&gt; f y = f&#39; y -&gt; f (x^ * y) = f&#39; (x^ * y)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f <span class="mi">1</span> = f&#39; <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (concat (grp_homo_unit f) (grp_homo_unit f&#39;)^).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : FreeGroup,
f x = f&#39; x -&gt; f y = f&#39; y -&gt; f (x^ * y) = f&#39; (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf3"><span class="nb">intros</span> x y p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>FreeGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = f&#39; x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = f&#39; y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (x^ * y) = f&#39; (x^ * y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf4"><span class="nb">refine</span> (grp_homo_op_agree f f&#39; _ q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>FreeGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = f&#39; x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = f&#39; y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x^ = f&#39; x^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf5">lhs napply grp_homo_inv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>FreeGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = f&#39; x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = f&#39; y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f x)^ = f&#39; x^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf6">rhs napply grp_homo_inv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, f x = f&#39; x</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>FreeGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = f&#39; x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = f&#39; y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f x)^ = (f&#39; x)^</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap _ p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Now we need to prove that the free group satisfies the universal property of the free group. *)</span>
  <span class="sd">(** TODO: remove funext from here and universal property of free group *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf7">#[export] <span class="kn">Instance</span> <span class="nf">isfreegroupon_freegroup</span> `{Funext}
    : IsFreeGroupOn A FreeGroup freegroup_in.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsFreeGroupOn A FreeGroup freegroup_in</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsFreeGroupOn A FreeGroup freegroup_in</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkf9"><span class="nb">intros</span> G f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr
  (FactorsThroughFreeGroup A FreeGroup freegroup_in G
     f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkfa">snapply Build_Contr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FactorsThroughFreeGroup A FreeGroup freegroup_in G f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkfb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkfb"><hr></label><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">y</span> : FactorsThroughFreeGroup A FreeGroup freegroup_in G
      f, <span class="nl">?center</span> = y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkfc">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FactorsThroughFreeGroup A FreeGroup freegroup_in G f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkfd">srefine (_;_); <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupHomomorphism FreeGroup G</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chkfe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chkfe"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; <span class="nl">?Goal</span> x) == f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chkff"><span class="mi">1</span>: <span class="nb">apply</span> FreeGroup_rec, f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; FreeGroup_rec f x) == f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span> x; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk100">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">y</span> : FactorsThroughFreeGroup A FreeGroup freegroup_in G
      f,
(FreeGroup_rec f : FreeGroup $-&gt; G;
((<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; <span class="mi">1</span>%path)
 :
 (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; FreeGroup_rec f x) == f)
:
(<span class="kr">fun</span> <span class="nv">f0</span> : FreeGroup $-&gt; G =&gt; f0 o freegroup_in == f)
  (FreeGroup_rec f : FreeGroup $-&gt; G)) = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk101"><span class="nb">intros</span> [g h].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g x) == f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(FreeGroup_rec f; <span class="kr">fun</span> <span class="nv">x</span> : A =&gt; <span class="mi">1</span>%path) = (g; h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk102">napply path_sigma_hprop; [ <span class="bp">exact</span> _ |].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g x) == f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(FreeGroup_rec f; <span class="kr">fun</span> <span class="nv">x</span> : A =&gt; <span class="mi">1</span>%path).<span class="mi">1</span> = (g; h).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk103"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g x) == f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup_rec f = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk104"><span class="nb">apply</span> equiv_path_grouphomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g x) == f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup_rec f == g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk105"><span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g x) == f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">g == FreeGroup_rec f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk106">snapply FreeGroup_ind_homotopy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>FreeGroup $-&gt; G</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g x) == f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : A, g x = FreeGroup_rec f x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Typeclass search can already find this but we leave it here as a definition for reference. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">isfreegroup_freegroup</span> `{Funext} : IsFreeGroup FreeGroup := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Reduction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> FreeGroup_rec {A G}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> FreeGroup_ind_homotopy {A G f f&#39;}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> freegroup_eta {A}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> freegroup_in {A}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Properties of free groups *)</span>

<span class="c">(* Given a function on the generators, there is an induced group homomorphism from the free group. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">isfreegroupon_rec</span> {<span class="nv">S</span> : <span class="kt">Type</span>} {<span class="nv">F_S</span> : Group}
  {<span class="nv">i</span> : S -&gt; F_S} `{IsFreeGroupOn S F_S i}
  {G : Group} (f : S -&gt; G) : F_S $-&gt; G
  := (center (FactorsThroughFreeGroup S F_S i G f)).<span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* The propositional computation rule for the recursor. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">isfreegroupon_rec_beta</span>
  {<span class="nv">S</span> : <span class="kt">Type</span>} {<span class="nv">F_S</span> : Group} {<span class="nv">i</span> : S -&gt; F_S} `{IsFreeGroupOn S F_S i}
  {G : Group} (f : S -&gt; G)
  : isfreegroupon_rec f o i == f
  := (center (FactorsThroughFreeGroup S F_S i G f)).<span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Two homomorphisms from a free group are equal if they agree on the generators. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk107"><span class="kn">Definition</span> <span class="nf">path_homomorphism_from_free_group</span> {<span class="nv">S</span> : <span class="kt">Type</span>}
  {<span class="nv">F_S</span> : Group} {<span class="nv">i</span> : S -&gt; F_S} `{IsFreeGroupOn S F_S i}
  {G : Group} (f g : F_S $-&gt; G) (K : f o i == g o i)
  : f = g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>F_S $-&gt; G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>f o i == g o i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk108"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>F_S $-&gt; G</span></span></span><br><span><var>K</var><span class="hyp-type"><b>: </b><span>f o i == g o i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* By assumption, the type [FactorsThroughFreeGroup S F_S i G (g o i)] of factorizations of [g o i] through [i] is contractible.  Therefore the two elements we have are equal.  Therefore, their first components are equal. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (path_contr (f; K) (g; <span class="kr">fun</span> <span class="nv">x</span> =&gt; idpath))..<span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk109"><span class="kn">Instance</span> <span class="nf">isequiv_isfreegroupon_rec</span> `{Funext} {S : <span class="kt">Type</span>}
  {F_S : Group} {i : S -&gt; F_S} `{IsFreeGroupOn S F_S i} {G : Group}
  : IsEquiv (@isfreegroupon_rec S F_S i _ G).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv isfreegroupon_rec</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk10a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv isfreegroupon_rec</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk10b"><span class="nb">apply</span> (isequiv_adjointify isfreegroupon_rec (<span class="kr">fun</span> <span class="nv">f</span> =&gt; f o i)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : F_S $-&gt; G =&gt;
 isfreegroupon_rec (<span class="kr">fun</span> <span class="nv">x0</span> : S =&gt; x (i x0))) == idmap</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk10c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk10c"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> (<span class="nv">x</span> : S -&gt; G) (<span class="nv">x0</span> : S) =&gt;
 isfreegroupon_rec x (i x0)) == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk10d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : F_S $-&gt; G =&gt;
 isfreegroupon_rec (<span class="kr">fun</span> <span class="nv">x0</span> : S =&gt; x (i x0))) == idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk10e"><span class="nb">intro</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>F_S $-&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isfreegroupon_rec (<span class="kr">fun</span> <span class="nv">x</span> : S =&gt; f (i x)) = f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk10f"><span class="nb">apply</span> path_homomorphism_from_free_group.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>F_S $-&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : S =&gt;
 isfreegroupon_rec (<span class="kr">fun</span> <span class="nv">x0</span> : S =&gt; f (i x0)) (i x)) ==
(<span class="kr">fun</span> <span class="nv">x</span> : S =&gt; f (i x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> isfreegroupon_rec_beta.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk110">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> (<span class="nv">x</span> : S -&gt; G) (<span class="nv">x0</span> : S) =&gt;
 isfreegroupon_rec x (i x0)) == idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk111"><span class="nb">intro</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>S -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : S =&gt; isfreegroupon_rec f (i x)) = f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* here we need [Funext]: *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_arrow, isfreegroupon_rec_beta.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The universal property of a free group. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_isfreegroupon_rec</span> `{Funext} {G F : Group} {A : <span class="kt">Type</span>}
  {i : A -&gt; F} `{IsFreeGroupOn A F i}
  : (A -&gt; G) &lt;~&gt; (F $-&gt; G) := Build_Equiv _ _ isfreegroupon_rec _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The above theorem is true regardless of the implementation of free groups. This lets us state the more specific theorem about the canonical free groups. This can be read as [FreeGroup] is left adjoint to the forgetful functor [group_type]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_freegroup_rec</span> `{Funext} (G : Group) (A : <span class="kt">Type</span>)
  : (A -&gt; G) &lt;~&gt; (FreeGroup A $-&gt; G)
  := equiv_isfreegroupon_rec.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk112"><span class="kn">Instance</span> <span class="nf">ishprop_isfreegroupon</span> `{Funext} (F : Group) (A : <span class="kt">Type</span>) (i : A -&gt; F)
  : IsHProp (IsFreeGroupOn A F i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsFreeGroupOn A F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk113"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsFreeGroupOn A F i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk114"><span class="nb">unfold</span> IsFreeGroupOn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp
  (<span class="kr">forall</span> (<span class="nv">A0</span> : Group) (<span class="nv">g</span> : A -&gt; A0),
   Contr (FactorsThroughFreeGroup A F i A0 g))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> istrunc_forall.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Both ways of stating the universal property are equivalent. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk115"><span class="kn">Definition</span> <span class="nf">equiv_isfreegroupon_isequiv_precomp</span> `{Funext}
  (F : Group) (A : <span class="kt">Type</span>) (i : A -&gt; F)
  : IsFreeGroupOn A F i &lt;~&gt; <span class="kr">forall</span> <span class="nv">G</span>, IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsFreeGroupOn A F i &lt;~&gt;
(<span class="kr">forall</span> <span class="nv">G</span> : Group, IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk116"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsFreeGroupOn A F i &lt;~&gt;
(<span class="kr">forall</span> <span class="nv">G</span> : Group, IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk117">srapply equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsFreeGroupOn A F i -&gt;
<span class="kr">forall</span> <span class="nv">G</span> : Group, IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk118" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk118"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">G</span> : Group, IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)) -&gt;
IsFreeGroupOn A F i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk119"><span class="mi">1</span>: <span class="nb">intros</span> ? ?; <span class="bp">exact</span> (equiv_isequiv (equiv_isfreegroupon_rec)^-<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">G</span> : Group, IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)) -&gt;
IsFreeGroupOn A F i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk11a"><span class="nb">intros</span> k G g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">G</span> : Group,
IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (FactorsThroughFreeGroup A F i G g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk11b"><span class="nb">specialize</span> (k G).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (FactorsThroughFreeGroup A F i G g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk11c">snapply contr_equiv&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">Type</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk11d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk11d"><hr></label><div class="goal-conclusion"><span class="nl">?A</span> &lt;~&gt; FactorsThroughFreeGroup A F i G g</div></blockquote><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk11e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk11e"><hr></label><div class="goal-conclusion">Contr <span class="nl">?A</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk11f"><span class="mi">1</span>: <span class="bp">exact</span> (hfiber (<span class="kr">fun</span> <span class="nv">f</span> <span class="nv">x</span> =&gt; grp_homo_map f (i x)) g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber
  (<span class="kr">fun</span> (<span class="nv">f</span> : GroupHomomorphism F G) (<span class="nv">x</span> : A) =&gt; f (i x))
  g &lt;~&gt; FactorsThroughFreeGroup A F i G g</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk120" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk120"><hr></label><div class="goal-conclusion">Contr
  (hfiber
     (<span class="kr">fun</span> (<span class="nv">f</span> : GroupHomomorphism F G) (<span class="nv">x</span> : A) =&gt;
      f (i x)) g)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk121">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber
  (<span class="kr">fun</span> (<span class="nv">f</span> : GroupHomomorphism F G) (<span class="nv">x</span> : A) =&gt; f (i x))
  g &lt;~&gt; FactorsThroughFreeGroup A F i G g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk122">rapply equiv_functor_sigma_id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : GroupHomomorphism F G,
(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; a (i x)) = g &lt;~&gt;
(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; a (i x)) == g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk123"><span class="nb">intro</span> y; <span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>GroupHomomorphism F G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; y (i x)) == g &lt;~&gt;
(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; y (i x)) = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> equiv_path_forall.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk124">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>F</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; F</span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>IsEquiv (<span class="kr">fun</span> <span class="nv">f</span> : F $-&gt; G =&gt; f o i)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr
  (hfiber
     (<span class="kr">fun</span> (<span class="nv">f</span> : GroupHomomorphism F G) (<span class="nv">x</span> : A) =&gt;
      f (i x)) g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Subgroups of free groups *)</span>

<span class="c">(* We say that a group [G] is generated by a subtype [X] if the natural map from the subgroup generated by [X] to [G] is a surjection.  One could equivalently say [IsEquiv (subgroup_incl (subgroup_generated X))], [forall g, subgroup_generated X g], or [subgroup_generated X = maximal_subgroup], but the definition using surjectivity is convenient later. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">isgeneratedby</span> (<span class="nv">G</span> : Group) (<span class="nv">X</span> : G -&gt; <span class="kt">Type</span>)
  := IsSurjection (subgroup_incl (subgroup_generated X)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">FreeGroupGenerated</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* In this Section, we prove that the free group [F_S] on a type [S] is generated in the above sense by the image of [S].  We conclude that the inclusion map is an equivalence, and that the free group is isomorphic as a group to the subgroup. We show that the inclusion is a surjection by showing that it is split epi in the category of groups. *)</span>

</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">S</span> : <span class="kt">Type</span>} {<span class="nv">F_S</span> : Group} {<span class="nv">i</span> : S -&gt; F_S} `{IsFreeGroupOn S F_S i}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* We define a group homomorphism from [F_S] to the subgroup [G] generated by [S] by sending a generator [s] to &quot;itself&quot;.  This map will be a section of the inclusion map. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk125"><span class="kn">Local Definition</span> <span class="nf">to_subgroup_generated</span>
    : F_S $-&gt; subgroup_generated (hfiber i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F_S $-&gt; subgroup_generated (hfiber i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk126"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F_S $-&gt; subgroup_generated (hfiber i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk127"><span class="nb">apply</span> isfreegroupon_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">S -&gt; subgroup_generated (hfiber i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk128"><span class="nb">intro</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_generated (hfiber i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk129">snapply subgroup_generated_gen_incl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F_S</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk12a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>S</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk12a"><hr></label><div class="goal-conclusion">hfiber i <span class="nl">?g</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk12b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F_S</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (i s).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk12c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber i (i s)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (s; idpath).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* We record the computation rule that [to_subgroup_generated] satisfies. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Definition</span> <span class="nf">to_subgroup_generated_beta</span> (<span class="nv">s</span> : S)
    : to_subgroup_generated (i s) = subgroup_generated_gen_incl (i s) (s; idpath)
    := isfreegroupon_rec_beta _ _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* It follows that [to_subgroup_generated] is a section of the inclusion map from [G] to [F_S]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk12d"><span class="kn">Local Definition</span> <span class="nf">is_retraction</span>
    : (subgroup_incl _) $o to_subgroup_generated = grp_homo_id.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_incl (subgroup_generated (hfiber i)) $o
to_subgroup_generated = grp_homo_id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk12e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">subgroup_incl (subgroup_generated (hfiber i)) $o
to_subgroup_generated = grp_homo_id</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk12f"><span class="nb">apply</span> path_homomorphism_from_free_group; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : S =&gt; (to_subgroup_generated (i x)).<span class="mi">1</span>) ==
(<span class="kr">fun</span> <span class="nv">x</span> : S =&gt; i x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk130"><span class="nb">intro</span> s.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>S</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(to_subgroup_generated (i s)).<span class="mi">1</span> = i s</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap pr1 (to_subgroup_generated_beta s)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* It follows that the inclusion map is a surjection, i.e., that [F_S] is generated by the image of [S]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk131"><span class="kn">Definition</span> <span class="nf">isgenerated_isfreegroupon</span>
    : isgeneratedby F_S (hfiber i).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isgeneratedby F_S (hfiber i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk132"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isgeneratedby F_S (hfiber i)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk133">snapply issurj_retr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F_S -&gt; subgroup_generated (hfiber i)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk134" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk134"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">y</span> : F_S,
subgroup_incl (subgroup_generated (hfiber i)) (<span class="nl">?s</span> y) =
y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk135">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F_S -&gt; subgroup_generated (hfiber i)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> to_subgroup_generated.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk136">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">y</span> : F_S,
subgroup_incl (subgroup_generated (hfiber i))
  (to_subgroup_generated y) = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk137"><span class="nb">apply</span> ap10; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : F_S =&gt; (to_subgroup_generated x).<span class="mi">1</span>) = idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap grp_homo_map is_retraction).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* Therefore, the inclusion map is an equivalence, since it is known to be an embedding. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk138"><span class="kn">Definition</span> <span class="nf">isequiv_subgroup_incl_freegroupon</span>
    : IsEquiv (subgroup_incl (subgroup_generated (hfiber i))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  (subgroup_incl (subgroup_generated (hfiber i)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk139"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  (subgroup_incl (subgroup_generated (hfiber i)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk13a"><span class="nb">apply</span> isequiv_surj_emb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ReflectiveSubuniverse.IsConnMap (Tr (-<span class="mi">1</span>))
  (subgroup_incl (subgroup_generated (hfiber i)))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="freegroup-v-chk13b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><label class="goal-separator" for="freegroup-v-chk13b"><hr></label><div class="goal-conclusion">IsEmbedding
  (subgroup_incl (subgroup_generated (hfiber i)))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk13c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ReflectiveSubuniverse.IsConnMap (Tr (-<span class="mi">1</span>))
  (subgroup_incl (subgroup_generated (hfiber i)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> isgenerated_isfreegroupon.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk13d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEmbedding
  (subgroup_incl (subgroup_generated (hfiber i)))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* Therefore, the subgroup is isomorphic to the free group. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk13e"><span class="kn">Definition</span> <span class="nf">iso_subgroup_incl_freegroupon</span>
    : GroupIsomorphism (subgroup_generated (hfiber i)) F_S.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupIsomorphism (subgroup_generated (hfiber i)) F_S</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk13f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupIsomorphism (subgroup_generated (hfiber i)) F_S</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk140">napply Build_GroupIsomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>S</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>F_S</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>S -&gt; F_S</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsFreeGroupOn S F_S i</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv <span class="nl">?Goal</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> isequiv_subgroup_incl_freegroupon.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">FreeGroupGenerated</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Properties of recursor *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk141"><span class="kn">Definition</span> <span class="nf">freegroup_rec_in</span> {<span class="nv">A</span> : <span class="kt">Type</span>}
  : FreeGroup_rec freegroup_in $== Id (FreeGroup A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup_rec freegroup_in $== Id (FreeGroup A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk142"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup_rec freegroup_in $== Id (FreeGroup A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> snapply FreeGroup_ind_homotopy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk143"><span class="kn">Definition</span> <span class="nf">freegroup_rec_compose</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">G</span> <span class="nv">H</span> : Group}
  (<span class="nv">f</span> : A -&gt; G) (<span class="nv">k</span> : G $-&gt; H)
  : FreeGroup_rec (k o f) $== k $o FreeGroup_rec f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup_rec (k o f) $== k $o FreeGroup_rec f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk144"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G, H</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; G</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>G $-&gt; H</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup_rec (k o f) $== k $o FreeGroup_rec f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> snapply FreeGroup_ind_homotopy; <span class="nb">intros</span> x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk145"><span class="kn">Definition</span> <span class="nf">freegroup_const</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">G</span> : Group}
  : FreeGroup_rec (<span class="kr">fun</span> <span class="nv">_</span> : A =&gt; <span class="mi">1</span>) $== @grp_homo_const _ G.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup_rec (<span class="kr">fun</span> <span class="nv">_</span> : A =&gt; <span class="mi">1</span>) $== grp_homo_const</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk146"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>G</var><span class="hyp-type"><b>: </b><span>Group</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup_rec (<span class="kr">fun</span> <span class="nv">_</span> : A =&gt; <span class="mi">1</span>) $== grp_homo_const</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> snapply FreeGroup_ind_homotopy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Functoriality *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk147"><span class="kn">Instance</span> <span class="nf">is0functor_freegroup</span> : Is0Functor FreeGroup.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is0Functor FreeGroup</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk148"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is0Functor FreeGroup</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk149">snapply Build_Is0Functor.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : <span class="kt">Type</span>,
(a $-&gt; b) -&gt; FreeGroup a $-&gt; FreeGroup b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk14a"><span class="nb">intros</span> X Y f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FreeGroup X $-&gt; FreeGroup Y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk14b">snapply FreeGroup_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; FreeGroup Y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (freegroup_in o f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk14c"><span class="kn">Instance</span> <span class="nf">is1functor_freegroup</span> : Is1Functor FreeGroup.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is1Functor FreeGroup</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk14d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is1Functor FreeGroup</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk14e">snapply Build_Is1Functor.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : <span class="kt">Type</span>) (<span class="nv">f</span> <span class="nv">g</span> : a $-&gt; b),
f $== g -&gt; fmap FreeGroup f $== fmap FreeGroup g</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : <span class="kt">Type</span>,
fmap FreeGroup (Id a) $== Id (FreeGroup a)</div></blockquote><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : a $-&gt; b) (<span class="nv">g</span> : b $-&gt; c),
fmap FreeGroup (g $o f) $==
fmap FreeGroup g $o fmap FreeGroup f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk14f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : <span class="kt">Type</span>) (<span class="nv">f</span> <span class="nv">g</span> : a $-&gt; b),
f $== g -&gt; fmap FreeGroup f $== fmap FreeGroup g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk150"><span class="nb">intros</span> X Y f g p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>X $-&gt; Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f $== g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap FreeGroup f $== fmap FreeGroup g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk151">snapply FreeGroup_ind_homotopy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>X $-&gt; Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f $== g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : X,
fmap FreeGroup f (freegroup_in x) =
fmap FreeGroup g (freegroup_in x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk152"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>X $-&gt; Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f $== g</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap FreeGroup f (freegroup_in x) =
fmap FreeGroup g (freegroup_in x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap freegroup_in (p x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk153">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : <span class="kt">Type</span>,
fmap FreeGroup (Id a) $== Id (FreeGroup a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span>; <span class="bp">exact</span> freegroup_rec_in.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk154">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : a $-&gt; b) (<span class="nv">g</span> : b $-&gt; c),
fmap FreeGroup (g $o f) $==
fmap FreeGroup g $o fmap FreeGroup f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="freegroup-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="freegroup-v-chk155"><span class="nb">intros</span> X Y Z f g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y $-&gt; Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap FreeGroup (g $o f) $==
fmap FreeGroup g $o fmap FreeGroup f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> snapply FreeGroup_ind_homotopy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span></span></pre>
</div>
</div></body>
</html>
