<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Biproduct.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk0"><span class="kn">From</span> HoTT <span class="kn">Require Import</span> Basics Types Truncations.Core.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> WildCat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> HSet.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> AbelianGroup.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Modalities.ReflectiveSubuniverse.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> mc_add_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Biproducts of abelian groups *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk1"><span class="kn">Definition</span> <span class="nf">ab_biprod</span>@{u} (A B : AbGroup@{u}) : AbGroup@{u}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">AbGroup</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">AbGroup</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk3">rapply (Build_AbGroup (grp_prod A B)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Commutative sg_op</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk4"><span class="nb">intros</span> [a b] [a&#39; b&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a, b) + (a&#39;, b&#39;) = (a&#39;, b&#39;) + (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_prod; <span class="nb">simpl</span>; <span class="nb">apply</span> commutativity.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** These inherit [IsEmbedding] instances from their [grp_prod] versions. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_biprod_inl</span> {<span class="nv">A</span> <span class="nv">B</span> : AbGroup} : A $-&gt; ab_biprod A B := grp_prod_inl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_biprod_inr</span> {<span class="nv">A</span> <span class="nv">B</span> : AbGroup} : B $-&gt; ab_biprod A B := grp_prod_inr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** These inherit [IsSurjection] instances from their [grp_prod] versions. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_biprod_pr1</span> {<span class="nv">A</span> <span class="nv">B</span> : AbGroup} : ab_biprod A B $-&gt; A := grp_prod_pr1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_biprod_pr2</span> {<span class="nv">A</span> <span class="nv">B</span> : AbGroup} : ab_biprod A B $-&gt; B := grp_prod_pr2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk5"><span class="kn">Definition</span> <span class="nf">ab_biprod_ind</span> {<span class="nv">A</span> <span class="nv">B</span> : AbGroup}
  (<span class="nv">P</span> : ab_biprod A B -&gt; <span class="kt">Type</span>)
  (<span class="nv">Hinl</span> : <span class="kr">forall</span> <span class="nv">a</span>, P (ab_biprod_inl a))
  (<span class="nv">Hinr</span> : <span class="kr">forall</span> <span class="nv">b</span>, P (ab_biprod_inr b))
  (<span class="nv">Hop</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, P x -&gt; P y -&gt; P (x + y))
  : <span class="kr">forall</span> <span class="nv">x</span>, P x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>ab_biprod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (ab_biprod_inl a)</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (ab_biprod_inr b)</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
P x -&gt; P y -&gt; P (x + y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : ab_biprod A B, P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>ab_biprod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (ab_biprod_inl a)</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (ab_biprod_inr b)</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
P x -&gt; P y -&gt; P (x + y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : ab_biprod A B, P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk7"><span class="nb">intros</span> [a b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>ab_biprod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (ab_biprod_inl a)</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (ab_biprod_inr b)</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
P x -&gt; P y -&gt; P (x + y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk8">snapply ((grp_prod_decompose a b)^ # _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>ab_biprod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (ab_biprod_inl a)</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (ab_biprod_inr b)</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
P x -&gt; P y -&gt; P (x + y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (((a, <span class="mi">0</span>) : grp_prod A B) + (<span class="mi">0</span>, b))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk9"><span class="nb">apply</span> Hop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>ab_biprod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (ab_biprod_inl a)</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (ab_biprod_inr b)</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
P x -&gt; P y -&gt; P (x + y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (a, <span class="mi">0</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chka" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>ab_biprod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (ab_biprod_inl a)</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (ab_biprod_inr b)</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
P x -&gt; P y -&gt; P (x + y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chka"><hr></label><div class="goal-conclusion">P (<span class="mi">0</span>, b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>ab_biprod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (ab_biprod_inl a)</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (ab_biprod_inr b)</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
P x -&gt; P y -&gt; P (x + y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (a, <span class="mi">0</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Hinl a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkc">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>ab_biprod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (ab_biprod_inl a)</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (ab_biprod_inr b)</span></span></span><br><span><var>Hop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
P x -&gt; P y -&gt; P (x + y)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (<span class="mi">0</span>, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Hinr b).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkd"><span class="kn">Definition</span> <span class="nf">ab_biprod_ind_homotopy</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : AbGroup}
  {<span class="nv">f</span> <span class="nv">g</span> : ab_biprod A B $-&gt; C}
  (<span class="nv">Hinl</span> : f $o ab_biprod_inl $== g $o ab_biprod_inl)
  (<span class="nv">Hinr</span> : f $o ab_biprod_inr $== g $o ab_biprod_inr)
  : f $== g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f $== g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chke"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f $== g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkf">rapply ab_biprod_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A,
f (ab_biprod_inl a) = g (ab_biprod_inl a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk10" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk10"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : B,
f (ab_biprod_inr b) = g (ab_biprod_inr b)</div></blockquote><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk11" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk11"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
f x = g x -&gt; f y = g y -&gt; f (x + y) = g (x + y)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk12">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A,
f (ab_biprod_inl a) = g (ab_biprod_inl a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> Hinl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk13">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : B,
f (ab_biprod_inr b) = g (ab_biprod_inr b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> Hinr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk14">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod A B,
f x = g x -&gt; f y = g y -&gt; f (x + y) = g (x + y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk15"><span class="nb">intros</span> x y p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>ab_biprod A B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = g x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = g y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (x + y) = g (x + y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk16">lhs napply grp_homo_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>ab_biprod A B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = g x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = g y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x + f y = g (x + y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk17">rhs napply grp_homo_op.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; C</span></span></span><br><span><var>Hinl</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inl $== g $o ab_biprod_inl</span></span></span><br><span><var>Hinr</var><span class="hyp-type"><b>: </b><span>f $o ab_biprod_inr $== g $o ab_biprod_inr</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>ab_biprod A B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = g x</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>f y = g y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f x + f y = g x + g y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">f_ap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Maps out of biproducts are determined on the two inclusions. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk18"><span class="kn">Definition</span> <span class="nf">equiv_ab_biprod_ind_homotopy</span> `{Funext} {A B X : AbGroup} (phi psi : ab_biprod A B $-&gt; X)
  : (phi $o ab_biprod_inl == psi $o ab_biprod_inl)
    * (phi $o ab_biprod_inr == psi $o ab_biprod_inr)
  &lt;~&gt; phi == psi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>phi, psi</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(phi $o ab_biprod_inl == psi $o ab_biprod_inl) *
(phi $o ab_biprod_inr == psi $o ab_biprod_inr) &lt;~&gt;
phi == psi</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk19"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>phi, psi</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(phi $o ab_biprod_inl == psi $o ab_biprod_inl) *
(phi $o ab_biprod_inr == psi $o ab_biprod_inr) &lt;~&gt;
phi == psi</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk1a"><span class="nb">apply</span> equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>phi, psi</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(phi $o ab_biprod_inl == psi $o ab_biprod_inl) *
(phi $o ab_biprod_inr == psi $o ab_biprod_inr) -&gt;
phi == psi</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk1b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>phi, psi</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; X</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk1b"><hr></label><div class="goal-conclusion">phi == psi -&gt;
(phi $o ab_biprod_inl == psi $o ab_biprod_inl) *
(phi $o ab_biprod_inr == psi $o ab_biprod_inr)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk1c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>phi, psi</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(phi $o ab_biprod_inl == psi $o ab_biprod_inl) *
(phi $o ab_biprod_inr == psi $o ab_biprod_inr) -&gt;
phi == psi</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (uncurry ab_biprod_ind_homotopy).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk1d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>phi, psi</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">phi == psi -&gt;
(phi $o ab_biprod_inl == psi $o ab_biprod_inl) *
(phi $o ab_biprod_inr == psi $o ab_biprod_inr)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">h</span> =&gt; (<span class="kr">fun</span> <span class="nv">a</span> =&gt; h _, <span class="kr">fun</span> <span class="nv">b</span> =&gt; h _)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Recursion principle *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk1e"><span class="kn">Proposition</span> <span class="nf">ab_biprod_rec</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">Y</span> : AbGroup}
            (<span class="nv">f</span> : A $-&gt; Y) (<span class="nv">g</span> : B $-&gt; Y)
  : (ab_biprod A B) $-&gt; Y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A B $-&gt; Y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk1f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A B $-&gt; Y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk20">snapply Build_GroupHomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A B -&gt; Y</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk21" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk21"><hr></label><div class="goal-conclusion">IsSemiGroupPreserving <span class="nl">?grp_homo_map</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk22">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A B -&gt; Y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> [a b]; <span class="bp">exact</span> (f a + g b).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk23">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSemiGroupPreserving
  (<span class="kr">fun</span> <span class="nv">X</span> : ab_biprod A B =&gt;
   (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) =&gt; f a + g b) (fst X) (snd X))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk24"><span class="nb">intros</span> [a b] [a&#39; b&#39;]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (a + a&#39;) + g (b + b&#39;) = f a + g b + (f a&#39; + g b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk25"><span class="nb">rewrite</span> (grp_homo_op f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a + f a&#39; + g (b + b&#39;) = f a + g b + (f a&#39; + g b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk26"><span class="nb">rewrite</span> (grp_homo_op g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a + f a&#39; + (g b + g b&#39;) = f a + g b + (f a&#39; + g b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk27"><span class="nb">rewrite</span> (associativity _ (g b) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a + f a&#39; + g b + g b&#39; = f a + g b + (f a&#39; + g b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk28"><span class="nb">rewrite</span> &lt;- (associativity _ (f a&#39;) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a + (f a&#39; + g b) + g b&#39; = f a + g b + (f a&#39; + g b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk29"><span class="nb">rewrite</span> (commutativity (f a&#39;) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a + (g b + f a&#39;) + g b&#39; = f a + g b + (f a&#39; + g b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk2a"><span class="nb">rewrite</span> (associativity _ (g b) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f a + g b + f a&#39; + g b&#39; = f a + g b + (f a&#39; + g b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (associativity _ (f a&#39;) _)^.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk2b"><span class="kn">Corollary</span> <span class="nf">ab_biprod_rec_uncurried</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">Y</span> : AbGroup}
  : (A $-&gt; Y) * (B $-&gt; Y)
    -&gt; (ab_biprod A B) $-&gt; Y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(A $-&gt; Y) * (B $-&gt; Y) -&gt; ab_biprod A B $-&gt; Y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk2c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(A $-&gt; Y) * (B $-&gt; Y) -&gt; ab_biprod A B $-&gt; Y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk2d"><span class="nb">intros</span> [f g].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A B $-&gt; Y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ab_biprod_rec f g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk2e"><span class="kn">Proposition</span> <span class="nf">ab_biprod_rec_eta</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">Y</span> : AbGroup}
            (<span class="nv">u</span> : ab_biprod A B $-&gt; Y)
  : ab_biprod_rec (u $o ab_biprod_inl) (u $o ab_biprod_inr) == u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_rec (u $o ab_biprod_inl)
  (u $o ab_biprod_inr) == u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk2f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_rec (u $o ab_biprod_inl)
  (u $o ab_biprod_inr) == u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk30"><span class="nb">intros</span> [a b]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">u (a, group_unit) + u (group_unit, b) = u (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk31"><span class="nb">refine</span> ((grp_homo_op u _ _)^ @ ap u _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a, group_unit) + (group_unit, b) = (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk32"><span class="nb">apply</span> path_prod.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst ((a, group_unit) + (group_unit, b)) = fst (a, b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk33" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk33"><hr></label><div class="goal-conclusion">snd ((a, group_unit) + (group_unit, b)) = snd (a, b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk34">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst ((a, group_unit) + (group_unit, b)) = fst (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (right_identity a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk35">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd ((a, group_unit) + (group_unit, b)) = snd (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (left_identity b).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk36"><span class="kn">Proposition</span> <span class="nf">ab_biprod_rec_beta_inl</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">Y</span> : AbGroup}
            (<span class="nv">a</span> : A $-&gt; Y) (<span class="nv">b</span> : B $-&gt; Y)
  : (ab_biprod_rec a b) $o ab_biprod_inl == a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_rec a b $o ab_biprod_inl == a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk37"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_rec a b $o ab_biprod_inl == a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk38"><span class="nb">intro</span> x; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a x + b group_unit = a x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk39"><span class="nb">rewrite</span> (grp_homo_unit b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a x + <span class="mi">0</span> = a x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (right_identity (a x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk3a"><span class="kn">Proposition</span> <span class="nf">ab_biprod_rec_beta_inr</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">Y</span> : AbGroup}
            (<span class="nv">a</span> : A $-&gt; Y) (<span class="nv">b</span> : B $-&gt; Y)
  : (ab_biprod_rec a b) $o ab_biprod_inr == b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_rec a b $o ab_biprod_inr == b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk3b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_rec a b $o ab_biprod_inr == b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk3c"><span class="nb">intro</span> y; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a group_unit + b y = b y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk3d"><span class="nb">rewrite</span> (grp_homo_unit a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> + b y = b y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (left_identity (b y)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk3e"><span class="kn">Theorem</span> <span class="nf">isequiv_ab_biprod_rec</span> `{Funext} {A B Y : AbGroup}
  : IsEquiv (@ab_biprod_rec_uncurried A B Y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv ab_biprod_rec_uncurried</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk3f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv ab_biprod_rec_uncurried</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk40">srapply isequiv_adjointify.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ab_biprod A B $-&gt; Y) -&gt; (A $-&gt; Y) * (B $-&gt; Y)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk41" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk41"><hr></label><div class="goal-conclusion">ab_biprod_rec_uncurried o <span class="nl">?g</span> == idmap</div></blockquote><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk42" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk42"><hr></label><div class="goal-conclusion"><span class="nl">?g</span> o ab_biprod_rec_uncurried == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk43">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ab_biprod A B $-&gt; Y) -&gt; (A $-&gt; Y) * (B $-&gt; Y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk44"><span class="nb">intro</span> phi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(A $-&gt; Y) * (B $-&gt; Y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (phi $o ab_biprod_inl, phi $o ab_biprod_inr).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk45">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_rec_uncurried
o (<span class="kr">fun</span> <span class="nv">phi</span> : ab_biprod A B $-&gt; Y =&gt;
   (phi $o ab_biprod_inl, phi $o ab_biprod_inr)) ==
idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk46"><span class="nb">intro</span> phi.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_rec_uncurried
  (phi $o ab_biprod_inl, phi $o ab_biprod_inr) = phi</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk47"><span class="nb">apply</span> equiv_path_grouphomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>ab_biprod A B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_rec_uncurried
  (phi $o ab_biprod_inl, phi $o ab_biprod_inr) == phi</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ab_biprod_rec_eta phi).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk48">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">phi</span> : ab_biprod A B $-&gt; Y =&gt;
 (phi $o ab_biprod_inl, phi $o ab_biprod_inr))
o ab_biprod_rec_uncurried == idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk49"><span class="nb">intros</span> [a b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ab_biprod_rec_uncurried (a, b) $o ab_biprod_inl,
ab_biprod_rec_uncurried (a, b) $o ab_biprod_inr) =
(a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk4a"><span class="nb">apply</span> path_prod.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst
  (ab_biprod_rec_uncurried (a, b) $o ab_biprod_inl,
  ab_biprod_rec_uncurried (a, b) $o ab_biprod_inr) =
fst (a, b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk4b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk4b"><hr></label><div class="goal-conclusion">snd
  (ab_biprod_rec_uncurried (a, b) $o ab_biprod_inl,
  ab_biprod_rec_uncurried (a, b) $o ab_biprod_inr) =
snd (a, b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk4c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst
  (ab_biprod_rec_uncurried (a, b) $o ab_biprod_inl,
  ab_biprod_rec_uncurried (a, b) $o ab_biprod_inr) =
fst (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk4d"><span class="nb">apply</span> equiv_path_grouphomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst
  (ab_biprod_rec_uncurried (a, b) $o ab_biprod_inl,
  ab_biprod_rec_uncurried (a, b) $o ab_biprod_inr) ==
fst (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ab_biprod_rec_beta_inl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk4e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd
  (ab_biprod_rec_uncurried (a, b) $o ab_biprod_inl,
  ab_biprod_rec_uncurried (a, b) $o ab_biprod_inr) =
snd (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk4f"><span class="nb">apply</span> equiv_path_grouphomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B, Y</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A $-&gt; Y</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B $-&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd
  (ab_biprod_rec_uncurried (a, b) $o ab_biprod_inl,
  ab_biprod_rec_uncurried (a, b) $o ab_biprod_inr) ==
snd (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ab_biprod_rec_beta_inr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Corecursion principle, inherited from Groups/Group.v. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_biprod_corec</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">X</span> : AbGroup} (<span class="nv">f</span> : X $-&gt; A) (<span class="nv">g</span> : X $-&gt; B)
  : X $-&gt; ab_biprod A B
  := grp_prod_corec f g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** *** Functoriality of [ab_biprod] *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">functor_ab_biprod</span> {<span class="nv">A</span> <span class="nv">A&#39;</span> <span class="nv">B</span> <span class="nv">B&#39;</span> : AbGroup} (<span class="nv">f</span> : A $-&gt; A&#39;) (<span class="nv">g</span>: B $-&gt; B&#39;)
  : ab_biprod A B $-&gt; ab_biprod A&#39; B&#39;
  := (ab_biprod_corec (f $o ab_biprod_pr1) (g $o ab_biprod_pr2)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_biprod_functor_beta</span> {<span class="nv">Z</span> <span class="nv">X</span> <span class="nv">Y</span> <span class="nv">A</span> <span class="nv">B</span> : AbGroup} (<span class="nv">f0</span> : Z $-&gt; X) (<span class="nv">f1</span> : Z $-&gt; Y)
           (<span class="nv">g0</span> : X $-&gt; A) (<span class="nv">g1</span> : Y $-&gt; B)
  : functor_ab_biprod g0 g1 $o ab_biprod_corec f0 f1
                      $== ab_biprod_corec (g0 $o f0) (g1 $o f1)
  := <span class="kr">fun</span> <span class="nv">_</span> =&gt; idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk50"><span class="kn">Instance</span> <span class="nf">is0bifunctor_ab_biprod</span> : Is0Bifunctor ab_biprod.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is0Bifunctor ab_biprod</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk51"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is0Bifunctor ab_biprod</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk52">srapply Build_Is0Bifunctor&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is0Functor (uncurry ab_biprod)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk53">snapply Build_Is0Functor.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span> : AbGroup * AbGroup,
(a $-&gt; b) -&gt;
uncurry ab_biprod a $-&gt; uncurry ab_biprod b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk54"><span class="nb">intros</span> [A B] [A&#39; B&#39;] [f g].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, A', B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fst (A, B) $-&gt; fst (A&#39;, B&#39;)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>snd (A, B) $-&gt; snd (A&#39;, B&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">uncurry ab_biprod (A, B) $-&gt;
uncurry ab_biprod (A&#39;, B&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (functor_ab_biprod f g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk55"><span class="kn">Instance</span> <span class="nf">is1bifunctor_ab_biprod</span> : Is1Bifunctor ab_biprod.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is1Bifunctor ab_biprod</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk56"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is1Bifunctor ab_biprod</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk57">snapply Build_Is1Bifunctor&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Is1Functor (uncurry ab_biprod)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk58">snapply Build_Is1Functor.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : AbGroup * AbGroup) (<span class="nv">f</span> <span class="nv">g</span> : a $-&gt; b),
f $== g -&gt;
fmap (uncurry ab_biprod) f $==
fmap (uncurry ab_biprod) g</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : AbGroup * AbGroup,
fmap (uncurry ab_biprod) (Id a) $==
Id (uncurry ab_biprod a)</div></blockquote><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : AbGroup * AbGroup) (<span class="nv">f</span> : a $-&gt; b)
(<span class="nv">g</span> : b $-&gt; c),
fmap (uncurry ab_biprod) (g $o f) $==
fmap (uncurry ab_biprod) g $o
fmap (uncurry ab_biprod) f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk59">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> : AbGroup * AbGroup) (<span class="nv">f</span> <span class="nv">g</span> : a $-&gt; b),
f $== g -&gt;
fmap (uncurry ab_biprod) f $==
fmap (uncurry ab_biprod) g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk5a"><span class="nb">intros</span> [A B] [A&#39; B&#39;] [f g] [f&#39; g&#39;] [p q] [a b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, A', B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fst (A, B) $-&gt; fst (A&#39;, B&#39;)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>snd (A, B) $-&gt; snd (A&#39;, B&#39;)</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>fst (A, B) $-&gt; fst (A&#39;, B&#39;)</span></span></span><br><span><var>g'</var><span class="hyp-type"><b>: </b><span>snd (A, B) $-&gt; snd (A&#39;, B&#39;)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fst (f, g) $-&gt; fst (f&#39;, g&#39;)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>snd (f, g) $-&gt; snd (f&#39;, g&#39;)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>fst (A, B)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>snd (A, B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap (uncurry ab_biprod) (f, g) (a, b) =
fmap (uncurry ab_biprod) (f&#39;, g&#39;) (a, b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk5b">snapply equiv_path_prod.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, A', B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>fst (A, B) $-&gt; fst (A&#39;, B&#39;)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>snd (A, B) $-&gt; snd (A&#39;, B&#39;)</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>fst (A, B) $-&gt; fst (A&#39;, B&#39;)</span></span></span><br><span><var>g'</var><span class="hyp-type"><b>: </b><span>snd (A, B) $-&gt; snd (A&#39;, B&#39;)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fst (f, g) $-&gt; fst (f&#39;, g&#39;)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>snd (f, g) $-&gt; snd (f&#39;, g&#39;)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>fst (A, B)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>snd (A, B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(fst (fmap (uncurry ab_biprod) (f, g) (a, b)) =
 fst (fmap (uncurry ab_biprod) (f&#39;, g&#39;) (a, b))) *
(snd (fmap (uncurry ab_biprod) (f, g) (a, b)) =
 snd (fmap (uncurry ab_biprod) (f&#39;, g&#39;) (a, b)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (p a, q b).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk5c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : AbGroup * AbGroup,
fmap (uncurry ab_biprod) (Id a) $==
Id (uncurry ab_biprod a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk5d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : AbGroup * AbGroup) (<span class="nv">f</span> : a $-&gt; b)
(<span class="nv">g</span> : b $-&gt; c),
fmap (uncurry ab_biprod) (g $o f) $==
fmap (uncurry ab_biprod) g $o
fmap (uncurry ab_biprod) f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">cbn</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk5e"><span class="kn">Definition</span> <span class="nf">isequiv_functor_ab_biprod</span> {<span class="nv">A</span> <span class="nv">A&#39;</span> <span class="nv">B</span> <span class="nv">B&#39;</span> : AbGroup}
           (<span class="nv">f</span> : A $-&gt; A&#39;) (<span class="nv">g</span> : B $-&gt; B&#39;) `{IsEquiv _ _ f} `{IsEquiv _ _ g}
  : IsEquiv (functor_ab_biprod f g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (functor_ab_biprod f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk5f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (functor_ab_biprod f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk60">srapply isequiv_adjointify.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A&#39; B&#39; -&gt; ab_biprod A B</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk61" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk61"><hr></label><div class="goal-conclusion">functor_ab_biprod f g o <span class="nl">?g</span> == idmap</div></blockquote><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk62" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk62"><hr></label><div class="goal-conclusion"><span class="nl">?g</span> o functor_ab_biprod f g == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk63"><span class="mi">1</span>: {</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A&#39; B&#39; -&gt; ab_biprod A B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk64">rapply functor_ab_biprod;
       <span class="nb">apply</span> grp_iso_inverse.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupIsomorphism A A&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk65" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk65"><hr></label><div class="goal-conclusion">GroupIsomorphism B B&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk66">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupIsomorphism A A&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Build_GroupIsomorphism _ _ f _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">       </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk67">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupIsomorphism B B&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Build_GroupIsomorphism _ _ g _).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk68">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_ab_biprod f g
o functor_ab_biprod
    (<span class="kr">let</span> <span class="nv">X</span> :=
       <span class="kr">fun</span> <span class="nv">H</span> : GroupIsomorphism A A&#39; =&gt;
       grp_iso_homo A&#39; A (grp_iso_inverse H) <span class="kr">in</span>
     X {| grp_iso_homo := f; isequiv_group_iso := H |})
    (<span class="kr">let</span> <span class="nv">X</span> :=
       <span class="kr">fun</span> <span class="nv">H</span> : GroupIsomorphism B B&#39; =&gt;
       grp_iso_homo B&#39; B (grp_iso_inverse H) <span class="kr">in</span>
     X
       {|
         grp_iso_homo := g; isequiv_group_iso := H0
       |}) == idmap</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk69" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk69"><hr></label><div class="goal-conclusion">functor_ab_biprod
  (<span class="kr">let</span> <span class="nv">X</span> :=
     <span class="kr">fun</span> <span class="nv">H</span> : GroupIsomorphism A A&#39; =&gt;
     grp_iso_homo A&#39; A (grp_iso_inverse H) <span class="kr">in</span>
   X {| grp_iso_homo := f; isequiv_group_iso := H |})
  (<span class="kr">let</span> <span class="nv">X</span> :=
     <span class="kr">fun</span> <span class="nv">H</span> : GroupIsomorphism B B&#39; =&gt;
     grp_iso_homo B&#39; B (grp_iso_inverse H) <span class="kr">in</span>
   X {| grp_iso_homo := g; isequiv_group_iso := H0 |})
o functor_ab_biprod f g == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk6a"><span class="kp">all</span>: <span class="nb">intros</span> [a b]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f (f^-<span class="mi">1</span> a), g (g^-<span class="mi">1</span> b)) = (a, b)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk6b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk6b"><hr></label><div class="goal-conclusion">(f^-<span class="mi">1</span> (f a), g^-<span class="mi">1</span> (g b)) = (a, b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk6c"><span class="kp">all</span>: <span class="nb">apply</span> path_prod&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f (f^-<span class="mi">1</span> a) = a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk6d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk6d"><hr></label><div class="goal-conclusion">g (g^-<span class="mi">1</span> b) = b</div></blockquote><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk6e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk6e"><hr></label><div class="goal-conclusion">f^-<span class="mi">1</span> (f a) = a</div></blockquote><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk6f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk6f"><hr></label><div class="goal-conclusion">g^-<span class="mi">1</span> (g b) = b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk70"><span class="mi">1</span>,<span class="mi">2</span>: <span class="nb">apply</span> eisretr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f^-<span class="mi">1</span> (f a) = a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk71" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A $-&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B $-&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv g</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk71"><hr></label><div class="goal-conclusion">g^-<span class="mi">1</span> (g b) = b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>: <span class="nb">apply</span> eissect.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_functor_ab_biprod</span> {<span class="nv">A</span> <span class="nv">A&#39;</span> <span class="nv">B</span> <span class="nv">B&#39;</span> : AbGroup}
           (<span class="nv">f</span> : A $-&gt; A&#39;) (<span class="nv">g</span> : B $-&gt; B&#39;) `{IsEquiv _ _ f} `{IsEquiv _ _ g}
  : GroupIsomorphism (ab_biprod A B) (ab_biprod A&#39; B&#39;)
  := Build_GroupIsomorphism _ _ _ (isequiv_functor_ab_biprod f g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Biproducts preserve embeddings. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk72"><span class="kn">Definition</span> <span class="nf">functor_ab_biprod_embedding</span> {<span class="nv">A</span> <span class="nv">A&#39;</span> <span class="nv">B</span> <span class="nv">B&#39;</span> : AbGroup}
           (<span class="nv">i</span> : A $-&gt; B) (<span class="nv">i&#39;</span> : A&#39; $-&gt; B&#39;)
           `{IsEmbedding i} `{IsEmbedding i&#39;}
  : IsEmbedding (functor_ab_biprod i i&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEmbedding (functor_ab_biprod i i&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk73"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEmbedding (functor_ab_biprod i i&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk74"><span class="nb">intros</span> [b b&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (hfiber (functor_ab_biprod i i&#39;) (b, b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk75"><span class="nb">apply</span> hprop_allpath.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : hfiber (functor_ab_biprod i i&#39;) (b, b&#39;),
x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk76"><span class="nb">intros</span> [[a0 a0&#39;] p] [[a1 a1&#39;] p&#39;]; <span class="nb">cbn</span> <span class="kr">in</span> p, p&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a0'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(i a0, i&#39; a0&#39;) = (b, b&#39;)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a1'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>(i a1, i&#39; a1&#39;) = (b, b&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((a0, a0&#39;); p) = ((a1, a1&#39;); p&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk77">rapply path_sigma_hprop; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a0'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(i a0, i&#39; a0&#39;) = (b, b&#39;)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a1'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>(i a1, i&#39; a1&#39;) = (b, b&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a0, a0&#39;) = (a1, a1&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk78"><span class="nb">pose</span> (q := (equiv_path_prod _ _)^-<span class="mi">1</span> p); <span class="nb">cbn</span> <span class="kr">in</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a0'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(i a0, i&#39; a0&#39;) = (b, b&#39;)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a1'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>(i a1, i&#39; a1&#39;) = (b, b&#39;)</span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>(ap fst p, ap snd p)</span></span><span class="hyp-type"><b>: </b><span>(i a0 = b) * (i&#39; a0&#39; = b&#39;)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a0, a0&#39;) = (a1, a1&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk79"><span class="nb">pose</span> (q&#39; := (equiv_path_prod _ _)^-<span class="mi">1</span> p&#39;); <span class="nb">cbn</span> <span class="kr">in</span> q&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a0'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(i a0, i&#39; a0&#39;) = (b, b&#39;)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a1'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>(i a1, i&#39; a1&#39;) = (b, b&#39;)</span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>(ap fst p, ap snd p)</span></span><span class="hyp-type"><b>: </b><span>(i a0 = b) * (i&#39; a0&#39; = b&#39;)</span></span></span></span><br><span><var>q'</var><span><span class="hyp-body"><b>:= </b><span>(ap fst p&#39;, ap snd p&#39;)</span></span><span class="hyp-type"><b>: </b><span>(i a1 = b) * (i&#39; a1&#39; = b&#39;)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a0, a0&#39;) = (a1, a1&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk7a"><span class="nb">destruct</span> q <span class="kr">as</span> [q0 q1], q&#39; <span class="kr">as</span> [q0&#39; q1&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a0'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(i a0, i&#39; a0&#39;) = (b, b&#39;)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a1'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>(i a1, i&#39; a1&#39;) = (b, b&#39;)</span></span></span><br><span><var>q0</var><span class="hyp-type"><b>: </b><span>i a0 = b</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>i&#39; a0&#39; = b&#39;</span></span></span><br><span><var>q0'</var><span class="hyp-type"><b>: </b><span>i a1 = b</span></span></span><br><span><var>q1'</var><span class="hyp-type"><b>: </b><span>i&#39; a1&#39; = b&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(a0, a0&#39;) = (a1, a1&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk7b"><span class="nb">apply</span> path_prod; rapply isinj_embedding; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a0'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(i a0, i&#39; a0&#39;) = (b, b&#39;)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a1'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>(i a1, i&#39; a1&#39;) = (b, b&#39;)</span></span></span><br><span><var>q0</var><span class="hyp-type"><b>: </b><span>i a0 = b</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>i&#39; a0&#39; = b&#39;</span></span></span><br><span><var>q0'</var><span class="hyp-type"><b>: </b><span>i a1 = b</span></span></span><br><span><var>q1'</var><span class="hyp-type"><b>: </b><span>i&#39; a1&#39; = b&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i a0 = i a1</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk7c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a0'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(i a0, i&#39; a0&#39;) = (b, b&#39;)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a1'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>(i a1, i&#39; a1&#39;) = (b, b&#39;)</span></span></span><br><span><var>q0</var><span class="hyp-type"><b>: </b><span>i a0 = b</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>i&#39; a0&#39; = b&#39;</span></span></span><br><span><var>q0'</var><span class="hyp-type"><b>: </b><span>i a1 = b</span></span></span><br><span><var>q1'</var><span class="hyp-type"><b>: </b><span>i&#39; a1&#39; = b&#39;</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk7c"><hr></label><div class="goal-conclusion">i&#39; a0&#39; = i&#39; a1&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk7d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a0'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(i a0, i&#39; a0&#39;) = (b, b&#39;)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a1'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>(i a1, i&#39; a1&#39;) = (b, b&#39;)</span></span></span><br><span><var>q0</var><span class="hyp-type"><b>: </b><span>i a0 = b</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>i&#39; a0&#39; = b&#39;</span></span></span><br><span><var>q0'</var><span class="hyp-type"><b>: </b><span>i a1 = b</span></span></span><br><span><var>q1'</var><span class="hyp-type"><b>: </b><span>i&#39; a1&#39; = b&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i a0 = i a1</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (q0 @ q0&#39;^).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk7e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>IsEmbedding0</var><span class="hyp-type"><b>: </b><span>IsEmbedding i</span></span></span><br><span><var>IsEmbedding1</var><span class="hyp-type"><b>: </b><span>IsEmbedding i&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a0'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>(i a0, i&#39; a0&#39;) = (b, b&#39;)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>a1'</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>(i a1, i&#39; a1&#39;) = (b, b&#39;)</span></span></span><br><span><var>q0</var><span class="hyp-type"><b>: </b><span>i a0 = b</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>i&#39; a0&#39; = b&#39;</span></span></span><br><span><var>q0'</var><span class="hyp-type"><b>: </b><span>i a1 = b</span></span></span><br><span><var>q1'</var><span class="hyp-type"><b>: </b><span>i&#39; a1&#39; = b&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i&#39; a0&#39; = i&#39; a1&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (q1 @ q1&#39;^).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Products preserve surjections. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk7f"><span class="kn">Definition</span> <span class="nf">functor_ab_biprod_surjection</span> `{Funext} {A A&#39; B B&#39; : AbGroup}
           (p : A $-&gt; B) (p&#39; : A&#39; $-&gt; B&#39;)
           `{S : IsSurjection p} `{S&#39; : IsSurjection p&#39;}
  : IsSurjection (functor_ab_biprod p p&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr (-<span class="mi">1</span>)) (functor_ab_biprod p p&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk80"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr (-<span class="mi">1</span>)) (functor_ab_biprod p p&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk81"><span class="nb">intros</span> [b b&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnected (Tr (-<span class="mi">1</span>))
  (hfiber (functor_ab_biprod p p&#39;) (b, b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk82"><span class="nb">pose proof</span> (a := S b); <span class="nb">pose proof</span> (a&#39; := S&#39; b&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>IsConnected (Tr (-<span class="mi">1</span>)) (hfiber p b)</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>IsConnected (Tr (-<span class="mi">1</span>)) (hfiber p&#39; b&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnected (Tr (-<span class="mi">1</span>))
  (hfiber (functor_ab_biprod p p&#39;) (b, b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk83"><span class="nb">apply</span> center <span class="kr">in</span> a, a&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Tr (-<span class="mi">1</span>) (hfiber p b)</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>Tr (-<span class="mi">1</span>) (hfiber p&#39; b&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnected (Tr (-<span class="mi">1</span>))
  (hfiber (functor_ab_biprod p p&#39;) (b, b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk84">strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>hfiber p&#39; b&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>hfiber p b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnected (Tr (-<span class="mi">1</span>))
  (hfiber (functor_ab_biprod p p&#39;) (b, b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk85">rapply contr_inhabited_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>hfiber p&#39; b&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>hfiber p b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Tr (-<span class="mi">1</span>) (hfiber (functor_ab_biprod p p&#39;) (b, b&#39;))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk86"><span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>hfiber p&#39; b&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>hfiber p b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber (functor_ab_biprod p p&#39;) (b, b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk87"><span class="kr">exists</span> (<span class="nv">ab_biprod_inl</span> <span class="nv">a</span>.<span class="mi">1</span> + ab_biprod_inr a&#39;.<span class="mi">1</span>); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>hfiber p&#39; b&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>hfiber p b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(p (a.<span class="mi">1</span> + group_unit), p&#39; (group_unit + a&#39;.<span class="mi">1</span>)) =
(b, b&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk88"><span class="nb">apply</span> path_prod;
    <span class="nb">refine</span> (grp_homo_op _ _ _ @ _);
    <span class="nb">rewrite</span> (grp_homo_unit _);
    <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>hfiber p&#39; b&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>hfiber p b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p a.<span class="mi">1</span> + <span class="mi">0</span> = b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk89" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>hfiber p&#39; b&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>hfiber p b</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk89"><hr></label><div class="goal-conclusion"><span class="mi">0</span> + p&#39; a&#39;.<span class="mi">1</span> = b&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk8a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>hfiber p&#39; b&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>hfiber p b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p a.<span class="mi">1</span> + <span class="mi">0</span> = b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (right_identity _ @ a.<span class="mi">2</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk8b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A $-&gt; B</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>A&#39; $-&gt; B&#39;</span></span></span><br><span><var>S</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p</span></span></span><br><span><var>S'</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) p&#39;</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>B&#39;</span></span></span><br><span><var>a'</var><span class="hyp-type"><b>: </b><span>hfiber p&#39; b&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>hfiber p b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> + p&#39; a&#39;.<span class="mi">1</span> = b&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (left_identity _ @ a&#39;.<span class="mi">2</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** *** Lemmas for working with biproducts *)</span>

<span class="sd">(** The swap isomorphism of the biproduct of two groups. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk8c"><span class="kn">Definition</span> <span class="nf">direct_sum_swap</span> {<span class="nv">A</span> <span class="nv">B</span> : AbGroup}
  : ab_biprod A B $&lt;~&gt; ab_biprod B A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A B $&lt;~&gt; ab_biprod B A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk8d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A B $&lt;~&gt; ab_biprod B A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk8e">snapply Build_GroupIsomorphism&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A B &lt;~&gt; ab_biprod B A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk8f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk8f"><hr></label><div class="goal-conclusion">IsSemiGroupPreserving <span class="nl">?f</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk90">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A B &lt;~&gt; ab_biprod B A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> equiv_prod_symm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk91">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSemiGroupPreserving (equiv_prod_symm A B)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Addition [+] is a group homomorphism [A+A -&gt; A]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_codiagonal</span> {<span class="nv">A</span> : AbGroup} : ab_biprod A A $-&gt; A
  := ab_biprod_rec grp_homo_id grp_homo_id.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_codiagonal_natural</span> {<span class="nv">A</span> <span class="nv">B</span> : AbGroup} (<span class="nv">f</span> : A $-&gt; B)
  : f $o ab_codiagonal $== ab_codiagonal $o functor_ab_biprod f f
  := <span class="kr">fun</span> <span class="nv">a</span> =&gt; grp_homo_op f _ _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_diagonal</span> {<span class="nv">A</span> : AbGroup} : A $-&gt; ab_biprod A A
  := ab_biprod_corec grp_homo_id grp_homo_id.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Given two abelian group homomorphisms [f] and [g], their pairing [(f, g) : B -&gt; A + A] can be written as a composite. Note that [ab_biprod_corec] is an alias for [grp_prod_corec]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk92"><span class="kn">Lemma</span> <span class="nf">ab_biprod_corec_diagonal</span> `{Funext} {A B : AbGroup} (f g : B $-&gt; A)
  : ab_biprod_corec f g = (functor_ab_biprod f g) $o ab_diagonal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>B $-&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_corec f g =
functor_ab_biprod f g $o ab_diagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk93"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>B $-&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod_corec f g =
functor_ab_biprod f g $o ab_diagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> equiv_path_grouphomomorphism; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Precomposing the codiagonal with the swap map has no effect. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk94"><span class="kn">Lemma</span> <span class="nf">ab_codiagonal_swap</span> `{Funext} {A : AbGroup}
  : (@ab_codiagonal A) $o direct_sum_swap = ab_codiagonal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_codiagonal $o direct_sum_swap = ab_codiagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk95"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_codiagonal $o direct_sum_swap = ab_codiagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk96"><span class="nb">apply</span> equiv_path_grouphomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_codiagonal $o direct_sum_swap == ab_codiagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk97"><span class="nb">intro</span> a; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ab_biprod A A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd a + fst a = fst a + snd a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (abgroup_commutative _ _ _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The corresponding result for the diagonal is true definitionally, so it isn&#39;t strictly necessary to state it, but we record it anyways. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_diagonal_swap</span> {<span class="nv">A</span> : AbGroup}
  : direct_sum_swap $o (@ab_diagonal A) = ab_diagonal
  := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The biproduct is associative. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk98"><span class="kn">Lemma</span> <span class="nf">ab_biprod_assoc</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : AbGroup}
  : ab_biprod A (ab_biprod B C) $&lt;~&gt; ab_biprod (ab_biprod A B) C.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A (ab_biprod B C) $&lt;~&gt;
ab_biprod (ab_biprod A B) C</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk99"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A (ab_biprod B C) $&lt;~&gt;
ab_biprod (ab_biprod A B) C</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk9a">snapply Build_GroupIsomorphism&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A (ab_biprod B C) &lt;~&gt;
ab_biprod (ab_biprod A B) C</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chk9b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chk9b"><hr></label><div class="goal-conclusion">IsSemiGroupPreserving <span class="nl">?f</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk9c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod A (ab_biprod B C) &lt;~&gt;
ab_biprod (ab_biprod A B) C</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> equiv_prod_assoc.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk9d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSemiGroupPreserving (equiv_prod_assoc A B C)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">unfold</span> IsSemiGroupPreserving; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The iterated diagonals [(ab_diagonal + id) o ab_diagonal] and [(id + ab_diagonal) o ab_diagonal] agree, after reassociating the direct sum. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_commute_id_diagonal</span> {<span class="nv">A</span> : AbGroup}
  : (functor_ab_biprod (@ab_diagonal A) grp_homo_id) $o ab_diagonal
    = ab_biprod_assoc $o (functor_ab_biprod grp_homo_id ab_diagonal) $o ab_diagonal
  := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A similar result for the codiagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk9e"><span class="kn">Lemma</span> <span class="nf">ab_commute_id_codiagonal</span> `{Funext} {A : AbGroup}
  : (@ab_codiagonal A) $o (functor_ab_biprod ab_codiagonal grp_homo_id) $o ab_biprod_assoc
    = ab_codiagonal $o (functor_ab_biprod grp_homo_id ab_codiagonal).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_codiagonal $o
functor_ab_biprod ab_codiagonal grp_homo_id $o
ab_biprod_assoc =
ab_codiagonal $o
functor_ab_biprod grp_homo_id ab_codiagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chk9f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_codiagonal $o
functor_ab_biprod ab_codiagonal grp_homo_id $o
ab_biprod_assoc =
ab_codiagonal $o
functor_ab_biprod grp_homo_id ab_codiagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chka0"><span class="nb">apply</span> equiv_path_grouphomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_codiagonal $o
functor_ab_biprod ab_codiagonal grp_homo_id $o
ab_biprod_assoc ==
ab_codiagonal $o
functor_ab_biprod grp_homo_id ab_codiagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chka1"><span class="nb">intro</span> a; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>ab_biprod A (ab_biprod A A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst a + fst (snd a) + snd (snd a) =
fst a + (fst (snd a) + snd (snd a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (grp_assoc _ _ _)^.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The next few results are used to prove associativity of the Baer sum. *)</span>

<span class="sd">(** A &quot;twist&quot; isomorphism [(A + B) + C &lt;~&gt; (C + B) + A]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chka2"><span class="kn">Lemma</span> <span class="nf">ab_biprod_twist</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : AbGroup@{u}}
  : ab_biprod (ab_biprod A B) C $&lt;~&gt; ab_biprod (ab_biprod C B) A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod (ab_biprod A B) C $&lt;~&gt;
ab_biprod (ab_biprod C B) A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chka3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod (ab_biprod A B) C $&lt;~&gt;
ab_biprod (ab_biprod C B) A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chka4">snapply Build_GroupIsomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupHomomorphism (ab_biprod (ab_biprod A B) C)
  (ab_biprod (ab_biprod C B) A)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chka5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chka5"><hr></label><div class="goal-conclusion">IsEquiv <span class="nl">?grp_iso_homo</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chka6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">GroupHomomorphism (ab_biprod (ab_biprod A B) C)
  (ab_biprod (ab_biprod C B) A)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chka7">snapply Build_GroupHomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod (ab_biprod A B) C -&gt;
ab_biprod (ab_biprod C B) A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chka8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chka8"><hr></label><div class="goal-conclusion">IsSemiGroupPreserving <span class="nl">?grp_homo_map</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chka9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod (ab_biprod A B) C -&gt;
ab_biprod (ab_biprod C B) A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkaa"><span class="nb">intros</span> [[a b] c].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod (ab_biprod C B) A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((c,b),a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkab">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSemiGroupPreserving
  (<span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
   (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
    (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
      (Overture.fst fst) (snd fst)) (fst X) (snd X))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkac"><span class="nb">unfold</span> IsSemiGroupPreserving.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod (ab_biprod A B) C,
(snd (x + y), snd (fst (x + y)), fst (fst (x + y))) =
(snd x, snd (fst x), fst (fst x)) +
(snd y, snd (fst y), fst (fst y))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkad">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  {|
    grp_homo_map :=
      <span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
      (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
       (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
         (Overture.fst fst) (snd fst)) (fst X) (snd X);
    issemigrouppreserving_grp_homo :=
      (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod (ab_biprod A B) C =&gt; <span class="mi">1</span>)
      :
      IsSemiGroupPreserving
        (<span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
         (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
          (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
            (Overture.fst fst) (snd fst)) (fst X)
           (snd X))
  |}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkae">snapply isequiv_adjointify.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod (ab_biprod C B) A -&gt;
ab_biprod (ab_biprod A B) C</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="biproduct-v-chkaf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chkaf"><hr></label><div class="goal-conclusion">{|
  grp_homo_map :=
    <span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
    (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
     (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
       (Overture.fst fst) (snd fst)) (fst X) (snd X);
  issemigrouppreserving_grp_homo :=
    (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod (ab_biprod A B) C =&gt; <span class="mi">1</span>)
    :
    IsSemiGroupPreserving
      (<span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
       (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
        (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
          (Overture.fst fst) (snd fst)) (fst X)
         (snd X))
|} o <span class="nl">?g</span> == idmap</div></blockquote><input class="alectryon-extra-goal-toggle" id="biproduct-v-chkb0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><label class="goal-separator" for="biproduct-v-chkb0"><hr></label><div class="goal-conclusion"><span class="nl">?g</span>
o {|
    grp_homo_map :=
      <span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
      (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
       (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
         (Overture.fst fst) (snd fst)) (fst X) (snd X);
    issemigrouppreserving_grp_homo :=
      (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod (ab_biprod A B) C =&gt; <span class="mi">1</span>)
      :
      IsSemiGroupPreserving
        (<span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
         (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
          (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
            (Overture.fst fst) (snd fst)) (fst X)
           (snd X))
  |} == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb1">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod (ab_biprod C B) A -&gt;
ab_biprod (ab_biprod A B) C</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb2"><span class="nb">intros</span> [[c b] a].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_biprod (ab_biprod A B) C</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((a,b),c).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb3">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{|
  grp_homo_map :=
    <span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
    (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
     (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
       (Overture.fst fst) (snd fst)) (fst X) (snd X);
  issemigrouppreserving_grp_homo :=
    (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod (ab_biprod A B) C =&gt; <span class="mi">1</span>)
    :
    IsSemiGroupPreserving
      (<span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
       (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
        (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
          (Overture.fst fst) (snd fst)) (fst X)
         (snd X))
|}
o (<span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod C B) A =&gt;
   (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod C B =&gt;
    (<span class="kr">fun</span> (<span class="nv">c</span> : C) (<span class="nv">b</span> : B) (<span class="nv">a</span> : A) =&gt; (a, b, c))
      (Overture.fst fst) (snd fst)) (fst X) (snd X)) ==
idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb4">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod C B) A =&gt;
 (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod C B =&gt;
  (<span class="kr">fun</span> (<span class="nv">c</span> : C) (<span class="nv">b</span> : B) (<span class="nv">a</span> : A) =&gt; (a, b, c))
    (Overture.fst fst) (snd fst)) (fst X) (snd X))
o {|
    grp_homo_map :=
      <span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
      (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
       (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
         (Overture.fst fst) (snd fst)) (fst X) (snd X);
    issemigrouppreserving_grp_homo :=
      (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : ab_biprod (ab_biprod A B) C =&gt; <span class="mi">1</span>)
      :
      IsSemiGroupPreserving
        (<span class="kr">fun</span> <span class="nv">X</span> : ab_biprod (ab_biprod A B) C =&gt;
         (<span class="kr">fun</span> <span class="nv">fst</span> : ab_biprod A B =&gt;
          (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) (<span class="nv">c</span> : C) =&gt; (c, b, a))
            (Overture.fst fst) (snd fst)) (fst X)
           (snd X))
  |} == idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The triagonal and cotriagonal homomorphisms. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_triagonal</span> {<span class="nv">A</span> : AbGroup} : A $-&gt; ab_biprod (ab_biprod A A) A
  := (functor_ab_biprod ab_diagonal grp_homo_id) $o ab_diagonal.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_cotriagonal</span> {<span class="nv">A</span> : AbGroup} : ab_biprod (ab_biprod A A) A $-&gt; A
  := ab_codiagonal $o (functor_ab_biprod ab_codiagonal grp_homo_id).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** For an abelian group [A], precomposing the triagonal on [A] with the twist map on [A] has no effect. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ab_triagonal_twist</span> {<span class="nv">A</span> : AbGroup}
  : ab_biprod_twist $o @ab_triagonal A = ab_triagonal
  := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A similar result for the cotriagonal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb5"><span class="kn">Definition</span> <span class="nf">ab_cotriagonal_twist</span> `{Funext} {A : AbGroup}
  : @ab_cotriagonal A $o ab_biprod_twist = ab_cotriagonal.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_cotriagonal $o ab_biprod_twist = ab_cotriagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_cotriagonal $o ab_biprod_twist = ab_cotriagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb7"><span class="nb">apply</span> equiv_path_grouphomomorphism.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ab_cotriagonal $o ab_biprod_twist == ab_cotriagonal</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb8"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>ab_biprod (ab_biprod A A) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ab_cotriagonal $o ab_biprod_twist) x =
ab_cotriagonal x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkb9"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>ab_biprod (ab_biprod A A) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd x + snd (fst x) + fst (fst x) =
fst (fst x) + snd (fst x) + snd x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkba"><span class="nb">refine</span> ((grp_assoc _ _ _)^ @ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>ab_biprod (ab_biprod A A) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd x + (snd (fst x) + fst (fst x)) =
fst (fst x) + snd (fst x) + snd x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="biproduct-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="biproduct-v-chkbb"><span class="nb">refine</span> (abgroup_commutative _ _ _ @ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>AbGroup</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>ab_biprod (ab_biprod A A) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd (fst x) + fst (fst x) + snd x =
fst (fst x) + snd (fst x) + snd x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap (<span class="kr">fun</span> <span class="nv">a</span> =&gt;  a + snd x) (abgroup_commutative _ _ _)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span></span></pre>
</div>
</div></body>
</html>
