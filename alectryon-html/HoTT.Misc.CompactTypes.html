<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>CompactTypes.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="sd">(** * Properties of compact and searchable types *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk0"><span class="kn">From</span> HoTT <span class="kn">Require Import</span> Basics Types.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Truncations.Core Truncations.Connectedness.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Spaces.Nat.Core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Misc.UStructures.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Spaces.NatSeq.Core Spaces.NatSeq.UStructure.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Homotopy.Suspension.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Pointed.Core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Universes.TruncType.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Idempotents.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> nat_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> pointed_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Basic definitions of compact types *)</span>

<span class="sd">(** A type [A] is compact if for every decidable predicate [P] on [A] we can either find an element of [A] making [P] false or we can show that [P a] always holds. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">IsCompact</span> (<span class="nv">A</span> : <span class="kt">Type</span>)
  := <span class="kr">forall</span> <span class="nv">P</span> : A -&gt; <span class="kt">Type</span>, (<span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)) -&gt;
                              {a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Any compact type is decidable. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk1"><span class="kn">Definition</span> <span class="nf">decidable_iscompact</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">c</span> : IsCompact A) : Decidable A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk3"><span class="nb">destruct</span> (c (<span class="kr">fun</span> (<span class="nv">_</span> : A) =&gt; Empty) _) <span class="kr">as</span> [c1|c2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>c1</var><span class="hyp-type"><b>: </b><span>{_ : A &amp; ~ Empty}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>c2</var><span class="hyp-type"><b>: </b><span>A -&gt; Empty</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk4"><hr></label><div class="goal-conclusion">Decidable A</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>c1</var><span class="hyp-type"><b>: </b><span>{_ : A &amp; ~ Empty}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl c1.<span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>c2</var><span class="hyp-type"><b>: </b><span>A -&gt; Empty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr c2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Compactness is equivalent to assuming the same for [HProp]-valued decidable predicates. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">IsCompactProps</span> (<span class="nv">A</span> : <span class="kt">Type</span>)
  := <span class="kr">forall</span> <span class="nv">P</span> : A -&gt; HProp, (<span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)) -&gt;
                              {a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk7"><span class="kn">Definition</span> <span class="nf">iscompact_iscompactprops</span> {<span class="nv">A</span>} (<span class="nv">c</span> : IsCompactProps A) : IsCompact A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompactProps A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompactProps A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk9"><span class="nb">intros</span> P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka"><span class="nb">destruct</span> (c (merely o P) _) <span class="kr">as</span> [l|r].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{a : A &amp; ~ merely (P a)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chkb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, merely (P a)</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chkb"><hr></label><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkc">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{a : A &amp; ~ merely (P a)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl (l.<span class="mi">1</span>; <span class="kr">fun</span> <span class="nv">p</span> =&gt; l.<span class="mi">2</span> (tr p))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, merely (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chke"><span class="nb">right</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, merely (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A, P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkf"><span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, merely (P a)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> merely_inhabited_iff_inhabited_stable, r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Since decidable types are stable, it&#39;s also equivalent to negate [P] in the definition. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">IsCompact&#39;</span> (<span class="nv">A</span> : <span class="kt">Type</span>)
  := <span class="kr">forall</span> <span class="nv">P</span> : A -&gt; <span class="kt">Type</span>, (<span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)) -&gt;
                              {a : A &amp; P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, ~ P a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk10"><span class="kn">Definition</span> <span class="nf">iff_iscompact_iscompact&#39;</span> (<span class="nv">A</span> : <span class="kt">Type</span>)
  : IsCompact A &lt;-&gt; IsCompact&#39; A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A &lt;-&gt; IsCompact&#39; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk11"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A &lt;-&gt; IsCompact&#39; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk12"><span class="nb">split</span>;
    napply (functor_forall (<span class="kr">fun</span> <span class="nv">P</span> =&gt; not o P)); <span class="nb">intro</span> P;
    rapply functor_forall; <span class="nb">intro</span> dP;
    <span class="nb">apply</span> functor_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; ~~ P a} -&gt; {a : A &amp; P a}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk13" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk13"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, ~ P a) -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, ~ P a</div></blockquote><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk14" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk14"><hr></label><div class="goal-conclusion">{a : A &amp; ~ P a} -&gt; {a : A &amp; ~ P a}</div></blockquote><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk15" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk15"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, ~~ P a) -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk16"><span class="mi">2</span>,<span class="mi">3</span>: <span class="bp">exact</span> idmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; ~~ P a} -&gt; {a : A &amp; P a}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk17" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk17"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, ~~ P a) -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk18"><span class="mi">1</span>: <span class="nb">apply</span> (functor_sigma idmap).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A, ~~ P a -&gt; P a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk19" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk19"><hr></label><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, ~~ P a) -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk1a"><span class="mi">2</span>: <span class="nb">apply</span> (functor_forall idmap).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A, ~~ P a -&gt; P a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk1b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk1b"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : A, ~~ P b -&gt; P b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>: <span class="nb">intro</span> a; <span class="bp">by</span> <span class="nb">apply</span> stable_decidable.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Another equivalent definition of compactness: If a family over the type is decidable, then the Œ£-type is decidable. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">IsSigmaCompact</span> (<span class="nv">A</span> : <span class="kt">Type</span>)
  := <span class="kr">forall</span> <span class="nv">P</span> : A -&gt; <span class="kt">Type</span>, (<span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)) -&gt; Decidable (sig P).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk1c"><span class="kn">Definition</span> <span class="nf">equiv_iscompact&#39;_issigmacompact</span> {<span class="nv">A</span> : <span class="kt">Type</span>}
  : IsCompact&#39; A &lt;-&gt; IsSigmaCompact A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact&#39; A &lt;-&gt; IsSigmaCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk1d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact&#39; A &lt;-&gt; IsSigmaCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk1e"><span class="nb">apply</span> iff_functor_forall; <span class="nb">intro</span> P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)) -&gt;
 {a : A &amp; P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, ~ P a)) &lt;-&gt;
((<span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)) -&gt;
 Decidable {x : _ &amp; P x})</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk1f"><span class="nb">apply</span> iff_functor_forall; <span class="nb">intro</span> dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, ~ P a) &lt;-&gt;
Decidable {x : _ &amp; P x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk20"><span class="nb">apply</span> iff_equiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, ~ P a) &lt;~&gt;
Decidable {x : _ &amp; P x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk21"><span class="nb">apply</span> (equiv_functor_sum&#39; equiv_idmap).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, ~ P a) &lt;~&gt; ~ {x : _ &amp; P x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">napply equiv_sig_ind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Again, it is enough to consider [HProp]-valued families. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">IsSigmaCompactProps</span> (<span class="nv">A</span> : <span class="kt">Type</span>)
  := <span class="kr">forall</span> <span class="nv">P</span> : A -&gt; HProp,
      (<span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)) -&gt; Decidable (sig P).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">issigmacompactprops_issigmacompact</span> {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">h</span> : IsSigmaCompact A)
  : IsSigmaCompactProps A
  := <span class="kr">fun</span> <span class="nv">P</span> <span class="nv">hP</span> =&gt; h P hP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk22"><span class="kn">Definition</span> <span class="nf">issigmacompact_issigmacompactprops</span> {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">h</span> : IsSigmaCompactProps A)
  : IsSigmaCompact A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSigmaCompactProps A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSigmaCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk23"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSigmaCompactProps A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSigmaCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk24"><span class="nb">intros</span> P hP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSigmaCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>hP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable {x : _ &amp; P x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk25"><span class="nb">refine</span> (decidable_iff _ (h (merely o P) _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSigmaCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>hP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : A &amp; merely (P x)} &lt;-&gt; {x : _ &amp; P x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk26"><span class="nb">apply</span> iff_functor_sigma; <span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSigmaCompactProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>hP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely (P a) &lt;-&gt; P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> merely_inhabited_iff_inhabited_stable.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A weaker definition: for any decidable family, the dependent function type is decidable. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">IsPiCompact</span> (<span class="nv">A</span> : <span class="kt">Type</span>)
  := <span class="kr">forall</span> (<span class="nv">P</span> : A -&gt; <span class="kt">Type</span>) (<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)),
      Decidable (<span class="kr">forall</span> <span class="nv">a</span> : A, P a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk27"><span class="kn">Definition</span> <span class="nf">ispicompact_issigmacompact</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">c</span> : IsSigmaCompact A)
  : IsPiCompact A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsPiCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk28"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsPiCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk29"><span class="nb">intros</span> P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (<span class="kr">forall</span> <span class="nv">a</span> : A, P a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk2a"><span class="nb">destruct</span> (c (not o P) _) <span class="kr">as</span> [l|r].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{x : A &amp; ~ P x}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (<span class="kr">forall</span> <span class="nv">a</span> : A, P a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk2b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>~ {x : A &amp; ~ P x}</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk2b"><hr></label><div class="goal-conclusion">Decidable (<span class="kr">forall</span> <span class="nv">a</span> : A, P a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk2c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{x : A &amp; ~ P x}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (<span class="kr">forall</span> <span class="nv">a</span> : A, P a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">right</span>; <span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">f</span> =&gt; l.<span class="mi">2</span> (f l.<span class="mi">1</span>)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk2d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>~ {x : A &amp; ~ P x}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (<span class="kr">forall</span> <span class="nv">a</span> : A, P a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk2e"><span class="nb">left</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>~ {x : A &amp; ~ P x}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A, P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk2f"><span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>~ {x : A &amp; ~ P x}</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk30"><span class="nb">apply</span> (stable_decidable (P a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsSigmaCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>~ {x : A &amp; ~ P x}</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">u</span> =&gt; r (a; u)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Compact types are closed under retracts. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk31"><span class="kn">Definition</span> <span class="nf">iscompact_retract</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">R</span> : RetractOf A) (<span class="nv">c</span> : IsCompact A)
  : IsCompact (retract_type R).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>RetractOf A</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact (retract_type R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk32"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>RetractOf A</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact (retract_type R)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk33"><span class="nb">intros</span> P dP; <span class="nb">destruct</span> (c (P o (retract_retr R)) _) <span class="kr">as</span> [l|r].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>RetractOf A</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>retract_type R -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : retract_type R, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{a : A &amp; ~ P (retract_retr R a)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : retract_type R &amp; ~ P a} +
 (<span class="kr">forall</span> <span class="nv">a</span> : retract_type R, P a))%type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>RetractOf A</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>retract_type R -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : retract_type R, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (retract_retr R a)</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk34"><hr></label><div class="goal-conclusion">({a : retract_type R &amp; ~ P a} +
 (<span class="kr">forall</span> <span class="nv">a</span> : retract_type R, P a))%type</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk35">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>RetractOf A</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>retract_type R -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : retract_type R, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{a : A &amp; ~ P (retract_retr R a)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : retract_type R &amp; ~ P a} +
 (<span class="kr">forall</span> <span class="nv">a</span> : retract_type R, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl ((retract_retr R) l.<span class="mi">1</span>; l.<span class="mi">2</span>)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk36">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>R</var><span class="hyp-type"><b>: </b><span>RetractOf A</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>retract_type R -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : retract_type R, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (retract_retr R a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : retract_type R &amp; ~ P a} +
 (<span class="kr">forall</span> <span class="nv">a</span> : retract_type R, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr (<span class="kr">fun</span> <span class="nv">a</span> =&gt;  ((retract_issect R) a) # r ((retract_sect R) a))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">iscompact_retract&#39;</span> {<span class="nv">A</span> <span class="nv">R</span> : <span class="kt">Type</span>} {<span class="nv">f</span> : A -&gt; R} {<span class="nv">g</span> : R -&gt; A}
  (<span class="nv">s</span> : f o g == idmap) (<span class="nv">c</span> : IsCompact A)
  : IsCompact R
  := iscompact_retract (Build_RetractOf A R f g s) c.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Assuming the set truncation map has a section, a type is compact if and only if its set truncation is compact. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk37"><span class="kn">Definition</span> <span class="nf">compact_set_trunc_compact</span> `{Univalence} {A : <span class="kt">Type</span>}
  (f : (Tr <span class="mi">0</span> A) -&gt; A) (s : tr o f == idmap)
  : IsCompact A &lt;-&gt; IsCompact (Tr <span class="mi">0</span> A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A &lt;-&gt; IsCompact (Tr <span class="mi">0</span> A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk38"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A &lt;-&gt; IsCompact (Tr <span class="mi">0</span> A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk39"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A -&gt; IsCompact (Tr <span class="mi">0</span> A)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk3a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk3a"><hr></label><div class="goal-conclusion">IsCompact (Tr <span class="mi">0</span> A) -&gt; IsCompact A</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk3b"><span class="mi">1</span>: <span class="bp">exact</span> (iscompact_retract&#39; s).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact (Tr <span class="mi">0</span> A) -&gt; IsCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk3c"><span class="nb">intro</span> cpt; rapply iscompact_iscompactprops.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br><span><var>cpt</var><span class="hyp-type"><b>: </b><span>IsCompact (Tr <span class="mi">0</span> A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompactProps A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk3d"><span class="nb">intros</span> P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br><span><var>cpt</var><span class="hyp-type"><b>: </b><span>IsCompact (Tr <span class="mi">0</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk3e"><span class="nb">destruct</span> (cpt (Trunc_rec P)) <span class="kr">as</span> [l|r].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br><span><var>cpt</var><span class="hyp-type"><b>: </b><span>IsCompact (Tr <span class="mi">0</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Tr <span class="mi">0</span> A, Decidable (Trunc_rec P a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk3f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br><span><var>cpt</var><span class="hyp-type"><b>: </b><span>IsCompact (Tr <span class="mi">0</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{a : Tr <span class="mi">0</span> A &amp; ~ Trunc_rec P a}</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk3f"><hr></label><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk40" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br><span><var>cpt</var><span class="hyp-type"><b>: </b><span>IsCompact (Tr <span class="mi">0</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : Tr <span class="mi">0</span> A, Trunc_rec P a</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk40"><hr></label><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk41">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br><span><var>cpt</var><span class="hyp-type"><b>: </b><span>IsCompact (Tr <span class="mi">0</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Tr <span class="mi">0</span> A, Decidable (Trunc_rec P a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk42"><span class="nb">intro</span> a; strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br><span><var>cpt</var><span class="hyp-type"><b>: </b><span>IsCompact (Tr <span class="mi">0</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (Trunc_rec P (tr a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (dP a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk43">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br><span><var>cpt</var><span class="hyp-type"><b>: </b><span>IsCompact (Tr <span class="mi">0</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{a : Tr <span class="mi">0</span> A &amp; ~ Trunc_rec P a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl (f l.<span class="mi">1</span>; <span class="kr">fun</span> <span class="nv">x</span> =&gt; l.<span class="mi">2</span> (ap (Trunc_rec P) (s l.<span class="mi">1</span>) # x))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk44">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Tr <span class="mi">0</span> A -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>tr o f == idmap</span></span></span><br><span><var>cpt</var><span class="hyp-type"><b>: </b><span>IsCompact (Tr <span class="mi">0</span> A)</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : Tr <span class="mi">0</span> A, Trunc_rec P a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr (<span class="kr">fun</span> <span class="nv">a</span> =&gt; r (tr a))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Basic definitions of searchable types *)</span>

<span class="sd">(** A type is searchable if for every decidable predicate we can find a &quot;universal witness&quot; for whether the predicate is always true or not. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">IsSearchable</span> (<span class="nv">A</span> : <span class="kt">Type</span>)
  := <span class="kr">forall</span> (<span class="nv">P</span> : A -&gt; <span class="kt">Type</span>) (<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)),
      {x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">IsSearchableProps</span> (<span class="nv">A</span> : <span class="kt">Type</span>)
  := <span class="kr">forall</span> (<span class="nv">P</span> : A -&gt; HProp) (<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)),
      {x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk45"><span class="kn">Definition</span> <span class="nf">issearchable_issearchableprops</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">s</span> : IsSearchableProps A)
  : IsSearchable A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>IsSearchableProps A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk46"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>IsSearchableProps A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk47"><span class="nb">intros</span> P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>IsSearchableProps A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk48"><span class="nb">specialize</span> (s (merely o P) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>{x : A &amp;
(merely o P) x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, (merely o P) a}</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk49"><span class="kr">exists</span> <span class="nv">s</span>.<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>{x : A &amp;
(merely o P) x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, (merely o P) a}</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P s.<span class="mi">1</span> -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk4a"><span class="nb">intros</span> h a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>{x : A &amp;
(merely o P) x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, (merely o P) a}</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>P s.<span class="mi">1</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> merely_inhabited_iff_inhabited_stable, s.<span class="mi">2</span>, tr, h.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A type is searchable if and only if it is compact and inhabited. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk4b"><span class="kn">Definition</span> <span class="nf">issearchable_iscompact_inhabited</span> {<span class="nv">A</span> : <span class="kt">Type</span>}
  : IsCompact A -&gt; A -&gt; IsSearchable A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A -&gt; A -&gt; IsSearchable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk4c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A -&gt; A -&gt; IsSearchable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk4d"><span class="nb">intros</span> c a P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk4e"><span class="nb">induction</span> (c P _) <span class="kr">as</span> [l|r].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{a : A &amp; ~ P a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk4f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P a</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk4f"><hr></label><div class="goal-conclusion">{x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk50">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{a : A &amp; ~ P a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk51"><span class="kr">exists</span> <span class="nv">l</span>.<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>{a : A &amp; ~ P a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P l.<span class="mi">1</span> -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span> h; <span class="bp">contradiction</span> (l.<span class="mi">2</span> h).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk52">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (a; <span class="kr">fun</span> <span class="nv">_</span> =&gt; r).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk53"><span class="kn">Definition</span> <span class="nf">iscompact_issearchable</span> {<span class="nv">A</span> : <span class="kt">Type</span>} : IsSearchable A -&gt; IsCompact A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable A -&gt; IsCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk54"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable A -&gt; IsCompact A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk55"><span class="nb">intros</span> h P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk56"><span class="nb">set</span> (w := (h P dP).<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>w</var><span><span class="hyp-body"><b>:= </b><span>(h P dP).<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk57"><span class="nb">destruct</span> (dP w) <span class="kr">as</span> [x|y].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>w</var><span><span class="hyp-body"><b>:= </b><span>(h P dP).<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>P w</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk58" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>w</var><span><span class="hyp-body"><b>:= </b><span>(h P dP).<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>~ P w</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk58"><hr></label><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk59">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>w</var><span><span class="hyp-body"><b>:= </b><span>(h P dP).<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>P w</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr ((h P dP).<span class="mi">2</span> x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk5a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>w</var><span><span class="hyp-body"><b>:= </b><span>(h P dP).<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>~ P w</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({a : A &amp; ~ P a} + (<span class="kr">forall</span> <span class="nv">a</span> : A, P a))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl (w; y)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">inhabited_issearchable</span> {<span class="nv">A</span> : <span class="kt">Type</span>} : IsSearchable A -&gt; A
  := <span class="kr">fun</span> <span class="nv">s</span> =&gt; (s (<span class="kr">fun</span> <span class="nv">a</span> =&gt; Unit) _).<span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">searchable_iff</span> {<span class="nv">A</span> : <span class="kt">Type</span>} : IsSearchable A &lt;-&gt; A * (IsCompact A)
  := (<span class="kr">fun</span> <span class="nv">s</span> =&gt; (inhabited_issearchable s, iscompact_issearchable s),
        <span class="kr">fun</span> <span class="nv">c</span> =&gt; issearchable_iscompact_inhabited (snd c) (fst c)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Examples of searchable and compact types  *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk5b"><span class="kn">Definition</span> <span class="nf">issearchable_contr</span> {<span class="nv">A</span>} (<span class="nv">c</span> : Contr A) : IsSearchable A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Contr A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk5c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Contr A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk5d"><span class="nb">intros</span> P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Contr A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : A &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk5e"><span class="kr">exists</span> (<span class="nv">center</span> <span class="nv">A</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Contr A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (center A) -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk5f"><span class="nb">intros</span> p a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>Contr A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>P (center A)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">induction</span> (contr a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk60"><span class="kn">Definition</span> <span class="nf">issearchable_Bool</span> : IsSearchable Bool.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable Bool</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk61"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable Bool</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk62"><span class="nb">intros</span> P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>Bool -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : Bool, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : Bool &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : Bool, P a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk63"><span class="nb">induction</span> (dP false) <span class="kr">as</span> [p | np]; [<span class="kr">exists</span> <span class="nv">true</span> | <span class="kr">exists</span> <span class="nv">false</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>Bool -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : Bool, Decidable (P a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>P false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P true -&gt; <span class="kr">forall</span> <span class="nv">a</span> : Bool, P a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk64" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span>Bool -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : Bool, Decidable (P a)</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ P false</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk64"><hr></label><div class="goal-conclusion">P false -&gt; <span class="kr">forall</span> <span class="nv">a</span> : Bool, P a</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>: <span class="bp">by</span> <span class="nb">intros</span> p&#39; [].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The empty type is trivially compact. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">iscompact_empty</span> : IsCompact Empty
  := <span class="kr">fun</span> <span class="nv">P</span> <span class="nv">dP</span> =&gt; inr (<span class="kr">fun</span> <span class="nv">a</span> =&gt; Empty_rec a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">iscompact_empty&#39;</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">na</span> : ~A) : IsCompact A
  := <span class="kr">fun</span> <span class="nv">p</span> <span class="nv">dP</span> =&gt; inr (<span class="kr">fun</span> <span class="nv">a</span> =&gt; Empty_rec (na a)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk65"><span class="kn">Definition</span> <span class="nf">iscompact_iff_not_or_issearchable</span> {<span class="nv">A</span> : <span class="kt">Type</span>} :
  IsCompact A &lt;-&gt; (~ A) + IsSearchable A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A &lt;-&gt; ~ A + IsSearchable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk66"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A &lt;-&gt; ~ A + IsSearchable A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk67"><span class="nb">constructor</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A -&gt; ~ A + IsSearchable A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk68" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk68"><hr></label><div class="goal-conclusion">~ A + IsSearchable A -&gt; IsCompact A</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk69">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A -&gt; ~ A + IsSearchable A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk6a"><span class="nb">intro</span> c.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(~ A + IsSearchable A)%type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk6b"><span class="nb">destruct</span> (decidable_iscompact c) <span class="kr">as</span> [l|r].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(~ A + IsSearchable A)%type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk6c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk6c"><hr></label><div class="goal-conclusion">(~ A + IsSearchable A)%type</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk6d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(~ A + IsSearchable A)%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr (issearchable_iscompact_inhabited c l)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk6e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(~ A + IsSearchable A)%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl r).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk6f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + IsSearchable A -&gt; IsCompact A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk70"><span class="nb">intros</span> [l|r].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk71" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk71"><hr></label><div class="goal-conclusion">IsCompact A</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk72">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (iscompact_empty&#39; l).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk73">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (iscompact_issearchable r).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Assuming univalence, the type of propositions is searchable. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk74"><span class="kn">Definition</span> <span class="nf">issearchable_hprop</span> `{Univalence} : IsSearchable HProp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable HProp</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk75"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable HProp</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk76"><span class="nb">apply</span> issearchable_issearchableprops.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchableProps HProp</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk77"><span class="nb">intros</span> P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>HProp -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : HProp, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : HProp &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : HProp, P a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk78"><span class="nb">destruct</span> (dP Unit_hp) <span class="kr">as</span> [t|f].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>HProp -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : HProp, Decidable (P a)</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>P Unit_hp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : HProp &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : HProp, P a}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk79" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>HProp -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : HProp, Decidable (P a)</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ P Unit_hp</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk79"><hr></label><div class="goal-conclusion">{x : HProp &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : HProp, P a}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk7a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>HProp -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : HProp, Decidable (P a)</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>P Unit_hp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : HProp &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : HProp, P a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk7b"><span class="kr">exists</span> <span class="nv">False_hp</span>; <span class="nb">intros</span> p a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>HProp -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : HProp, Decidable (P a)</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>P Unit_hp</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>P False_hp</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk7c">rapply stable_decidable.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>HProp -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : HProp, Decidable (P a)</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>P Unit_hp</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>P False_hp</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ P a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span> (not_not_constant_family_hprop P).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk7d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>HProp -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : HProp, Decidable (P a)</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ P Unit_hp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : HProp &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : HProp, P a}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Unit_hp; <span class="kr">fun</span> <span class="nv">h</span> =&gt; Empty_rec (f h)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Assuming univalence, if the domain of a surjective map is searchable, then so is its codomain. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk7e"><span class="kn">Definition</span> <span class="nf">issearchableprops_image</span> `{Univalence} (A B : <span class="kt">Type</span>)
  (s : IsSearchableProps A)
  (f : A -&gt; B) (surj : IsSurjection f)
  : IsSearchableProps B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>IsSearchableProps A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchableProps B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk7f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>IsSearchableProps A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchableProps B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk80"><span class="nb">intros</span> P dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>IsSearchableProps A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; HProp</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : B, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : B &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : B, P a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk81"><span class="nb">specialize</span> (s (P o f) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; HProp</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>{x : A &amp; (P o f) x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : A, (P o f) a}</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : B, Decidable (P a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x : B &amp; P x -&gt; <span class="kr">forall</span> <span class="nv">a</span> : B, P a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (f s.<span class="mi">1</span>; <span class="kr">fun</span> <span class="nv">t</span> =&gt; conn_map_elim _ f _ (s.<span class="mi">2</span> t)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">issearchable_image</span> `{Univalence} (A B : <span class="kt">Type</span>)
  (s : IsSearchable A)
  (f : A -&gt; B) (surj : IsSurjection f)
  : IsSearchable B
  := issearchable_issearchableprops (issearchableprops_image A B s f surj).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Assuming univalence, every connected pointed type is searchable. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">issearchable_isconnected_ptype</span> `{Univalence} (A : pType)
  (c : IsConnected <span class="mi">0</span> A)
  : IsSearchable A
  := issearchable_image Unit A (issearchable_contr _) (<span class="kr">fun</span> <span class="nv">_</span> =&gt; pt) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Assuming univalence, the suspension of any type is searchable. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk82"><span class="kn">Definition</span> <span class="nf">issearchable_suspension</span> `{Univalence} (A : <span class="kt">Type</span>)
  : IsSearchable (Susp A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable (Susp A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk83"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsSearchable (Susp A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk84">snrefine (issearchable_image Bool (Susp A) issearchable_Bool _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Bool -&gt; Susp A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk85" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk85"><hr></label><div class="goal-conclusion">IsConnMap (Tr (-<span class="mi">1</span>)) <span class="nl">?f</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk86">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Bool -&gt; Susp A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Bool_rec _ North South).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk87">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr (-<span class="mi">1</span>)) (Bool_rec (Susp A) North South)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk88">snapply Susp_ind; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnected (Tr (-<span class="mi">1</span>))
  (hfiber (Bool_rec (Susp A) North South) North)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk89" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk89"><hr></label><div class="goal-conclusion">IsConnected (Tr (-<span class="mi">1</span>))
  (hfiber (Bool_rec (Susp A) North South) South)</div></blockquote><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk8a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk8a"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : A,
transport
  (<span class="kr">fun</span> <span class="nv">y</span> : Susp A =&gt;
   IsConnected (Tr (-<span class="mi">1</span>))
     (hfiber (Bool_rec (Susp A) North South) y))
  (merid x) <span class="nl">?Goal</span> = <span class="nl">?Goal0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk8b"><span class="mi">1</span>,<span class="mi">2</span>: rapply contr_inhabited_hprop; <span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber (Bool_rec (Susp A) North South) North</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk8c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk8c"><hr></label><div class="goal-conclusion">hfiber (Bool_rec (Susp A) North South) South</div></blockquote><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk8d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk8d"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : A,
transport
  (<span class="kr">fun</span> <span class="nv">y</span> : Susp A =&gt;
   IsConnected (Tr (-<span class="mi">1</span>))
     (hfiber (Bool_rec (Susp A) North South) y))
  (merid x)
  (contr_inhabited_hprop
     (Tr (-<span class="mi">1</span>)
        (hfiber (Bool_rec (Susp A) North South) North))
     (tr <span class="nl">?Goal0</span>)) =
contr_inhabited_hprop
  (Tr (-<span class="mi">1</span>)
     (hfiber (Bool_rec (Susp A) North South) South))
  (tr <span class="nl">?Goal1</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk8e"><span class="mi">1</span>: <span class="bp">exact</span> (true; idpath).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber (Bool_rec (Susp A) North South) South</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk8f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk8f"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : A,
transport
  (<span class="kr">fun</span> <span class="nv">y</span> : Susp A =&gt;
   IsConnected (Tr (-<span class="mi">1</span>))
     (hfiber (Bool_rec (Susp A) North South) y))
  (merid x)
  (contr_inhabited_hprop
     (Tr (-<span class="mi">1</span>)
        (hfiber (Bool_rec (Susp A) North South) North))
     (tr (true; <span class="mi">1</span>))) =
contr_inhabited_hprop
  (Tr (-<span class="mi">1</span>)
     (hfiber (Bool_rec (Susp A) North South) South))
  (tr <span class="nl">?Goal0</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk90"><span class="mi">1</span>: <span class="bp">exact</span> (false; idpath).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : A,
transport
  (<span class="kr">fun</span> <span class="nv">y</span> : Susp A =&gt;
   IsConnected (Tr (-<span class="mi">1</span>))
     (hfiber (Bool_rec (Susp A) North South) y))
  (merid x)
  (contr_inhabited_hprop
     (Tr (-<span class="mi">1</span>)
        (hfiber (Bool_rec (Susp A) North South) North))
     (tr (true; <span class="mi">1</span>))) =
contr_inhabited_hprop
  (Tr (-<span class="mi">1</span>)
     (hfiber (Bool_rec (Susp A) North South) South))
  (tr (false; <span class="mi">1</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span> x; <span class="bp">by</span> <span class="nb">apply</span> path_ishprop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk91"><span class="kn">Definition</span> <span class="nf">iscompact_image</span> `{Univalence} (A B : <span class="kt">Type</span>)
  (c : IsCompact A)
  (f : A -&gt; B) (surj : IsSurjection f)
  : IsCompact B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk92"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsCompact B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk93"><span class="nb">apply</span> iscompact_iff_not_or_issearchable.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(~ B + IsSearchable B)%type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk94"><span class="nb">destruct</span> ((fst iscompact_iff_not_or_issearchable) c) <span class="kr">as</span> [n|s].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(~ B + IsSearchable B)%type</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk95" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk95"><hr></label><div class="goal-conclusion">(~ B + IsSearchable B)%type</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk96">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(~ B + IsSearchable B)%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">left</span>; <span class="bp">by</span> rapply conn_map_elim.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk97">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>IsCompact A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>surj</var><span class="hyp-type"><b>: </b><span>IsConnMap (Tr (-<span class="mi">1</span>)) f</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(~ B + IsSearchable B)%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">right</span>; <span class="bp">by</span> rapply issearchable_image.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Uniform_Search</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** ** Searchability of [nat -&gt; A] *)</span>

  <span class="sd">(** Following https://www.cs.bham.ac.uk/~mhe/TypeTopology/TypeTopology.UniformSearch.html, we prove that if [A] is searchable then [nat -&gt; A] is uniformly searchable. *)</span>

  <span class="sd">(** A type with a uniform structure is uniformly searchable if it is searchable over uniformly continuous predicates. Here the uniform structure on [Type] is the trivial one [trivial_us] involving the identity types at each level. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">uniformly_searchable</span> (<span class="nv">A</span> : <span class="kt">Type</span>) {<span class="nv">usA</span> : UStructure A}
    := <span class="kr">forall</span> (<span class="nv">P</span> : A -&gt; <span class="kt">Type</span>) (<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">a</span> : A, Decidable (P a)),
        uniformly_continuous P -&gt; <span class="kr">exists</span> <span class="nv">w0</span> : A, (P w0 -&gt; <span class="kr">forall</span> <span class="nv">u</span> : A, P u).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">issearchable_A</span> : IsSearchable A).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** The witness function for uniformly continuous predicates on [nat -&gt; A]. The first argument [n : nat] will be the modulus of uniform continuity, but we do not use the property in this definition. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk98"><span class="kn">Definition</span> <span class="nf">uniformsearch_witness</span> (<span class="nv">n</span> : nat) (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
    (<span class="nv">dP</span> : <span class="kr">forall</span> (<span class="nv">f</span> : nat -&gt; A), Decidable (P f))
    : nat -&gt; A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk99"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk9a"><span class="nb">induction</span> n <span class="kr">in</span> P, dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat -&gt; A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chk9b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)) -&gt;
nat -&gt; A</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chk9b"><hr></label><div class="goal-conclusion">nat -&gt; A</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk9c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">_</span> =&gt; inhabited_issearchable issearchable_A).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk9d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)) -&gt;
nat -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk9e"><span class="nb">pose</span> (g Q dQ := Q (IHn Q dQ)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)) -&gt;
nat -&gt; A</span></span></span><br><span><var>g</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">Q</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
  (<span class="nv">dQ</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (Q f)) =&gt;
Q (IHn Q dQ)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">Q</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (Q f)) -&gt; <span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chk9f"><span class="nb">pose</span> (wA := (issearchable_A (<span class="kr">fun</span> <span class="nv">x</span> =&gt; g (P o (seq_cons x)) _) _).<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)) -&gt;
nat -&gt; A</span></span></span><br><span><var>g</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">Q</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
  (<span class="nv">dQ</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (Q f)) =&gt;
Q (IHn Q dQ)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">Q</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (Q f)) -&gt; <span class="kt">Type</span></span></span></span></span><br><span><var>wA</var><span><span class="hyp-body"><b>:= </b><span>(issearchable_A
   (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
    g (P o seq_cons x)
      (<span class="kr">fun</span> <span class="nv">f</span> : nat -&gt; A =&gt; dP (seq_cons x f)))
   (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt;
    dP
      (seq_cons a
         (IHn
            (<span class="kr">fun</span> <span class="nv">x0</span> : nat -&gt; A =&gt;
             P (seq_cons a x0))
            (<span class="kr">fun</span> <span class="nv">f</span> : nat -&gt; A =&gt; dP (seq_cons a f)))))).<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span>A</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (seq_cons wA (IHn (P o (seq_cons wA)) _)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** We often need to apply [P] to [uniformsearch_witness n P dP], and this saves repeating [P]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Definition</span> <span class="nf">pred_uniformsearch_witness</span> (<span class="nv">n</span> : nat) (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
    (<span class="nv">dP</span> : <span class="kr">forall</span> (<span class="nv">f</span> : nat -&gt; A), Decidable (P f))
    := P (uniformsearch_witness n P dP).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** The desired property of the witness function. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka0"><span class="kn">Definition</span> <span class="nf">uniformsearch_witness_spec</span> {<span class="nv">n</span> : nat} (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
    (<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : (nat -&gt; A), Decidable (P f))
    (<span class="nv">is_mod</span> : is_modulus_of_uniform_continuity n P)
    (<span class="nv">h</span> : pred_uniformsearch_witness n P dP)
    : <span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n P dP</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n P dP</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka2"><span class="nb">induction</span> n <span class="kr">in</span> P, dP, is_mod, h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity <span class="mi">0</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness <span class="mi">0</span> P dP</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chka3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n.+<span class="mi">1</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n.+<span class="mi">1</span> P dP</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
(<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)),
is_modulus_of_uniform_continuity n P -&gt;
pred_uniformsearch_witness n P dP -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chka3"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity <span class="mi">0</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness <span class="mi">0</span> P dP</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka5"><span class="nb">intro</span> u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity <span class="mi">0</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness <span class="mi">0</span> P dP</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>nat -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka6"><span class="nb">refine</span> (transport idmap _ h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity <span class="mi">0</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness <span class="mi">0</span> P dP</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>nat -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pred_uniformsearch_witness <span class="mi">0</span> P dP = P u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* For [n = 0], [is_mod u1 u2] says that [P u1 = P u2]. *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> is_mod, sequence_type_us_zero.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n.+<span class="mi">1</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n.+<span class="mi">1</span> P dP</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
(<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)),
is_modulus_of_uniform_continuity n P -&gt;
pred_uniformsearch_witness n P dP -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka8"><span class="nb">intro</span> u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n.+<span class="mi">1</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n.+<span class="mi">1</span> P dP</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
(<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)),
is_modulus_of_uniform_continuity n P -&gt;
pred_uniformsearch_witness n P dP -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>nat -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chka9"><span class="nb">refine</span> (transport idmap _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n.+<span class="mi">1</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n.+<span class="mi">1</span> P dP</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
(<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)),
is_modulus_of_uniform_continuity n P -&gt;
pred_uniformsearch_witness n P dP -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>nat -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> = P u</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chkaa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n.+<span class="mi">1</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n.+<span class="mi">1</span> P dP</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
(<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)),
is_modulus_of_uniform_continuity n P -&gt;
pred_uniformsearch_witness n P dP -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>nat -&gt; A</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chkaa"><hr></label><div class="goal-conclusion"><span class="nl">?Goal</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkab"><span class="mi">1</span>: <span class="bp">exact</span> (uniformly_continuous_extensionality P (m:=<span class="mi">0</span>)
                  (uniformly_continuous_has_modulus is_mod)
                  (seq_cons_head_tail u)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n.+<span class="mi">1</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n.+<span class="mi">1</span> P dP</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
(<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)),
is_modulus_of_uniform_continuity n P -&gt;
pred_uniformsearch_witness n P dP -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>nat -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (seq_cons (u <span class="mi">0</span>) (seq_tail u))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkac">rapply (IHn (P o (seq_cons (u <span class="mi">0</span>)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n.+<span class="mi">1</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n.+<span class="mi">1</span> P dP</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
(<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)),
is_modulus_of_uniform_continuity n P -&gt;
pred_uniformsearch_witness n P dP -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>nat -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_modulus_of_uniform_continuity n
  (<span class="kr">fun</span> <span class="nv">x</span> : nat -&gt; A =&gt; P (seq_cons (u <span class="mi">0</span>) x))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="compacttypes-v-chkad" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n.+<span class="mi">1</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n.+<span class="mi">1</span> P dP</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
(<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)),
is_modulus_of_uniform_continuity n P -&gt;
pred_uniformsearch_witness n P dP -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>nat -&gt; A</span></span></span><br></div><label class="goal-separator" for="compacttypes-v-chkad"><hr></label><div class="goal-conclusion">pred_uniformsearch_witness n
  (<span class="kr">fun</span> <span class="nv">x</span> : nat -&gt; A =&gt; P (seq_cons (u <span class="mi">0</span>) x))
  (<span class="kr">fun</span> <span class="nv">f</span> : nat -&gt; A =&gt; dP (seq_cons (u <span class="mi">0</span>) f))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkae"><span class="mi">1</span>: <span class="nb">apply</span> cons_decreases_modulus, is_mod.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)</span></span></span><br><span><var>is_mod</var><span class="hyp-type"><b>: </b><span>is_modulus_of_uniform_continuity n.+<span class="mi">1</span> P</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>pred_uniformsearch_witness n.+<span class="mi">1</span> P dP</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">P</span> : (nat -&gt; A) -&gt; <span class="kt">Type</span>)
(<span class="nv">dP</span> : <span class="kr">forall</span> <span class="nv">f</span> : nat -&gt; A, Decidable (P f)),
is_modulus_of_uniform_continuity n P -&gt;
pred_uniformsearch_witness n P dP -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>nat -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pred_uniformsearch_witness n
  (<span class="kr">fun</span> <span class="nv">x</span> : nat -&gt; A =&gt; P (seq_cons (u <span class="mi">0</span>) x))
  (<span class="kr">fun</span> <span class="nv">f</span> : nat -&gt; A =&gt; dP (seq_cons (u <span class="mi">0</span>) f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      <span class="c">(* The universality of [uniformsearch_witness] says that it is enough to check this statement with [u 0] replaced with [wA] above, and that is exactly what [h] proves, by the inductive step. *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((issearchable_A
                 (<span class="kr">fun</span> <span class="nv">y</span> =&gt; pred_uniformsearch_witness n (P o (seq_cons y)) _) _).<span class="mi">2</span>
                h (u <span class="mi">0</span>)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkaf"><span class="kn">Definition</span> <span class="nf">has_uniformly_searchable_seq_issearchable</span>
    : uniformly_searchable (nat -&gt; A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">uniformly_searchable (nat -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkb0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">uniformly_searchable (nat -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkb1"><span class="nb">intros</span> P dP contP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : nat -&gt; A, Decidable (P a)</span></span></span><br><span><var>contP</var><span class="hyp-type"><b>: </b><span>uniformly_continuous P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{w0 : nat -&gt; A &amp; P w0 -&gt; <span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="compacttypes-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="compacttypes-v-chkb2"><span class="kr">exists</span> (<span class="nv">uniformsearch_witness</span> (contP <span class="mi">0</span>).<span class="mi">1</span> P dP).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>issearchable_A</var><span class="hyp-type"><b>: </b><span>IsSearchable A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>(nat -&gt; A) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : nat -&gt; A, Decidable (P a)</span></span></span><br><span><var>contP</var><span class="hyp-type"><b>: </b><span>uniformly_continuous P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (uniformsearch_witness (contP <span class="mi">0</span>).<span class="mi">1</span> P dP) -&gt;
<span class="kr">forall</span> <span class="nv">u</span> : nat -&gt; A, P u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> uniformsearch_witness_spec; <span class="bp">exact</span> (contP <span class="mi">0</span>).<span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Uniform_Search</span>.</span></span></pre>
</div>
</div></body>
</html>
