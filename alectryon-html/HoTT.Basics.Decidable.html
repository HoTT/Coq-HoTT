<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Decidable.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk0"><span class="kn">Require Import</span>
  Basics.Overture
  Basics.PathGroupoids
  Basics.Trunc
  Basics.Tactics
  Basics.Iff.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> trunc_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> path_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Decidability *)</span>

<span class="sd">(** ** Definitions *)</span>

<span class="c">(* NB: This has to come after our definition of [not] (which is in [Overture]), so that it refers to our [not] rather than the one in [Coq.Logic]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">Decidable</span> (<span class="nv">A</span> : <span class="kt">Type</span>) :=
  dec : A + (~ A).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> dec A {_}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The [decide_type] and [decide] tactic allow to automatically prove</span>
<span class="sd">decidable claims using previously written decision procedures that</span>
<span class="sd">compute. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">decide_type</span> A :=
  <span class="kr">let</span> <span class="nv">K</span> := (<span class="kp">eval</span> <span class="nb">hnf</span> <span class="kr">in</span> (dec A)) <span class="kr">in</span>
  <span class="kr">match</span> K <span class="kr">with</span>
  | inl <span class="nl">?Z</span> =&gt; <span class="bp">exact</span> Z
  | inr <span class="nl">?Z</span> =&gt; <span class="bp">exact</span> Z
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">decide</span> :=
  <span class="kr">multimatch goal with</span>
  | [|- <span class="nl">?A</span>] =&gt; decide_type A
  | [|- ~ <span class="nl">?A</span>] =&gt; decide_type A
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk1"><span class="kn">Definition</span> <span class="nf">decidable_true</span> {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">a</span> : A)
  (<span class="nv">P</span> : <span class="kr">forall</span> (<span class="nv">p</span> : Decidable A), <span class="kt">Type</span>)
  (<span class="nv">p</span> : <span class="kr">forall</span> <span class="nv">x</span>, P (inl x))
  : <span class="kr">forall</span> <span class="nv">p</span>, P p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P (inl x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">p</span> : Decidable A, P p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P (inl x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">p</span> : Decidable A, P p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk3"><span class="nb">intros</span> [x|n].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P (inl x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inl x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P (inl x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk4"><hr></label><div class="goal-conclusion">P (inr n)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P (inl x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inl x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, P (inl x)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inr n)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span> n.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Replace a term [p] of the form [Decidable A] with [inl x] if we have a term [a : A] showing that [A] is true. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">decidable_true</span> p a :=
  <span class="nb">generalize</span> p;
  rapply (decidable_true a);
  <span class="kp">try</span> <span class="nb">intro</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk7"><span class="kn">Definition</span> <span class="nf">decidable_false</span> {<span class="nv">A</span> : <span class="kt">Type</span>}
  (<span class="nv">n</span> : not A)
  (<span class="nv">P</span> : <span class="kr">forall</span> (<span class="nv">p</span> : Decidable A), <span class="kt">Type</span>)
  (<span class="nv">p</span> : <span class="kr">forall</span> <span class="nv">n&#39;</span>, P (inr n&#39;))
  : <span class="kr">forall</span> <span class="nv">p</span>, P p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n&#39;</span> : ~ A, P (inr n&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">p</span> : Decidable A, P p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n&#39;</span> : ~ A, P (inr n&#39;)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">p</span> : Decidable A, P p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk9"><span class="nb">intros</span> [x|n&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n&#39;</span> : ~ A, P (inr n&#39;)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inl x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chka" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n&#39;</span> : ~ A, P (inr n&#39;)</span></span></span><br><span><var>n'</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><label class="goal-separator" for="decidable-v-chka"><hr></label><div class="goal-conclusion">P (inr n&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chkb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n&#39;</span> : ~ A, P (inr n&#39;)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inl x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span> n.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chkc">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n&#39;</span> : ~ A, P (inr n&#39;)</span></span></span><br><span><var>n'</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inr n&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Replace a term [p] of the form [Decidable A] with [inr na] if we have a term [n : not A] showing that [A] is false. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Ltac</span> <span class="nf">decidable_false</span> p n :=
  <span class="nb">generalize</span> p;
  rapply (decidable_false n);
  <span class="kp">try</span> <span class="nb">intro</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">DecidablePaths</span> (<span class="nv">A</span> : <span class="kt">Type</span>) :=
  dec_paths :: <span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : A), Decidable (x = y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">Stable</span> <span class="nv">P</span> := stable : ~~P -&gt; P.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** We always have a map in the other direction. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">not_not_unit</span> {<span class="nv">P</span> : <span class="kt">Type</span>} : P -&gt; ~~P
  := <span class="kr">fun</span> <span class="nv">x</span> <span class="nv">np</span> =&gt; np x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">ishprop_stable_hprop</span> `{Funext} P `{IsHProp P} : IsHProp (Stable P)
  := istrunc_forall.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chkd"><span class="kn">Instance</span> <span class="nf">stable_decidable</span> <span class="nv">P</span> `{Decidable P} : Stable P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Stable P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chke"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Stable P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chkf"><span class="nb">intros</span> dn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable P</span></span></span><br><span><var>dn</var><span class="hyp-type"><b>: </b><span>~~ P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* [dec P] either solves the goal or contradicts [dn]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> (dec P).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk10"><span class="kn">Instance</span> <span class="nf">stable_negation</span> <span class="nv">P</span> : Stable (~ P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Stable (~ P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk11"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Stable (~ P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk12"><span class="nb">intros</span> nnnp p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nnnp</var><span class="hyp-type"><b>: </b><span>~~ ~ P</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (nnnp (not_not_unit p)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk13"><span class="kn">Definition</span> <span class="nf">iff_stable</span> <span class="nv">P</span> `(Stable P) : ~~P &lt;-&gt; P.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Stable P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ P &lt;-&gt; P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk14"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Stable P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ P &lt;-&gt; P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk15"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Stable P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ P -&gt; P</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk16" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Stable P</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk16"><hr></label><div class="goal-conclusion">P -&gt; ~~ P</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk17">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Stable P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ P -&gt; P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> stable.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk18">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Stable P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P -&gt; ~~ P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> not_not_unit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk19"><span class="kn">Definition</span> <span class="nf">stable_iff</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A &lt;-&gt; B)
  : Stable A -&gt; Stable B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;-&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Stable A -&gt; Stable B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk1a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;-&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Stable A -&gt; Stable B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk1b"><span class="nb">intros</span> stableA nnb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;-&gt; B</span></span></span><br><span><var>stableA</var><span class="hyp-type"><b>: </b><span>Stable A</span></span></span><br><span><var>nnb</var><span class="hyp-type"><b>: </b><span>~~ B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk1c"><span class="nb">destruct</span> f <span class="kr">as</span> [f finv].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>finv</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>stableA</var><span class="hyp-type"><b>: </b><span>Stable A</span></span></span><br><span><var>nnb</var><span class="hyp-type"><b>: </b><span>~~ B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (f (stableA (<span class="kr">fun</span> <span class="nv">na</span> =&gt; nnb (<span class="kr">fun</span> <span class="nv">b</span> =&gt; na (finv b))))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">stable_equiv&#39;</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A &lt;~&gt; B)
  : Stable A -&gt; Stable B
  := stable_iff f.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">stable_equiv</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A -&gt; B) `{!IsEquiv f}
  : Stable A -&gt; Stable B
  := stable_equiv&#39; (Build_Equiv _ _ f _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(**</span>
<span class="sd">  Because [vm_compute] evaluates terms in [PROP] eagerly</span>
<span class="sd">  and does not remove dead code we</span>
<span class="sd">  need the decide_rel hack. Suppose we have [(x = y) =def  (f x = f y)], now:</span>
<span class="sd">     [bool_decide (x = y) -&gt; bool_decide (f x = f y) -&gt; ...]</span>
<span class="sd">  As we see, the dead code [f x] and [f y] is actually evaluated,</span>
<span class="sd">  which is of course an utter waste.</span>
<span class="sd">  Therefore we introduce [decide_rel] and [bool_decide_rel].</span>
<span class="sd">     [bool_decide_rel (=) x y -&gt; bool_decide_rel (fun a b =&gt; f a = f b) x y -&gt; ...]</span>
<span class="sd">  Now the definition of equality remains under a lambda and</span>
<span class="sd">  our problem does not occur anymore!</span>
<span class="sd">*)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">decide_rel</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">R</span> : A -&gt; B -&gt; <span class="kt">Type</span>)
  {<span class="nv">dec</span> : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, Decidable (R x y)} (<span class="nv">x</span> : A) (<span class="nv">y</span> : B)
  : Decidable (R x y)
  := dec x y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Decidable hprops *)</span>

<span class="sd">(** Contractible types are decidable. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">decidable_contr</span> <span class="nv">X</span> `{Contr X} : Decidable X
  := inl (center X).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Thus, hprops have decidable equality. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">decidablepaths_hprop</span> <span class="nv">X</span> `{IsHProp X} : DecidablePaths X
  := <span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> =&gt; dec (x = y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Empty types are trivial. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">decidable_empty</span> : Decidable Empty
  := inr idmap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

<span class="sd">(** ** Transfer along equivalences *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk1d"><span class="kn">Definition</span> <span class="nf">decidable_iff</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A &lt;-&gt; B)
  : Decidable A -&gt; Decidable B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;-&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable A -&gt; Decidable B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk1e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;-&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable A -&gt; Decidable B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk1f"><span class="nb">intros</span> [a|na].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;-&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable B</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk20" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;-&gt; B</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk20"><hr></label><div class="goal-conclusion">Decidable B</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk21">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;-&gt; B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl (fst f a)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk22">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;-&gt; B</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr (<span class="kr">fun</span> <span class="nv">b</span> =&gt; na (snd f b))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">decidable_equiv&#39;</span> (<span class="nv">A</span> : <span class="kt">Type</span>) {<span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A &lt;~&gt; B)
: Decidable A -&gt; Decidable B
  := decidable_iff f.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">decidable_equiv</span> (<span class="nv">A</span> : <span class="kt">Type</span>) {<span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B) `{!IsEquiv f}
: Decidable A -&gt; Decidable B
  := decidable_equiv&#39; _ (Build_Equiv _ _ f _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk23"><span class="kn">Definition</span> <span class="nf">decidablepaths_equiv</span>
           (<span class="nv">A</span> : <span class="kt">Type</span>) {<span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B) `{IsEquiv A B f}
: DecidablePaths A -&gt; DecidablePaths B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">DecidablePaths A -&gt; DecidablePaths B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk24"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">DecidablePaths A -&gt; DecidablePaths B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk25"><span class="nb">intros</span> d x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (x = y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk26"><span class="nb">destruct</span> (d (f^-<span class="mi">1</span> x) (f^-<span class="mi">1</span> y)) <span class="kr">as</span> [e|ne].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>f^-<span class="mi">1</span> x = f^-<span class="mi">1</span> y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (x = y)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk27" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>ne</var><span class="hyp-type"><b>: </b><span>f^-<span class="mi">1</span> x &lt;&gt; f^-<span class="mi">1</span> y</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk27"><hr></label><div class="goal-conclusion">Decidable (x = y)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk28">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>f^-<span class="mi">1</span> x = f^-<span class="mi">1</span> y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (x = y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk29"><span class="nb">apply</span> inl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>f^-<span class="mi">1</span> x = f^-<span class="mi">1</span> y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((eisretr f x)^ @ ap f e @ eisretr f y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk2a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>ne</var><span class="hyp-type"><b>: </b><span>f^-<span class="mi">1</span> x &lt;&gt; f^-<span class="mi">1</span> y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (x = y)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk2b"><span class="nb">apply</span> inr; <span class="nb">intros</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>ne</var><span class="hyp-type"><b>: </b><span>f^-<span class="mi">1</span> x &lt;&gt; f^-<span class="mi">1</span> y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ne, ap, p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">decidablepaths_equiv&#39;</span> (<span class="nv">A</span> : <span class="kt">Type</span>) {<span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A &lt;~&gt; B)
: DecidablePaths A -&gt; DecidablePaths B
  := decidablepaths_equiv A f.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Hedberg&#39;s theorem: any type with decidable equality is a set. *)</span>

<span class="sd">(** A weakly constant function is one all of whose values are equal (in a specified way). *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">WeaklyConstant</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A -&gt; B) :=
  wconst : <span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span>, f x = f y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Any map that factors through an hprop is weakly constant. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk2c"><span class="kn">Definition</span> <span class="nf">wconst_through_hprop</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">P</span>} `{IsHProp P}
           (f : A -&gt; P) (g : P -&gt; B)
: WeaklyConstant (g o f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IsHProp0</var><span class="hyp-type"><b>: </b><span>IsHProp P</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; P</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>P -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">WeaklyConstant (g o f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk2d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IsHProp0</var><span class="hyp-type"><b>: </b><span>IsHProp P</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; P</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>P -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">WeaklyConstant (g o f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x y; <span class="nb">apply</span> (ap g), path_ishprop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A type is collapsible if it admits a weakly constant endomap. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">Collapsible</span> (<span class="nv">A</span> : <span class="kt">Type</span>) :=
  { collapse : A -&gt; A ;
    wconst_collapse :: WeaklyConstant collapse
  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Class</span> <span class="nf">PathCollapsible</span> (<span class="nv">A</span> : <span class="kt">Type</span>) :=
  path_coll :: <span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : A), Collapsible (x = y).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk2e"><span class="kn">Instance</span> <span class="nf">collapsible_decidable</span> (<span class="nv">A</span> : <span class="kt">Type</span>) `{Decidable A}
: Collapsible A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Collapsible A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk2f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Collapsible A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk30"><span class="nb">destruct</span> (dec A) <span class="kr">as</span> [a | na].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Collapsible A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk31" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk31"><hr></label><div class="goal-conclusion">Collapsible A</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk32">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Collapsible A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk33"><span class="kr">exists</span> (<span class="nv">const</span> <span class="nv">a</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">WeaklyConstant (const a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x y; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk34">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Collapsible A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk35"><span class="kr">exists</span> <span class="nv">idmap</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">WeaklyConstant idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x y; <span class="nb">destruct</span> (na x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk36"><span class="kn">Instance</span> <span class="nf">pathcoll_decpaths</span> (<span class="nv">A</span> : <span class="kt">Type</span>) `{DecidablePaths A}
: PathCollapsible A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PathCollapsible A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk37"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PathCollapsible A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x y; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** We give this a relatively high-numbered priority so that in deducing [IsHProp -&gt; IsHSet] Coq doesn&#39;t detour via [DecidablePaths]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk38"><span class="kn">Instance</span> <span class="nf">hset_pathcoll</span> (<span class="nv">A</span> : <span class="kt">Type</span>) `{PathCollapsible A}
: IsHSet A | <span class="mi">1000</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk39"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk3a"><span class="nb">apply</span> istrunc_S.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_mere_relation A paths</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk3b"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (x = y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk3c"><span class="nb">assert</span> (h : <span class="kr">forall</span> <span class="nv">p</span>:x=y, p = (collapse (idpath x))^ @ collapse p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">p</span> : x = y, p = (collapse <span class="mi">1</span>)^ @ collapse p</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk3d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">p</span> : x = y, p = (collapse <span class="mi">1</span>)^ @ collapse p</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk3d"><hr></label><div class="goal-conclusion">IsHProp (x = y)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk3e">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">p</span> : x = y, p = (collapse <span class="mi">1</span>)^ @ collapse p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> []; <span class="nb">symmetry</span>; <span class="bp">by</span> <span class="nb">apply</span> concat_Vp.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk3f">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">p</span> : x = y, p = (collapse <span class="mi">1</span>)^ @ collapse p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (x = y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk40"><span class="nb">apply</span> hprop_allpath; <span class="nb">intros</span> p q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">p</span> : x = y, p = (collapse <span class="mi">1</span>)^ @ collapse p</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk41"><span class="nb">refine</span> (h p @ _ @ (h q)^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">p</span> : x = y, p = (collapse <span class="mi">1</span>)^ @ collapse p</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(collapse <span class="mi">1</span>)^ @ collapse p =
(collapse <span class="mi">1</span>)^ @ collapse q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk42"><span class="nb">apply</span> whiskerL.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>PathCollapsible A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">p</span> : x = y, p = (collapse <span class="mi">1</span>)^ @ collapse p</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">collapse p = collapse q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> wconst.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk43"><span class="kn">Definition</span> <span class="nf">collapsible_hprop</span> (<span class="nv">A</span> : <span class="kt">Type</span>) `{IsHProp A}
: Collapsible A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IsHProp0</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Collapsible A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk44"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IsHProp0</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Collapsible A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk45"><span class="kr">exists</span> <span class="nv">idmap</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IsHProp0</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">WeaklyConstant idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x y; <span class="nb">apply</span> path_ishprop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk46"><span class="kn">Definition</span> <span class="nf">pathcoll_hset</span> (<span class="nv">A</span> : <span class="kt">Type</span>) `{IsHSet A}
: PathCollapsible A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IsHSet0</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PathCollapsible A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk47"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>IsHSet0</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PathCollapsible A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x y; <span class="nb">apply</span> collapsible_hprop; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Hedberg&#39;s Theorem *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk48"><span class="kn">Corollary</span> <span class="nf">hset_decpaths</span> (<span class="nv">A</span> : <span class="kt">Type</span>) `{DecidablePaths A}
: IsHSet A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk49"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** We can use Hedberg&#39;s Theorem to simplify a goal of the form [forall (d : Decidable (x = x :&gt; A)), P d] when [A] has decidable paths. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk4a"><span class="kn">Definition</span> <span class="nf">decidable_paths_refl</span> (<span class="nv">A</span> : <span class="kt">Type</span>) `{DecidablePaths A}
  (x : A)
  (P : <span class="kr">forall</span> (<span class="nv">d</span> : Decidable (x = x)), <span class="kt">Type</span>)
  (Px : P (inl idpath))
  : <span class="kr">forall</span> <span class="nv">d</span>, P d.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable (x = x) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Px</var><span class="hyp-type"><b>: </b><span>P (inl <span class="mi">1</span>)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">d</span> : Decidable (x = x), P d</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk4b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable (x = x) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Px</var><span class="hyp-type"><b>: </b><span>P (inl <span class="mi">1</span>)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">d</span> : Decidable (x = x), P d</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk4c">rapply (decidable_true idpath).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable (x = x) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Px</var><span class="hyp-type"><b>: </b><span>P (inl <span class="mi">1</span>)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x0</span> : x = x, P (inl x0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk4d"><span class="nb">intro</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable (x = x) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Px</var><span class="hyp-type"><b>: </b><span>P (inl <span class="mi">1</span>)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inl p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="sd">(** We cannot eliminate [p : x = x] with path induction, but we can use Hedberg&#39;s theorem to replace this with [idpath]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk4e"><span class="nb">assert</span> (r : (idpath = p)) <span class="bp">by</span> <span class="nb">apply</span> path_ishprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>Decidable (x = x) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Px</var><span class="hyp-type"><b>: </b><span>P (inl <span class="mi">1</span>)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span><span class="mi">1</span> = p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inl p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">destruct</span> r.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Truncation *)</span>

<span class="sd">(** Having decidable equality (which implies being an hset, by Hedberg&#39;s theorem above) is itself an hprop. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk4f"><span class="kn">Instance</span> <span class="nf">ishprop_decpaths</span> `{Funext} (A : <span class="kt">Type</span>)
: IsHProp (DecidablePaths A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (DecidablePaths A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk50"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (DecidablePaths A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk51"><span class="nb">apply</span> hprop_inhabited_contr; <span class="nb">intros</span> d.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (DecidablePaths A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk52"><span class="nb">assert</span> (IsHSet A) <span class="bp">by</span> <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (DecidablePaths A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk53"><span class="nb">apply</span> (Build_Contr _ d).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">y</span> : DecidablePaths A, d = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk54"><span class="nb">intros</span> d&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>d'</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">d = d&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk55">funext x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>d'</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">d x y = d&#39; x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk56"><span class="nb">generalize</span> (d x y); <span class="nb">clear</span> d; <span class="nb">intros</span> d.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>d'</var><span class="hyp-type"><b>: </b><span>DecidablePaths A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>Decidable (x = y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">d = d&#39; x y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk57"><span class="nb">generalize</span> (d&#39; x y); <span class="nb">clear</span> d&#39;; <span class="nb">intros</span> d&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>d, d'</var><span class="hyp-type"><b>: </b><span>Decidable (x = y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">d = d&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk58"><span class="nb">destruct</span> d <span class="kr">as</span> [d|nd]; <span class="nb">destruct</span> d&#39; <span class="kr">as</span> [d&#39;|nd&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>d, d'</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl d = inl d&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk59" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>nd'</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; y</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk59"><hr></label><div class="goal-conclusion">inl d = inr nd&#39;</div></blockquote><input class="alectryon-extra-goal-toggle" id="decidable-v-chk5a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>nd</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; y</span></span></span><br><span><var>d'</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk5a"><hr></label><div class="goal-conclusion">inr nd = inl d&#39;</div></blockquote><input class="alectryon-extra-goal-toggle" id="decidable-v-chk5b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>nd, nd'</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; y</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk5b"><hr></label><div class="goal-conclusion">inr nd = inr nd&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk5c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>d, d'</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl d = inl d&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ap, path_ishprop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk5d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>nd'</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl d = inr nd&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (nd&#39; d).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk5e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>nd</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; y</span></span></span><br><span><var>d'</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr nd = inl d&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (nd d&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk5f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>nd, nd'</var><span class="hyp-type"><b>: </b><span>x &lt;&gt; y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr nd = inr nd&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ap, path_forall; <span class="nb">intros</span> p; <span class="nb">elim</span> (nd p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Logical Laws *)</span>

<span class="sd">(** Various logical laws don&#39;t hold constructively as they do classically due to a required use of excluded middle. For us, this means that some laws require further assumptions on the decidability of propositions. *)</span>

<span class="sd">(** Here we give the dual De Morgan&#39;s Law which complements the one given in Iff.v.  One direction requires that one of the two propositions be decidable, while the other direction needs no assumption.  We state the latter property first, to avoid duplication in the proof. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk60"><span class="kn">Definition</span> <span class="nf">not_prod_sum_not</span> <span class="nv">A</span> <span class="nv">B</span> : ~ A + ~ B -&gt; ~ (A * B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B -&gt; ~ (A * B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk61"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B -&gt; ~ (A * B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk62"><span class="nb">intros</span> [na|nb] [a b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk63" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nb</var><span class="hyp-type"><b>: </b><span>~ B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk63"><hr></label><div class="goal-conclusion">Empty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk64">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (na a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk65">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nb</var><span class="hyp-type"><b>: </b><span>~ B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (nb b).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk66"><span class="kn">Definition</span> <span class="nf">iff_not_prod</span> <span class="nv">A</span> <span class="nv">B</span> `{Decidable A}
  : ~ (A * B) &lt;-&gt; ~ A + ~ B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (A * B) &lt;-&gt; ~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk67"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (A * B) &lt;-&gt; ~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk68"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (A * B) -&gt; ~ A + ~ B</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk69" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk69"><hr></label><div class="goal-conclusion">~ A + ~ B -&gt; ~ (A * B)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk6a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (A * B) -&gt; ~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk6b"><span class="nb">intros</span> np.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk6c"><span class="nb">destruct</span> (dec A) <span class="kr">as</span> [a|na].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk6d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk6d"><hr></label><div class="goal-conclusion">~ A + ~ B</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk6e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr (<span class="kr">fun</span> <span class="nv">b</span> =&gt; np (a, b))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk6f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl na).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk70">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B -&gt; ~ (A * B)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> not_prod_sum_not.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk71"><span class="kn">Definition</span> <span class="nf">iff_not_prod&#39;</span> <span class="nv">A</span> <span class="nv">B</span> `{Decidable B}
  : ~ (A * B) &lt;-&gt; ~ A + ~ B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (A * B) &lt;-&gt; ~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk72"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (A * B) &lt;-&gt; ~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk73"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (A * B) -&gt; ~ A + ~ B</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk74" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk74"><hr></label><div class="goal-conclusion">~ A + ~ B -&gt; ~ (A * B)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk75">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (A * B) -&gt; ~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk76"><span class="nb">intros</span> np.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk77"><span class="nb">destruct</span> (dec B) <span class="kr">as</span> [b|nb].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="decidable-v-chk78" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>nb</var><span class="hyp-type"><b>: </b><span>~ B</span></span></span><br></div><label class="goal-separator" for="decidable-v-chk78"><hr></label><div class="goal-conclusion">~ A + ~ B</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk79">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl (<span class="kr">fun</span> <span class="nv">a</span> =&gt; np (a, b))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk7a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>nb</var><span class="hyp-type"><b>: </b><span>~ B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inr nb).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="decidable-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="decidable-v-chk7b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Decidable B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A + ~ B -&gt; ~ (A * B)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> not_prod_sum_not.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span></span></pre>
</div>
</div></body>
</html>
