<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>ExactSequence.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk0"><span class="kn">From</span> HoTT <span class="kn">Require Import</span> Basics Types.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> SuccessorStructure.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> WildCat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Pointed.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Modalities.Identity Modalities.Descent.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Truncations.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> HFiber.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> ObjectClassifier.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> succ_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Open Scope</span> pointed_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Exact sequences *)</span>

<span class="sd">(** ** Very short complexes *)</span>

<span class="sd">(** A (very short) complex is a pair of pointed maps whose composite is the zero map. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">IsComplex</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span>} (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y)
  := (f o* i ==* pconst).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** This induces a map from the domain of [i] to the fiber of [f]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk1"><span class="kn">Definition</span> <span class="nf">cxfib</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} {<span class="nv">i</span> : F -&gt;* X} {<span class="nv">f</span> : X -&gt;* Y}
  (<span class="nv">cx</span> : IsComplex i f)
  : F -&gt;* pfiber f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F -&gt;* pfiber f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F -&gt;* pfiber f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk3">srapply Build_pMap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F -&gt; pfiber f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk4"><hr></label><div class="goal-conclusion"><span class="nl">?f</span> pt = pt</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">F -&gt; pfiber f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span> =&gt; (i x; cx x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : F =&gt; (i x; cx x)) pt = pt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk7"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i pt; cx pt) = ispointed_fiber f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk8"><span class="nb">refine</span> (path_sigma&#39; _ (point_eq i) _); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f x = pt) (point_eq i) (cx pt) =
point_eq f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk9"><span class="nb">refine</span> (transport_paths_Fl _ _ @ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ap f (point_eq i))^ @ cx pt = point_eq f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka"><span class="nb">apply</span> moveR_Vp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cx pt = ap f (point_eq i) @ point_eq f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((concat_p1 _)^ @ point_htpy cx).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ...whose composite with the projection [pfib : pfiber i -&gt; X] is [i].  *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb"><span class="kn">Definition</span> <span class="nf">pfib_cxfib</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} {<span class="nv">i</span> : F -&gt;* X} {<span class="nv">f</span> : X -&gt;* Y}
  (<span class="nv">cx</span> : IsComplex i f)
  : pfib f o* cxfib cx ==* i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pfib f o* cxfib cx ==* i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pfib f o* cxfib cx ==* i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd">srapply Build_pHomotopy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pfib f o* cxfib cx == i</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chke" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chke"><hr></label><div class="goal-conclusion"><span class="nl">?p</span> pt =
dpoint_eq (pfib f o* cxfib cx) @ (dpoint_eq i)^</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkf">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pfib f o* cxfib cx == i</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk10">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x0</span> : F =&gt; <span class="mi">1</span>) pt =
dpoint_eq (pfib f o* cxfib cx) @ (dpoint_eq i)^</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk11"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> =
(ap pr1
   (path_sigma&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f x = pt) (point_eq i)
      (transport_paths_Fl (point_eq i) (cx pt) @
       moveR_Vp (cx pt) (point_eq f)
         (ap f (point_eq i))
         ((concat_p1 (cx pt))^ @
          ((concat_p1 (cx pt) @ dpoint_eq cx) @
           concat_p1 (ap f (point_eq i) @ point_eq f))))) @
 <span class="mi">1</span>) @ (dpoint_eq i)^</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> ap_pr1_path_sigma; hott_simpl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Truncation preserves complexes. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk12"><span class="kn">Definition</span> <span class="nf">iscomplex_ptr</span> (<span class="nv">n</span> : trunc_index) {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) (<span class="nv">cx</span> : IsComplex i f)
  : IsComplex (fmap (pTr n) i) (fmap (pTr n) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (fmap (pTr n) i) (fmap (pTr n) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk13"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (fmap (pTr n) i) (fmap (pTr n) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk14"><span class="nb">refine</span> ((fmap_comp (pTr n) i f)^* @* _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap (pTr n) (f $o i) ==* pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk15"><span class="nb">refine</span> (_ @* ptr_functor_pconst n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap (pTr n) (f $o i) ==* fmap (pTr n) pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">tapply (fmap2 (pTr _)); <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Loop spaces preserve complexes. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk16"><span class="kn">Definition</span> <span class="nf">iscomplex_loops</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) (<span class="nv">cx</span> : IsComplex i f)
  : IsComplex (fmap loops i) (fmap loops f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (fmap loops i) (fmap loops f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk17"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (fmap loops i) (fmap loops f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk18"><span class="nb">refine</span> ((fmap_comp loops i f)^$ $@ _ $@ fmap_zero_morphism _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap loops (f $o i) $== fmap loops zero_morphism</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">tapply (fmap2 loops); <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk19"><span class="kn">Definition</span> <span class="nf">iscomplex_iterated_loops</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) (<span class="nv">cx</span> : IsComplex i f) (<span class="nv">n</span> : nat)
  : IsComplex (fmap (iterated_loops n) i) (fmap (iterated_loops n) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (fmap (iterated_loops n) i)
  (fmap (iterated_loops n) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk1a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (fmap (iterated_loops n) i)
  (fmap (iterated_loops n) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk1b"><span class="nb">induction</span> n <span class="kr">as</span> [|n IHn]; [ <span class="bp">exact</span> cx | ].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsComplex (fmap (iterated_loops n) i) (fmap (iterated_loops n) f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (fmap (iterated_loops n.+<span class="mi">1</span>) i)
  (fmap (iterated_loops n.+<span class="mi">1</span>) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> iscomplex_loops; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Passage across homotopies preserves complexes. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">iscomplex_homotopic_i</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  {<span class="nv">i</span> <span class="nv">i&#39;</span> : F -&gt;* X} (<span class="nv">ii</span> : i&#39; ==* i) (<span class="nv">f</span> : X -&gt;* Y) (<span class="nv">cx</span> : IsComplex i f)
  : IsComplex i&#39; f := pmap_postwhisker f ii @* cx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">iscomplex_homotopic_f</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) {<span class="nv">f</span> <span class="nv">f&#39;</span> : X -&gt;* Y} (<span class="nv">ff</span> : f&#39; ==* f) (<span class="nv">cx</span> : IsComplex i f)
  : IsComplex i f&#39;
  := pmap_prewhisker i ff @* cx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk1c"><span class="kn">Definition</span> <span class="nf">iscomplex_cancelL</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> <span class="nv">Y&#39;</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) (<span class="nv">e</span> : Y &lt;~&gt;* Y&#39;) (<span class="nv">cx</span> : IsComplex i (e o* f))
  : IsComplex i f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Y &lt;~&gt;* Y&#39;</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i (e o* f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex i f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk1d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Y &lt;~&gt;* Y&#39;</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i (e o* f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex i f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk1e"><span class="nb">refine</span> (_ @* precompose_pconst e^-<span class="mi">1</span>*).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Y &lt;~&gt;* Y&#39;</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i (e o* f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o* i ==* e^-<span class="mi">1</span>* o* pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk1f"><span class="nb">refine</span> ((compose_V_hh e (f o* i))^$ $@ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Y &lt;~&gt;* Y&#39;</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i (e o* f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e^-<span class="mi">1</span>* $o (e $o (f o* i)) $== e^-<span class="mi">1</span>* o* pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk20"><span class="nb">refine</span> (cat_postwhisker e^-<span class="mi">1</span>* _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Y &lt;~&gt;* Y&#39;</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i (e o* f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e $o (f o* i) $== pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk21"><span class="nb">refine</span> ((cat_assoc _ _ _)^$ $@ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Y &lt;~&gt;* Y&#39;</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i (e o* f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e $o f $o i $== pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> cx.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** And likewise passage across squares with equivalences *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk22"><span class="kn">Definition</span> <span class="nf">iscomplex_equiv_i</span> {<span class="nv">F</span> <span class="nv">F&#39;</span> <span class="nv">X</span> <span class="nv">X&#39;</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">i&#39;</span> : F&#39; -&gt;* X&#39;)
  (<span class="nv">g</span> : F&#39; &lt;~&gt;* F) (<span class="nv">h</span> : X&#39; &lt;~&gt;* X) (<span class="nv">p</span> : h o* i&#39; ==* i o* g)
  (<span class="nv">f</span> : X -&gt;* Y)
  (<span class="nv">cx</span>: IsComplex i f)
  : IsComplex i&#39; (f o* h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex i&#39; (f o* h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk23"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex i&#39; (f o* h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk24"><span class="nb">refine</span> (pmap_compose_assoc _ _ _ @* _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o* (h o* i&#39;) ==* pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk25"><span class="nb">refine</span> (pmap_postwhisker f p @* _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o* (i o* g) ==* pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk26"><span class="nb">refine</span> ((pmap_compose_assoc _ _ _)^* @* _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o* i o* g ==* pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk27"><span class="nb">refine</span> (pmap_prewhisker g cx @* _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pconst o* g ==* pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> postcompose_pconst.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A special version with only an equivalence on the fiber. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk28"><span class="kn">Definition</span> <span class="nf">iscomplex_equiv_fiber</span> {<span class="nv">F</span> <span class="nv">F&#39;</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) (<span class="nv">phi</span> : F&#39; &lt;~&gt;* F)
  `{cx : IsComplex i f}
  : IsComplex (i o* phi) f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (i o* phi) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk29"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (i o* phi) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk2a"><span class="nb">refine</span> ((pmap_compose_assoc _ _ _)^* @* _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o* i o* phi ==* pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk2b"><span class="nb">refine</span> (pmap_prewhisker _ cx @* _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>cx</var><span class="hyp-type"><b>: </b><span>IsComplex i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pconst o* phi ==* pconst</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> postcompose_pconst.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Any pointed map induces a trivial complex. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk2c"><span class="kn">Definition</span> <span class="nf">iscomplex_trivial</span> {<span class="nv">X</span> <span class="nv">Y</span> : pType} (<span class="nv">f</span> : X -&gt;* Y)
  : IsComplex (@pconst pUnit X) f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex pconst f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk2d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex pconst f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk2e">srapply Build_pHomotopy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o* pconst == pconst</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk2f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk2f"><hr></label><div class="goal-conclusion"><span class="nl">?p</span> pt = dpoint_eq (f o* pconst) @ (dpoint_eq pconst)^</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk30">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o* pconst == pconst</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk31"><span class="nb">intro</span> x; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>pUnit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f pt = pt</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (point_eq f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk32">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">fun</span> <span class="nv">x</span> : pUnit =&gt;
  point_eq f : (f o* pconst) x = pconst x)
 :
 f o* pconst == pconst) pt =
dpoint_eq (f o* pconst) @ (dpoint_eq pconst)^</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk33"><span class="nb">cbn</span>; <span class="nb">symmetry</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">1</span> @ point_eq f) @ <span class="mi">1</span> = point_eq f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (concat_p1 _ @ concat_1p _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** If [Y] is a set, then [IsComplex] is an [HProp]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Instance</span> <span class="nf">ishprop_iscomplex_hset</span> `{Funext} {F X Y : pType} `{IsHSet Y}
  (i : F -&gt;* X) (f : X -&gt;* Y)
  : IsHProp (IsComplex i f) := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Very short exact sequences and fiber sequences *)</span>

<span class="sd">(** A complex is [n]-exact if the induced map [cxfib] is [n]-connected.  *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Cumulative</span> <span class="kn">Class</span> <span class="nf">IsExact</span> (<span class="nv">n</span> : Modality) {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) :=
{
  cx_isexact : IsComplex i f ;
  conn_map_isexact :: IsConnMap n (cxfib cx_isexact)
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">issig_isexact</span> (<span class="nv">n</span> : Modality) {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y)
  : _ &lt;~&gt; IsExact n i f := <span class="kp">ltac</span>:(issig).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** If [Y] is a set, then [IsExact] is an [HProp]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk34"><span class="kn">Instance</span> <span class="nf">ishprop_isexact_hset</span> `{Univalence} {F X Y : pType} `{IsHSet Y}
  (n : Modality) (i : F -&gt;* X) (f : X -&gt;* Y)
  : IsHProp (IsExact n i f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>IsHSet0</var><span class="hyp-type"><b>: </b><span>IsHSet Y</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsExact n i f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk35"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>IsHSet0</var><span class="hyp-type"><b>: </b><span>IsHSet Y</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (IsExact n i f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk36">rapply (transport (<span class="kr">fun</span> <span class="nv">A</span> =&gt; IsHProp A) (x := { cx : IsComplex i f &amp; IsConnMap n (cxfib cx) })).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>IsHSet0</var><span class="hyp-type"><b>: </b><span>IsHSet Y</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{cx : IsComplex i f &amp; IsConnMap n (cxfib cx)} =
IsExact n i f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk37" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>IsHSet0</var><span class="hyp-type"><b>: </b><span>IsHSet Y</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk37"><hr></label><div class="goal-conclusion">IsHProp {cx : IsComplex i f &amp; IsConnMap n (cxfib cx)}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk38"><span class="mi">2</span>: <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>IsHSet0</var><span class="hyp-type"><b>: </b><span>IsHSet Y</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{cx : IsComplex i f &amp; IsConnMap n (cxfib cx)} =
IsExact n i f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_universe_uncurried; issig.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** With exactness we can choose preimages. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk39"><span class="kn">Lemma</span> <span class="nf">isexact_preimage</span> (<span class="nv">O</span> : Modality) {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) `{IsExact O _ _ _ i f}
  (x : X) (p : f x = point Y)
  : O (hfiber i x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = pt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">O (hfiber i x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk3a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = pt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">O (hfiber i x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk3b">rapply (O_functor O (A:=hfiber (cxfib cx_isexact) (x; p))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = pt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber (cxfib cx_isexact) (x; p) -&gt; hfiber i x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk3c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = pt</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk3c"><hr></label><div class="goal-conclusion">O (hfiber (cxfib cx_isexact) (x; p))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk3d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = pt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber (cxfib cx_isexact) (x; p) -&gt; hfiber i x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk3e"><span class="nb">intros</span> [z q].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = pt</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>cxfib cx_isexact z = (x; p)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber i x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (z; ap pr1 q).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk3f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f x = pt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">O (hfiber (cxfib cx_isexact) (x; p))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> center, conn_map_isexact.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Bundled version of the above. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk40"><span class="kn">Lemma</span> <span class="nf">isexact_preimage_hfiber</span> (<span class="nv">O</span> : Modality) {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) `{IsExact O _ _ _ i f}
  (x : hfiber f pt)
  : O (hfiber i x.<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>hfiber f pt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">O (hfiber i x.<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk41"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>hfiber f pt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">O (hfiber i x.<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">srapply isexact_preimage; <span class="bp">exact</span> x.<span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** If the base is contractible, then [i] is [O]-connected. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">isconnmap_O_isexact_base_contr</span> (<span class="nv">O</span> : Modality@{u}) {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  `{Contr Y} (i : F -&gt;* X) (f : X -&gt;* Y)
  `{IsExact@{_ _ u u u} O _ _ _ i f}
  : IsConnMap O i
  := conn_map_compose@{u _ u _} O (cxfib@{u u _ _} cx_isexact) pr1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Passage across homotopies preserves exactness. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk42"><span class="kn">Definition</span> <span class="nf">isexact_homotopic_i</span> <span class="nv">n</span>  {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  {<span class="nv">i</span> <span class="nv">i&#39;</span> : F -&gt;* X} (<span class="nv">ii</span> : i&#39; ==* i) (<span class="nv">f</span> : X -&gt;* Y)
  `{IsExact n F X Y i f}
  : IsExact n i&#39; f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i, i'</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>ii</var><span class="hyp-type"><b>: </b><span>i&#39; ==* i</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i&#39; f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk43"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i, i'</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>ii</var><span class="hyp-type"><b>: </b><span>i&#39; ==* i</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i&#39; f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk44"><span class="kr">exists</span> (<span class="nv">iscomplex_homotopic_i</span> <span class="nv">ii</span> <span class="nv">f</span> <span class="nv">cx_isexact</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i, i'</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>ii</var><span class="hyp-type"><b>: </b><span>i&#39; ==* i</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (cxfib (iscomplex_homotopic_i ii f cx_isexact))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk45"><span class="nb">refine</span> (conn_map_homotopic n (cxfib cx_isexact) _ _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i, i'</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>ii</var><span class="hyp-type"><b>: </b><span>i&#39; ==* i</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cxfib cx_isexact ==
cxfib (iscomplex_homotopic_i ii f cx_isexact)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk46"><span class="nb">intros</span> u; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i, i'</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>ii</var><span class="hyp-type"><b>: </b><span>i&#39; ==* i</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i u; cx_isexact u) =
(i&#39; u; ap f (ii u) @ cx_isexact u)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk47"><span class="nb">refine</span> (path_sigma&#39; _ (ii u)^ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i, i'</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>ii</var><span class="hyp-type"><b>: </b><span>i&#39; ==* i</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f x = pt) (ii u)^
  (cx_isexact u) = ap f (ii u) @ cx_isexact u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (transport_paths_Fl _ _ @ ((inverse2 (ap_V _ _) @ inv_V _) @@ <span class="mi">1</span>)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk48"><span class="kn">Definition</span> <span class="nf">isexact_homotopic_f</span> <span class="nv">n</span>  {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) {<span class="nv">f</span> <span class="nv">f&#39;</span> : X -&gt;* Y} (<span class="nv">ff</span> : f&#39; ==* f)
  `{IsExact n F X Y i f}
  : IsExact n i f&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i f&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk49"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i f&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk4a"><span class="kr">exists</span> (<span class="nv">iscomplex_homotopic_f</span> <span class="nv">i</span> <span class="nv">ff</span> <span class="nv">cx_isexact</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (cxfib (iscomplex_homotopic_f i ff cx_isexact))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk4b"><span class="nb">pose</span> (e := equiv_hfiber_homotopic _ _ ff pt).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (cxfib (iscomplex_homotopic_f i ff cx_isexact))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk4c">nrefine (cancelL_isequiv_conn_map n _ e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv e</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk4d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk4d"><hr></label><div class="goal-conclusion">IsConnMap n
  (<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
   e (cxfib (iscomplex_homotopic_f i ff cx_isexact) x))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk4e"><span class="mi">1</span>: <span class="nb">apply</span> equiv_isequiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
   e (cxfib (iscomplex_homotopic_f i ff cx_isexact) x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk4f"><span class="nb">refine</span> (conn_map_homotopic n (cxfib (cx_isexact)) _ _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cxfib cx_isexact ==
(<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
 e (cxfib (iscomplex_homotopic_f i ff cx_isexact) x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk50"><span class="nb">intro</span> u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cxfib cx_isexact u =
e (cxfib (iscomplex_homotopic_f i ff cx_isexact) u)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk51"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i u; cx_isexact u) =
(i u; (ff (i u))^ @ (ff (i u) @ cx_isexact u))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk52">srapply path_hfiber.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i u; cx_isexact u).<span class="mi">1</span> =
(i u; (ff (i u))^ @ (ff (i u) @ cx_isexact u)).<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk53" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk53"><hr></label><div class="goal-conclusion">(i u; cx_isexact u).<span class="mi">2</span> =
ap f <span class="nl">?q</span> @
(i u; (ff (i u))^ @ (ff (i u) @ cx_isexact u)).<span class="mi">2</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk54"><span class="mi">1</span>: <span class="bp">reflexivity</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f, f'</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>f&#39; ==* f</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>equiv_hfiber_homotopic f&#39; f ff pt</span></span><span class="hyp-type"><b>: </b><span>hfiber f&#39; pt &lt;~&gt; hfiber f pt</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i u; cx_isexact u).<span class="mi">2</span> =
ap f <span class="mi">1</span> @
(i u; (ff (i u))^ @ (ff (i u) @ cx_isexact u)).<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (concat_1p _ @ concat_V_pp _ _)^.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** And also passage across squares with equivalences. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk55"><span class="kn">Definition</span> <span class="nf">isexact_equiv_i</span> <span class="nv">n</span>  {<span class="nv">F</span> <span class="nv">F&#39;</span> <span class="nv">X</span> <span class="nv">X&#39;</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">i&#39;</span> : F&#39; -&gt;* X&#39;)
  (<span class="nv">g</span> : F&#39; &lt;~&gt;* F) (<span class="nv">h</span> : X&#39; &lt;~&gt;* X) (<span class="nv">p</span> : h o* i&#39; ==* i o* g)
  (<span class="nv">f</span> : X -&gt;* Y) `{IsExact n F X Y i f}
  : IsExact n i&#39; (f o* h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i&#39; (f o* h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk56"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i&#39; (f o* h)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk57"><span class="kr">exists</span> (<span class="nv">iscomplex_equiv_i</span> <span class="nv">i</span> <span class="nv">i&#39;</span> <span class="nv">g</span> <span class="nv">h</span> <span class="nv">p</span> <span class="nv">f</span> <span class="nv">cx_isexact</span>); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (<span class="kr">fun</span> <span class="nv">x</span> : F&#39; =&gt;
   (i&#39; x;
   <span class="mi">1</span> @ (ap f (p x) @ (<span class="mi">1</span> @ (cx_isexact (g x) @ <span class="mi">1</span>)))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk58">snrefine (cancelL_equiv_conn_map n (C := pfiber f) _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber (<span class="kr">fun</span> <span class="nv">x</span> : X&#39; =&gt; f (h x)) pt &lt;~&gt; pfiber f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk59" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk59"><hr></label><div class="goal-conclusion">IsConnMap n
  (<span class="nl">?g</span>
   o (<span class="kr">fun</span> <span class="nv">x</span> : F&#39; =&gt;
      (i&#39; x;
      <span class="mi">1</span> @ (ap f (p x) @ (<span class="mi">1</span> @ (cx_isexact (g x) @ <span class="mi">1</span>))))))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk5a">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hfiber (<span class="kr">fun</span> <span class="nv">x</span> : X&#39; =&gt; f (h x)) pt &lt;~&gt; pfiber f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (@equiv_functor_hfiber _ _ _ _ (f o h) f h equiv_idmap
             (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="mi">1</span>%path) (point Y)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk5b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (equiv_functor_hfiber (<span class="kr">fun</span> <span class="nv">x</span> : X&#39; =&gt; <span class="mi">1</span>) pt
   o (<span class="kr">fun</span> <span class="nv">x</span> : F&#39; =&gt;
      (i&#39; x;
      <span class="mi">1</span> @ (ap f (p x) @ (<span class="mi">1</span> @ (cx_isexact (g x) @ <span class="mi">1</span>))))))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk5c"><span class="nb">cbn</span>; <span class="nb">unfold</span> functor_hfiber, functor_sigma; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (<span class="kr">fun</span> <span class="nv">x</span> : F&#39; =&gt;
   (h (i&#39; x);
   <span class="mi">1</span> @
   ap idmap
     (<span class="mi">1</span> @ (ap f (p x) @ (<span class="mi">1</span> @ (cx_isexact (g x) @ <span class="mi">1</span>))))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk5d"><span class="nb">refine</span> (conn_map_homotopic n (@cxfib _ _ _ i f cx_isexact o g) _ _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : F&#39; =&gt; cxfib cx_isexact (g x)) ==
(<span class="kr">fun</span> <span class="nv">x</span> : F&#39; =&gt;
 (h (i&#39; x);
 <span class="mi">1</span> @
 ap idmap
   (<span class="mi">1</span> @ (ap f (p x) @ (<span class="mi">1</span> @ (cx_isexact (g x) @ <span class="mi">1</span>))))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk5e"><span class="nb">intros</span> u; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i (g u); cx_isexact (g u)) =
(h (i&#39; u);
<span class="mi">1</span> @
ap idmap
  (<span class="mi">1</span> @ (ap f (p u) @ (<span class="mi">1</span> @ (cx_isexact (g u) @ <span class="mi">1</span>)))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk5f"><span class="nb">refine</span> (path_sigma&#39; _ (p u)^ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f x = pt) (p u)^
  (cx_isexact (g u)) =
<span class="mi">1</span> @
ap idmap
  (<span class="mi">1</span> @ (ap f (p u) @ (<span class="mi">1</span> @ (cx_isexact (g u) @ <span class="mi">1</span>))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">abstract</span> (
        <span class="nb">rewrite</span> transport_paths_Fl, ap_V, inv_V,
        !concat_1p, concat_p1, ap_idmap;
        <span class="bp">reflexivity</span>
      ).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** In particular, we can transfer exactness across equivalences of the total space. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk60"><span class="kn">Definition</span> <span class="nf">moveL_isexact_equiv</span> <span class="nv">n</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">X&#39;</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X&#39; -&gt;* Y) (<span class="nv">phi</span> : X &lt;~&gt;* X&#39;)
  `{IsExact n _ _ _ (phi o* i) f}
  : IsExact n i (f o* phi).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>X &lt;~&gt;* X&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n (phi o* i) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i (f o* phi)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk61"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>X &lt;~&gt;* X&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n (phi o* i) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i (f o* phi)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk62">rapply (isexact_equiv_i _ _ _ pequiv_pmap_idmap phi); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, X', Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>X &lt;~&gt;* X&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n (phi o* i) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">phi o* i ==* phi o* i o* pmap_idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (pmap_precompose_idmap _)^*.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Similarly, we can cancel equivalences on the fiber. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk63"><span class="kn">Definition</span> <span class="nf">isexact_equiv_fiber</span> <span class="nv">n</span> {<span class="nv">F</span> <span class="nv">F&#39;</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) (<span class="nv">phi</span> : F&#39; &lt;~&gt;* F)
  `{E : IsExact n _ _ _ i f}
  : IsExact n (i o* phi) f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n (i o* phi) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk64"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n (i o* phi) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk65">snapply Build_IsExact.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (i o* phi) f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk66" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk66"><hr></label><div class="goal-conclusion">IsConnMap n (cxfib <span class="nl">?cx_isexact</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk67"><span class="mi">1</span>: <span class="nb">apply</span> iscomplex_equiv_fiber, cx_isexact.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n (cxfib (iscomplex_equiv_fiber i f phi))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk68"><span class="nb">apply</span> (conn_map_homotopic _ (cxfib cx_isexact o* phi)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cxfib cx_isexact o* phi ==
cxfib (iscomplex_equiv_fiber i f phi)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk69" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk69"><hr></label><div class="goal-conclusion">IsConnMap n (cxfib cx_isexact o* phi)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk6a">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cxfib cx_isexact o* phi ==
cxfib (iscomplex_equiv_fiber i f phi)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk6b"><span class="nb">intro</span> x; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i (phi x); cx_isexact (phi x)) =
(i (phi x); <span class="mi">1</span> @ (cx_isexact (phi x) @ <span class="mi">1</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> concat_p1, concat_1p.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk6c">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>phi</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>E</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n (cxfib cx_isexact o* phi)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** An equivalence of short sequences preserves exactness. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk6d"><span class="kn">Definition</span> <span class="nf">isexact_square_if</span> <span class="nv">n</span>  {<span class="nv">F</span> <span class="nv">F&#39;</span> <span class="nv">X</span> <span class="nv">X&#39;</span> <span class="nv">Y</span> <span class="nv">Y&#39;</span> : pType}
  {<span class="nv">i</span> : F -&gt;* X} {<span class="nv">i&#39;</span> : F&#39; -&gt;* X&#39;}
  {<span class="nv">f</span> : X -&gt;* Y} {<span class="nv">f&#39;</span> : X&#39; -&gt;* Y&#39;}
  (<span class="nv">g</span> : F&#39; &lt;~&gt;* F) (<span class="nv">h</span> : X&#39; &lt;~&gt;* X) (<span class="nv">k</span> : Y&#39; &lt;~&gt;* Y)
  (<span class="nv">p</span> : h o* i&#39; ==* i o* g) (<span class="nv">q</span> : k o* f&#39; ==* f o* h)
  `{IsExact n F X Y i f}
  : IsExact n i&#39; f&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i&#39; f&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk6e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i&#39; f&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk6f"><span class="nb">pose</span> (I := isexact_equiv_i n i i&#39; g h p f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i&#39; f&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk70"><span class="nb">pose</span> (I2 := isexact_homotopic_f n i&#39; q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact n i&#39; f&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk71"><span class="kr">exists</span> (<span class="nv">iscomplex_cancelL</span> <span class="nv">i&#39;</span> <span class="nv">f&#39;</span> <span class="nv">k</span> <span class="nv">cx_isexact</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk72"><span class="nb">epose</span> (e := (pequiv_pfiber pequiv_pmap_idmap k (pmap_precompose_idmap (k o* f&#39;))^*
    : pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk73">nrefine (cancelL_isequiv_conn_map n _ e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv e</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk74" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk74"><hr></label><div class="goal-conclusion">IsConnMap n
  (<span class="kr">fun</span> <span class="nv">x</span> : F&#39; =&gt;
   e (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact) x))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk75"><span class="mi">1</span>: <span class="nb">apply</span> pointed_isequiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap n
  (<span class="kr">fun</span> <span class="nv">x</span> : F&#39; =&gt;
   e (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact) x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk76"><span class="nb">refine</span> (conn_map_homotopic n (cxfib (cx_isexact)) _ _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cxfib cx_isexact ==
(<span class="kr">fun</span> <span class="nv">x</span> : F&#39; =&gt;
 e (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact) x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk77"><span class="nb">intro</span> u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cxfib cx_isexact u =
e (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact) u)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk78">srapply path_hfiber.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(cxfib cx_isexact u).<span class="mi">1</span> =
(e (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact) u)).<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk79" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk79"><hr></label><div class="goal-conclusion">(cxfib cx_isexact u).<span class="mi">2</span> =
ap (k o* f&#39;) <span class="nl">?q</span> @
(e (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact) u)).<span class="mi">2</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk7a">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(cxfib cx_isexact u).<span class="mi">1</span> =
(e (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact) u)).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk7b">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(cxfib cx_isexact u).<span class="mi">2</span> =
ap (k o* f&#39;) <span class="mi">1</span> @
(e (cxfib (iscomplex_cancelL i&#39; f&#39; k cx_isexact) u)).<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk7c"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q (i&#39; u) @
(<span class="mi">1</span> @ (ap f (p u) @ (<span class="mi">1</span> @ (cx_isexact (g u) @ <span class="mi">1</span>)))) =
<span class="mi">1</span> @
((<span class="mi">1</span> @
  ap k
    ((((<span class="mi">1</span> @ (<span class="mi">1</span> @ eissect k (f&#39; (i&#39; u)))) @ <span class="mi">1</span>)^ @
      ap k^-<span class="mi">1</span>
        (<span class="mi">1</span> @
         (q (i&#39; u) @
          (<span class="mi">1</span> @
           (ap f (p u) @ (<span class="mi">1</span> @ (cx_isexact (g u) @ <span class="mi">1</span>))))))) @
     moveR_equiv_V pt pt (point_eq k)^)) @ point_eq k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk7d"><span class="nb">unfold</span> moveR_equiv_V.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q (i&#39; u) @
(<span class="mi">1</span> @ (ap f (p u) @ (<span class="mi">1</span> @ (cx_isexact (g u) @ <span class="mi">1</span>)))) =
<span class="mi">1</span> @
((<span class="mi">1</span> @
  ap k
    ((((<span class="mi">1</span> @ (<span class="mi">1</span> @ eissect k (f&#39; (i&#39; u)))) @ <span class="mi">1</span>)^ @
      ap k^-<span class="mi">1</span>
        (<span class="mi">1</span> @
         (q (i&#39; u) @
          (<span class="mi">1</span> @
           (ap f (p u) @ (<span class="mi">1</span> @ (cx_isexact (g u) @ <span class="mi">1</span>))))))) @
     (ap k^-<span class="mi">1</span> (point_eq k)^ @ eissect k pt))) @
 point_eq k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk7e"><span class="nb">rewrite</span> !concat_1p, !concat_p1, ap_pp_p, ap_pp, (ap_pp k _ (eissect k (point Y&#39;))), ap_V, &lt;- !eisadj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q (i&#39; u) @ (ap f (p u) @ cx_isexact (g u)) =
((eisretr k (k (f&#39; (i&#39; u))))^ @
 ap k
   (ap k^-<span class="mi">1</span>
      (q (i&#39; u) @ (ap f (p u) @ cx_isexact (g u))))) @
((ap k (ap k^-<span class="mi">1</span> (point_eq k)^) @ eisretr k (k pt)) @
 point_eq k)</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk7f"><span class="nb">rewrite</span> &lt;- !ap_compose, concat_pp_p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q (i&#39; u) @ (ap f (p u) @ cx_isexact (g u)) =
(eisretr k (k (f&#39; (i&#39; u))))^ @
(ap (<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; k (k^-<span class="mi">1</span> x))
   (q (i&#39; u) @ (ap f (p u) @ cx_isexact (g u))) @
 ((ap (<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; k (k^-<span class="mi">1</span> x)) (point_eq k)^ @
   eisretr k (k pt)) @ point_eq k))</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk80"><span class="nb">rewrite</span> (concat_A1p (eisretr k)), concat_pV_p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q (i&#39; u) @ (ap f (p u) @ cx_isexact (g u)) =
(eisretr k (k (f&#39; (i&#39; u))))^ @
(ap (<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; k (k^-<span class="mi">1</span> x))
   (q (i&#39; u) @ (ap f (p u) @ cx_isexact (g u))) @
 eisretr k pt)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk81"><span class="nb">rewrite</span> (concat_A1p (eisretr k)), concat_V_pp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, F', X, X', Y, Y'</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>i'</var><span class="hyp-type"><b>: </b><span>F&#39; -&gt;* X&#39;</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>f'</var><span class="hyp-type"><b>: </b><span>X&#39; -&gt;* Y&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>F&#39; &lt;~&gt;* F</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>X&#39; &lt;~&gt;* X</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Y&#39; &lt;~&gt;* Y</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>h o* i&#39; ==* i o* g</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k o* f&#39; ==* f o* h</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact n i f</span></span></span><br><span><var>I</var><span><span class="hyp-body"><b>:= </b><span>isexact_equiv_i n i i&#39; g h p f</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (f o* h)</span></span></span></span><br><span><var>I2</var><span><span class="hyp-body"><b>:= </b><span>isexact_homotopic_f n i&#39; q</span></span><span class="hyp-type"><b>: </b><span>IsExact n i&#39; (k o* f&#39;)</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>pequiv_pfiber pequiv_pmap_idmap k
  (pmap_precompose_idmap (k o* f&#39;))^*
:
pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span><span class="hyp-type"><b>: </b><span>pfiber f&#39; &lt;~&gt;* pfiber (k o* f&#39;)</span></span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q (i&#39; u) @ (ap f (p u) @ cx_isexact (g u)) =
q (i&#39; u) @ (ap f (p u) @ cx_isexact (g u))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** If a complex [F -&gt; E -&gt; B] is [O]-exact, the map [F -&gt; B] is [O]-local, and path types in [Y] are [O]-local, then the induced map [cxfib] is an equivalence. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk82"><span class="kn">Instance</span> <span class="nf">isequiv_cxfib</span> {<span class="nv">O</span> : Modality} {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} {<span class="nv">i</span> : F -&gt;* X} {<span class="nv">f</span> : X -&gt;* Y}
  `{<span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In O (y = y&#39;)} `{MapIn O _ _ i} (ex : IsExact O i f)
  : IsEquiv (cxfib cx_isexact).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In O (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn O i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (cxfib cx_isexact)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk83"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In O (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn O i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (cxfib cx_isexact)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk84">rapply isequiv_conn_ino_map.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In O (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn O i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap <span class="nl">?Goal</span> (cxfib cx_isexact)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk85" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In O (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn O i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk85"><hr></label><div class="goal-conclusion">MapIn <span class="nl">?Goal</span> (cxfib cx_isexact)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk86"><span class="mi">1</span>: <span class="nb">apply</span> ex.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In O (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn O i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact O i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">MapIn O (cxfib cx_isexact)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">rapply (cancelL_mapinO _ _ pr1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_cxfib</span> {<span class="nv">O</span> : Modality} {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} {<span class="nv">i</span> : F -&gt;* X} {<span class="nv">f</span> : X -&gt;* Y}
  `{<span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In O (y = y&#39;)} `{MapIn O _ _ i} (ex : IsExact O i f)
  : F &lt;~&gt;* pfiber f
  := Build_pEquiv _ (isequiv_cxfib ex).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk87"><span class="kn">Proposition</span> <span class="nf">equiv_cxfib_beta</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} {<span class="nv">i</span> : F -&gt;* X} {<span class="nv">f</span> : X -&gt;* Y}
  `{<span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In O (y = y&#39;)} `{MapIn O _ _ i} (ex : IsExact O i f)
  : i o pequiv_inverse (equiv_cxfib ex) == pfib _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In (Tr <span class="mi">0</span>%nat) (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn (Tr <span class="mi">0</span>%nat) i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact (Tr <span class="mi">0</span>%nat) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i o pequiv_inverse (equiv_cxfib ex) == pfib f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk88"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In (Tr <span class="mi">0</span>%nat) (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn (Tr <span class="mi">0</span>%nat) i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact (Tr <span class="mi">0</span>%nat) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i o pequiv_inverse (equiv_cxfib ex) == pfib f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk89">rapply equiv_ind.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In (Tr <span class="mi">0</span>%nat) (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn (Tr <span class="mi">0</span>%nat) i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact (Tr <span class="mi">0</span>%nat) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv <span class="nl">?Goal0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk8a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In (Tr <span class="mi">0</span>%nat) (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn (Tr <span class="mi">0</span>%nat) i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact (Tr <span class="mi">0</span>%nat) i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk8a"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : <span class="nl">?Goal</span>,
i (pequiv_inverse (equiv_cxfib ex) (<span class="nl">?Goal0</span> x)) =
pfib f (<span class="nl">?Goal0</span> x)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk8b"><span class="mi">1</span>: <span class="bp">exact</span> (isequiv_cxfib ex).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In (Tr <span class="mi">0</span>%nat) (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn (Tr <span class="mi">0</span>%nat) i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact (Tr <span class="mi">0</span>%nat) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : F,
i
  (pequiv_inverse (equiv_cxfib ex)
     (cxfib cx_isexact x)) =
pfib f (cxfib cx_isexact x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk8c"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">y</span> <span class="nv">y&#39;</span> : Y, In (Tr <span class="mi">0</span>%nat) (y = y&#39;)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>MapIn (Tr <span class="mi">0</span>%nat) i</span></span></span><br><span><var>ex</var><span class="hyp-type"><b>: </b><span>IsExact (Tr <span class="mi">0</span>%nat) i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i
  (pequiv_inverse (equiv_cxfib ex)
     (cxfib cx_isexact x)) =
pfib f (cxfib cx_isexact x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap (<span class="kr">fun</span> <span class="nv">g</span> =&gt; i g) (eissect _ x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** A purely exact sequence is [O]-exact for any modality [O]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk8d"><span class="kn">Definition</span> <span class="nf">isexact_purely_O</span> {<span class="nv">O</span> : Modality} {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) `{IsExact purely _ _ _ i f}
  : IsExact O i f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact O i f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk8e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact O i f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk8f">srapply Build_IsExact.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex i f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk90" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk90"><hr></label><div class="goal-conclusion">IsConnMap O (cxfib <span class="nl">?cx_isexact</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk91"><span class="mi">1</span>: <span class="bp">exact</span> cx_isexact.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>O</var><span class="hyp-type"><b>: </b><span>Modality</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap O (cxfib cx_isexact)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** When [n] is the identity modality [purely], so that [cxfib] is an equivalence, we get simply a fiber sequence.  In particular, the fiber of a given map yields an purely-exact sequence. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk92"><span class="kn">Definition</span> <span class="nf">iscomplex_pfib</span> {<span class="nv">X</span> <span class="nv">Y</span>} (<span class="nv">f</span> : X -&gt;* Y)
  : IsComplex (pfib f) f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (pfib f) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk93"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsComplex (pfib f) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk94">srapply Build_pHomotopy.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o* pfib f == pconst</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk95" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk95"><hr></label><div class="goal-conclusion"><span class="nl">?p</span> pt = dpoint_eq (f o* pfib f) @ (dpoint_eq pconst)^</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk96">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o* pfib f == pconst</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> [x p]; <span class="bp">exact</span> p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk97">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">fun</span> <span class="nv">x0</span> : pfiber f =&gt; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; idmap) x0.<span class="mi">1</span> x0.<span class="mi">2</span>)
 :
 f o* pfib f == pconst) pt =
dpoint_eq (f o* pfib f) @ (dpoint_eq pconst)^</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk98"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">point_eq f = (<span class="mi">1</span> @ point_eq f) @ <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (concat_p1 _ @ concat_1p _)^.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk99"><span class="kn">Instance</span> <span class="nf">isexact_pfib</span> {<span class="nv">X</span> <span class="nv">Y</span>} (<span class="nv">f</span> : X -&gt;* Y)
  : IsExact purely (pfib f) f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (pfib f) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk9a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (pfib f) f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk9b"><span class="kr">exists</span> (<span class="nv">iscomplex_pfib</span> <span class="nv">f</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap purely (cxfib (iscomplex_pfib f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Fiber sequences can alternatively be defined as an equivalence to the fiber of some map. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">FiberSeq</span> (<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType) := { f : X -&gt;* Y &amp; F &lt;~&gt;* pfiber f }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">i_fiberseq</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span>} (<span class="nv">fs</span> : FiberSeq F X Y)
  : F -&gt;* X
  := pfib fs.<span class="mi">1</span> o* fs.<span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk9c"><span class="kn">Instance</span> <span class="nf">isexact_purely_fiberseq</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} (<span class="nv">fs</span> : FiberSeq F X Y)
  : IsExact purely (i_fiberseq fs) fs.<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (i_fiberseq fs) fs.<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk9d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (i_fiberseq fs) fs.<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk9e">srapply Build_IsExact; [ srapply Build_pHomotopy | ].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fs.<span class="mi">1</span> o* i_fiberseq fs == pconst</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk9f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk9f"><hr></label><div class="goal-conclusion"><span class="nl">?p</span> pt =
dpoint_eq (fs.<span class="mi">1</span> o* i_fiberseq fs) @
(dpoint_eq pconst)^</div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chka0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chka0"><hr></label><div class="goal-conclusion">IsConnMap purely (cxfib (Build_pHomotopy <span class="nl">?p</span> <span class="nl">?q</span>))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fs.<span class="mi">1</span> o* i_fiberseq fs == pconst</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka2"><span class="nb">intros</span> u; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fs.<span class="mi">1</span> (fs.<span class="mi">2</span> u).<span class="mi">1</span> = pt</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((fs.<span class="mi">2</span> u).<span class="mi">2</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">fun</span> <span class="nv">u</span> : F =&gt;
  (fs.<span class="mi">2</span> u).<span class="mi">2</span> : (fs.<span class="mi">1</span> o* i_fiberseq fs) u = pconst u)
 :
 fs.<span class="mi">1</span> o* i_fiberseq fs == pconst) pt =
dpoint_eq (fs.<span class="mi">1</span> o* i_fiberseq fs) @
(dpoint_eq pconst)^</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka4"><span class="nb">apply</span> moveL_pV.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(fs.<span class="mi">2</span> pt).<span class="mi">2</span> @ dpoint_eq pconst =
dpoint_eq (fs.<span class="mi">1</span> o* i_fiberseq fs)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka5"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(fs.<span class="mi">2</span> pt).<span class="mi">2</span> @ <span class="mi">1</span> =
ap fs.<span class="mi">1</span> (ap pr1 (point_eq fs.<span class="mi">2</span>) @ <span class="mi">1</span>) @ point_eq fs.<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka6"><span class="nb">refine</span> (concat_p1 _ @ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(fs.<span class="mi">2</span> pt).<span class="mi">2</span> =
ap fs.<span class="mi">1</span> (ap pr1 (point_eq fs.<span class="mi">2</span>) @ <span class="mi">1</span>) @ point_eq fs.<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka7"><span class="nb">apply</span> moveL_Mp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ap fs.<span class="mi">1</span> (ap pr1 (point_eq fs.<span class="mi">2</span>) @ <span class="mi">1</span>))^ @ (fs.<span class="mi">2</span> pt).<span class="mi">2</span> =
point_eq fs.<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka8"><span class="nb">refine</span> (_ @ (point_eq fs.<span class="mi">2</span>)..<span class="mi">2</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ap fs.<span class="mi">1</span> (ap pr1 (point_eq fs.<span class="mi">2</span>) @ <span class="mi">1</span>))^ @ (fs.<span class="mi">2</span> pt).<span class="mi">2</span> =
transport (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; fs.<span class="mi">1</span> x = pt)
  (point_eq fs.<span class="mi">2</span>) ..<span class="mi">1</span> (fs.<span class="mi">2</span> pt).<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chka9"><span class="nb">refine</span> (_ @ (transport_paths_Fl _ _)^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ap fs.<span class="mi">1</span> (ap pr1 (point_eq fs.<span class="mi">2</span>) @ <span class="mi">1</span>))^ @ (fs.<span class="mi">2</span> pt).<span class="mi">2</span> =
(ap fs.<span class="mi">1</span> (point_eq fs.<span class="mi">2</span>) ..<span class="mi">1</span>)^ @ (fs.<span class="mi">2</span> pt).<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> whiskerR, inverse2, ap, concat_p1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkaa">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap purely
  (cxfib
     (Build_pHomotopy
        ((<span class="kr">fun</span> <span class="nv">u</span> : F =&gt;
          (fs.<span class="mi">2</span> u).<span class="mi">2</span>
          :
          (fs.<span class="mi">1</span> o* i_fiberseq fs) u = pconst u)
         :
         fs.<span class="mi">1</span> o* i_fiberseq fs == pconst)
        (moveL_pV (dpoint_eq pconst) (fs.<span class="mi">2</span> pt).<span class="mi">2</span>
           (dpoint_eq (fs.<span class="mi">1</span> o* i_fiberseq fs))
           (concat_p1 (fs.<span class="mi">2</span> pt).<span class="mi">2</span> @
            moveL_Mp (point_eq fs.<span class="mi">1</span>) (fs.<span class="mi">2</span> pt).<span class="mi">2</span>
              (ap fs.<span class="mi">1</span> (ap pr1 (point_eq fs.<span class="mi">2</span>) @ <span class="mi">1</span>))
              ((whiskerR
                  (inverse2
                     (ap (ap fs.<span class="mi">1</span>)
                        (concat_p1 (point_eq fs.<span class="mi">2</span>) ..<span class="mi">1</span>)))
                  (fs.<span class="mi">2</span> pt).<span class="mi">2</span> @
                (transport_paths_Fl
                   (point_eq fs.<span class="mi">2</span>) ..<span class="mi">1</span> (fs.<span class="mi">2</span> pt).<span class="mi">2</span>)^) @
               (point_eq fs.<span class="mi">2</span>) ..<span class="mi">2</span>)
            :
            (fs.<span class="mi">2</span> pt).<span class="mi">2</span> @ dpoint_eq pconst =
            dpoint_eq (fs.<span class="mi">1</span> o* i_fiberseq fs)))))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkab"><span class="nb">intros</span> [x p].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fs.<span class="mi">1</span> x = pt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnected purely
  (hfiber
     (cxfib
        (Build_pHomotopy (<span class="kr">fun</span> <span class="nv">u</span> : F =&gt; (fs.<span class="mi">2</span> u).<span class="mi">2</span>)
           (moveL_pV (dpoint_eq pconst) (fs.<span class="mi">2</span> pt).<span class="mi">2</span>
              (dpoint_eq (fs.<span class="mi">1</span> o* i_fiberseq fs))
              (concat_p1 (fs.<span class="mi">2</span> pt).<span class="mi">2</span> @
               moveL_Mp (point_eq fs.<span class="mi">1</span>) (fs.<span class="mi">2</span> pt).<span class="mi">2</span>
                 (ap fs.<span class="mi">1</span> (ap pr1 (point_eq fs.<span class="mi">2</span>) @ <span class="mi">1</span>))
                 ((whiskerR
                     (inverse2
                        (ap (ap fs.<span class="mi">1</span>)
                           (concat_p1
                              (point_eq fs.<span class="mi">2</span>) ..<span class="mi">1</span>)))
                     (fs.<span class="mi">2</span> pt).<span class="mi">2</span> @
                   (transport_paths_Fl
                      (point_eq fs.<span class="mi">2</span>) ..<span class="mi">1</span> (fs.<span class="mi">2</span> pt).<span class="mi">2</span>)^) @
                  (point_eq fs.<span class="mi">2</span>) ..<span class="mi">2</span>))))) (x; p))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkac"><span class="nb">apply</span> contr_map_isequiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fs.<span class="mi">1</span> x = pt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  (cxfib
     (Build_pHomotopy (<span class="kr">fun</span> <span class="nv">u</span> : F =&gt; (fs.<span class="mi">2</span> u).<span class="mi">2</span>)
        (moveL_pV (dpoint_eq pconst) (fs.<span class="mi">2</span> pt).<span class="mi">2</span>
           (dpoint_eq (fs.<span class="mi">1</span> o* i_fiberseq fs))
           (concat_p1 (fs.<span class="mi">2</span> pt).<span class="mi">2</span> @
            moveL_Mp (point_eq fs.<span class="mi">1</span>) (fs.<span class="mi">2</span> pt).<span class="mi">2</span>
              (ap fs.<span class="mi">1</span> (ap pr1 (point_eq fs.<span class="mi">2</span>) @ <span class="mi">1</span>))
              ((whiskerR
                  (inverse2
                     (ap (ap fs.<span class="mi">1</span>)
                        (concat_p1 (point_eq fs.<span class="mi">2</span>) ..<span class="mi">1</span>)))
                  (fs.<span class="mi">2</span> pt).<span class="mi">2</span> @
                (transport_paths_Fl
                   (point_eq fs.<span class="mi">2</span>) ..<span class="mi">1</span> (fs.<span class="mi">2</span> pt).<span class="mi">2</span>)^) @
               (point_eq fs.<span class="mi">2</span>) ..<span class="mi">2</span>)))))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">change</span> (IsEquiv fs.<span class="mi">2</span>); <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">pequiv_cxfib</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} {<span class="nv">i</span> : F -&gt;* X} {<span class="nv">f</span> : X -&gt;* Y}
  `{IsExact purely F X Y i f}
  : F &lt;~&gt;* pfiber f
  := Build_pEquiv (cxfib cx_isexact) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fiberseq_isexact_purely</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType} (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y)
  `{IsExact purely F X Y i f} : FiberSeq F X Y
  := (f; pequiv_cxfib).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** It&#39;s easier to show that [loops] preserves fiber sequences than that it preserves purely-exact sequences. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkad"><span class="kn">Definition</span> <span class="nf">fiberseq_loops</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span>} (<span class="nv">fs</span> : FiberSeq F X Y)
  : FiberSeq (loops F) (loops X) (loops Y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FiberSeq (loops F) (loops X) (loops Y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkae"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FiberSeq (loops F) (loops X) (loops Y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="sd">(** TODO: doesn&#39;t work?! *)</span>
<span class="c">(*   exists (fmap loops fs.1). *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkaf"><span class="nb">refine</span> (fmap loops fs.<span class="mi">1</span>; _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">loops F &lt;~&gt;* pfiber (fmap loops fs.<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb0"><span class="nb">refine</span> (_ o*E emap loops fs.<span class="mi">2</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>FiberSeq F X Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">loops (pfiber fs.<span class="mi">1</span>) &lt;~&gt;* pfiber (fmap loops fs.<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (pfiber_fmap_loops fs.<span class="mi">1</span>)^-<span class="mi">1</span>*.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Now we can deduce that [loops] preserves purely-exact sequences. The hardest part is modifying the first map back to [fmap loops i]. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb1"><span class="kn">Instance</span> <span class="nf">isexact_loops</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span>} (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y)
  `{IsExact purely F X Y i f}
  : IsExact purely (fmap loops i) (fmap loops f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (fmap loops i) (fmap loops f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (fmap loops i) (fmap loops f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb3"><span class="nb">refine</span> (@isexact_homotopic_i purely _ _ _ _ (fmap loops i) _ (fmap loops f)
    (isexact_purely_fiberseq (fiberseq_loops (fiberseq_isexact_purely i f)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap loops i ==*
i_fiberseq
  (fiberseq_loops (fiberseq_isexact_purely i f))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb4"><span class="nb">transitivity</span> (fmap loops (pfib f) o* fmap loops (cxfib cx_isexact)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap loops i ==*
fmap loops (pfib f) o* fmap loops (cxfib cx_isexact)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkb5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkb5"><hr></label><div class="goal-conclusion">fmap loops (pfib f) o* fmap loops (cxfib cx_isexact) ==*
i_fiberseq
  (fiberseq_loops (fiberseq_isexact_purely i f))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap loops i ==*
fmap loops (pfib f) o* fmap loops (cxfib cx_isexact)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb7"><span class="nb">refine</span> (_ @* fmap_comp loops _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap loops i ==*
fmap loops (pfib f $o cxfib cx_isexact)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb8">tapply (fmap2 loops).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i $== pfib f $o cxfib cx_isexact</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">symmetry</span>; <span class="nb">apply</span> pfib_cxfib.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkb9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap loops (pfib f) o* fmap loops (cxfib cx_isexact) ==*
i_fiberseq
  (fiberseq_loops (fiberseq_isexact_purely i f))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkba"><span class="nb">refine</span> (_ @* pmap_compose_assoc _ _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap loops (pfib f) o* fmap loops (cxfib cx_isexact) ==*
pfib (fiberseq_loops (fiberseq_isexact_purely i f)).<span class="mi">1</span>
o* (pfiber_fmap_loops (fiberseq_isexact_purely i f).<span class="mi">1</span>)^-<span class="mi">1</span>*
o* emap loops (fiberseq_isexact_purely i f).<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkbb"><span class="nb">refine</span> (pmap_prewhisker (fmap loops (cxfib cx_isexact)) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap loops (pfib f) ==*
pfib (fiberseq_loops (fiberseq_isexact_purely i f)).<span class="mi">1</span>
o* (pfiber_fmap_loops (fiberseq_isexact_purely i f).<span class="mi">1</span>)^-<span class="mi">1</span>*</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkbc"><span class="nb">apply</span> moveR_pequiv_fV.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fmap loops (pfib f)
o* pfiber_fmap_loops (fiberseq_isexact_purely i f).<span class="mi">1</span> ==*
pfib (fiberseq_loops (fiberseq_isexact_purely i f)).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> pr1_pfiber_fmap_loops.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkbd"><span class="kn">Instance</span> <span class="nf">isexact_iterated_loops</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span>}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) `{IsExact purely F X Y i f} (n : nat)
  : IsExact purely (fmap (iterated_loops n) i) (fmap (iterated_loops n) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (fmap (iterated_loops n) i)
  (fmap (iterated_loops n) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkbe"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (fmap (iterated_loops n) i)
  (fmap (iterated_loops n) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> n <span class="kr">as</span> [|n IHn]; [ <span class="bp">assumption</span> | <span class="nb">apply</span> isexact_loops; <span class="bp">assumption</span> ].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** (n.+1)-truncation preserves n-exactness. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkbf"><span class="kn">Instance</span> <span class="nf">isexact_ptr</span> `{Univalence} (n : trunc_index)
  {F X Y : pType} (i : F -&gt;* X) (f : X -&gt;* Y)
  `{IsExact (Tr n) F X Y i f}
  : IsExact (Tr n) (fmap (pTr n.+<span class="mi">1</span>) i) (fmap (pTr n.+<span class="mi">1</span>) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact (Tr n) (fmap (pTr n.+<span class="mi">1</span>) i) (fmap (pTr n.+<span class="mi">1</span>) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkc0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact (Tr n) (fmap (pTr n.+<span class="mi">1</span>) i) (fmap (pTr n.+<span class="mi">1</span>) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkc1"><span class="kr">exists</span> (<span class="nv">iscomplex_ptr</span> <span class="nv">n</span>.+<span class="mi">1</span> i f cx_isexact).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr n)
  (cxfib (iscomplex_ptr n.+<span class="mi">1</span> i f cx_isexact))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkc2">srefine (cancelR_conn_map (Tr n) (@tr n.+<span class="mi">1</span> F) 
    (@cxfib _ _ _ (fmap (pTr n.+<span class="mi">1</span>) i) (fmap (pTr n.+<span class="mi">1</span>) f) _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr n) tr</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkc3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkc3"><hr></label><div class="goal-conclusion">IsConnMap (Tr n)
  (cxfib (iscomplex_ptr n.+<span class="mi">1</span> i f cx_isexact) o tr)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkc4">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr n) tr</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> x; rapply isconnected_pred.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkc5">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr n)
  (cxfib (iscomplex_ptr n.+<span class="mi">1</span> i f cx_isexact) o tr)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkc6">napply conn_map_homotopic.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> ==
(<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
 cxfib (iscomplex_ptr n.+<span class="mi">1</span> i f cx_isexact) (tr x))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkc7"><hr></label><div class="goal-conclusion">IsConnMap (Tr n) <span class="nl">?Goal</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkc8"><span class="mi">2</span>:napply (conn_map_compose _ (cxfib _)
               (functor_hfiber (<span class="kr">fun</span> <span class="nv">y</span> =&gt; (to_O_natural (Tr n.+<span class="mi">1</span>) f y)^)
                               (point Y))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
 functor_hfiber
   (<span class="kr">fun</span> <span class="nv">y</span> : X =&gt; (to_O_natural (Tr n.+<span class="mi">1</span>) f y)^) pt
   (cxfib <span class="nl">?Goal1</span> x)) ==
(<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
 cxfib (iscomplex_ptr n.+<span class="mi">1</span> i f cx_isexact) (tr x))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkc9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkc9"><hr></label><div class="goal-conclusion">IsConnMap (Tr n) (cxfib <span class="nl">?Goal1</span>)</div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkca" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkca"><hr></label><div class="goal-conclusion">IsConnMap (Tr n)
  (functor_hfiber
     (<span class="kr">fun</span> <span class="nv">y</span> : X =&gt; (to_O_natural (Tr n.+<span class="mi">1</span>) f y)^) pt)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkcb"><span class="mi">3</span>:<span class="nb">pose</span> @O_lex_leq_Tr; rapply (OO_conn_map_functor_hfiber_to_O).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
 functor_hfiber
   (<span class="kr">fun</span> <span class="nv">y</span> : X =&gt; (to_O_natural (Tr n.+<span class="mi">1</span>) f y)^) pt
   (cxfib <span class="nl">?Goal1</span> x)) ==
(<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
 cxfib (iscomplex_ptr n.+<span class="mi">1</span> i f cx_isexact) (tr x))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkcc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkcc"><hr></label><div class="goal-conclusion">IsConnMap (Tr n) (cxfib <span class="nl">?Goal1</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkcd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
 functor_hfiber
   (<span class="kr">fun</span> <span class="nv">y</span> : X =&gt; (to_O_natural (Tr n.+<span class="mi">1</span>) f y)^) pt
   (cxfib <span class="nl">?Goal1</span> x)) ==
(<span class="kr">fun</span> <span class="nv">x</span> : F =&gt;
 cxfib (iscomplex_ptr n.+<span class="mi">1</span> i f cx_isexact) (tr x))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkce"><span class="nb">intros</span> x; <span class="nb">refine</span> (path_sigma&#39; _ <span class="mi">1</span> _); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>F</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((to_O_natural (Tr n.+<span class="mi">1</span>) f (i x))^)^ @ ap tr (<span class="nl">?Goal</span> x) =
<span class="mi">1</span> @ (ap tr (cx_isexact x) @ <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* This is even simpler than it looks, because for truncations [to_O_natural n.+1 := 1], [to n.+1 := tr], and [cx_const := H]. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="mi">1</span> @@ (concat_p1 _)^).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkcf">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact (Tr n) i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr n) (cxfib cx_isexact)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** In particular, (n.+1)-truncation takes fiber sequences to n-exact ones. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd0"><span class="kn">Instance</span> <span class="nf">isexact_ptr_purely</span> `{Univalence} (n : trunc_index)
  {F X Y : pType} (i : F -&gt;* X) (f : X -&gt;* Y) `{IsExact purely F X Y i f}
  : IsExact (Tr n) (fmap (pTr n.+<span class="mi">1</span>) i) (fmap (pTr n.+<span class="mi">1</span>) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact (Tr n) (fmap (pTr n.+<span class="mi">1</span>) i) (fmap (pTr n.+<span class="mi">1</span>) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact (Tr n) (fmap (pTr n.+<span class="mi">1</span>) i) (fmap (pTr n.+<span class="mi">1</span>) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd2">rapply isexact_ptr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact (Tr n) i f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd3"><span class="kr">exists</span> <span class="nv">cx_isexact</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsConnMap (Tr n) (cxfib cx_isexact)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd4"><span class="nb">intros</span> z; <span class="nb">apply</span> isconnected_contr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>trunc_index</span></span></span><br><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>pfiber f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (hfiber (cxfib cx_isexact) z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (conn_map_isexact (f := f) (i := i) z).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Connecting maps *)</span>

<span class="sd">(** It&#39;s useful to see [pfib_cxfib] as a degenerate square. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd5"><span class="kn">Definition</span> <span class="nf">square_pfib_pequiv_cxfib</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) `{IsExact purely F X Y i f}
  : pequiv_pmap_idmap o* i ==* pfib f o* pequiv_cxfib.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pequiv_pmap_idmap o* i ==* pfib f o* pequiv_cxfib</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pequiv_pmap_idmap o* i ==* pfib f o* pequiv_cxfib</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd7"><span class="nb">unfold</span> Square.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pequiv_pmap_idmap o* i ==* pfib f o* pequiv_cxfib</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd8"><span class="nb">refine</span> (pmap_postcompose_idmap _ @* _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i ==* pfib f o* pequiv_cxfib</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">symmetry</span>; <span class="nb">apply</span> pfib_cxfib.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The connecting maps for the long exact sequence of loop spaces, defined as an extension to a fiber sequence. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkd9"><span class="kn">Definition</span> <span class="nf">connect_fiberseq</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span>}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) `{IsExact purely F X Y i f}
  : FiberSeq (loops Y) F X.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FiberSeq (loops Y) F X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkda"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">FiberSeq (loops Y) F X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkdb"><span class="kr">exists</span> <span class="nv">i</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">loops Y &lt;~&gt;* pfiber i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (((pfiber2_loops f) o*E (pequiv_pfiber _ _ (square_pfib_pequiv_cxfib i f)))^-<span class="mi">1</span>*).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">connecting_map</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span>}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) `{IsExact purely F X Y i f}
  : loops Y -&gt;* F
  := i_fiberseq (connect_fiberseq i f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkdc"><span class="kn">Instance</span> <span class="nf">isexact_connect_R</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span>}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) `{IsExact purely F X Y i f}
  : IsExact purely (fmap loops f) (connecting_map i f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (fmap loops f) (connecting_map i f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkdd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (fmap loops f) (connecting_map i f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkde"><span class="nb">refine</span> (isexact_equiv_i (Y := F) purely
          (pfib (pfib i)) (fmap loops f)
          (((loops_inv X) o*E
            (pfiber2_loops (pfib f)) o*E
           (pequiv_pfiber _ _ (square_pequiv_pfiber _ _ (square_pfib_pequiv_cxfib i f))))^-<span class="mi">1</span>*)
          (((pfiber2_loops f) o*E (pequiv_pfiber _ _ (square_pfib_pequiv_cxfib i f)))^-<span class="mi">1</span>*)
          _ (pfib i)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(pfiber2_loops f
 o*E pequiv_pfiber pequiv_cxfib pequiv_pmap_idmap
       (square_pfib_pequiv_cxfib i f))^-<span class="mi">1</span>*
o* fmap loops f ==*
pfib (pfib i)
o* (loops_inv X o*E pfiber2_loops (pfib f)
    o*E pequiv_pfiber
          (pequiv_pfiber pequiv_cxfib
             pequiv_pmap_idmap
             (square_pfib_pequiv_cxfib i f))
          pequiv_cxfib
          (square_pequiv_pfiber pequiv_cxfib
             pequiv_pmap_idmap
             (square_pfib_pequiv_cxfib i f)))^-<span class="mi">1</span>*</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkdf"><span class="nb">refine</span> (vinverse 
            ((loops_inv X) o*E
             (pfiber2_loops (pfib f)) o*E
             (pequiv_pfiber _ _ (square_pequiv_pfiber _ _ (square_pfib_pequiv_cxfib i f))))
            ((pfiber2_loops f) o*E (pequiv_pfiber _ _ (square_pfib_pequiv_cxfib i f))) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Square
  (loops_inv X o*E pfiber2_loops (pfib f)
   o*E pequiv_pfiber
         (pequiv_pfiber pequiv_cxfib pequiv_pmap_idmap
            (square_pfib_pequiv_cxfib i f))
         pequiv_cxfib
         (square_pequiv_pfiber pequiv_cxfib
            pequiv_pmap_idmap
            (square_pfib_pequiv_cxfib i f)))
  (pfiber2_loops f
   o*E pequiv_pfiber pequiv_cxfib pequiv_pmap_idmap
         (square_pfib_pequiv_cxfib i f))
  (pfib (pfib i)) (fmap loops f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chke0"><span class="nb">refine</span> (vconcat (f03 := loops_inv X o* pfiber2_loops (pfib f))
                  (f01 := pequiv_pfiber _ _ (square_pequiv_pfiber _ _ (square_pfib_pequiv_cxfib i f)))
                  (f23 := pfiber2_loops f)
                  (f21 := pequiv_pfiber _ _ (square_pfib_pequiv_cxfib i f)) _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Square
  (pequiv_pfiber
     (pequiv_pfiber pequiv_cxfib pequiv_pmap_idmap
        (square_pfib_pequiv_cxfib i f)) pequiv_cxfib
     (square_pequiv_pfiber pequiv_cxfib
        pequiv_pmap_idmap
        (square_pfib_pequiv_cxfib i f)))
  (pequiv_pfiber pequiv_cxfib pequiv_pmap_idmap
     (square_pfib_pequiv_cxfib i f)) (pfib (pfib i))
  <span class="nl">?Goal</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chke1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chke1"><hr></label><div class="goal-conclusion">Square (loops_inv X o* pfiber2_loops (pfib f))
  (pfiber2_loops f) <span class="nl">?Goal</span> (fmap loops f)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chke2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Square
  (pequiv_pfiber
     (pequiv_pfiber pequiv_cxfib pequiv_pmap_idmap
        (square_pfib_pequiv_cxfib i f)) pequiv_cxfib
     (square_pequiv_pfiber pequiv_cxfib
        pequiv_pmap_idmap
        (square_pfib_pequiv_cxfib i f)))
  (pequiv_pfiber pequiv_cxfib pequiv_pmap_idmap
     (square_pfib_pequiv_cxfib i f)) (pfib (pfib i))
  <span class="nl">?Goal</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (square_pequiv_pfiber _ _ (square_pequiv_pfiber _ _ (square_pfib_pequiv_cxfib i f))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chke3">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Square (loops_inv X o* pfiber2_loops (pfib f))
  (pfiber2_loops f) (pfib (pfib (pfib f)))
  (fmap loops f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (pfiber2_fmap_loops f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The connecting map associated to a pointed family. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chke4"><span class="kn">Definition</span> <span class="nf">connecting_map_family</span> {<span class="nv">Y</span> : pType} (<span class="nv">P</span> : pFam Y)
  : loops Y -&gt;* [P pt, dpoint P].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pFam Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">loops Y -&gt;* [P pt, dpoint P]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chke5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pFam Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">loops Y -&gt;* [P pt, dpoint P]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chke6">srapply Build_pMap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pFam Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">loops Y -&gt; [P pt, dpoint P]</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chke7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pFam Y</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chke7"><hr></label><div class="goal-conclusion"><span class="nl">?f</span> pt = pt</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chke8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pFam Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">loops Y -&gt; [P pt, dpoint P]</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chke9"><span class="nb">intro</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pFam Y</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>loops Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[P pt, dpoint P]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkea"><span class="nb">apply</span> (transport P l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pFam Y</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>loops Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P pt</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> P.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkeb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>pFam Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">l</span> : loops Y =&gt;
 transport P l (<span class="kr">let</span> <span class="nv">X</span> := dpoint P <span class="kr">in</span> X)) pt = pt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Long exact sequences *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">LongExactSequence</span> (<span class="nv">k</span> : Modality) (<span class="nv">N</span> : SuccStr) : <span class="kt">Type</span> :=
{
  les_carrier : N -&gt; pType;
  les_fn : <span class="kr">forall</span> <span class="nv">n</span>, les_carrier n.+<span class="mi">1</span> -&gt;* les_carrier n;
  les_isexact :: <span class="kr">forall</span> <span class="nv">n</span>, IsExact k (les_fn n.+<span class="mi">1</span>) (les_fn n)
}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">les_carrier</span> : LongExactSequence &gt;-&gt; <span class="kt">Funclass</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> les_fn {k N} S n : <span class="nb">rename</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Long exact sequences are preserved by truncation. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">trunc_les</span> `{Univalence} (k : trunc_index) {N : SuccStr}
  (S : LongExactSequence purely N)
  : LongExactSequence (Tr k) N
  := Build_LongExactSequence
       (Tr k) N (<span class="kr">fun</span> <span class="nv">n</span> =&gt; pTr k.+<span class="mi">1</span> (S n))
       (<span class="kr">fun</span> <span class="nv">n</span> =&gt; fmap (pTr k.+<span class="mi">1</span>) (les_fn S n)) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

<span class="sd">(** ** LES of loop spaces and homotopy groups *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">loops_carrier</span> (<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType) (<span class="nv">n</span> : N3) : pType :=
  <span class="kr">match</span> n <span class="kr">with</span>
  | (n, inl (inl (inl x))) =&gt; Empty_ind _ x
  | (n, inl (inl (inr tt))) =&gt; iterated_loops n Y
  | (n, inl (inr tt)) =&gt; iterated_loops n X
  | (n, inr tt) =&gt; iterated_loops n F
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Starting from a fiber sequence, we can obtain a long purely-exact sequence of loop spaces. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkec"><span class="kn">Definition</span> <span class="nf">loops_les</span> {<span class="nv">F</span> <span class="nv">X</span> <span class="nv">Y</span> : pType}
  (<span class="nv">i</span> : F -&gt;* X) (<span class="nv">f</span> : X -&gt;* Y) `{IsExact purely F X Y i f}
  : LongExactSequence purely (N3).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LongExactSequence purely N3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chked"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LongExactSequence purely N3</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkee">srefine (Build_LongExactSequence purely (N3) (loops_carrier F X Y) _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : N3,
loops_carrier F X Y n.+<span class="mi">1</span> -&gt;* loops_carrier F X Y n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkef" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkef"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : N3,
IsExact purely (<span class="nl">?les_fn</span> n.+<span class="mi">1</span>) (<span class="nl">?les_fn</span> n)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkf0"><span class="kp">all</span>:<span class="nb">intros</span> [n [[[[]|[]]|[]]|[]]]; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; X
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n -&gt;*
(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; Y
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkf1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkf1"><hr></label><div class="goal-conclusion">(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; F
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n -&gt;*
(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; X
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n</div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkf2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkf2"><hr></label><div class="goal-conclusion">loops
  ((<span class="kr">fix</span> F (m : nat) : pType :=
      <span class="kr">match</span> m <span class="kr">with</span>
      | <span class="mi">0</span>%nat =&gt; Y
      | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
      <span class="kr">end</span>) n) -&gt;*
(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; F
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n</div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkf3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkf3"><hr></label><div class="goal-conclusion">IsExact purely <span class="nl">?Goal0</span> <span class="nl">?Goal</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkf4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkf4"><hr></label><div class="goal-conclusion">IsExact purely <span class="nl">?Goal1</span> <span class="nl">?Goal0</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkf5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkf5"><hr></label><div class="goal-conclusion">IsExact purely <span class="nl">?Goal</span>@{n:=n.+<span class="mi">1</span>%nat} <span class="nl">?Goal1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkf6">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; X
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n -&gt;*
(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; Y
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (fmap (iterated_loops n) f).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkf7">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; F
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n -&gt;*
(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; X
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkf8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkf8"><hr></label><div class="goal-conclusion">loops
  ((<span class="kr">fix</span> F (m : nat) : pType :=
      <span class="kr">match</span> m <span class="kr">with</span>
      | <span class="mi">0</span>%nat =&gt; Y
      | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
      <span class="kr">end</span>) n) -&gt;*
(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; F
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n</div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkf9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkf9"><hr></label><div class="goal-conclusion">IsExact purely <span class="nl">?Goal</span> (fmap (iterated_loops n) f)</div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkfa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkfa"><hr></label><div class="goal-conclusion">IsExact purely <span class="nl">?Goal0</span> <span class="nl">?Goal</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkfb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkfb"><hr></label><div class="goal-conclusion">IsExact purely (fmap (iterated_loops n.+<span class="mi">1</span>) f) <span class="nl">?Goal0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkfc">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; F
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n -&gt;*
(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; X
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (fmap (iterated_loops n) i).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chkfd">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">loops
  ((<span class="kr">fix</span> F (m : nat) : pType :=
      <span class="kr">match</span> m <span class="kr">with</span>
      | <span class="mi">0</span>%nat =&gt; Y
      | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
      <span class="kr">end</span>) n) -&gt;*
(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; F
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkfe" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkfe"><hr></label><div class="goal-conclusion">IsExact purely (fmap (iterated_loops n) i)
  (fmap (iterated_loops n) f)</div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chkff" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chkff"><hr></label><div class="goal-conclusion">IsExact purely <span class="nl">?Goal</span> (fmap (iterated_loops n) i)</div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk100" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk100"><hr></label><div class="goal-conclusion">IsExact purely (fmap (iterated_loops n.+<span class="mi">1</span>) f) <span class="nl">?Goal</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk101">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">loops
  ((<span class="kr">fix</span> F (m : nat) : pType :=
      <span class="kr">match</span> m <span class="kr">with</span>
      | <span class="mi">0</span>%nat =&gt; Y
      | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
      <span class="kr">end</span>) n) -&gt;*
(<span class="kr">fix</span> F (m : nat) : pType :=
   <span class="kr">match</span> m <span class="kr">with</span>
   | <span class="mi">0</span>%nat =&gt; F
   | m&#39;.+<span class="mi">1</span>%nat =&gt; loops (F m&#39;)
   <span class="kr">end</span>) n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (connecting_map (fmap (iterated_loops n) i)
                          (fmap (iterated_loops n) f)).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk102">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsExact purely (fmap (iterated_loops n) i)
  (fmap (iterated_loops n) f)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk103" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk103"><hr></label><div class="goal-conclusion">IsExact purely
  (connecting_map (fmap (iterated_loops n) i)
     (fmap (iterated_loops n) f))
  (fmap (iterated_loops n) i)</div></blockquote><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk104" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>F, X, Y</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>F -&gt;* X</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt;* Y</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsExact purely i f</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>+N</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk104"><hr></label><div class="goal-conclusion">IsExact purely (fmap (iterated_loops n.+<span class="mi">1</span>) f)
  (connecting_map (fmap (iterated_loops n) i)
     (fmap (iterated_loops n) f))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>:<span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** And from that, a long exact sequence of homotopy groups (though for now it is just a sequence of pointed sets). *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Pi_les</span> `{Univalence} {F X Y : pType}
  (i : F -&gt;* X) (f : X -&gt;* Y) `{IsExact purely F X Y i f}
  : LongExactSequence (Tr (-<span class="mi">1</span>)) (N3)
  := trunc_les (-<span class="mi">1</span>) (loops_les i f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Classifying fiber sequences *)</span>

<span class="sd">(** Fiber sequences correspond to pointed maps into the universe. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk105"><span class="kn">Definition</span> <span class="nf">classify_fiberseq</span> `{Univalence} {Y F : pType@{u}}
  : (Y -&gt;* [<span class="kt">Type</span>@{u}, F]) &lt;~&gt; { X : pType@{u} &amp; FiberSeq F X Y }.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>Y, F</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Y -&gt;* [<span class="kt">Type</span>, F]) &lt;~&gt; {X : pType &amp; FiberSeq F X Y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk106"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>Y, F</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Y -&gt;* [<span class="kt">Type</span>, F]) &lt;~&gt; {X : pType &amp; FiberSeq F X Y}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk107"><span class="nb">refine</span> (_ oE _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>Y, F</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> &lt;~&gt; {X : pType &amp; FiberSeq F X Y}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="exactsequence-v-chk108" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>Y, F</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br></div><label class="goal-separator" for="exactsequence-v-chk108"><hr></label><div class="goal-conclusion">(Y -&gt;* [<span class="kt">Type</span>, F]) &lt;~&gt; <span class="nl">?Goal</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="sd">(** To apply [equiv_sigma_pfibration] we need to invert the equivalence on the fiber. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk109">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>Y, F</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal</span> &lt;~&gt; {X : pType &amp; FiberSeq F X Y}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk10a"><span class="kp">do</span> <span class="mi">2</span> (rapply equiv_functor_sigma_id; <span class="nb">intro</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>Y, F, a</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>a -&gt;* Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nl">?Goal0</span> a0 &lt;~&gt; (F &lt;~&gt;* pfiber a0)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> equiv_pequiv_inverse.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="exactsequence-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="exactsequence-v-chk10b">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>Y, F</var><span class="hyp-type"><b>: </b><span>pType</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Y -&gt;* [<span class="kt">Type</span>, F]) &lt;~&gt;
{a : pType &amp; {a0 : a -&gt;* Y &amp; pfiber a0 &lt;~&gt;* F}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((equiv_sigma_assoc _ _)^-<span class="mi">1</span> oE equiv_sigma_pfibration).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span></span></pre>
</div>
</div></body>
</html>
