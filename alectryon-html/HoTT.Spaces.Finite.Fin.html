<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Fin.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk0"><span class="kn">From</span> HoTT <span class="kn">Require Import</span> Basics.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Types.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> HSet.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Spaces.Nat.Core.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Equiv.PathSplit.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** By setting this, using [simple_induction] instead of [induction], and specifying universe variables in a couple of places, we can avoid all universe variables in this file.  Several results are confirmed to use no universe variables with an @{} annotation. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Set Universe Minimization ToSet</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> path_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> nat_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** * Finite sets *)</span>

<span class="sd">(** ** Canonical finite sets *)</span>

<span class="sd">(** A *finite set* is a type that is merely equivalent to the canonical finite set determined by some natural number.  There are many equivalent ways to define the canonical finite sets, such as [{ k : nat &amp; k &lt; n}]; we instead choose a recursive one. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">Fin</span> (<span class="nv">n</span> : nat) : Type0
  := <span class="kr">match</span> n <span class="kr">with</span>
       | <span class="mi">0</span> =&gt; Empty
       | S n =&gt; Fin n + Unit
     <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">fin_to_nat</span> {<span class="nv">n</span>} : Fin n -&gt; nat
  := <span class="kr">match</span> n <span class="kr">with</span>
     | <span class="mi">0</span> =&gt; Empty_rec
     | S n&#39; =&gt;
       <span class="kr">fun</span> <span class="nv">k</span> =&gt;
         <span class="kr">match</span> k <span class="kr">with</span>
         | inl k&#39; =&gt; fin_to_nat k&#39;
         | inr tt =&gt; n&#39;
         <span class="kr">end</span>
     <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk1"><span class="kn">Instance</span> <span class="nf">decidable_fin</span> (<span class="nv">n</span> : nat)
: Decidable (Fin n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (Fin n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (Fin n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk3"><span class="nb">destruct</span> n <span class="kr">as</span> [|n]; <span class="kp">try</span> <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Decidable (Fin n.+<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl (inr tt)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk4"><span class="kn">Instance</span> <span class="nf">decidablepaths_fin</span>@{} (n : nat)
: DecidablePaths (Fin n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">DecidablePaths (Fin n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">DecidablePaths (Fin n)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">simple_induction n n IHn; <span class="nb">simpl</span>; <span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk6"><span class="kn">Instance</span> <span class="nf">contr_fin1</span> : Contr (Fin <span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (Fin <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk7"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (Fin <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (contr_equiv&#39; Unit (sum_empty_l Unit)^-<span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk8"><span class="kn">Definition</span> <span class="nf">fin_empty</span> (<span class="nv">n</span> : nat) (<span class="nv">f</span> : Fin n -&gt; Empty) : n = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; Empty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; Empty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chka"><span class="nb">destruct</span> n; [ <span class="bp">reflexivity</span> | ].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> -&gt; Empty</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n.+<span class="mi">1</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (f (inr tt)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The zeroth element of a non-empty finite set is the left most element. It also happens to be the biggest by term size. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">fin_zero</span> {<span class="nv">n</span> : nat} : Fin n.+<span class="mi">1</span> :=
  <span class="kr">match</span> n <span class="kr">with</span>
  | O =&gt; inr tt
  | S _ =&gt; inl fin_zero
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Where `fin_zero` computes the first element of Fin (S n), `fin_last` computes the last. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_last</span> {<span class="nv">n</span> : nat} : Fin (S n) := inr tt.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Injection Fin n -&gt; Fin n.+1 mapping the kth element to the kth element. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_incl</span> {<span class="nv">n</span> : nat} (<span class="nv">k</span> : Fin n) : Fin (S n) := inl k.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** There is an injection from Fin n -&gt; Fin n.+1 that maps the kth element to the (k+1)th element. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">fsucc</span> {<span class="nv">n</span> : nat} : Fin n -&gt; Fin n.+<span class="mi">1</span> :=
  <span class="kr">match</span> n <span class="kr">with</span>
  | O =&gt; Empty_rec
  | S n&#39; =&gt;
    <span class="kr">fun</span> <span class="nv">i</span> : Fin (S n&#39;) =&gt;
      <span class="kr">match</span> i <span class="kr">with</span>
      | inl i&#39; =&gt; inl (fsucc i&#39;)
      | inr tt =&gt; inr tt
      <span class="kr">end</span>
  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** This injection is an injection/embedding *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb"><span class="kn">Lemma</span> <span class="nf">isembedding_fsucc</span>@{} {n : nat} : IsEmbedding (@fsucc n).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEmbedding fsucc</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEmbedding fsucc</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd"><span class="nb">apply</span> isembedding_isinj_hset.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsInjective fsucc</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke">simple_induction n n IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">IsInjective fsucc</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br></div><label class="goal-separator" for="fin-v-chkf"><hr></label><div class="goal-conclusion">IsInjective fsucc</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk10">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">IsInjective fsucc</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk11"><span class="nb">intro</span> i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>i</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">y</span> : Fin <span class="mi">0</span>, fsucc i = fsucc y -&gt; i = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> i.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk12">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsInjective fsucc</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk13"><span class="nb">intros</span> [] []; <span class="nb">intro</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>f, f0</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inl f) = fsucc (inl f0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl f = inl f0</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk14" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inl f) = fsucc (inr u)</span></span></span><br></div><label class="goal-separator" for="fin-v-chk14"><hr></label><div class="goal-conclusion">inl f = inr u</div></blockquote><input class="alectryon-extra-goal-toggle" id="fin-v-chk15" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inr u) = fsucc (inl f)</span></span></span><br></div><label class="goal-separator" for="fin-v-chk15"><hr></label><div class="goal-conclusion">inr u = inl f</div></blockquote><input class="alectryon-extra-goal-toggle" id="fin-v-chk16" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>u, u0</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inr u) = fsucc (inr u0)</span></span></span><br></div><label class="goal-separator" for="fin-v-chk16"><hr></label><div class="goal-conclusion">inr u = inr u0</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk17">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>f, f0</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inl f) = fsucc (inl f0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl f = inl f0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk18">f_ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>f, f0</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inl f) = fsucc (inl f0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f = f0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk19"><span class="nb">apply</span> IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>f, f0</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inl f) = fsucc (inl f0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fsucc f = fsucc f0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk1a"><span class="nb">eapply</span> path_sum_inl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>f, f0</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inl f) = fsucc (inl f0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl (fsucc f) = inl (fsucc f0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk1b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inl f) = fsucc (inr u)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl f = inr u</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk1c"><span class="nb">destruct</span> u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inl f) = fsucc (inr tt)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl f = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (inl_ne_inr _ _ p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk1d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inr u) = fsucc (inl f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr u = inl f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk1e"><span class="nb">destruct</span> u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inr tt) = fsucc (inl f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr tt = inl f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (inr_ne_inl _ _ p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk1f">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>IsInjective fsucc</span></span></span><br><span><var>u, u0</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fsucc (inr u) = fsucc (inr u0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr u = inr u0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> u, u0; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk20"><span class="kn">Lemma</span> <span class="nf">path_fin_fsucc_incl</span> {<span class="nv">n</span> : nat} : <span class="kr">forall</span> <span class="nv">k</span> : Fin n, fsucc (fin_incl k) = fin_incl (fsucc k).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">k</span> : Fin n,
fsucc (fin_incl k) = fin_incl (fsucc k)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk21"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">k</span> : Fin n,
fsucc (fin_incl k) = fin_incl (fsucc k)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">trivial</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">path_nat_fin_incl</span> {<span class="nv">n</span> : nat} (<span class="nv">k</span> : Fin n)
  : fin_to_nat (fin_incl k) = fin_to_nat k
  := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk22"><span class="kn">Lemma</span> <span class="nf">path_nat_fsucc</span>@{} {n : nat} : <span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_to_nat (fsucc k) = S (fin_to_nat k).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">k</span> : Fin n,
fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk23"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">k</span> : Fin n,
fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk24">simple_induction n n IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">k</span> : Fin <span class="mi">0</span>,
fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk25" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chk25"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">k</span> : Fin n.+<span class="mi">1</span>,
fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk26">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">k</span> : Fin <span class="mi">0</span>,
fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> [].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk27">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">k</span> : Fin n.+<span class="mi">1</span>,
fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk28"><span class="nb">intros</span> [k&#39;|[]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></span></span></span><br><span><var>k'</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_to_nat (fsucc (inl k&#39;)) = (fin_to_nat (inl k&#39;)).+<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk29" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chk29"><hr></label><div class="goal-conclusion">fin_to_nat (fsucc (inr tt)) = (fin_to_nat (inr tt)).+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk2a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></span></span></span><br><span><var>k'</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_to_nat (fsucc (inl k&#39;)) = (fin_to_nat (inl k&#39;)).+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk2b"><span class="nb">rewrite</span> path_fin_fsucc_incl, path_nat_fin_incl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></span></span></span><br><span><var>k'</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_to_nat (fsucc k&#39;) = (fin_to_nat (inl k&#39;)).+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> IHn.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk2c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_to_nat (fsucc k) = (fin_to_nat k).+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_to_nat (fsucc (inr tt)) = (fin_to_nat (inr tt)).+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk2d"><span class="kn">Lemma</span> <span class="nf">path_nat_fin_zero</span>@{} {n} : fin_to_nat (@fin_zero n) = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_to_nat fin_zero = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk2e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_to_nat fin_zero = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk2f">simple_induction n n IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_to_nat fin_zero = <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk30" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>fin_to_nat fin_zero = <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chk30"><hr></label><div class="goal-conclusion">fin_to_nat fin_zero = <span class="mi">0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk31">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_to_nat fin_zero = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk32">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>fin_to_nat fin_zero = <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_to_nat fin_zero = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">trivial</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">path_nat_fin_last</span> {<span class="nv">n</span>} : fin_to_nat (@fin_last n) = n
  := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Transposition equivalences *)</span>

<span class="sd">(** To prove some basic facts about canonical finite sets, we need some standard automorphisms of them.  Here we define some transpositions and prove that they in fact do the desired things. *)</span>

<span class="sd">(** *** Swap the last two elements. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_transpose_last_two</span> (<span class="nv">n</span> : nat)
  : Fin n.+<span class="mi">2</span> &lt;~&gt; Fin n.+<span class="mi">2</span>
  := ((equiv_sum_assoc _ _ _)^-<span class="mi">1</span>)
       oE (<span class="mi">1</span> +E (equiv_sum_symm _ _))
       oE (equiv_sum_assoc _ _ _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> fin_transpose_last_two : <span class="nb">simpl</span> nomatch.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_transpose_last_two_last</span> (<span class="nv">n</span> : nat)
  : fin_transpose_last_two n (inr tt) = (inl (inr tt))
  := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_transpose_last_two_nextlast</span> (<span class="nv">n</span> : nat)
  : fin_transpose_last_two n (inl (inr tt)) = (inr tt)
  := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_transpose_last_two_rest</span> (<span class="nv">n</span> : nat) (<span class="nv">k</span> : Fin n)
  : fin_transpose_last_two n (inl (inl k)) = (inl (inl k))
  := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** *** Swap the last element with [k]. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk33"><span class="kn">Fixpoint</span> <span class="nf">fin_transpose_last_with</span> (<span class="nv">n</span> : nat) (<span class="nv">k</span> : Fin n.+<span class="mi">1</span>)
  : Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk34"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk35"><span class="nb">destruct</span> k <span class="kr">as</span> [k|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk36" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk36"><hr></label><div class="goal-conclusion">Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk37">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk38"><span class="nb">destruct</span> n <span class="kr">as</span> [|n].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin <span class="mi">1</span> &lt;~&gt; Fin <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk39" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chk39"><hr></label><div class="goal-conclusion">Fin n.+<span class="mi">2</span> &lt;~&gt; Fin n.+<span class="mi">2</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk3a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin <span class="mi">1</span> &lt;~&gt; Fin <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> k.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk3b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">2</span> &lt;~&gt; Fin n.+<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk3c"><span class="nb">destruct</span> k <span class="kr">as</span> [k|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">2</span> &lt;~&gt; Fin n.+<span class="mi">2</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk3d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk3d"><hr></label><div class="goal-conclusion">Fin n.+<span class="mi">2</span> &lt;~&gt; Fin n.+<span class="mi">2</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk3e">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">2</span> &lt;~&gt; Fin n.+<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk3f"><span class="nb">refine</span> ((fin_transpose_last_two n)
                  oE _
                  oE (fin_transpose_last_two n)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">2</span> &lt;~&gt; Fin n.+<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((fin_transpose_last_with n (inl k)) +E <span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk40">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">2</span> &lt;~&gt; Fin n.+<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> fin_transpose_last_two.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk41">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fin_transpose_last_with</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">n</span> : nat,
Fin n.+<span class="mi">1</span> -&gt;
Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">1</span> &lt;~&gt; Fin n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (equiv_idmap _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> fin_transpose_last_with : <span class="nb">simpl</span> nomatch.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk42"><span class="kn">Definition</span> <span class="nf">fin_transpose_last_with_last</span>@{} (n : nat) (k : Fin n.+<span class="mi">1</span>)
  : fin_transpose_last_with n k (inr tt) = k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k (inr tt) = k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk43"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k (inr tt) = k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk44"><span class="nb">destruct</span> k <span class="kr">as</span> [k|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k) (inr tt) = inl k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk45" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk45"><hr></label><div class="goal-conclusion">fin_transpose_last_with n (inr u) (inr tt) = inr u</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk46">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k) (inr tt) = inl k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk47">simple_induction n n IHn; <span class="nb">intro</span> k; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Overture.Empty_rec (Empty + Unit &lt;~&gt; Empty + Unit) k
  (inr tt) = inl k</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk48" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inr tt) = inl k</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chk48"><hr></label><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl k) (inr tt) = inl k</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk49">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Overture.Empty_rec (Empty + Unit &lt;~&gt; Empty + Unit) k
  (inr tt) = inl k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> k.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk4a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inr tt) = inl k</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl k) (inr tt) = inl k</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk4b"><span class="nb">destruct</span> k <span class="kr">as</span> [k|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inr tt) = inl k</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl (inl k)) (inr tt) =
inl (inl k)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk4c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inr tt) = inl k</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk4c"><hr></label><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl (inr u)) (inr tt) =
inl (inr u)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk4d">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inr tt) = inl k</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl (inl k)) (inr tt) =
inl (inl k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk4e"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inr tt) = inl k</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span>
      fin_transpose_last_with n (inl k) (inr tt)
    <span class="kr">with</span>
    | inl a =&gt; inl a
    | inr b =&gt; inr (inl b)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl (inl k)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> IHn; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk4f">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inr tt) = inl k</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl (inr u)) (inr tt) =
inl (inr u)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk50"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inr tt) = inl k</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl (inr tt) = inl (inr u)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ap, ap, path_contr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk51">- <span class="sd">(** We have to destruct [n] since fixpoints don&#39;t reduce unless their argument is a constructor. *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inr u) (inr tt) = inr u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk52"><span class="nb">destruct</span> n; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr tt = inr u</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk53" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk53"><hr></label><div class="goal-conclusion">inr tt = inr u</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>:<span class="nb">apply</span> ap, path_contr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk54"><span class="kn">Definition</span> <span class="nf">fin_transpose_last_with_with</span>@{} (n : nat) (k : Fin n.+<span class="mi">1</span>)
  : fin_transpose_last_with n k k = inr tt.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k k = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk55"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k k = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk56"><span class="nb">destruct</span> k <span class="kr">as</span> [k|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k) (inl k) = inr tt</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk57" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk57"><hr></label><div class="goal-conclusion">fin_transpose_last_with n (inr u) (inr u) = inr tt</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk58">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k) (inl k) = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk59">simple_induction n n IHn; <span class="nb">intro</span> k; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Overture.Empty_rec (Empty + Unit &lt;~&gt; Empty + Unit) k
  (inl k) = inr tt</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk5a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inl k) = inr tt</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chk5a"><hr></label><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl k) (inl k) = inr tt</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk5b">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Overture.Empty_rec (Empty + Unit &lt;~&gt; Empty + Unit) k
  (inl k) = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> k.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk5c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inl k) = inr tt</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl k) (inl k) = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk5d"><span class="nb">destruct</span> k <span class="kr">as</span> [|k]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inl k) = inr tt</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span>
      fin_transpose_last_with n (inl f) (inl f)
    <span class="kr">with</span>
    | inl a =&gt; inl a
    | inr b =&gt; inr (inl b)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inr tt</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk5e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inl k) = inr tt</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk5e"><hr></label><div class="goal-conclusion">inr k = inr tt</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk5f">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inl k) = inr tt</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span>
      fin_transpose_last_with n (inl f) (inl f)
    <span class="kr">with</span>
    | inl a =&gt; inl a
    | inr b =&gt; inr (inl b)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> IHn; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk60">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, fin_transpose_last_with n (inl k) (inl k) = inr tt</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr k = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ap, path_contr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk61">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inr u) (inr u) = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk62"><span class="nb">destruct</span> n; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr u = inr tt</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk63" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk63"><hr></label><div class="goal-conclusion">inr u = inr tt</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">all</span>:<span class="nb">apply</span> ap, path_contr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk64"><span class="kn">Definition</span> <span class="nf">fin_transpose_last_with_rest</span>@{} (n : nat)
  (k : Fin n.+<span class="mi">1</span>) (l : Fin n)
  (notk : k &lt;&gt; inl l)
  : fin_transpose_last_with n k (inl l) = (inl l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>k &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k (inl l) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk65"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>k &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k (inl l) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk66"><span class="nb">destruct</span> k <span class="kr">as</span> [k|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl k &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k) (inl l) = inl l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk67" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inr u &lt;&gt; inl l</span></span></span><br></div><label class="goal-separator" for="fin-v-chk67"><hr></label><div class="goal-conclusion">fin_transpose_last_with n (inr u) (inl l) = inl l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk68">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl k &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k) (inl l) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk69">simple_induction n n IHn; <span class="nb">intros</span> k l notk; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl k &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Overture.Empty_rec (Empty + Unit &lt;~&gt; Empty + Unit) k
  (inl l) = inl l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk6a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl k &lt;&gt; inl l</span></span></span><br></div><label class="goal-separator" for="fin-v-chk6a"><hr></label><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl k) (inl l) = inl l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk6b"><span class="mi">1</span>: <span class="nb">elim</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl k &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n.+<span class="mi">1</span> (inl k) (inl l) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk6c"><span class="nb">destruct</span> k <span class="kr">as</span> [k|]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span>
      functor_sum (fin_transpose_last_with n (inl k))
        idmap
        <span class="kr">match</span>
          functor_sum idmap
            (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
             <span class="kr">match</span> ab <span class="kr">with</span>
             | inl a =&gt; inr a
             | inr b =&gt; inl b
             <span class="kr">end</span>)
            <span class="kr">match</span> l <span class="kr">with</span>
            | inl a =&gt; inl a
            | inr b =&gt; inr (inl b)
            <span class="kr">end</span>
        <span class="kr">with</span>
        | inl a =&gt; inl (inl a)
        | inr (inl b) =&gt; inl (inr b)
        | inr (inr c) =&gt; inr c
        <span class="kr">end</span>
    <span class="kr">with</span>
    | inl (inl a) =&gt; inl a
    | inl (inr b) =&gt; inr (inl b)
    | inr c =&gt; inr (inr c)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk6d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inr u) &lt;&gt; inl l</span></span></span><br></div><label class="goal-separator" for="fin-v-chk6d"><hr></label><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span> l <span class="kr">with</span>
    | inl a =&gt; inl a
    | inr b =&gt; inr (inl b)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk6e">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span>
      functor_sum (fin_transpose_last_with n (inl k))
        idmap
        <span class="kr">match</span>
          functor_sum idmap
            (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
             <span class="kr">match</span> ab <span class="kr">with</span>
             | inl a =&gt; inr a
             | inr b =&gt; inl b
             <span class="kr">end</span>)
            <span class="kr">match</span> l <span class="kr">with</span>
            | inl a =&gt; inl a
            | inr b =&gt; inr (inl b)
            <span class="kr">end</span>
        <span class="kr">with</span>
        | inl a =&gt; inl (inl a)
        | inr (inl b) =&gt; inl (inr b)
        | inr (inr c) =&gt; inr c
        <span class="kr">end</span>
    <span class="kr">with</span>
    | inl (inl a) =&gt; inl a
    | inl (inr b) =&gt; inr (inl b)
    | inr c =&gt; inr (inr c)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk6f"><span class="nb">destruct</span> l <span class="kr">as</span> [l|]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl (inl l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span>
      fin_transpose_last_with n (inl k) (inl l)
    <span class="kr">with</span>
    | inl a =&gt; inl a
    | inr b =&gt; inr (inl b)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl (inl l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk70" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl (inr u)</span></span></span><br></div><label class="goal-separator" for="fin-v-chk70"><hr></label><div class="goal-conclusion">inl (inr u) = inl (inr u)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk71">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl (inl l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span>
      fin_transpose_last_with n (inl k) (inl l)
    <span class="kr">with</span>
    | inl a =&gt; inl a
    | inr b =&gt; inr (inl b)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl (inl l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk72"><span class="nb">rewrite</span> IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl (inl l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>) (inl l)
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl (inl l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk73" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl (inl l)</span></span></span><br></div><label class="goal-separator" for="fin-v-chk73"><hr></label><div class="goal-conclusion">inl k &lt;&gt; inl l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk74">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl (inl l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>) (inl l)
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl (inl l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk75">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl (inl l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl k &lt;&gt; inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">p</span> =&gt; notk (ap inl p)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk76">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inl k) &lt;&gt; inl (inr u)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl (inr u) = inl (inr u)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk77">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inr u) &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span> l <span class="kr">with</span>
    | inl a =&gt; inl a
    | inr b =&gt; inr (inl b)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk78">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inr u) &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  functor_sum idmap
    (<span class="kr">fun</span> <span class="nv">ab</span> : Unit + Unit =&gt;
     <span class="kr">match</span> ab <span class="kr">with</span>
     | inl a =&gt; inr a
     | inr b =&gt; inl b
     <span class="kr">end</span>)
    <span class="kr">match</span> l <span class="kr">with</span>
    | inl a =&gt; inl a
    | inr b =&gt; inr (inl b)
    <span class="kr">end</span>
<span class="kr">with</span>
| inl a =&gt; inl (inl a)
| inr (inl b) =&gt; inl (inr b)
| inr (inr c) =&gt; inr c
<span class="kr">end</span> = inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk79"><span class="nb">destruct</span> l <span class="kr">as</span> [l|]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inr u) &lt;&gt; inl (inl l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl (inl l) = inl (inl l)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk7a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>u, u0</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inr u) &lt;&gt; inl (inr u0)</span></span></span><br></div><label class="goal-separator" for="fin-v-chk7a"><hr></label><div class="goal-conclusion">inr u0 = inl (inr u0)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk7b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inr u) &lt;&gt; inl (inl l)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inl (inl l) = inl (inl l)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk7c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
inl k &lt;&gt; inl l -&gt;
fin_transpose_last_with n (inl k) (inl l) =
inl l</span></span></span><br><span><var>u, u0</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inl (inr u) &lt;&gt; inl (inr u0)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr u0 = inl (inr u0)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (notk (ap inl (ap inr (path_unit _ _)))).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input">}</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk7d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>notk</var><span class="hyp-type"><b>: </b><span>inr u &lt;&gt; inl l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inr u) (inl l) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> n; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk7e"><span class="kn">Definition</span> <span class="nf">fin_transpose_last_with_last_other</span> (<span class="nv">n</span> : nat) (<span class="nv">k</span> : Fin n.+<span class="mi">1</span>)
  : fin_transpose_last_with n (inr tt) k = k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inr tt) k = k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk7f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inr tt) k = k</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> n; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk80"><span class="kn">Definition</span> <span class="nf">fin_transpose_last_with_invol</span> (<span class="nv">n</span> : nat) (<span class="nv">k</span> : Fin n.+<span class="mi">1</span>)
  : fin_transpose_last_with n k o fin_transpose_last_with n k == idmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k
o fin_transpose_last_with n k == idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk81"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k
o fin_transpose_last_with n k == idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk82"><span class="nb">intros</span> l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k
  (fin_transpose_last_with n k l) = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk83"><span class="nb">destruct</span> l <span class="kr">as</span> [l|[]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k
  (fin_transpose_last_with n k (inl l)) = inl l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk84" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chk84"><hr></label><div class="goal-conclusion">fin_transpose_last_with n k
  (fin_transpose_last_with n k (inr tt)) = inr tt</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk85">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k
  (fin_transpose_last_with n k (inl l)) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk86"><span class="nb">destruct</span> k <span class="kr">as</span> [k|[]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k)
  (fin_transpose_last_with n (inl k) (inl l)) = inl l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk87" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><label class="goal-separator" for="fin-v-chk87"><hr></label><div class="goal-conclusion">fin_transpose_last_with n (inr tt)
  (fin_transpose_last_with n (inr tt) (inl l)) = inl l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk88">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k)
  (fin_transpose_last_with n (inl k) (inl l)) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk89"><span class="nb">destruct</span> (dec_paths k l) <span class="kr">as</span> [p|p].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>k = l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k)
  (fin_transpose_last_with n (inl k) (inl l)) = inl l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk8a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>k &lt;&gt; l</span></span></span><br></div><label class="goal-separator" for="fin-v-chk8a"><hr></label><div class="goal-conclusion">fin_transpose_last_with n (inl k)
  (fin_transpose_last_with n (inl k) (inl l)) = inl l</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk8b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>k = l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k)
  (fin_transpose_last_with n (inl k) (inl l)) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk8c"><span class="nb">rewrite</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>k = l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl l)
  (fin_transpose_last_with n (inl l) (inl l)) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk8d"><span class="nb">rewrite</span> fin_transpose_last_with_with.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>k = l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl l) (inr tt) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> fin_transpose_last_with_last.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk8e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>k &lt;&gt; l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inl k)
  (fin_transpose_last_with n (inl k) (inl l)) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> fin_transpose_last_with_rest;
          <span class="kp">try</span> <span class="nb">apply</span> fin_transpose_last_with_rest;
          <span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">q</span> =&gt; p (path_sum_inl _ q)).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk8f">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inr tt)
  (fin_transpose_last_with n (inr tt) (inl l)) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk90">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inr tt)
  (fin_transpose_last_with n (inr tt) (inl l)) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk91"><span class="nb">rewrite</span> fin_transpose_last_with_last_other.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n (inr tt) (inl l) = inl l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> fin_transpose_last_with_last_other.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk92">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k
  (fin_transpose_last_with n k (inr tt)) = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk93" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk93"><span class="nb">rewrite</span> fin_transpose_last_with_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with n k k = inr tt</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> fin_transpose_last_with_with.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Equivalences between canonical finite sets *)</span>

<span class="sd">(** To give an equivalence [Fin n.+1 &lt;~&gt; Fin m.+1] is equivalent to giving an element of [Fin m.+1] (the image of the last element) together with an equivalence [Fin n &lt;~&gt; Fin m].  More specifically, any such equivalence can be decomposed uniquely as a last-element transposition followed by an equivalence fixing the last element.  *)</span>

<span class="sd">(** Here is the uncurried map that constructs an equivalence [Fin n.+1 &lt;~&gt; Fin m.+1]. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_equiv</span> (<span class="nv">n</span> <span class="nv">m</span> : nat)
  (<span class="nv">k</span> : Fin m.+<span class="mi">1</span>) (<span class="nv">e</span> : Fin n &lt;~&gt; Fin m)
  : Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span>
  := (fin_transpose_last_with m k) oE (e +E <span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Here is the curried version that we will prove to be an equivalence. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_equiv&#39;</span> (<span class="nv">n</span> <span class="nv">m</span> : nat)
  : ((Fin m.+<span class="mi">1</span>) * (Fin n &lt;~&gt; Fin m)) -&gt; (Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span>)
  := <span class="kr">fun</span> <span class="nv">ke</span> =&gt; fin_equiv n m (fst ke) (snd ke).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** We construct its inverse and the two homotopies first as versions using homotopies without funext (similar to [ExtendableAlong]), then apply funext at the end. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk94"><span class="kn">Definition</span> <span class="nf">fin_equiv_hfiber</span>@{} (n m : nat) (e : Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span>)
  : { kf : (Fin m.+<span class="mi">1</span>) * (Fin n &lt;~&gt; Fin m) &amp; fin_equiv&#39; n m kf == e }.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{kf : Fin m.+<span class="mi">1</span> * (Fin n &lt;~&gt; Fin m) &amp;
fin_equiv&#39; n m kf == e}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk95"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{kf : Fin m.+<span class="mi">1</span> * (Fin n &lt;~&gt; Fin m) &amp;
fin_equiv&#39; n m kf == e}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk96"><span class="nb">simpl</span> <span class="kr">in</span> e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{kf : Fin m.+<span class="mi">1</span> * (Fin n &lt;~&gt; Fin m) &amp;
fin_equiv&#39; n m kf == e}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk97"><span class="nb">refine</span> (equiv_sigma_prod _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : Fin m.+<span class="mi">1</span> &amp;
{b : Fin n &lt;~&gt; Fin m &amp; fin_equiv&#39; n m (a, b) == e}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk98">recall (e (inr tt)) <span class="kr">as</span> y <span class="nb">eqn</span>:p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>(Fin m + Unit)%type</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : Fin m.+<span class="mi">1</span> &amp;
{b : Fin n &lt;~&gt; Fin m &amp; fin_equiv&#39; n m (a, b) == e}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk99"><span class="nb">assert</span> (p&#39; := (moveL_equiv_V _ _ p)^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>(Fin m + Unit)%type</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> y = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : Fin m.+<span class="mi">1</span> &amp;
{b : Fin n &lt;~&gt; Fin m &amp; fin_equiv&#39; n m (a, b) == e}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk9a"><span class="kr">exists</span> <span class="nv">y</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>(Fin m + Unit)%type</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> y = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{b : Fin n &lt;~&gt; Fin m &amp; fin_equiv&#39; n m (y, b) == e}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk9b"><span class="nb">destruct</span> y <span class="kr">as</span> [y|[]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{b : Fin n &lt;~&gt; Fin m &amp; fin_equiv&#39; n m (inl y, b) == e}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk9c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chk9c"><hr></label><div class="goal-conclusion">{b : Fin n &lt;~&gt; Fin m &amp;
fin_equiv&#39; n m (inr tt, b) == e}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk9d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{b : Fin n &lt;~&gt; Fin m &amp; fin_equiv&#39; n m (inl y, b) == e}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk9e"><span class="nb">simple refine</span> (equiv_unfunctor_sum_l@{<span class="kt">Set</span> <span class="kt">Set</span> <span class="kt">Set</span> <span class="kt">Set</span> <span class="kt">Set</span> <span class="kt">Set</span>}
              (fin_transpose_last_with m (inl y) oE e)
              _ _ ; _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Fin n,
is_inl
  ((fin_transpose_last_with m (inl y) oE e) (inl a))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk9f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chk9f"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Unit,
is_inr
  ((fin_transpose_last_with m (inl y) oE e) (inr b))</div></blockquote><input class="alectryon-extra-goal-toggle" id="fin-v-chka0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chka0"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">b</span> : Fin n &lt;~&gt; Fin m =&gt;
 fin_equiv&#39; n m (inl y, b) == e)
  (equiv_unfunctor_sum_l
     (fin_transpose_last_with m (inl y) oE e) <span class="nl">?Ha</span> 
     <span class="nl">?Hb</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chka1">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Fin n,
is_inl
  ((fin_transpose_last_with m (inl y) oE e) (inl a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chka2"><span class="nb">intros</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl
  ((fin_transpose_last_with m (inl y) oE e) (inl a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chka3">ev_equiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (fin_transpose_last_with m (inl y) (e (inl a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chka4"><span class="nb">assert</span> (q : inl y &lt;&gt; e (inl a))
        <span class="bp">by</span> <span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">z</span> =&gt; inl_ne_inr _ _ (equiv_inj e (z^ @ p^))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>inl y &lt;&gt; e (inl a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (fin_transpose_last_with m (inl y) (e (inl a)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chka5"><span class="nb">set</span> (z := e (inl a)) <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>z</var><span><span class="hyp-body"><b>:= </b><span>e (inl a)</span></span><span class="hyp-type"><b>: </b><span>(Fin m + Unit)%type</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>inl y &lt;&gt; z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (fin_transpose_last_with m (inl y) z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chka6"><span class="nb">destruct</span> z <span class="kr">as</span> [z|[]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>inl y &lt;&gt; inl z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (fin_transpose_last_with m (inl y) (inl z))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chka7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>inl y &lt;&gt; inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chka7"><hr></label><div class="goal-conclusion">is_inl (fin_transpose_last_with m (inl y) (inr tt))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chka8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>z</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>inl y &lt;&gt; inl z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (fin_transpose_last_with m (inl y) (inl z))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> fin_transpose_last_with_rest;
        <span class="kp">try</span> <span class="bp">exact</span> tt; <span class="kp">try</span> <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chka9">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>inl y &lt;&gt; inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (fin_transpose_last_with m (inl y) (inr tt))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> fin_transpose_last_with_last; <span class="bp">exact</span> tt.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkaa">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Unit,
is_inr
  ((fin_transpose_last_with m (inl y) oE e) (inr b))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkab" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chkab"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">b</span> : Fin n &lt;~&gt; Fin m =&gt;
 fin_equiv&#39; n m (inl y, b) == e)
  (equiv_unfunctor_sum_l
     (fin_transpose_last_with m (inl y) oE e)
     (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
      <span class="kr">let</span> <span class="nv">q</span> :=
        <span class="kr">fun</span> <span class="nv">z</span> : inl y = e (inl a) =&gt;
        inl_ne_inr a tt (equiv_inj e (z^ @ p^)) <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">z</span> := e (inl a) <span class="kr">in</span>
      <span class="kr">match</span>
        z <span class="kr">as</span> s
        <span class="kr">return</span>
          (inl y &lt;&gt; s -&gt;
           is_inl
             (fin_transpose_last_with m (inl y) s))
      <span class="kr">with</span>
      | inl f =&gt;
          (<span class="kr">fun</span> (<span class="nv">z0</span> : Fin m) (<span class="nv">q0</span> : inl y &lt;&gt; inl z0) =&gt;
           internal_paths_rew_r
             (<span class="kr">fun</span> <span class="nv">f0</span> : Fin m.+<span class="mi">1</span> =&gt; is_inl f0) tt
             (fin_transpose_last_with_rest m (inl y)
                z0 q0)) f
      | inr u =&gt;
          (<span class="kr">fun</span> <span class="nv">u0</span> : Unit =&gt;
           <span class="kr">match</span>
             u0 <span class="kr">as</span> u1
             <span class="kr">return</span>
               (inl y &lt;&gt; inr u1 -&gt;
                is_inl
                  (fin_transpose_last_with m (inl y)
                     (inr u1)))
           <span class="kr">with</span>
           | tt =&gt;
               <span class="kr">fun</span> <span class="nv">_</span> : inl y &lt;&gt; inr tt =&gt;
               internal_paths_rew_r
                 (<span class="kr">fun</span> <span class="nv">f</span> : Fin m.+<span class="mi">1</span> =&gt; is_inl f) tt
                 (fin_transpose_last_with_last m
                    (inl y))
           <span class="kr">end</span>) u
      <span class="kr">end</span> q) <span class="nl">?Hb</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkac">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Unit,
is_inr
  ((fin_transpose_last_with m (inl y) oE e) (inr b))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkad"><span class="nb">intros</span> [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inr
  ((fin_transpose_last_with m (inl y) oE e) (inr tt))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkae">ev_equiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inr
  (fin_transpose_last_with m (inl y) (e (inr tt)))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkaf"><span class="nb">rewrite</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inr (fin_transpose_last_with m (inl y) (inl y))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> fin_transpose_last_with_with; <span class="bp">exact</span> tt.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb0">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">b</span> : Fin n &lt;~&gt; Fin m =&gt;
 fin_equiv&#39; n m (inl y, b) == e)
  (equiv_unfunctor_sum_l
     (fin_transpose_last_with m (inl y) oE e)
     (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
      <span class="kr">let</span> <span class="nv">q</span> :=
        <span class="kr">fun</span> <span class="nv">z</span> : inl y = e (inl a) =&gt;
        inl_ne_inr a tt (equiv_inj e (z^ @ p^)) <span class="kr">in</span>
      <span class="kr">let</span> <span class="nv">z</span> := e (inl a) <span class="kr">in</span>
      <span class="kr">match</span>
        z <span class="kr">as</span> s
        <span class="kr">return</span>
          (inl y &lt;&gt; s -&gt;
           is_inl
             (fin_transpose_last_with m (inl y) s))
      <span class="kr">with</span>
      | inl f =&gt;
          (<span class="kr">fun</span> (<span class="nv">z0</span> : Fin m) (<span class="nv">q0</span> : inl y &lt;&gt; inl z0) =&gt;
           internal_paths_rew_r
             (<span class="kr">fun</span> <span class="nv">f0</span> : Fin m.+<span class="mi">1</span> =&gt; is_inl f0) tt
             (fin_transpose_last_with_rest m (inl y)
                z0 q0)) f
      | inr u =&gt;
          (<span class="kr">fun</span> <span class="nv">u0</span> : Unit =&gt;
           <span class="kr">match</span>
             u0 <span class="kr">as</span> u1
             <span class="kr">return</span>
               (inl y &lt;&gt; inr u1 -&gt;
                is_inl
                  (fin_transpose_last_with m (inl y)
                     (inr u1)))
           <span class="kr">with</span>
           | tt =&gt;
               <span class="kr">fun</span> <span class="nv">_</span> : inl y &lt;&gt; inr tt =&gt;
               internal_paths_rew_r
                 (<span class="kr">fun</span> <span class="nv">f</span> : Fin m.+<span class="mi">1</span> =&gt; is_inl f) tt
                 (fin_transpose_last_with_last m
                    (inl y))
           <span class="kr">end</span>) u
      <span class="kr">end</span> q)
     (<span class="kr">fun</span> <span class="nv">b</span> : Unit =&gt;
      <span class="kr">match</span>
        b <span class="kr">as</span> u
        <span class="kr">return</span>
          (is_inr
             ((fin_transpose_last_with m (inl y) oE e)
                (inr u)))
      <span class="kr">with</span>
      | tt =&gt;
          internal_paths_rew_r
            (<span class="kr">fun</span> <span class="nv">s</span> : Fin m + Unit =&gt;
             is_inr
               (fin_transpose_last_with m (inl y) s))
            (internal_paths_rew_r
               (<span class="kr">fun</span> <span class="nv">f</span> : Fin m.+<span class="mi">1</span> =&gt; is_inr f) tt
               (fin_transpose_last_with_with m (inl y)))
            p
      <span class="kr">end</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb1"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_equiv&#39; n m
  (inl y,
  equiv_unfunctor_sum_l
    (fin_transpose_last_with m (inl y) oE e)
    (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
     <span class="kr">let</span> <span class="nv">q</span> :=
       <span class="kr">fun</span> <span class="nv">z</span> : inl y = e (inl a) =&gt;
       inl_ne_inr a tt (equiv_inj e (z^ @ p^)) <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">z</span> := e (inl a) <span class="kr">in</span>
     <span class="kr">match</span>
       z <span class="kr">as</span> s
       <span class="kr">return</span>
         (inl y &lt;&gt; s -&gt;
          is_inl (fin_transpose_last_with m (inl y) s))
     <span class="kr">with</span>
     | inl f =&gt;
         <span class="kr">fun</span> <span class="nv">q0</span> : inl y &lt;&gt; inl f =&gt;
         internal_paths_rew_r
           (<span class="kr">fun</span> <span class="nv">f0</span> : Fin m.+<span class="mi">1</span> =&gt; is_inl f0) tt
           (fin_transpose_last_with_rest m (inl y) f
              q0)
     | inr u =&gt;
         <span class="kr">match</span>
           u <span class="kr">as</span> u0
           <span class="kr">return</span>
             (inl y &lt;&gt; inr u0 -&gt;
              is_inl
                (fin_transpose_last_with m (inl y)
                   (inr u0)))
         <span class="kr">with</span>
         | tt =&gt;
             <span class="kr">fun</span> <span class="nv">_</span> : inl y &lt;&gt; inr tt =&gt;
             internal_paths_rew_r
               (<span class="kr">fun</span> <span class="nv">f</span> : Fin m.+<span class="mi">1</span> =&gt; is_inl f) tt
               (fin_transpose_last_with_last m (inl y))
         <span class="kr">end</span>
     <span class="kr">end</span> q)
    (<span class="kr">fun</span> <span class="nv">b</span> : Unit =&gt;
     <span class="kr">match</span>
       b <span class="kr">as</span> u
       <span class="kr">return</span>
         (is_inr
            ((fin_transpose_last_with m (inl y) oE e)
               (inr u)))
     <span class="kr">with</span>
     | tt =&gt;
         internal_paths_rew_r
           (<span class="kr">fun</span> <span class="nv">s</span> : Fin m + Unit =&gt;
            is_inr
              (fin_transpose_last_with m (inl y) s))
           (internal_paths_rew_r
              (<span class="kr">fun</span> <span class="nv">f</span> : Fin m.+<span class="mi">1</span> =&gt; is_inr f) tt
              (fin_transpose_last_with_with m (inl y)))
           p
     <span class="kr">end</span>)) x = e x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb2"><span class="nb">unfold</span> fst, snd; ev_equiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_equiv&#39; n m
  (inl y,
  equiv_unfunctor_sum_l
    (fin_transpose_last_with m (inl y) oE e)
    (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
     <span class="kr">match</span>
       e (inl a) <span class="kr">as</span> s
       <span class="kr">return</span>
         (inl y &lt;&gt; s -&gt;
          is_inl (fin_transpose_last_with m (inl y) s))
     <span class="kr">with</span>
     | inl f =&gt;
         <span class="kr">fun</span> <span class="nv">q</span> : inl y &lt;&gt; inl f =&gt;
         internal_paths_rew_r
           (<span class="kr">fun</span> <span class="nv">f0</span> : Fin m.+<span class="mi">1</span> =&gt; is_inl f0) tt
           (fin_transpose_last_with_rest m (inl y) f q)
     | inr u =&gt;
         <span class="kr">match</span>
           u <span class="kr">as</span> u0
           <span class="kr">return</span>
             (inl y &lt;&gt; inr u0 -&gt;
              is_inl
                (fin_transpose_last_with m (inl y)
                   (inr u0)))
         <span class="kr">with</span>
         | tt =&gt;
             <span class="kr">fun</span> <span class="nv">_</span> : inl y &lt;&gt; inr tt =&gt;
             internal_paths_rew_r
               (<span class="kr">fun</span> <span class="nv">f</span> : Fin m.+<span class="mi">1</span> =&gt; is_inl f) tt
               (fin_transpose_last_with_last m (inl y))
         <span class="kr">end</span>
     <span class="kr">end</span>
       (<span class="kr">fun</span> <span class="nv">z</span> : inl y = e (inl a) =&gt;
        inl_ne_inr a tt (equiv_inj e (z^ @ p^))))
    (<span class="kr">fun</span> <span class="nv">b</span> : Unit =&gt;
     <span class="kr">match</span>
       b <span class="kr">as</span> u
       <span class="kr">return</span>
         (is_inr
            ((fin_transpose_last_with m (inl y) o e)
               (inr u)))
     <span class="kr">with</span>
     | tt =&gt;
         internal_paths_rew_r
           (<span class="kr">fun</span> <span class="nv">s</span> : Fin m + Unit =&gt;
            is_inr
              (fin_transpose_last_with m (inl y) s))
           (internal_paths_rew_r
              (<span class="kr">fun</span> <span class="nv">f</span> : Fin m.+<span class="mi">1</span> =&gt; is_inr f) tt
              (fin_transpose_last_with_with m (inl y)))
           p
     <span class="kr">end</span>)) x = e x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb3"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inl y)
  (functor_sum
     (unfunctor_sum_l
        (<span class="kr">fun</span> <span class="nv">x</span> : Fin n + Unit =&gt;
         fin_transpose_last_with m (inl y) (e x))
        (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
         <span class="kr">match</span>
           e (inl a) <span class="kr">as</span> s
           <span class="kr">return</span>
             (inl y &lt;&gt; s -&gt;
              is_inl
                (fin_transpose_last_with m (inl y) s))
         <span class="kr">with</span>
         | inl f =&gt;
             <span class="kr">fun</span> <span class="nv">q</span> : inl y &lt;&gt; inl f =&gt;
             internal_paths_rew_r
               (<span class="kr">fun</span> <span class="nv">f0</span> : Fin m + Unit =&gt; is_inl f0) tt
               ((<span class="kr">fix</span> IHn (n0 : nat) :
                     <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n0,
                     inl k &lt;&gt; inl l -&gt;
                     fin_transpose_last_with n0
                       (inl k) (inl l) = inl l :=
                   <span class="kr">match</span>
                     n0 <span class="kr">as</span> n
                     <span class="kr">return</span>
                       (<span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
                        inl k &lt;&gt; inl l -&gt;
                        fin_transpose_last_with n
                          (...) (...) = inl l)
                   <span class="kr">with</span>
                   | <span class="mi">0</span> =&gt;
                       <span class="kr">fun</span> (<span class="nv">k</span> <span class="nv">l</span> : Empty)
                         (<span class="nv">_</span> : inl k &lt;&gt; inl l) =&gt;
                       Overture.Empty_rec
                         (Overture.Empty_rec
                            (Empty + Unit &lt;~&gt;
                             Empty + Unit) k (inl l) =
                          inl l) k
                   | n.+<span class="mi">1</span> =&gt;
                       <span class="kr">fun</span> (<span class="nv">k</span> <span class="nv">l</span> : Fin n + Unit)
                         (<span class="nv">notk</span> : inl k &lt;&gt; inl l) =&gt;
                       <span class="kr">match</span>
                         k <span class="kr">as</span> s <span class="kr">return</span> (... -&gt; ...)
                       <span class="kr">with</span>
                       | inl f0 =&gt;
                           <span class="kr">fun</span> <span class="nv">notk0</span> : ... &lt;&gt; ... =&gt;
                           <span class="kr">match</span> ... <span class="kr">with</span>
                           | ... ...
                           | ... ...
                           <span class="kr">end</span> notk0
                       | inr u =&gt;
                           <span class="kr">fun</span> <span class="nv">notk0</span> : ... &lt;&gt; ... =&gt;
                           <span class="kr">match</span> ... <span class="kr">with</span>
                           | ... ...
                           | ... ...
                           <span class="kr">end</span> notk0
                       <span class="kr">end</span> notk
                   <span class="kr">end</span>) m y f q)
         | inr u =&gt;
             <span class="kr">match</span>
               u <span class="kr">as</span> u0
               <span class="kr">return</span>
                 (inl y &lt;&gt; inr u0 -&gt;
                  is_inl
                    (fin_transpose_last_with m (inl y)
                       (inr u0)))
             <span class="kr">with</span>
             | tt =&gt;
                 <span class="kr">fun</span> <span class="nv">_</span> : inl y &lt;&gt; inr tt =&gt;
                 internal_paths_rew_r
                   (<span class="kr">fun</span> <span class="nv">f</span> : Fin m + Unit =&gt; is_inl f)
                   tt
                   (fin_transpose_last_with_last m
                      (inl y))
             <span class="kr">end</span>
         <span class="kr">end</span>
           (<span class="kr">fun</span> <span class="nv">z</span> : inl y = e (inl a) =&gt;
            inl_ne_inr a tt (equiv_inj e (z^ @ p^)))))
     idmap x) = e x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb4"><span class="nb">destruct</span> x <span class="kr">as</span> [x|[]]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inl y)
  (inl
     (unfunctor_sum_l
        (<span class="kr">fun</span> <span class="nv">x</span> : Fin n + Unit =&gt;
         fin_transpose_last_with m (inl y) (e x))
        (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
         <span class="kr">match</span>
           e (inl a) <span class="kr">as</span> s
           <span class="kr">return</span>
             (inl y &lt;&gt; s -&gt;
              is_inl
                (fin_transpose_last_with m (inl y) s))
         <span class="kr">with</span>
         | inl f =&gt;
             <span class="kr">fun</span> <span class="nv">q</span> : inl y &lt;&gt; inl f =&gt;
             internal_paths_rew_r
               (<span class="kr">fun</span> <span class="nv">f0</span> : Fin m + Unit =&gt; is_inl f0) tt
               ((<span class="kr">fix</span> IHn (n0 : nat) :
                     <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n0,
                     inl k &lt;&gt; inl l -&gt;
                     fin_transpose_last_with n0
                       (inl k) (inl l) = inl l :=
                   <span class="kr">match</span>
                     n0 <span class="kr">as</span> n
                     <span class="kr">return</span>
                       (<span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
                        inl k &lt;&gt; inl l -&gt;
                        fin_transpose_last_with n
                          (...) (...) = inl l)
                   <span class="kr">with</span>
                   | <span class="mi">0</span> =&gt;
                       <span class="kr">fun</span> (<span class="nv">k</span> <span class="nv">l</span> : Empty)
                         (<span class="nv">_</span> : inl k &lt;&gt; inl l) =&gt;
                       Overture.Empty_rec
                         (Overture.Empty_rec
                            (Empty + Unit &lt;~&gt;
                             Empty + Unit) k (inl l) =
                          inl l) k
                   | n.+<span class="mi">1</span> =&gt;
                       <span class="kr">fun</span> (<span class="nv">k</span> <span class="nv">l</span> : Fin n + Unit)
                         (<span class="nv">notk</span> : inl k &lt;&gt; inl l) =&gt;
                       <span class="kr">match</span>
                         k <span class="kr">as</span> s <span class="kr">return</span> (... -&gt; ...)
                       <span class="kr">with</span>
                       | inl f0 =&gt;
                           <span class="kr">fun</span> <span class="nv">notk0</span> : ... &lt;&gt; ... =&gt;
                           <span class="kr">match</span> ... <span class="kr">with</span>
                           | ... ...
                           | ... ...
                           <span class="kr">end</span> notk0
                       | inr u =&gt;
                           <span class="kr">fun</span> <span class="nv">notk0</span> : ... &lt;&gt; ... =&gt;
                           <span class="kr">match</span> ... <span class="kr">with</span>
                           | ... ...
                           | ... ...
                           <span class="kr">end</span> notk0
                       <span class="kr">end</span> notk
                   <span class="kr">end</span>) m y f q)
         | inr u =&gt;
             <span class="kr">match</span>
               u <span class="kr">as</span> u0
               <span class="kr">return</span>
                 (inl y &lt;&gt; inr u0 -&gt;
                  is_inl
                    (fin_transpose_last_with m (inl y)
                       (inr u0)))
             <span class="kr">with</span>
             | tt =&gt;
                 <span class="kr">fun</span> <span class="nv">_</span> : inl y &lt;&gt; inr tt =&gt;
                 internal_paths_rew_r
                   (<span class="kr">fun</span> <span class="nv">f</span> : Fin m + Unit =&gt; is_inl f)
                   tt
                   (fin_transpose_last_with_last m
                      (inl y))
             <span class="kr">end</span>
         <span class="kr">end</span>
           (<span class="kr">fun</span> <span class="nv">z</span> : inl y = e (inl a) =&gt;
            inl_ne_inr a tt (equiv_inj e (z^ @ p^))))
        x)) = e (inl x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkb5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chkb5"><hr></label><div class="goal-conclusion">fin_transpose_last_with m (inl y) (inr tt) =
e (inr tt)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb6">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inl y)
  (inl
     (unfunctor_sum_l
        (<span class="kr">fun</span> <span class="nv">x</span> : Fin n + Unit =&gt;
         fin_transpose_last_with m (inl y) (e x))
        (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
         <span class="kr">match</span>
           e (inl a) <span class="kr">as</span> s
           <span class="kr">return</span>
             (inl y &lt;&gt; s -&gt;
              is_inl
                (fin_transpose_last_with m (inl y) s))
         <span class="kr">with</span>
         | inl f =&gt;
             <span class="kr">fun</span> <span class="nv">q</span> : inl y &lt;&gt; inl f =&gt;
             internal_paths_rew_r
               (<span class="kr">fun</span> <span class="nv">f0</span> : Fin m + Unit =&gt; is_inl f0) tt
               ((<span class="kr">fix</span> IHn (n0 : nat) :
                     <span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n0,
                     inl k &lt;&gt; inl l -&gt;
                     fin_transpose_last_with n0
                       (inl k) (inl l) = inl l :=
                   <span class="kr">match</span>
                     n0 <span class="kr">as</span> n
                     <span class="kr">return</span>
                       (<span class="kr">forall</span> <span class="nv">k</span> <span class="nv">l</span> : Fin n,
                        inl k &lt;&gt; inl l -&gt;
                        fin_transpose_last_with n
                          (...) (...) = inl l)
                   <span class="kr">with</span>
                   | <span class="mi">0</span> =&gt;
                       <span class="kr">fun</span> (<span class="nv">k</span> <span class="nv">l</span> : Empty)
                         (<span class="nv">_</span> : inl k &lt;&gt; inl l) =&gt;
                       Overture.Empty_rec
                         (Overture.Empty_rec
                            (Empty + Unit &lt;~&gt;
                             Empty + Unit) k (inl l) =
                          inl l) k
                   | n.+<span class="mi">1</span> =&gt;
                       <span class="kr">fun</span> (<span class="nv">k</span> <span class="nv">l</span> : Fin n + Unit)
                         (<span class="nv">notk</span> : inl k &lt;&gt; inl l) =&gt;
                       <span class="kr">match</span>
                         k <span class="kr">as</span> s <span class="kr">return</span> (... -&gt; ...)
                       <span class="kr">with</span>
                       | inl f0 =&gt;
                           <span class="kr">fun</span> <span class="nv">notk0</span> : ... &lt;&gt; ... =&gt;
                           <span class="kr">match</span> ... <span class="kr">with</span>
                           | ... ...
                           | ... ...
                           <span class="kr">end</span> notk0
                       | inr u =&gt;
                           <span class="kr">fun</span> <span class="nv">notk0</span> : ... &lt;&gt; ... =&gt;
                           <span class="kr">match</span> ... <span class="kr">with</span>
                           | ... ...
                           | ... ...
                           <span class="kr">end</span> notk0
                       <span class="kr">end</span> notk
                   <span class="kr">end</span>) m y f q)
         | inr u =&gt;
             <span class="kr">match</span>
               u <span class="kr">as</span> u0
               <span class="kr">return</span>
                 (inl y &lt;&gt; inr u0 -&gt;
                  is_inl
                    (fin_transpose_last_with m (inl y)
                       (inr u0)))
             <span class="kr">with</span>
             | tt =&gt;
                 <span class="kr">fun</span> <span class="nv">_</span> : inl y &lt;&gt; inr tt =&gt;
                 internal_paths_rew_r
                   (<span class="kr">fun</span> <span class="nv">f</span> : Fin m + Unit =&gt; is_inl f)
                   tt
                   (fin_transpose_last_with_last m
                      (inl y))
             <span class="kr">end</span>
         <span class="kr">end</span>
           (<span class="kr">fun</span> <span class="nv">z</span> : inl y = e (inl a) =&gt;
            inl_ne_inr a tt (equiv_inj e (z^ @ p^))))
        x)) = e (inl x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb7"><span class="nb">rewrite</span> unfunctor_sum_l_beta.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inl y)
  (fin_transpose_last_with m (inl y) (e (inl x))) =
e (inl x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> fin_transpose_last_with_invol.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb8">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inl y</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inl y) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inl y) (inr tt) =
e (inr tt)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (fin_transpose_last_with_last _ _ @ p^).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkb9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{b : Fin n &lt;~&gt; Fin m &amp;
fin_equiv&#39; n m (inr tt, b) == e}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkba"><span class="nb">simple refine</span> (equiv_unfunctor_sum_l@{<span class="kt">Set</span> <span class="kt">Set</span> <span class="kt">Set</span> <span class="kt">Set</span> <span class="kt">Set</span> <span class="kt">Set</span>} e _ _ ; _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Fin n, is_inl (e (inl a))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkbb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chkbb"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Unit, is_inr (e (inr b))</div></blockquote><input class="alectryon-extra-goal-toggle" id="fin-v-chkbc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chkbc"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">b</span> : Fin n &lt;~&gt; Fin m =&gt;
 fin_equiv&#39; n m (inr tt, b) == e)
  (equiv_unfunctor_sum_l e <span class="nl">?Ha</span> <span class="nl">?Hb</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkbd">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Fin n, is_inl (e (inl a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkbe"><span class="nb">intros</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (e (inl a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkbf"><span class="nb">destruct</span> (is_inl_or_is_inr (e (inl a))) <span class="kr">as</span> [l|r].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>is_inl (e (inl a))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (e (inl a))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkc0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>is_inr (e (inl a))</span></span></span><br></div><label class="goal-separator" for="fin-v-chkc0"><hr></label><div class="goal-conclusion">is_inl (e (inl a))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkc1">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>is_inl (e (inl a))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (e (inl a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> l.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkc2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>is_inr (e (inl a))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (e (inl a))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkc3"><span class="nb">assert</span> (q := inr_un_inr (e (inl a)) r).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>is_inr (e (inl a))</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>inr (un_inr (e (inl a)) r) = e (inl a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (e (inl a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkc4"><span class="nb">apply</span> moveR_equiv_V <span class="kr">in</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>is_inr (e (inl a))</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr (un_inr (e (inl a)) r)) = inl a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (e (inl a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkc5"><span class="nb">assert</span> (s := q^ @ ap (e^-<span class="mi">1</span> o inr) (path_unit _ _) @ p&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>is_inr (e (inl a))</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr (un_inr (e (inl a)) r)) = inl a</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>inl a = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_inl (e (inl a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (inl_ne_inr _ _ s).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkc6">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Unit, is_inr (e (inr b))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkc7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chkc7"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">b</span> : Fin n &lt;~&gt; Fin m =&gt;
 fin_equiv&#39; n m (inr tt, b) == e)
  (equiv_unfunctor_sum_l e
     (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
      <span class="kr">let</span> <span class="nv">s</span> := is_inl_or_is_inr (e (inl a)) <span class="kr">in</span>
      <span class="kr">match</span> s <span class="kr">with</span>
      | inl i =&gt; idmap i
      | inr i =&gt;
          (<span class="kr">fun</span> <span class="nv">r</span> : is_inr (e (inl a)) =&gt;
           <span class="kr">let</span> <span class="nv">q</span> := inr_un_inr (e (inl a)) r <span class="kr">in</span>
           <span class="kr">let</span> <span class="nv">q0</span> :=
             moveR_equiv_V
               (inr (un_inr (e (inl a)) r)) (inl a) q
             <span class="kr">in</span>
           <span class="kr">let</span> <span class="nv">s0</span> :=
             (q0^ @
              ap (e^-<span class="mi">1</span> o inr)
                (path_unit (un_inr (e (inl a)) r) tt)) @
             p&#39; <span class="kr">in</span>
           Overture.Empty_rec (is_inl (e (inl a)))
             (inl_ne_inr a tt s0)) i
      <span class="kr">end</span>) <span class="nl">?Hb</span>)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkc8">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Unit, is_inr (e (inr b))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> []; <span class="bp">exact</span> (p^ # tt).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkc9">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">b</span> : Fin n &lt;~&gt; Fin m =&gt;
 fin_equiv&#39; n m (inr tt, b) == e)
  (equiv_unfunctor_sum_l e
     (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
      <span class="kr">let</span> <span class="nv">s</span> := is_inl_or_is_inr (e (inl a)) <span class="kr">in</span>
      <span class="kr">match</span> s <span class="kr">with</span>
      | inl i =&gt; idmap i
      | inr i =&gt;
          (<span class="kr">fun</span> <span class="nv">r</span> : is_inr (e (inl a)) =&gt;
           <span class="kr">let</span> <span class="nv">q</span> := inr_un_inr (e (inl a)) r <span class="kr">in</span>
           <span class="kr">let</span> <span class="nv">q0</span> :=
             moveR_equiv_V
               (inr (un_inr (e (inl a)) r)) (inl a) q
             <span class="kr">in</span>
           <span class="kr">let</span> <span class="nv">s0</span> :=
             (q0^ @
              ap (e^-<span class="mi">1</span> o inr)
                (path_unit (un_inr (e (inl a)) r) tt)) @
             p&#39; <span class="kr">in</span>
           Overture.Empty_rec (is_inl (e (inl a)))
             (inl_ne_inr a tt s0)) i
      <span class="kr">end</span>)
     (<span class="kr">fun</span> <span class="nv">b</span> : Unit =&gt;
      <span class="kr">match</span> b <span class="kr">as</span> u <span class="kr">return</span> (is_inr (e (inr u))) <span class="kr">with</span>
      | tt =&gt; transport is_inr p^ tt
      <span class="kr">end</span>))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkca"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_equiv&#39; n m
  (inr tt,
  equiv_unfunctor_sum_l e
    (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
     <span class="kr">let</span> <span class="nv">s</span> := is_inl_or_is_inr (e (inl a)) <span class="kr">in</span>
     <span class="kr">match</span> s <span class="kr">with</span>
     | inl i =&gt; i
     | inr i =&gt;
         <span class="kr">let</span> <span class="nv">q</span> := inr_un_inr (e (inl a)) i <span class="kr">in</span>
         <span class="kr">let</span> <span class="nv">q0</span> :=
           moveR_equiv_V (inr (un_inr (e (inl a)) i))
             (inl a) q <span class="kr">in</span>
         <span class="kr">let</span> <span class="nv">s0</span> :=
           (q0^ @
            ap (<span class="kr">fun</span> <span class="nv">x</span> : Unit =&gt; e^-<span class="mi">1</span> (inr x))
              (path_unit (un_inr (e (inl a)) i) tt)) @
           p&#39; <span class="kr">in</span>
         Overture.Empty_rec (is_inl (e (inl a)))
           (inl_ne_inr a tt s0)
     <span class="kr">end</span>)
    (<span class="kr">fun</span> <span class="nv">b</span> : Unit =&gt;
     <span class="kr">match</span> b <span class="kr">as</span> u <span class="kr">return</span> (is_inr (e (inr u))) <span class="kr">with</span>
     | tt =&gt; transport is_inr p^ tt
     <span class="kr">end</span>)) x = e x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkcb"><span class="nb">unfold</span> fst, snd; ev_equiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_equiv&#39; n m
  (inr tt,
  equiv_unfunctor_sum_l e
    (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
     <span class="kr">match</span> is_inl_or_is_inr (e (inl a)) <span class="kr">with</span>
     | inl i =&gt; i
     | inr i =&gt;
         Overture.Empty_rec (is_inl (e (inl a)))
           (inl_ne_inr a tt
              (((moveR_equiv_V
                   (inr (un_inr (e (inl a)) i))
                   (inl a) (inr_un_inr (e (inl a)) i))^ @
                ap (<span class="kr">fun</span> <span class="nv">x</span> : Unit =&gt; e^-<span class="mi">1</span> (inr x))
                  (path_unit (un_inr (e (inl a)) i) tt)) @
               p&#39;))
     <span class="kr">end</span>)
    (<span class="kr">fun</span> <span class="nv">b</span> : Unit =&gt;
     <span class="kr">match</span> b <span class="kr">as</span> u <span class="kr">return</span> (is_inr (e (inr u))) <span class="kr">with</span>
     | tt =&gt; transport is_inr p^ tt
     <span class="kr">end</span>)) x = e x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkcc"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inr tt)
  (functor_sum
     (unfunctor_sum_l e
        (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
         <span class="kr">match</span> is_inl_or_is_inr (e (inl a)) <span class="kr">with</span>
         | inl i =&gt; i
         | inr i =&gt;
             Overture.Empty_rec (is_inl (e (inl a)))
               (inl_ne_inr a tt
                  (((moveR_equiv_V
                       (inr (un_inr (e (inl a)) i))
                       (inl a)
                       (inr_un_inr (e (inl a)) i))^ @
                    ap (<span class="kr">fun</span> <span class="nv">x</span> : Unit =&gt; e^-<span class="mi">1</span> (inr x))
                      (path_unit
                         (un_inr (e (inl a)) i) tt)) @
                   p&#39;))
         <span class="kr">end</span>)) idmap x) = e x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkcd"><span class="nb">destruct</span> x <span class="kr">as</span> [a|[]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inr tt)
  (functor_sum
     (unfunctor_sum_l e
        (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
         <span class="kr">match</span> is_inl_or_is_inr (e (inl a)) <span class="kr">with</span>
         | inl i =&gt; i
         | inr i =&gt;
             Overture.Empty_rec (is_inl (e (inl a)))
               (inl_ne_inr a tt
                  (((moveR_equiv_V
                       (inr (un_inr (e (inl a)) i))
                       (inl a)
                       (inr_un_inr (e (inl a)) i))^ @
                    ap (<span class="kr">fun</span> <span class="nv">x</span> : Unit =&gt; e^-<span class="mi">1</span> (inr x))
                      (path_unit
                         (un_inr (e (inl a)) i) tt)) @
                   p&#39;))
         <span class="kr">end</span>)) idmap (inl a)) = e (inl a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkce" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><label class="goal-separator" for="fin-v-chkce"><hr></label><div class="goal-conclusion">fin_transpose_last_with m (inr tt)
  (functor_sum
     (unfunctor_sum_l e
        (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
         <span class="kr">match</span> is_inl_or_is_inr (e (inl a)) <span class="kr">with</span>
         | inl i =&gt; i
         | inr i =&gt;
             Overture.Empty_rec (is_inl (e (inl a)))
               (inl_ne_inr a tt
                  (((moveR_equiv_V
                       (inr (un_inr (e (inl a)) i))
                       (inl a)
                       (inr_un_inr (e (inl a)) i))^ @
                    ap (<span class="kr">fun</span> <span class="nv">x</span> : Unit =&gt; e^-<span class="mi">1</span> (inr x))
                      (path_unit
                         (un_inr (e (inl a)) i) tt)) @
                   p&#39;))
         <span class="kr">end</span>)) idmap (inr tt)) = e (inr tt)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkcf">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inr tt)
  (functor_sum
     (unfunctor_sum_l e
        (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
         <span class="kr">match</span> is_inl_or_is_inr (e (inl a)) <span class="kr">with</span>
         | inl i =&gt; i
         | inr i =&gt;
             Overture.Empty_rec (is_inl (e (inl a)))
               (inl_ne_inr a tt
                  (((moveR_equiv_V
                       (inr (un_inr (e (inl a)) i))
                       (inl a)
                       (inr_un_inr (e (inl a)) i))^ @
                    ap (<span class="kr">fun</span> <span class="nv">x</span> : Unit =&gt; e^-<span class="mi">1</span> (inr x))
                      (path_unit
                         (un_inr (e (inl a)) i) tt)) @
                   p&#39;))
         <span class="kr">end</span>)) idmap (inl a)) = e (inl a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd0"><span class="nb">rewrite</span> fin_transpose_last_with_last_other.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_sum
  (unfunctor_sum_l e
     (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
      <span class="kr">match</span> is_inl_or_is_inr (e (inl a)) <span class="kr">with</span>
      | inl i =&gt; i
      | inr i =&gt;
          Overture.Empty_rec (is_inl (e (inl a)))
            (inl_ne_inr a tt
               (((moveR_equiv_V
                    (inr (un_inr (e (inl a)) i))
                    (inl a) (inr_un_inr (e (inl a)) i))^ @
                 ap (<span class="kr">fun</span> <span class="nv">x</span> : Unit =&gt; e^-<span class="mi">1</span> (inr x))
                   (path_unit (un_inr (e (inl a)) i)
                      tt)) @ p&#39;))
      <span class="kr">end</span>)) idmap (inl a) = e (inl a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> unfunctor_sum_l_beta.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd1">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inr tt)
  (functor_sum
     (unfunctor_sum_l e
        (<span class="kr">fun</span> <span class="nv">a</span> : Fin n =&gt;
         <span class="kr">match</span> is_inl_or_is_inr (e (inl a)) <span class="kr">with</span>
         | inl i =&gt; i
         | inr i =&gt;
             Overture.Empty_rec (is_inl (e (inl a)))
               (inl_ne_inr a tt
                  (((moveR_equiv_V
                       (inr (un_inr (e (inl a)) i))
                       (inl a)
                       (inr_un_inr (e (inl a)) i))^ @
                    ap (<span class="kr">fun</span> <span class="nv">x</span> : Unit =&gt; e^-<span class="mi">1</span> (inr x))
                      (path_unit
                         (un_inr (e (inl a)) i) tt)) @
                   p&#39;))
         <span class="kr">end</span>)) idmap (inr tt)) = e (inr tt)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd2"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_transpose_last_with m (inr tt) (inr tt) =
e (inr tt)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd3"><span class="nb">rewrite</span> fin_transpose_last_with_last.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n + Unit &lt;~&gt; Fin m + Unit</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>e (inr tt) = inr tt</span></span></span><br><span><var>p'</var><span class="hyp-type"><b>: </b><span>e^-<span class="mi">1</span> (inr tt) = inr tt</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">inr tt = e (inr tt)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">symmetry</span>; <span class="bp">exact</span> p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_equiv_inv</span> (<span class="nv">n</span> <span class="nv">m</span> : nat) (<span class="nv">e</span> : Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span>)
  : (Fin m.+<span class="mi">1</span>) * (Fin n &lt;~&gt; Fin m)
  := (fin_equiv_hfiber n m e).<span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">fin_equiv_issect</span> (<span class="nv">n</span> <span class="nv">m</span> : nat) (<span class="nv">e</span> : Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span>)
  : fin_equiv&#39; n m (fin_equiv_inv n m e) == e
  := (fin_equiv_hfiber n m e).<span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd4"><span class="kn">Definition</span> <span class="nf">fin_equiv_inj_fst</span> (<span class="nv">n</span> <span class="nv">m</span> : nat)
           (<span class="nv">k</span> <span class="nv">l</span> : Fin m.+<span class="mi">1</span>) (<span class="nv">e</span> <span class="nv">f</span> : Fin n &lt;~&gt; Fin m)
  : (fin_equiv n m k e == fin_equiv n m l f) -&gt; (k = l).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_equiv n m k e == fin_equiv n m l f -&gt; k = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd5"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_equiv n m k e == fin_equiv n m l f -&gt; k = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd6"><span class="nb">intros</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv n m k e == fin_equiv n m l f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">k = l</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">refine</span> (_ @ p (inr tt) @ _); <span class="nb">simpl</span>;
  <span class="nb">rewrite</span> fin_transpose_last_with_last; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd7"><span class="kn">Definition</span> <span class="nf">fin_equiv_inj_snd</span> (<span class="nv">n</span> <span class="nv">m</span> : nat)
           (<span class="nv">k</span> <span class="nv">l</span> : Fin m.+<span class="mi">1</span>) (<span class="nv">e</span> <span class="nv">f</span> : Fin n &lt;~&gt; Fin m)
  : (fin_equiv n m k e == fin_equiv n m l f) -&gt; (e == f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_equiv n m k e == fin_equiv n m l f -&gt; e == f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_equiv n m k e == fin_equiv n m l f -&gt; e == f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkd9"><span class="nb">intros</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv n m k e == fin_equiv n m l f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e == f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkda"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv n m k e == fin_equiv n m l f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e x = f x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkdb"><span class="nb">assert</span> (q := p (inr tt)); <span class="nb">simpl</span> <span class="kr">in</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv n m k e == fin_equiv n m l f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>fin_transpose_last_with m k (inr tt) =
fin_transpose_last_with m l (inr tt)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e x = f x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkdc"><span class="nb">rewrite</span> !fin_transpose_last_with_last <span class="kr">in</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k, l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv n m k e == fin_equiv n m l f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>k = l</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e x = f x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkdd"><span class="nb">rewrite</span> &lt;- q <span class="kr">in</span> p; <span class="nb">clear</span> q l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e, f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv n m k e == fin_equiv n m k f</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e x = f x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (path_sum_inl _
           (equiv_inj (fin_transpose_last_with m k) (p (inl x)))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Now it&#39;s time for funext. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkde"><span class="kn">Instance</span> <span class="nf">isequiv_fin_equiv</span> `{Funext} (n m : nat)
  : IsEquiv (fin_equiv&#39; n m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (fin_equiv&#39; n m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkdf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (fin_equiv&#39; n m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke0"><span class="nb">refine</span> (isequiv_pathsplit <span class="mi">0</span> _); <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span>,
hfiber (fin_equiv&#39; n m) a</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chke1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="fin-v-chke1"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Fin m.+<span class="mi">1</span> * (Fin n &lt;~&gt; Fin m),
PathSplit <span class="mi">1</span> (ap (fin_equiv&#39; n m))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span>,
hfiber (fin_equiv&#39; n m) a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke3"><span class="nb">intros</span> e; <span class="kr">exists</span> (<span class="nv">fin_equiv_inv</span> <span class="nv">n</span> <span class="nv">m</span> <span class="nv">e</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fin_equiv&#39; n m (fin_equiv_inv n m e) = e</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_equiv, path_arrow, fin_equiv_issect.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : Fin m.+<span class="mi">1</span> * (Fin n &lt;~&gt; Fin m),
PathSplit <span class="mi">1</span> (ap (fin_equiv&#39; n m))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke5"><span class="nb">intros</span> [k e] [l f]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">forall</span>
  <span class="nv">a</span> : fin_equiv&#39; n m (k, e) = fin_equiv&#39; n m (l, f),
  hfiber (ap (fin_equiv&#39; n m)) a) *
 ((k, e) = (l, f) -&gt; (k, e) = (l, f) -&gt; Unit))%type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke6"><span class="nb">refine</span> (_ , <span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; tt).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">a</span> : fin_equiv&#39; n m (k, e) = fin_equiv&#39; n m (l, f),
hfiber (ap (fin_equiv&#39; n m)) a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke7"><span class="nb">intros</span> p; <span class="nb">refine</span> (_ ; path_ishprop _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv&#39; n m (k, e) = fin_equiv&#39; n m (l, f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(k, e) = (l, f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke8"><span class="nb">apply</span> (ap equiv_fun) <span class="kr">in</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv&#39; n m (k, e) = fin_equiv&#39; n m (l, f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(k, e) = (l, f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chke9"><span class="nb">apply</span> ap10 <span class="kr">in</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv&#39; n m (k, e) == fin_equiv&#39; n m (l, f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(k, e) = (l, f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkea"><span class="nb">apply</span> path_prod&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv&#39; n m (k, e) == fin_equiv&#39; n m (l, f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">k = l</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkeb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv&#39; n m (k, e) == fin_equiv&#39; n m (l, f)</span></span></span><br></div><label class="goal-separator" for="fin-v-chkeb"><hr></label><div class="goal-conclusion">e = f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkec">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv&#39; n m (k, e) == fin_equiv&#39; n m (l, f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">k = l</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (fin_equiv_inj_fst n m k l e f p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chked">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv&#39; n m (k, e) == fin_equiv&#39; n m (l, f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkee"><span class="nb">apply</span> path_equiv, path_arrow.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>l</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n &lt;~&gt; Fin m</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>fin_equiv&#39; n m (k, e) == fin_equiv&#39; n m (l, f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e == f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (fin_equiv_inj_snd n m k l e f p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_fin_equiv</span> `{Funext} (n m : nat)
  : ((Fin m.+<span class="mi">1</span>) * (Fin n &lt;~&gt; Fin m)) &lt;~&gt; (Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span>)
  := Build_Equiv _ _ (fin_equiv&#39; n m) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** In particular, this implies that if two canonical finite sets are equivalent, then their cardinalities are equal. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkef"><span class="kn">Definition</span> <span class="nf">nat_eq_fin_equiv</span> (<span class="nv">n</span> <span class="nv">m</span> : nat)
: (Fin n &lt;~&gt; Fin m) -&gt; (n = m).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n &lt;~&gt; Fin m -&gt; n = m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkf0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n, m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n &lt;~&gt; Fin m -&gt; n = m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkf1"><span class="nb">revert</span> m; simple_induction n n IHn; <span class="nb">intro</span> m; simple_induction m m IHm; <span class="nb">intros</span> e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> &lt;~&gt; Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkf2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHm</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> &lt;~&gt; Fin m -&gt; <span class="mi">0</span> = m</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> &lt;~&gt; Fin m.+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chkf2"><hr></label><div class="goal-conclusion"><span class="mi">0</span> = m.+<span class="mi">1</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="fin-v-chkf3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">m</span> : nat, Fin n &lt;~&gt; Fin m -&gt; n = m</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin <span class="mi">0</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chkf3"><hr></label><div class="goal-conclusion">n.+<span class="mi">1</span> = <span class="mi">0</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="fin-v-chkf4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">m</span> : nat, Fin n &lt;~&gt; Fin m -&gt; n = m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHm</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m -&gt; n.+<span class="mi">1</span> = m</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chkf4"><hr></label><div class="goal-conclusion">n.+<span class="mi">1</span> = m.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkf5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> &lt;~&gt; Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkf6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHm</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> &lt;~&gt; Fin m -&gt; <span class="mi">0</span> = m</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> &lt;~&gt; Fin m.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = m.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (e^-<span class="mi">1</span> (inr tt)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkf7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">m</span> : nat, Fin n &lt;~&gt; Fin m -&gt; n = m</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n.+<span class="mi">1</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (e (inr tt)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkf8">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">m</span> : nat, Fin n &lt;~&gt; Fin m -&gt; n = m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHm</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m -&gt; n.+<span class="mi">1</span> = m</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">n.+<span class="mi">1</span> = m.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkf9"><span class="nb">refine</span> (ap S (IHn m _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">m</span> : nat, Fin n &lt;~&gt; Fin m -&gt; n = m</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHm</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m -&gt; n.+<span class="mi">1</span> = m</span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span> &lt;~&gt; Fin m.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n &lt;~&gt; Fin m</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (snd (fin_equiv_inv n m e)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Initial segments of [nat] *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkfa"><span class="kn">Definition</span> <span class="nf">nat_fin</span> (<span class="nv">n</span> : nat) (<span class="nv">k</span> : Fin n) : nat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkfb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkfc">simple_induction n n nf; <span class="nb">intro</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chkfd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nf</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chkfd"><hr></label><div class="goal-conclusion">nat</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkfe">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chkff">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nf</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk100"><span class="nb">destruct</span> k <span class="kr">as</span> [k|_].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nf</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk101" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nf</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br></div><label class="goal-separator" for="fin-v-chk101"><hr></label><div class="goal-conclusion">nat</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk102">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nf</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (nf k).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk103">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nf</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> n.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">nat_fin_inl</span> (<span class="nv">n</span> : nat) (<span class="nv">k</span> : Fin n)
  : nat_fin n.+<span class="mi">1</span> (inl k) = nat_fin n k
  := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk104"><span class="kn">Definition</span> <span class="nf">nat_fin_compl</span> (<span class="nv">n</span> : nat) (<span class="nv">k</span> : Fin n) : nat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk105"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk106">simple_induction n n nfc; <span class="nb">intro</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk107" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nfc</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chk107"><hr></label><div class="goal-conclusion">nat</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk108">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk109">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nfc</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk10a"><span class="nb">destruct</span> k <span class="kr">as</span> [k|_].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nfc</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk10b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nfc</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br></div><label class="goal-separator" for="fin-v-chk10b"><hr></label><div class="goal-conclusion">nat</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk10c">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nfc</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (nfc k).+<span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk10d">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>nfc</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nat</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk10e"><span class="kn">Definition</span> <span class="nf">nat_fin_compl_compl</span> <span class="nv">n</span> <span class="nv">k</span>
  : (nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk10f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk110">simple_induction n n IHn; <span class="nb">intro</span> k.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(nat_fin <span class="mi">0</span> k + nat_fin_compl <span class="mi">0</span> k).+<span class="mi">1</span> = <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk111" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, (nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="fin-v-chk111"><hr></label><div class="goal-conclusion">(nat_fin n.+<span class="mi">1</span> k + nat_fin_compl n.+<span class="mi">1</span> k).+<span class="mi">1</span> = n.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk112">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(nat_fin <span class="mi">0</span> k + nat_fin_compl <span class="mi">0</span> k).+<span class="mi">1</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk113">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, (nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(nat_fin n.+<span class="mi">1</span> k + nat_fin_compl n.+<span class="mi">1</span> k).+<span class="mi">1</span> = n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk114"><span class="nb">destruct</span> k <span class="kr">as</span> [k|?]; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, (nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(nat_fin n k + (nat_fin_compl n k).+<span class="mi">1</span>).+<span class="mi">1</span> = n.+<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk115" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, (nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk115"><hr></label><div class="goal-conclusion">(n + <span class="mi">0</span>).+<span class="mi">1</span> = n.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk116">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, (nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(nat_fin n k + (nat_fin_compl n k).+<span class="mi">1</span>).+<span class="mi">1</span> = n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk117"><span class="nb">rewrite</span> nat_add_comm.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, (nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((nat_fin_compl n k).+<span class="mi">1</span> + nat_fin n k).+<span class="mi">1</span> = n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk118"><span class="nb">specialize</span> (IHn k).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>(nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((nat_fin_compl n k).+<span class="mi">1</span> + nat_fin n k).+<span class="mi">1</span> = n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk119"><span class="nb">rewrite</span> nat_add_comm <span class="kr">in</span> IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>(nat_fin_compl n k + nat_fin n k).+<span class="mi">1</span> = n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">((nat_fin_compl n k).+<span class="mi">1</span> + nat_fin n k).+<span class="mi">1</span> = n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap S IHn).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk11a">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">k</span> : Fin n, (nat_fin n k + nat_fin_compl n k).+<span class="mi">1</span> = n</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(n + <span class="mi">0</span>).+<span class="mi">1</span> = n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">rewrite</span> nat_add_comm; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** [fsucc_mod] is the successor function mod n *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk11b"><span class="kn">Definition</span> <span class="nf">fsucc_mod</span>@{} {n : nat} : Fin n -&gt; Fin n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n -&gt; Fin n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk11c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n -&gt; Fin n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk11d"><span class="nb">destruct</span> n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin <span class="mi">0</span> -&gt; Fin <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk11e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><label class="goal-separator" for="fin-v-chk11e"><hr></label><div class="goal-conclusion">Fin n.+<span class="mi">1</span> -&gt; Fin n.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk11f"><span class="mi">1</span>: <span class="bp">exact</span> idmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">1</span> -&gt; Fin n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk120"><span class="nb">intros</span> [x|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk121" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><label class="goal-separator" for="fin-v-chk121"><hr></label><div class="goal-conclusion">Fin n.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk122">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Fin n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (fsucc x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk123">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span>Unit</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Fin n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> fin_zero.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** [fsucc] allows us to convert a natural number into an element of a finite set. This can be thought of as the modulo map. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">fin_nat</span> {<span class="nv">n</span> : nat} (<span class="nv">m</span> : nat) : Fin n.+<span class="mi">1</span>
  := <span class="kr">match</span> m <span class="kr">with</span>
      | <span class="mi">0</span> =&gt; fin_zero
      | S m =&gt; fsucc_mod (fin_nat m)
     <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The 1-dimensional version of Sperner&#39;s lemma says that given any finite sequence of decidable hProps, where the sequence starts with true and ends with false, we can find a point in the sequence where the sequence changes from true to false. This is like a discrete intermediate value theorem. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk124"><span class="kn">Fixpoint</span> <span class="nf">sperners_lemma_1d</span> {<span class="nv">n</span>} :
  <span class="kr">forall</span> (<span class="nv">f</span> : Fin (n.+<span class="mi">2</span>) -&gt; <span class="kt">Type</span>)
         {<span class="nv">dprop</span> : <span class="kr">forall</span> <span class="nv">i</span>, Decidable (f i)}
         (<span class="nv">left_true</span> : f fin_zero)
         (<span class="nv">right_false</span> : ~ f fin_last),
    {k : Fin n.+<span class="mi">1</span> &amp; f (fin_incl k) /\ ~ f (fsucc k)}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>, Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk125"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>, Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk126"><span class="nb">intros</span> ???.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk127"><span class="nb">destruct</span> n <span class="kr">as</span> [|n].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">2</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin <span class="mi">2</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin <span class="mi">1</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk128" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">3</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">3</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br></div><label class="goal-separator" for="fin-v-chk128"><hr></label><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin n.+<span class="mi">2</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk129">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">2</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin <span class="mi">2</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin <span class="mi">1</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk12a"><span class="kr">exists</span> <span class="nv">fin_zero</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">2</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin <span class="mi">2</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br><span><var>right_false</var><span class="hyp-type"><b>: </b><span>~ f fin_last</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f (fin_incl fin_zero) * ~ f (fsucc fin_zero))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk12b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">3</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">3</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin n.+<span class="mi">2</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk12c"><span class="nb">destruct</span> (dec (f (fin_incl fin_last))) <span class="kr">as</span> [prev_true|prev_false].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">3</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">3</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br><span><var>prev_true</var><span class="hyp-type"><b>: </b><span>f (fin_incl fin_last)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin n.+<span class="mi">2</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="fin-v-chk12d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">3</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">3</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br><span><var>prev_false</var><span class="hyp-type"><b>: </b><span>~ f (fin_incl fin_last)</span></span></span><br></div><label class="goal-separator" for="fin-v-chk12d"><hr></label><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin n.+<span class="mi">2</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk12e">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">3</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">3</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br><span><var>prev_true</var><span class="hyp-type"><b>: </b><span>f (fin_incl fin_last)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin n.+<span class="mi">2</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk12f"><span class="kr">exists</span> <span class="nv">fin_last</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">3</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">3</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br><span><var>prev_true</var><span class="hyp-type"><b>: </b><span>f (fin_incl fin_last)</span></span></span><br><span><var>right_false</var><span class="hyp-type"><b>: </b><span>~ f fin_last</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f (fin_incl fin_last) * ~ f (fsucc fin_last))%type</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk130">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">3</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">3</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br><span><var>prev_false</var><span class="hyp-type"><b>: </b><span>~ f (fin_incl fin_last)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin n.+<span class="mi">2</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk131"><span class="nb">destruct</span> (sperners_lemma_1d _ (f o fin_incl) _ left_true prev_false) <span class="kr">as</span> [k&#39; [fleft fright]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">3</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">3</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br><span><var>prev_false</var><span class="hyp-type"><b>: </b><span>~ f (fin_incl fin_last)</span></span></span><br><span><var>k'</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>fleft</var><span class="hyp-type"><b>: </b><span>f (fin_incl (fin_incl k&#39;))</span></span></span><br><span><var>fright</var><span class="hyp-type"><b>: </b><span>~ f (fin_incl (fsucc k&#39;))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ f fin_last -&gt;
{k : Fin n.+<span class="mi">2</span> &amp; (f (fin_incl k) * ~ f (fsucc k))%type}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="fin-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="fin-v-chk132"><span class="kr">exists</span> (<span class="nv">fin_incl</span> <span class="nv">k&#39;</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>sperners_lemma_1d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">n</span> : nat)
(<span class="nv">f</span> : Fin n.+<span class="mi">2</span> -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">2</span>,
 Decidable (f i)) -&gt;
f fin_zero -&gt;
~ f fin_last -&gt;
{k : Fin n.+<span class="mi">1</span> &amp;
(f (fin_incl k) * ~ f (fsucc k))%type}</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">3</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>dprop</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">i</span> : Fin n.+<span class="mi">3</span>, Decidable (f i)</span></span></span><br><span><var>left_true</var><span class="hyp-type"><b>: </b><span>f fin_zero</span></span></span><br><span><var>prev_false</var><span class="hyp-type"><b>: </b><span>~ f (fin_incl fin_last)</span></span></span><br><span><var>k'</var><span class="hyp-type"><b>: </b><span>Fin n.+<span class="mi">1</span></span></span></span><br><span><var>fleft</var><span class="hyp-type"><b>: </b><span>f (fin_incl (fin_incl k&#39;))</span></span></span><br><span><var>fright</var><span class="hyp-type"><b>: </b><span>~ f (fin_incl (fsucc k&#39;))</span></span></span><br><span><var>right_false</var><span class="hyp-type"><b>: </b><span>~ f fin_last</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(f (fin_incl (fin_incl k&#39;)) *
 ~ f (fsucc (fin_incl k&#39;)))%type</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">split</span>; <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span></span></pre>
</div>
</div></body>
</html>
