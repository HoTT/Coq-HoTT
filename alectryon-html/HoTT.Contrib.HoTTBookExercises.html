<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>HoTTBookExercises.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="sd">(** The HoTT Book Exercises formalization. *)</span>

<span class="sd">(** This file records formalized solutions to the HoTT Book exercises. *)</span>

<span class="c">(*  See HoTTBook.v for an IMPORTANT NOTE FOR THE HoTT DEVELOPERS.</span>

<span class="c">    PROCEDURE FOR UPDATING THE FILE:</span>

<span class="c">   1. Compile the latest version of the HoTT Book to update the LaTeX</span>
<span class="c">      labels. Do not forget to pull in changes from HoTT/HoTT.</span>

<span class="c">   2. Run `etc/Book.py` using the `--exercises` flag (so your command</span>
<span class="c">      should look like `cat ../book/*.aux | etc/Book.py --exercises contrib/HoTTBookExercises.v`)</span>
<span class="c">      If it complains, fix things.</span>

<span class="c">   3. Add contents to new entries.</span>

<span class="c">   4. Run `etc/Book.py` again to make sure it is happy.</span>

<span class="c">   5. Compile this file with `make contrib` or `make contrib/HoTTBookExercises.vo`.</span>

<span class="c">   6. Do the git thing to submit your changes.</span>

<span class="c">*)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk0"><span class="kn">From</span> HoTT <span class="kn">Require Import</span> Basics Types HProp HSet Projective
     TruncType Truncations Modalities.Notnot Modalities.Open Modalities.Closed
     Misc.BoundedSearch Equiv.BiInv Spaces.Nat Spaces.Torus.TorusEquivCircles
     Classes.implementations.peano_naturals Metatheory.Core Metatheory.FunextVarieties
     Metatheory.ImpredicativeTruncation Spaces.Finite.Fin ExcludedMiddle.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> nat_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> type_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> path_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* END OF PREAMBLE *)</span>
<span class="c">(* ================================================== ex:composition *)</span>
<span class="sd">(** Exercise 1.1 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_1</span> := (<span class="kr">fun</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C) =&gt; g o f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1"><span class="kn">Theorem</span> <span class="nf">Book_1_1_refl</span> : <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C) (<span class="nv">h</span> : C -&gt; D),
                          h o (g o f) = (h o g) o f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C)
(<span class="nv">h</span> : C -&gt; D), h o (g o f) = h o g o f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : B -&gt; C)
(<span class="nv">h</span> : C -&gt; D), h o (g o f) = h o g o f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:pr-to-rec *)</span>
<span class="sd">(** Exercise 1.2 *)</span>

<span class="sd">(** Recursor as equivalence. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_2_prod_lib</span> := @HoTT.Types.Prod.equiv_uncurry.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_2_prod</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Recursor with projection functions instead of pattern-matching. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">prod_rec_proj</span> <span class="nv">C</span> (<span class="nv">g</span> : A -&gt; B -&gt; C) (<span class="nv">p</span> : A * B) : C
    := g (fst p) (snd p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_2_prod</span> := prod_rec_proj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3"><span class="kn">Proposition</span> <span class="nf">Book_1_2_prod_fst</span> : fst = prod_rec_proj A (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> =&gt; a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>prod_rec_proj</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : A -&gt; B -&gt; C)
  (<span class="nv">p</span> : A * B) =&gt; g (fst p) (snd p)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(A -&gt; B -&gt; C) -&gt; A * B -&gt; C</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst = prod_rec_proj A (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">_</span> : B) =&gt; a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>prod_rec_proj</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : A -&gt; B -&gt; C)
  (<span class="nv">p</span> : A * B) =&gt; g (fst p) (snd p)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(A -&gt; B -&gt; C) -&gt; A * B -&gt; C</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst = prod_rec_proj A (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">_</span> : B) =&gt; a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5"><span class="kn">Proposition</span> <span class="nf">Book_1_2_prod_snd</span> : snd = prod_rec_proj B (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">b</span> =&gt; b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>prod_rec_proj</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : A -&gt; B -&gt; C)
  (<span class="nv">p</span> : A * B) =&gt; g (fst p) (snd p)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(A -&gt; B -&gt; C) -&gt; A * B -&gt; C</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd = prod_rec_proj B (<span class="kr">fun</span> <span class="nv">_</span> : A =&gt; idmap)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>prod_rec_proj</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : A -&gt; B -&gt; C)
  (<span class="nv">p</span> : A * B) =&gt; g (fst p) (snd p)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(A -&gt; B -&gt; C) -&gt; A * B -&gt; C</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd = prod_rec_proj B (<span class="kr">fun</span> <span class="nv">_</span> : A =&gt; idmap)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_2_prod</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Recursor as (dependent) equivalence. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_2_sig_lib</span> := @HoTT.Types.Sigma.equiv_sig_ind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_2_sig</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">A</span> : <span class="kt">Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">B</span> : A -&gt; <span class="kt">Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Non-dependent recursor with projection functions instead of pattern matching. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">sig_rec_proj</span> <span class="nv">C</span> (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A), B x -&gt; C) (<span class="nv">p</span> : <span class="kr">exists</span> (<span class="nv">x</span> : A), B x) : C
    := g (pr1 p) (pr2 p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_2_sig</span> := @sig_rec_proj.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7"><span class="kn">Proposition</span> <span class="nf">Book_1_2_sig_fst</span> : @pr1 A B = sig_rec_proj A (<span class="kr">fun</span> <span class="nv">a</span> =&gt; <span class="kr">fun</span> <span class="nv">b</span> =&gt; a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>sig_rec_proj</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span> : A, B x -&gt; C)
  (<span class="nv">p</span> : {x : A &amp; B x}) =&gt; 
g p.<span class="mi">1</span> p.<span class="mi">2</span></span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">x</span> : A, B x -&gt; C) -&gt;
{x : A &amp; B x} -&gt; C</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pr1 = sig_rec_proj A (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">_</span> : B a) =&gt; a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>sig_rec_proj</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span> : A, B x -&gt; C)
  (<span class="nv">p</span> : {x : A &amp; B x}) =&gt; 
g p.<span class="mi">1</span> p.<span class="mi">2</span></span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">x</span> : A, B x -&gt; C) -&gt;
{x : A &amp; B x} -&gt; C</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">pr1 = sig_rec_proj A (<span class="kr">fun</span> (<span class="nv">a</span> : A) (<span class="nv">_</span> : B a) =&gt; a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** NB: You cannot implement pr2 with only the recursor, so it is not possible</span>
<span class="sd">      to check its definitional equality as the exercise suggests. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_2_sig</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:pr-to-ind *)</span>
<span class="sd">(** Exercise 1.3 *)</span>

<span class="sd">(** The propositional uniqueness principles are named with an</span>
<span class="sd">    &#39;eta&#39; postfix in the HoTT library. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_3_prod_lib</span> := @HoTT.Types.Prod.prod_ind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_3_prod</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">prod_ind_eta</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>) (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) (<span class="nv">x</span> : A * B) : C x
    := transport C (HoTT.Types.Prod.eta_prod x) (g (fst x) (snd x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_3_prod</span> := prod_ind_eta.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9"><span class="kn">Proposition</span> <span class="nf">Book_1_3_prod_refl</span> : <span class="kr">forall</span> <span class="nv">C</span> <span class="nv">g</span> <span class="nv">a</span> <span class="nv">b</span>, prod_ind_eta C g (a, b) = g a b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>prod_ind_eta</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y))
  (<span class="nv">x</span> : A * B) =&gt;
transport C (eta_prod x)
  (g (fst x) (snd x))</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : A * B, C x</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>)
(<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) (<span class="nv">a</span> : A)
(<span class="nv">b</span> : B), prod_ind_eta C g (a, b) = g a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>prod_ind_eta</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y))
  (<span class="nv">x</span> : A * B) =&gt;
transport C (eta_prod x)
  (g (fst x) (snd x))</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : A * B, C x</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : A * B -&gt; <span class="kt">Type</span>)
(<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : B), C (x, y)) (<span class="nv">a</span> : A)
(<span class="nv">b</span> : B), prod_ind_eta C g (a, b) = g a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_3_prod</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_3_sig_lib</span> := @HoTT.Basics.Overture.sig_ind.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_3_sig</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">A</span> : <span class="kt">Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">B</span> : A -&gt; <span class="kt">Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">sig_ind_eta</span> (<span class="nv">C</span> : (<span class="kr">exists</span> (<span class="nv">a</span> : A), B a) -&gt; <span class="kt">Type</span>)
                          (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b))
                          (<span class="nv">x</span> : <span class="kr">exists</span> (<span class="nv">a</span> : A), B a) : C x
    := transport C (HoTT.Types.Sigma.eta_sigma x) (g (pr1 x) (pr2 x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_3_sig</span> := sig_ind_eta.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb"><span class="kn">Proposition</span> <span class="nf">Book_1_3_sig_refl</span> : <span class="kr">forall</span> <span class="nv">C</span> <span class="nv">g</span> <span class="nv">a</span> <span class="nv">b</span>, sig_ind_eta C g (a; b) = g a b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>sig_ind_eta</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b))
  (<span class="nv">x</span> : {a : A &amp; B a}) =&gt;
transport C (eta_sigma x) (g x.<span class="mi">1</span> x.<span class="mi">2</span>)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : {a : A &amp; B a}, C x</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>)
(<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b)) (<span class="nv">a</span> : A)
(<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt; B a0) a),
sig_ind_eta C g (a; b) = g a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>sig_ind_eta</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>)
  (<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b))
  (<span class="nv">x</span> : {a : A &amp; B a}) =&gt;
transport C (eta_sigma x) (g x.<span class="mi">1</span> x.<span class="mi">2</span>)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : {a : A &amp; B a}, C x</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : {a : A &amp; B a} -&gt; <span class="kt">Type</span>)
(<span class="nv">g</span> : <span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B a), C (a; b)) (<span class="nv">a</span> : A)
(<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt; B a0) a),
sig_ind_eta C g (a; b) = g a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_3_sig</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:iterator *)</span>
<span class="sd">(** Exercise 1.4 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_4</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">Book_1_4_iter</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">c0</span> : C) (<span class="nv">cs</span> : C -&gt; C) (<span class="nv">n</span> : nat) : C
    := <span class="kr">match</span> n <span class="kr">with</span>
      | O =&gt; c0
      | S m =&gt; cs (Book_1_4_iter C c0 cs m)
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_4_rec&#39;</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">c0</span> : C) (<span class="nv">cs</span> : nat -&gt; C -&gt; C) : nat -&gt; nat * C
    := Book_1_4_iter (nat * C) (O, c0) (<span class="kr">fun</span> <span class="nv">x</span> =&gt; (S (fst x), cs (fst x) (snd x))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_4_rec</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">c0</span> : C) (<span class="nv">cs</span> : nat -&gt; C -&gt; C) (<span class="nv">n</span> : nat) : C
    := snd (Book_1_4_rec&#39; C c0 cs n).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd"><span class="kn">Lemma</span> <span class="nf">Book_1_4_aux</span> : <span class="kr">forall</span> <span class="nv">C</span> <span class="nv">c0</span> <span class="nv">cs</span> <span class="nv">n</span>, fst (Book_1_4_rec&#39; C c0 cs n) = n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">c0</span> : C) (<span class="nv">cs</span> : nat -&gt; C -&gt; C)
(<span class="nv">n</span> : nat), fst (Book_1_4_rec&#39; C c0 cs n) = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">c0</span> : C) (<span class="nv">cs</span> : nat -&gt; C -&gt; C)
(<span class="nv">n</span> : nat), fst (Book_1_4_rec&#39; C c0 cs n) = n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf"><span class="nb">intros</span> C c0 cs n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst (Book_1_4_rec&#39; C c0 cs n) = n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10"><span class="nb">induction</span> n <span class="kr">as</span> [| m IH].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst (Book_1_4_rec&#39; C c0 cs <span class="mi">0</span>) = <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk11" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>fst (Book_1_4_rec&#39; C c0 cs m) = m</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk11"><hr></label><div class="goal-conclusion">fst (Book_1_4_rec&#39; C c0 cs m.+<span class="mi">1</span>) = m.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst (Book_1_4_rec&#39; C c0 cs <span class="mi">0</span>) = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>fst (Book_1_4_rec&#39; C c0 cs m) = m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fst (Book_1_4_rec&#39; C c0 cs m.+<span class="mi">1</span>) = m.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15"><span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>fst (Book_1_4_rec&#39; C c0 cs m) = m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(fst (Book_1_4_rec&#39; C c0 cs m)).+<span class="mi">1</span> = m.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap S IH).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16"><span class="kn">Proposition</span> <span class="nf">Book_1_4_eq</span>
    : <span class="kr">forall</span> <span class="nv">C</span> <span class="nv">c0</span> <span class="nv">cs</span> <span class="nv">n</span>, Book_1_4_rec C c0 cs n = nat_rect (<span class="kr">fun</span> <span class="nv">_</span> =&gt; C) c0 cs n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">c0</span> : C) (<span class="nv">cs</span> : nat -&gt; C -&gt; C)
(<span class="nv">n</span> : nat),
Book_1_4_rec C c0 cs n =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">C</span> : <span class="kt">Type</span>) (<span class="nv">c0</span> : C) (<span class="nv">cs</span> : nat -&gt; C -&gt; C)
(<span class="nv">n</span> : nat),
Book_1_4_rec C c0 cs n =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs n</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18"><span class="nb">intros</span> C c0 cs n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_4_rec C c0 cs n =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs n</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19"><span class="nb">induction</span> n <span class="kr">as</span> [| m IH].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_4_rec C c0 cs <span class="mi">0</span> =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs <span class="mi">0</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>Book_1_4_rec C c0 cs m =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs m</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1a"><hr></label><div class="goal-conclusion">Book_1_4_rec C c0 cs m.+<span class="mi">1</span> =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs m.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_4_rec C c0 cs <span class="mi">0</span> =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_4_rec C c0 cs <span class="mi">0</span> = c0</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>Book_1_4_rec C c0 cs m =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_4_rec C c0 cs m.+<span class="mi">1</span> =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs m.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e"><span class="nb">change</span> (cs (fst (Book_1_4_rec&#39; C c0 cs m)) (Book_1_4_rec C c0 cs m)
              = cs m (nat_rect (<span class="kr">fun</span> <span class="nv">_</span> =&gt; C) c0 cs m)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>Book_1_4_rec C c0 cs m =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cs (fst (Book_1_4_rec&#39; C c0 cs m))
  (Book_1_4_rec C c0 cs m) =
cs m (nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1f">lhs rapply (ap (<span class="kr">fun</span> <span class="nv">x</span> =&gt; cs x _) (Book_1_4_aux _ _ _ _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>c0</var><span class="hyp-type"><b>: </b><span>C</span></span></span><br><span><var>cs</var><span class="hyp-type"><b>: </b><span>nat -&gt; C -&gt; C</span></span></span><br><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span>Book_1_4_rec C c0 cs m =
nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">cs m (Book_1_4_rec C c0 cs m) =
cs m (nat_rect (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; C) c0 cs m)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap (cs m) IH).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_4</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:sum-via-bool *)</span>
<span class="sd">(** Exercise 1.5 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_5</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_5_sum</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) := { x : Bool &amp; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;&#39;inl&#39; a&quot;</span> := (true; a) (<span class="kn">at level</span> <span class="mi">0</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;&#39;inr&#39; b&quot;</span> := (false; b) (<span class="kn">at level</span> <span class="mi">0</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_5_ind</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">C</span> : Book_1_5_sum A B -&gt; <span class="kt">Type</span>) (<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">a</span>, C (inl a))
   (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">b</span>, C (inr b)) : <span class="kr">forall</span> <span class="nv">x</span> : Book_1_5_sum A B, C x := <span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="kr">match</span> x <span class="kr">with</span>
   | inl a =&gt; f a
   | inr b =&gt; g b
   <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk20"><span class="kn">Theorem</span> <span class="nf">inl_red</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">C</span> : Book_1_5_sum A B -&gt; <span class="kt">Type</span>} <span class="nv">f</span> <span class="nv">g</span> { <span class="nv">a</span> : A }
  : Book_1_5_ind A B C f g (inl a) = f a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Book_1_5_sum A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span>
<span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) true,
C inl (a)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span>
<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) false,
C inr (b)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_5_ind A B C f g inl (a) = f a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk21"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Book_1_5_sum A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span>
<span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) true,
C inl (a)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span>
<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) false,
C inr (b)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_5_ind A B C f g inl (a) = f a</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk22"><span class="kn">Theorem</span> <span class="nf">inr_red</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">C</span> : Book_1_5_sum A B -&gt; <span class="kt">Type</span>} <span class="nv">f</span> <span class="nv">g</span> { <span class="nv">b</span> : B }
  : Book_1_5_ind A B C f g (inr b) = g b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Book_1_5_sum A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span>
<span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) true,
C inl (a)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span>
<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) false,
C inr (b)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_5_ind A B C f g inr (b) = g b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk23"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Book_1_5_sum A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span>
<span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) true,
C inl (a)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span>
<span class="nv">b</span> : (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B) false,
C inr (b)</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_5_ind A B C f g inr (b) = g b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_5</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:prod-via-bool *)</span>
<span class="sd">(** Exercise 1.6 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_6</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> `{Funext}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_6_prod</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) := <span class="kr">forall</span> <span class="nv">x</span> : Bool, (<span class="kr">if</span> x <span class="kr">then</span> A <span class="kr">else</span> B).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_6_mk_pair</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) : Book_1_6_prod A B
    := <span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="kr">match</span> x <span class="kr">with</span>
              | true =&gt; a
              | false =&gt; b
              <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;( a , b )&quot;</span> := (Book_1_6_mk_pair a b) (<span class="kn">at level</span> <span class="mi">0</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;&#39;pr1&#39; p&quot;</span> := (p true) (<span class="kn">at level</span> <span class="mi">0</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot;&#39;pr2&#39; p&quot;</span> := (p false) (<span class="kn">at level</span> <span class="mi">0</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_6_eq</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">p</span> : Book_1_6_prod A B) : (pr1 p, pr2 p) == p
    := <span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="kr">match</span> x <span class="kr">with</span>
              | true =&gt; <span class="mi">1</span>
              | false =&gt; <span class="mi">1</span>
              <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk24"><span class="kn">Theorem</span> <span class="nf">Book_1_6_id</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">a</span> : A) (<span class="nv">b</span> : B) : Book_1_6_eq (a, b) = (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_6_eq (a, b) = (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk25"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_6_eq (a, b) = (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk26"><span class="nb">apply</span> path_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_6_eq (a, b) == (<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk27"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_6_eq (a, b) x = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> x; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_6_eta</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">p</span> : Book_1_6_prod A B) : (pr1 p, pr2 p) = p
    := path_forall (pr1 p, pr2 p) p (Book_1_6_eq p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_6_ind</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">C</span> : Book_1_6_prod A B -&gt; <span class="kt">Type</span>) (<span class="nv">f</span> : <span class="kr">forall</span> <span class="nv">a</span> <span class="nv">b</span>, C (a, b))
    (<span class="nv">p</span> : Book_1_6_prod A B) : C p
    := transport C (Book_1_6_eta p) (f (pr1 p) (pr2 p)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk28"><span class="kn">Theorem</span> <span class="nf">Book_1_6_red</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">C</span> : Book_1_6_prod A B -&gt; <span class="kt">Type</span>) <span class="nv">f</span> <span class="nv">a</span> <span class="nv">b</span>
    : Book_1_6_ind C f (a, b) = f a b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Book_1_6_prod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B), C (a, b)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_6_ind C f (a, b) = f a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk29"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Book_1_6_prod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B), C (a, b)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_1_6_ind C f (a, b) = f a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a"><span class="nb">unfold</span> Book_1_6_ind, Book_1_6_eta.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Book_1_6_prod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B), C (a, b)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport C
  (path_forall ((a, b) true, (a, b) false) (a, b)
     (Book_1_6_eq (a, b)))
  (f ((a, b) true) ((a, b) false)) = f a b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Book_1_6_prod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B), C (a, b)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport C
  (path_forall (a, b) (a, b) (Book_1_6_eq (a, b)))
  (f a b) = f a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2c"><span class="nb">rewrite</span> Book_1_6_id, path_forall_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Book_1_6_prod A B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">a</span> : A) (<span class="nv">b</span> : B), C (a, b)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport C <span class="mi">1</span> (f a b) = f a b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_6</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:pm-to-ml *)</span>
<span class="sd">(** Exercise 1.7 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_7</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_7_id</span> {<span class="nv">A</span> : <span class="kt">Type</span>}
    : <span class="kr">forall</span> {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y), (x; <span class="mi">1</span>) = (y; p) :&gt; { a : A &amp; x = a }
    := paths_ind&#39; (<span class="kr">fun</span> (<span class="nv">x</span> <span class="nv">y</span> : A) (<span class="nv">p</span> : x = y) =&gt; (x; <span class="mi">1</span>) = (y; p)) (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_7_transport</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">P</span> : A -&gt; <span class="kt">Type</span>)
    : <span class="kr">forall</span> {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y), P x -&gt; P y
    := paths_ind&#39; (<span class="kr">fun</span> (<span class="nv">x</span> <span class="nv">y</span> : A) (<span class="nv">p</span> : x = y) =&gt; P x -&gt; P y) (<span class="kr">fun</span> <span class="nv">x</span> =&gt; idmap).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_7_ind&#39;</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">a</span> : A) (<span class="nv">C</span> : <span class="kr">forall</span> <span class="nv">x</span>, (a = x) -&gt; <span class="kt">Type</span>)
    (<span class="nv">c</span> : C a <span class="mi">1</span>) (<span class="nv">x</span> : A) (<span class="nv">p</span> : a = x)
    : C x p
    := Book_1_7_transport (<span class="kr">fun</span> <span class="nv">r</span> =&gt; C (pr1 r) (pr2 r)) (Book_1_7_id p) c.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_7_eq</span> {<span class="nv">A</span> : <span class="kt">Type</span>} (<span class="nv">a</span> : A) (<span class="nv">C</span> : <span class="kr">forall</span> <span class="nv">x</span>, (a = x) -&gt; <span class="kt">Type</span>) (<span class="nv">c</span> : C a <span class="mi">1</span>)
    : Book_1_7_ind&#39; a C c a <span class="mi">1</span> = c
    := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_7</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:nat-semiring *)</span>
<span class="sd">(** Exercise 1.8 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_8</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">Book_1_8_rec_nat</span> (<span class="nv">C</span> : <span class="kt">Type</span>) <span class="nv">c0</span> <span class="nv">cs</span> (<span class="nv">n</span> : nat) : C
    := <span class="kr">match</span> n <span class="kr">with</span>
      | O =&gt; c0
      | S m =&gt; cs m (Book_1_8_rec_nat C c0 cs m)
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_8_add</span> : nat -&gt; nat -&gt; nat
    := Book_1_8_rec_nat (nat -&gt; nat) (<span class="kr">fun</span> <span class="nv">m</span> =&gt; m) (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">g</span> <span class="nv">m</span> =&gt; (S (g m))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_8_mult</span> : nat -&gt; nat -&gt; nat
    := Book_1_8_rec_nat (nat -&gt; nat) (<span class="kr">fun</span> <span class="nv">m</span> =&gt; <span class="mi">0</span>) (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">g</span> <span class="nv">m</span> =&gt; Book_1_8_add m (g m)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* [Book_1_8_rec_nat] gives back a function with the wrong argument order, so we flip the order of the arguments [p] and [q]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_8_exp</span> : nat -&gt; nat -&gt; nat
    := <span class="kr">fun</span> <span class="nv">p</span> <span class="nv">q</span> =&gt;
        (Book_1_8_rec_nat (nat -&gt; nat) (<span class="kr">fun</span> <span class="nv">m</span> =&gt; (S <span class="mi">0</span>)) (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">g</span> <span class="nv">m</span> =&gt; Book_1_8_mult m (g m))) q p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Example</span> <span class="nf">add_example</span>: Book_1_8_add <span class="mi">32</span> <span class="mi">17</span> = <span class="mi">49</span> := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Example</span> <span class="nf">mult_example</span>: Book_1_8_mult <span class="mi">20</span> <span class="mi">5</span> = <span class="mi">100</span> := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Example</span> <span class="nf">exp_example</span>: Book_1_8_exp <span class="mi">2</span> <span class="mi">10</span> = <span class="mi">1024</span> := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_8_semiring</span> := HoTT.Classes.implementations.peano_naturals.nat_semiring.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_8</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:fin *)</span>
<span class="sd">(** Exercise 1.9 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_9</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">Book_1_9_Fin</span> (<span class="nv">n</span> : nat) : <span class="kt">Type</span>
    := <span class="kr">match</span> n <span class="kr">with</span>
      | O =&gt; Empty
      | S m =&gt; (Book_1_9_Fin m) + Unit
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_9_fmax</span> (<span class="nv">n</span> : nat) : Book_1_9_Fin (S n) := inr tt.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_9</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:ackermann *)</span>
<span class="sd">(** Exercise 1.10 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">ack</span> (<span class="nv">n</span> <span class="nv">m</span> : nat) : nat 
  := <span class="kr">match</span> n <span class="kr">with</span>
    | O =&gt; S m
    | S p =&gt; <span class="kr">let fix</span> <span class="nv">ackn</span> (<span class="nv">m</span> : nat)
              := <span class="kr">match</span> m <span class="kr">with</span>
                | O =&gt; ack p <span class="mi">1</span>
                | S q =&gt; ack p (ackn q)
                <span class="kr">end</span>
            <span class="kr">in</span> ackn m
    <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_10</span> := ack.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:neg-ldn *)</span>
<span class="sd">(** Exercise 1.11 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_11</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2d"><span class="kn">Theorem</span> <span class="nf">dblneg</span> : <span class="kr">forall</span> <span class="nv">A</span>, (~~~A) -&gt; ~A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, ~~ ~ A -&gt; ~ A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, ~~ ~ A -&gt; ~ A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2f"><span class="nb">intros</span> A f a; <span class="nb">apply</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~~ ~ A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk30"><span class="nb">intros</span> g; <span class="nb">apply</span> g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~~ ~ A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> a.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_11</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:tautologies *)</span>
<span class="sd">(** Exercise 1.12 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_12</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk31"><span class="kn">Theorem</span> <span class="nf">Book_1_12_part1</span> : <span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span>, A -&gt; (B -&gt; A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, A -&gt; B -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk32"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, A -&gt; B -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk33"><span class="nb">intros</span> ? ? a ?.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> a.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk34"><span class="kn">Theorem</span> <span class="nf">Book_1_12_part2</span> : <span class="kr">forall</span> <span class="nv">A</span>, A -&gt; ~~A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A -&gt; ~~ A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk35"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A -&gt; ~~ A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk36"><span class="nb">intros</span> A a f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (f a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk37"><span class="kn">Theorem</span> <span class="nf">Book_1_12_part3</span> : <span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span>, ((~A) + (~B)) -&gt; ~(A * B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, ~ A + ~ B -&gt; ~ (A * B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk38"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, ~ A + ~ B -&gt; ~ (A * B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk39"><span class="nb">intros</span> A B [na | nb] [a b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk3a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nb</var><span class="hyp-type"><b>: </b><span>~ B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk3a"><hr></label><div class="goal-conclusion">Empty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (na a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nb</var><span class="hyp-type"><b>: </b><span>~ B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (nb b).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_12</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:not-not-lem *)</span>
<span class="sd">(** Exercise 1.13 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_1_13</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3d"><span class="kn">Lemma</span> <span class="nf">Book_1_13_aux</span>: <span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span>, ~(A + B) -&gt; ~A * ~B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, ~ (A + B) -&gt; ~ A * ~ B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, ~ (A + B) -&gt; ~ A * ~ B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk3f"><span class="nb">intros</span> A B nAorB; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nAorB</var><span class="hyp-type"><b>: </b><span>~ (A + B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk40" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nAorB</var><span class="hyp-type"><b>: </b><span>~ (A + B)</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk40"><hr></label><div class="goal-conclusion">~ B</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk41">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nAorB</var><span class="hyp-type"><b>: </b><span>~ (A + B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span> a; <span class="bp">exact</span> (nAorB (inl a)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk42">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nAorB</var><span class="hyp-type"><b>: </b><span>~ (A + B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span> b; <span class="bp">exact</span> (nAorB (inr b)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk43"><span class="kn">Theorem</span> <span class="nf">Book_1_13</span> : <span class="kr">forall</span> <span class="nv">P</span>, ~~(P + ~P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : <span class="kt">Type</span>, ~~ (P + ~ P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk44"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : <span class="kt">Type</span>, ~~ (P + ~ P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk45"><span class="nb">intros</span> P f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ (P + ~ P)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk46"><span class="nb">apply</span> Book_1_13_aux <span class="kr">in</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ P * ~~ P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk47"><span class="nb">destruct</span> f <span class="kr">as</span> [np nnp].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ P</span></span></span><br><span><var>nnp</var><span class="hyp-type"><b>: </b><span>~~ P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (nnp np).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk48"><span class="kn">Theorem</span> <span class="nf">Book_1_13_direct</span> : <span class="kr">forall</span> <span class="nv">P</span>, ~~(P + ~P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : <span class="kt">Type</span>, ~~ (P + ~ P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk49"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">P</span> : <span class="kt">Type</span>, ~~ (P + ~ P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4a"><span class="nb">intros</span> P f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ (P + ~ P)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4b"><span class="nb">apply</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ (P + ~ P)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P + ~ P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4c"><span class="nb">apply</span> inr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ (P + ~ P)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4d"><span class="nb">intro</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ (P + ~ P)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4e"><span class="nb">apply</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~ (P + ~ P)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P + ~ P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (inl p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_1_13</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:without-K *)</span>
<span class="sd">(** Exercise 1.14 *)</span>

<span class="sd">(** There is no adequate type family C : Pi_{x, y, p} U  such that C(x, x, p) is p = refl x definitionally. *)</span>

<span class="c">(* ================================================== ex:subtFromPathInd *)</span>
<span class="sd">(** Exercise 1.15 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_15_paths_rec</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">C</span> : A -&gt; <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y) : C x -&gt; C y 
  := <span class="kr">match</span> p <span class="kr">with</span> <span class="mi">1</span> =&gt; idmap <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="sd">(** This is exactly the definition of [transport] from Basics.Overture. *)</span>

<span class="c">(* ================================================== ex:add-nat-commutative *)</span>
<span class="sd">(** Exercise 1.16 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_1_16</span> := HoTT.Spaces.Nat.Core.nat_add_comm.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:basics:concat *)</span>
<span class="sd">(** Exercise 2.1 *)</span>

<span class="c">(* Book_2_1_concatenation1 is equivalent to the proof given in the text *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk4f"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation1</span> :
    <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A}, x = y -&gt; y = z -&gt; x = z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk50"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk51"><span class="nb">intros</span> A x y z x_eq_y y_eq_z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x_eq_y</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>y_eq_z</var><span class="hyp-type"><b>: </b><span>y = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk52"><span class="nb">induction</span> x_eq_y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>y_eq_z</var><span class="hyp-type"><b>: </b><span>x = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk53"><span class="nb">induction</span> y_eq_z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk54"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation2</span> :
    <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A}, x = y -&gt; y = z -&gt; x = z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk55"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk56"><span class="nb">intros</span> A x y z x_eq_y y_eq_z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x_eq_y</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>y_eq_z</var><span class="hyp-type"><b>: </b><span>y = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk57"><span class="nb">induction</span> x_eq_y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>y_eq_z</var><span class="hyp-type"><b>: </b><span>x = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> y_eq_z.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk58"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation3</span> :
    <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A}, x = y -&gt; y = z -&gt; x = z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk59"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A), x = y -&gt; y = z -&gt; x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5a"><span class="nb">intros</span> A x y z x_eq_y y_eq_z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x_eq_y</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>y_eq_z</var><span class="hyp-type"><b>: </b><span>y = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = z</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5b"><span class="nb">induction</span> y_eq_z.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>x_eq_y</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> x_eq_y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;p *1 q&quot;</span> := (Book_2_1_concatenation1 p q) (<span class="kn">at level</span> <span class="mi">10</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;p *2 q&quot;</span> := (Book_2_1_concatenation2 p q) (<span class="kn">at level</span> <span class="mi">10</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;p *3 q&quot;</span> := (Book_2_1_concatenation3 p q) (<span class="kn">at level</span> <span class="mi">10</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_2_1_Proofs_Are_Equal</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5c"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation1_eq_Book_2_1_concatenation2</span> : p *<span class="mi">1</span> q = p *<span class="mi">2</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>y = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p *<span class="mi">1</span> q = p *<span class="mi">2</span> q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>y = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p *<span class="mi">1</span> q = p *<span class="mi">2</span> q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5e"><span class="nb">induction</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> *<span class="mi">1</span> <span class="mi">1</span> = <span class="mi">1</span> *<span class="mi">2</span> <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk5f"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation2_eq_Book_2_1_concatenation3</span> : p *<span class="mi">2</span> q =  p *<span class="mi">3</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>y = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p *<span class="mi">2</span> q = p *<span class="mi">3</span> q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk60"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>y = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p *<span class="mi">2</span> q = p *<span class="mi">3</span> q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk61"><span class="nb">induction</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> *<span class="mi">2</span> <span class="mi">1</span> = <span class="mi">1</span> *<span class="mi">3</span> <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk62"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation1_eq_Book_2_1_concatenation3</span> : p *<span class="mi">1</span> q = p *<span class="mi">3</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>y = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p *<span class="mi">1</span> q = p *<span class="mi">3</span> q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk63"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>y = z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p *<span class="mi">1</span> q = p *<span class="mi">3</span> q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk64"><span class="nb">induction</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> *<span class="mi">1</span> <span class="mi">1</span> = <span class="mi">1</span> *<span class="mi">3</span> <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_2_1_Proofs_Are_Equal</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:eq-proofs-commute *)</span>
<span class="sd">(** Exercise 2.2 *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk65"><span class="kn">Definition</span> <span class="nf">Book_2_2</span> :
  <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
    (Book_2_1_concatenation1_eq_Book_2_1_concatenation2 p q) *<span class="mi">1</span>
    (Book_2_1_concatenation2_eq_Book_2_1_concatenation3 p q) =
    (Book_2_1_concatenation1_eq_Book_2_1_concatenation3 p q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A) (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
(Book_2_1_concatenation1_eq_Book_2_1_concatenation2 p
   q) *<span class="mi">1</span>
(Book_2_1_concatenation2_eq_Book_2_1_concatenation3 p
   q) =
Book_2_1_concatenation1_eq_Book_2_1_concatenation3 p q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk66"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A) (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
(Book_2_1_concatenation1_eq_Book_2_1_concatenation2 p
   q) *<span class="mi">1</span>
(Book_2_1_concatenation2_eq_Book_2_1_concatenation3 p
   q) =
Book_2_1_concatenation1_eq_Book_2_1_concatenation3 p q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk67"><span class="nb">induction</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(Book_2_1_concatenation1_eq_Book_2_1_concatenation2 <span class="mi">1</span>
   <span class="mi">1</span>) *<span class="mi">1</span>
(Book_2_1_concatenation2_eq_Book_2_1_concatenation3 <span class="mi">1</span>
   <span class="mi">1</span>) =
Book_2_1_concatenation1_eq_Book_2_1_concatenation3 <span class="mi">1</span> <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:fourth-concat *)</span>
<span class="sd">(** Exercise 2.3 *)</span>

<span class="c">(* Since we have x_eq_y : x = y we can transport y_eq_z : y = z along</span>
<span class="c">   x_eq_y‚Åª¬π : y = x in the type family Œªw.(w = z) to obtain a term</span>
<span class="c">   of type x = z. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation4</span>
    {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A} : x = y -&gt; y = z -&gt; x = z :=
  <span class="kr">fun</span> <span class="nv">x_eq_y</span> <span class="nv">y_eq_z</span> =&gt; transport (<span class="kr">fun</span> <span class="nv">w</span> =&gt; w = z) (inverse x_eq_y) y_eq_z.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Notation</span> <span class="s2">&quot;p *4 q&quot;</span> := (Book_2_1_concatenation4 p q) (<span class="kn">at level</span> <span class="mi">10</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk68"><span class="kn">Definition</span> <span class="nf">Book_2_1_concatenation1_eq_Book_2_1_concatenation4</span> :
    <span class="kr">forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z), (p *<span class="mi">1</span> q = p *<span class="mi">4</span> q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A) (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
p *<span class="mi">1</span> q = p *<span class="mi">4</span> q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk69"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A) (<span class="nv">p</span> : x = y) (<span class="nv">q</span> : y = z),
p *<span class="mi">1</span> q = p *<span class="mi">4</span> q</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6a"><span class="nb">induction</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> *<span class="mi">1</span> <span class="mi">1</span> = <span class="mi">1</span> *<span class="mi">4</span> <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:npaths *)</span>
<span class="sd">(** Exercise 2.4 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_4_npath</span> : nat -&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>
  := nat_ind (<span class="kr">fun</span> (<span class="nv">n</span> : nat) =&gt; <span class="kt">Type</span> -&gt; <span class="kt">Type</span>)
             <span class="c">(* 0-dimensional paths are elements *)</span>
             (<span class="kr">fun</span> <span class="nv">A</span> =&gt; A)
             <span class="c">(* (n+1)-dimensional paths are paths between n-dimimensional paths *)</span>
             (<span class="kr">fun</span> <span class="nv">n</span> <span class="nv">f</span> <span class="nv">A</span> =&gt; (<span class="kr">exists</span> <span class="nv">a1</span> <span class="nv">a2</span> : (f A), a1 = a2)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* This is the intuition behind definition of nboundary:</span>
<span class="c">   As we&#39;ve defined them, every (n+1)-path is a path between two n-paths. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6b"><span class="kn">Lemma</span> <span class="nf">npath_as_sig</span> : <span class="kr">forall</span> {<span class="nv">n</span> : nat} {<span class="nv">A</span> : <span class="kt">Type</span>},
    (Book_2_4_npath (S n) A) = (<span class="kr">exists</span> (<span class="nv">p1</span> <span class="nv">p2</span> : Book_2_4_npath n A), p1 = p2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">A</span> : <span class="kt">Type</span>),
Book_2_4_npath n.+<span class="mi">1</span> A =
{p1 : Book_2_4_npath n A &amp;
{p2 : Book_2_4_npath n A &amp; p1 = p2}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6c"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">n</span> : nat) (<span class="nv">A</span> : <span class="kt">Type</span>),
Book_2_4_npath n.+<span class="mi">1</span> A =
{p1 : Book_2_4_npath n A &amp;
{p2 : Book_2_4_npath n A &amp; p1 = p2}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* It can be helpful to take a look at what this definition does.</span>
<span class="c">   Try uncommenting the following lines: *)</span>
<span class="c">(*</span>
<span class="c">Context {A : Type}.</span>
<span class="c">Eval compute in (Book_2_4_npath 0 A). (* = A : Type *)</span>
<span class="c">Eval compute in (Book_2_4_npath 1 A). (* = {a1 : A &amp; {a2 : A &amp; a1 = a2}} : Type *)</span>
<span class="c">Eval compute in (Book_2_4_npath 2 A). (* and so on... *)</span>
<span class="c">*)</span>

<span class="c">(* Given an (n+1)-path, we simply project to a pair of n-paths. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_4_nboundary</span>
  : <span class="kr">forall</span> {<span class="nv">n</span> : nat} {<span class="nv">A</span> : <span class="kt">Type</span>}, Book_2_4_npath (S n) A -&gt;
                          (Book_2_4_npath n A * Book_2_4_npath n A)
  := <span class="kr">fun</span> {<span class="nv">n</span>} {<span class="nv">A</span>} <span class="nv">p</span> =&gt; (pr1 p, pr1 (pr2 p)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:ap-to-apd-equiv-apd-to-ap *)</span>
<span class="sd">(** Exercise 2.5 *)</span>

<span class="c">(* Note that &quot;@&quot; is notation for concatentation and ^ is for inversion *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_eq_2_3_6</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">f</span> : A -&gt; B)
  : (f x = f y) -&gt; (transport (<span class="kr">fun</span> <span class="nv">_</span> =&gt; B) p (f x) = f y) :=
  <span class="kr">fun</span> <span class="nv">fx_eq_fy</span> =&gt;
    (HoTT.Basics.PathGroupoids.transport_const p (f x)) @ fx_eq_fy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_eq_2_3_7</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">f</span> : A -&gt; B)
  : (transport (<span class="kr">fun</span> <span class="nv">_</span> =&gt; B) p (f x) = f y) -&gt; f x = f y :=
  <span class="kr">fun</span> <span class="nv">fx_eq_fy</span> =&gt;
    (HoTT.Basics.PathGroupoids.transport_const p (f x))^ @ fx_eq_fy.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* By induction on p, it suffices to assume that x ‚â° y and p ‚â° refl, so</span>
<span class="c">   the above equations concatenate identity paths, which are units under</span>
<span class="c">   concatenation.</span>

<span class="c">   [isequiv_adjointify] is one way to prove two functions form an equivalence,</span>
<span class="c">   specifically one proves that they are (category-theoretic) sections of one</span>
<span class="c">   another, that is, each is a right inverse for the other. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6d"><span class="kn">Definition</span> <span class="nf">Equivalence_Book_eq_2_3_6_and_Book_eq_2_3_6</span>
           {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y) (<span class="nv">f</span> : A -&gt; B)
    : IsEquiv (Book_eq_2_3_6 p f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (Book_eq_2_3_6 p f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (Book_eq_2_3_6 p f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (isequiv_adjointify (Book_eq_2_3_6 p f) (Book_eq_2_3_7 p f));
    <span class="nb">unfold</span> Book_eq_2_3_6, Book_eq_2_3_7, transport_const;
    <span class="nb">induction</span> p;
    <span class="nb">intros</span> y;
    <span class="kp">do</span> <span class="mi">2</span> (<span class="nb">rewrite</span> concat_1p);
    <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:equiv-concat *)</span>
<span class="sd">(** Exercise 2.6 *)</span>

<span class="c">(* This exercise is solved in the library as</span>
<span class="c">   HoTT.Types.Paths.isequiv_concat_l</span>
<span class="c"> *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">concat_left</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">z</span> : A) (<span class="nv">p</span> : x = y)
    : (y = z) -&gt; (x = z) :=
  <span class="kr">fun</span> <span class="nv">q</span> =&gt; p @ q.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">concat_right</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">z</span> : A) (<span class="nv">p</span> : x = y)
    : (x = z) -&gt; (y = z) :=
  <span class="kr">fun</span> <span class="nv">q</span> =&gt; (inverse p) @ q.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* Again, by induction on p, it suffices to assume that x ‚â° y and p ‚â° refl, so</span>
<span class="c">   the above equations concatenate identity paths, which are units under</span>
<span class="c">   concatenation. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk6f"><span class="kn">Definition</span> <span class="nf">Book_2_6</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">x</span> <span class="nv">y</span> <span class="nv">z</span> : A} (<span class="nv">p</span> : x = y)
  : IsEquiv (concat_left z p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (concat_left z p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk70"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y, z</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (concat_left z p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (isequiv_adjointify (concat_left z p) (concat_right z p));
    <span class="nb">induction</span> p;
    <span class="nb">unfold</span> concat_right, concat_left;
    <span class="nb">intros</span> y;
    <span class="kp">do</span> <span class="mi">2</span> (<span class="nb">rewrite</span> concat_1p);
    <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:ap-sigma *)</span>
<span class="sd">(** Exercise 2.7 *)</span>

<span class="c">(* Already solved as ap_functor_sigma; there is a copy here for completeness *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_2_7</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk71"><span class="kn">Definition</span> <span class="nf">Book_2_7</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">P</span> : A -&gt; <span class="kt">Type</span>} {<span class="nv">Q</span> : B -&gt; <span class="kt">Type</span>}
            (<span class="nv">f</span> : A -&gt; B) (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">a</span>, P a -&gt; Q (f a))
            (<span class="nv">u</span> <span class="nv">v</span> : sig P) (<span class="nv">p</span> : u.<span class="mi">1</span> = v.<span class="mi">1</span>) (<span class="nv">q</span> : p # u.<span class="mi">2</span> = v.<span class="mi">2</span>)
  : ap (functor_sigma f g) (path_sigma P u v p q)
    = path_sigma Q (functor_sigma f g u) (functor_sigma f g v)
                (ap f p)
                ((transport_compose Q f p (g u.<span class="mi">1</span> u.<span class="mi">2</span>))^
                  @ (@ap_transport _ P (<span class="kr">fun</span> <span class="nv">x</span> =&gt; Q (f x)) _ _ p g u.<span class="mi">2</span>)^
                  @ ap (g v.<span class="mi">1</span>) q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span><br><span><var>u, v</var><span class="hyp-type"><b>: </b><span>{x : _ &amp; P x}</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>u.<span class="mi">1</span> = v.<span class="mi">1</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>transport P p u.<span class="mi">2</span> = v.<span class="mi">2</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (functor_sigma f g) (path_sigma P u v p q) =
path_sigma Q (functor_sigma f g u)
  (functor_sigma f g v) (ap f p)
  (((transport_compose Q f p (g u.<span class="mi">1</span> u.<span class="mi">2</span>))^ @
    (ap_transport p g u.<span class="mi">2</span>)^) @ ap (g v.<span class="mi">1</span>) q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk72"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span><br><span><var>u, v</var><span class="hyp-type"><b>: </b><span>{x : _ &amp; P x}</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>u.<span class="mi">1</span> = v.<span class="mi">1</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>transport P p u.<span class="mi">2</span> = v.<span class="mi">2</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (functor_sigma f g) (path_sigma P u v p q) =
path_sigma Q (functor_sigma f g u)
  (functor_sigma f g v) (ap f p)
  (((transport_compose Q f p (g u.<span class="mi">1</span> u.<span class="mi">2</span>))^ @
    (ap_transport p g u.<span class="mi">2</span>)^) @ ap (g v.<span class="mi">1</span>) q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk73"><span class="nb">destruct</span> u <span class="kr">as</span> [u1 u2]; <span class="nb">destruct</span> v <span class="kr">as</span> [v1 v2]; <span class="nb">simpl</span> <span class="kr">in</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span><br><span><var>u1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>u2</var><span class="hyp-type"><b>: </b><span>P u1</span></span></span><br><span><var>v1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>v2</var><span class="hyp-type"><b>: </b><span>P v1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>u1 = v1</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>transport P p u2 = v2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (functor_sigma f g)
  (path_sigma P (u1; u2) (v1; v2) p q) =
path_sigma Q (functor_sigma f g (u1; u2))
  (functor_sigma f g (v1; v2)) (ap f p)
  (((transport_compose Q f p (g (u1; u2).<span class="mi">1</span> (u1; u2).<span class="mi">2</span>))^ @
    (ap_transport p g (u1; u2).<span class="mi">2</span>)^) @
   ap (g (v1; v2).<span class="mi">1</span>) q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk74"><span class="nb">destruct</span> p; <span class="nb">simpl</span> <span class="kr">in</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span><br><span><var>u1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>u2, v2</var><span class="hyp-type"><b>: </b><span>P u1</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>u2 = v2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (functor_sigma f g)
  (path_sigma P (u1; u2) (u1; v2) <span class="mi">1</span> q) =
path_sigma Q (functor_sigma f g (u1; u2))
  (functor_sigma f g (u1; v2)) (ap f <span class="mi">1</span>)
  (((transport_compose Q f <span class="mi">1</span> (g (u1; u2).<span class="mi">1</span> (u1; u2).<span class="mi">2</span>))^ @
    (ap_transport <span class="mi">1</span> g (u1; u2).<span class="mi">2</span>)^) @
   ap (g (u1; v2).<span class="mi">1</span>) q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk75" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk75"><span class="nb">destruct</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P a -&gt; Q (f a)</span></span></span><br><span><var>u1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>u2</var><span class="hyp-type"><b>: </b><span>P u1</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (functor_sigma f g)
  (path_sigma P (u1; u2) (u1; u2) <span class="mi">1</span> <span class="mi">1</span>) =
path_sigma Q (functor_sigma f g (u1; u2))
  (functor_sigma f g (u1; u2)) (ap f <span class="mi">1</span>)
  (((transport_compose Q f <span class="mi">1</span> (g (u1; u2).<span class="mi">1</span> (u1; u2).<span class="mi">2</span>))^ @
    (ap_transport <span class="mi">1</span> g (u1; u2).<span class="mi">2</span>)^) @
   ap (g (u1; u2).<span class="mi">1</span>) <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_2_7</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:ap-coprod *)</span>
<span class="sd">(** Exercise 2.8 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_8</span> := @HoTT.Types.Sum.ap_functor_sum.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:coprod-ump *)</span>
<span class="sd">(** Exercise 2.9 *)</span>

<span class="c">(* This exercise is solved in the library as</span>
<span class="c">   HoTT.Types.Sum.equiv_sum_ind</span>
<span class="c"> *)</span>
<span class="c">(* To extract a function on either summand, compose with the injections *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">coprod_ump1</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">X</span>} : (A + B -&gt; X) -&gt; (A -&gt; X) * (B -&gt; X) :=
  <span class="kr">fun</span> <span class="nv">f</span> =&gt; (f o inl, f o inr).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* To create a function on the direct sum from functions on the summands, work</span>
<span class="c">   by cases *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">coprod_ump2</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">X</span>} : (A -&gt; X) * (B -&gt; X) -&gt; (A + B -&gt; X) :=
  prod_ind (<span class="kr">fun</span> <span class="nv">_</span> =&gt; A + B -&gt; X) (<span class="kr">fun</span> <span class="nv">f</span> <span class="nv">g</span> =&gt; sum_ind (<span class="kr">fun</span> <span class="nv">_</span> =&gt; X) f g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk76"><span class="kn">Definition</span> <span class="nf">Book_2_9</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">X</span>} `{Funext} : (A -&gt; X) * (B -&gt; X) &lt;~&gt; (A + B -&gt; X).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(A -&gt; X) * (B -&gt; X) &lt;~&gt; (A + B -&gt; X)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk77"><span class="nb">apply</span> (equiv_adjointify coprod_ump2 coprod_ump1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A + B -&gt; X =&gt; coprod_ump2 (coprod_ump1 x)) ==
idmap</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk78" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk78"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : (A -&gt; X) * (B -&gt; X) =&gt;
 coprod_ump1 (coprod_ump2 x)) == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk79"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A + B -&gt; X =&gt; coprod_ump2 (coprod_ump1 x)) ==
idmap</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk7a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk7a"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : (A -&gt; X) * (B -&gt; X) =&gt;
 coprod_ump1 (coprod_ump2 x)) == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A + B -&gt; X =&gt; coprod_ump2 (coprod_ump1 x)) ==
idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7c"><span class="nb">intros</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A + B -&gt; X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">coprod_ump2 (coprod_ump1 f) = f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7d"><span class="nb">apply</span> path_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A + B -&gt; X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">coprod_ump2 (coprod_ump1 f) == f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> [a | b]; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : (A -&gt; X) * (B -&gt; X) =&gt;
 coprod_ump1 (coprod_ump2 x)) == idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk7f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk7f"><span class="nb">intros</span> [f g].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">coprod_ump1 (coprod_ump2 (f, g)) = (f, g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:sigma-assoc *)</span>
<span class="sd">(** Exercise 2.10 *)</span>

<span class="c">(* This exercise is solved in the library as</span>
<span class="c">   HoTT.Types.Sigma.equiv_sigma_assoc</span>
<span class="c"> *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">TwoTen</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> `{A : <span class="kt">Type</span>} {B : A -&gt; <span class="kt">Type</span>} {C : (<span class="kr">exists</span> <span class="nv">a</span> : A, B a) -&gt; <span class="kt">Type</span>}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Definition</span> <span class="nf">f210</span> : (<span class="kr">exists</span> <span class="nv">a</span> : A, (<span class="kr">exists</span> <span class="nv">b</span> : B a, (C (a; b)))) -&gt;
                          (<span class="kr">exists</span> (<span class="nv">p</span> : <span class="kr">exists</span> <span class="nv">a</span> : A, B a), (C p)) :=
    <span class="kr">fun</span> <span class="nv">pairpair</span> =&gt;
      <span class="kr">match</span> pairpair <span class="kr">with</span> (a; pp) =&gt;
        <span class="kr">match</span> pp <span class="kr">with</span> (b; c) =&gt; ((a; b); c) <span class="kr">end</span>
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk80"><span class="kn">Local Definition</span> <span class="nf">g210</span> : (<span class="kr">exists</span> (<span class="nv">p</span> : <span class="kr">exists</span> <span class="nv">a</span> : A, B a), (C p)) -&gt;
                          (<span class="kr">exists</span> <span class="nv">a</span> : A, (<span class="kr">exists</span> <span class="nv">b</span> : B a, (C (a; b)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{p : {a : A &amp; B a} &amp; C p} -&gt;
{a : A &amp; {b : B a &amp; C (a; b)}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk81"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{p : {a : A &amp; B a} &amp; C p} -&gt;
{a : A &amp; {b : B a &amp; C (a; b)}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk82"><span class="nb">intros</span> pairpair.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span><br><span><var>pairpair</var><span class="hyp-type"><b>: </b><span>{p : {a : A &amp; B a} &amp; C p}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; {b : B a &amp; C (a; b)}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk83"><span class="nb">induction</span> pairpair <span class="kr">as</span> [pair c].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span><br><span><var>pair</var><span class="hyp-type"><b>: </b><span>{a : A &amp; B a}</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C pair</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; {b : B a &amp; C (a; b)}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk84"><span class="nb">induction</span> pair <span class="kr">as</span> [a b].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B a</span></span></span><br><span><var>c</var><span class="hyp-type"><b>: </b><span>C (a; b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; {b : B a &amp; C (a; b)}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (a; (b; c)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk85"><span class="kn">Definition</span> <span class="nf">Book_2_10</span> : (<span class="kr">exists</span> <span class="nv">a</span> : A, (<span class="kr">exists</span> <span class="nv">b</span> : B a, (C (a; b)))) &lt;~&gt;
                         (<span class="kr">exists</span> (<span class="nv">p</span> : <span class="kr">exists</span> <span class="nv">a</span> : A, B a), (C p)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; {b : B a &amp; C (a; b)}} &lt;~&gt;
{p : {a : A &amp; B a} &amp; C p}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk86"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>{a : A &amp; B a} -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; {b : B a &amp; C (a; b)}} &lt;~&gt;
{p : {a : A &amp; B a} &amp; C p}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (equiv_adjointify f210 g210); <span class="nb">compute</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">TwoTen</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:pullback *)</span>
<span class="sd">(** Exercise 2.11 *)</span>

<span class="sd">(** The definition of commutative squares in HoTT.Limits.Pullback is slightly different, using a homotopy between the composites instead of a path. *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_11</span> `{H : Funext} {X A B C} (f : A -&gt; C) (g : B -&gt; C)
  : (X -&gt; HoTT.Limits.Pullback.Pullback f g)
    &lt;~&gt; HoTT.Limits.Pullback.Pullback (<span class="kr">fun</span> <span class="nv">h</span> : X -&gt; A =&gt; f o h) (<span class="kr">fun</span> <span class="nv">k</span> : X -&gt; B =&gt; g o k)
  := HoTT.Limits.Pullback.equiv_ispullback_commsq f g
    oE (HoTT.Limits.Pullback.equiv_pullback_corec f g)^-<span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:pullback-pasting *)</span>
<span class="sd">(** Exercise 2.12 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_12_i</span> := @HoTT.Limits.Pullback.ispullback_pasting_left.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_12_ii</span> := @HoTT.Limits.Pullback.ispullback_pasting_outer.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:eqvboolbool *)</span>
<span class="sd">(** Exercise 2.13 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_13</span> := @HoTT.Types.Bool.equiv_bool_aut_bool.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:equality-reflection *)</span>
<span class="sd">(** Exercise 2.14 *)</span>

<span class="sd">(** Assuming the equality reflection rule, given any [q : x = y], [x] and [y] are definitionally equal, so [q] and [refl_x] have the same type [x = x]. We can form the type [forall x y, forall q, q = refl_x]. A path induction produces an element [r], with [r x x p : p = refl_x], which is also definitional by the equality reflection rule. *)</span>

<span class="c">(* ================================================== ex:strengthen-transport-is-ap *)</span>
<span class="sd">(** Exercise 2.15 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_15</span> {<span class="nv">A</span>} (<span class="nv">B</span> : A -&gt; <span class="kt">Type</span>) {<span class="nv">x</span> <span class="nv">y</span> : A} (<span class="nv">p</span> : x = y)
  : transport B p = HoTT.Types.<span class="kn">Universe</span>.equiv_path _ _ (ap B p)
  := <span class="kr">match</span> p <span class="kr">with</span> <span class="mi">1</span> =&gt; <span class="mi">1</span> <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:strong-from-weak-funext *)</span>
<span class="sd">(** Exercise 2.16 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_16</span> := @HoTT.Metatheory.FunextVarieties.NaiveFunext_implies_Funext.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:equiv-functor-types *)</span>
<span class="sd">(** Exercise 2.17 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_2_17_prod</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">A</span> <span class="nv">A&#39;</span> <span class="nv">B</span> <span class="nv">B&#39;</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A &lt;~&gt; A&#39;) (<span class="nv">g</span> : B &lt;~&gt; B&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_17_i_prod</span> : A * B &lt;~&gt; A&#39; * B&#39;
    := HoTT.Types.Prod.equiv_functor_prod&#39; f g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk87"><span class="kn">Definition</span> <span class="nf">Book_2_17_ii_prod</span> `{Univalence} : A * B &lt;~&gt; A&#39; * B&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A * B &lt;~&gt; A&#39; * B&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk88"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A * B &lt;~&gt; A&#39; * B&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk89"><span class="nb">apply</span> equiv_path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A * B = A&#39; * B&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap011 prod (path_universe_uncurried f) (path_universe_uncurried g)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8a"><span class="kn">Definition</span> <span class="nf">Book_2_17_eq_prod&#39;</span> (<span class="nv">p</span> : A = A&#39;) (<span class="nv">q</span> : B = B&#39;)
    : transport idmap (ap011 prod p q)
      = functor_prod (transport idmap p) (transport idmap q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A = A&#39;</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 prod p q) =
functor_prod (transport idmap p) (transport idmap q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A = A&#39;</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 prod p q) =
functor_prod (transport idmap p) (transport idmap q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8c"><span class="nb">clear</span> f g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A = A&#39;</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 prod p q) =
functor_prod (transport idmap p) (transport idmap q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8d"><span class="nb">destruct</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 prod <span class="mi">1</span> <span class="mi">1</span>) =
functor_prod (transport idmap <span class="mi">1</span>) (transport idmap <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8e"><span class="kn">Theorem</span> <span class="nf">Book_2_17_eq_prod</span> `{Univalence}
    : Book_2_17_ii_prod = Book_2_17_i_prod.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_prod = Book_2_17_i_prod</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk8f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_prod = Book_2_17_i_prod</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk90"><span class="nb">apply</span> path_equiv; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011 prod (path_universe_uncurried f)
     (path_universe_uncurried g)) = functor_prod f g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk91" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk91">lhs napply Book_2_17_eq_prod&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_prod
  (transport idmap (path_universe_uncurried f))
  (transport idmap (path_universe_uncurried g)) =
functor_prod f g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk92">snapply ap011.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk93" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk93"><hr></label><div class="goal-conclusion">transport idmap (path_universe_uncurried g) = g</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk94" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk94">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> transport_idmap_path_universe_uncurried.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk95">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried g) = g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> transport_idmap_path_universe_uncurried.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_2_17_prod</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_2_17_sigma</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">A</span> <span class="nv">A&#39;</span> : <span class="kt">Type</span>} {<span class="nv">B</span> : A -&gt; <span class="kt">Type</span>} {<span class="nv">B&#39;</span> : A&#39; -&gt; <span class="kt">Type</span>}
    (<span class="nv">f</span> : A &lt;~&gt; A&#39;) (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">a</span>, B a &lt;~&gt; B&#39; (f a)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_17_i_sigma</span> : {a : A &amp; B a} &lt;~&gt; {a&#39; : A&#39; &amp; B&#39; a&#39;}
    := HoTT.Types.Sigma.equiv_functor_sigma&#39; f g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_17_path_fibr_1</span> (<span class="nv">p</span> : A = A&#39;)
    (<span class="nv">q</span> : B = B&#39; o (transport idmap p))
    : (transport (<span class="kr">fun</span> <span class="nv">A0</span> =&gt; A0 -&gt; <span class="kt">Type</span>) p B) = B&#39;
    := moveR_transport_p _ _ _ _
        (transport (<span class="kr">fun</span> <span class="nv">p0</span> =&gt; B = B&#39; o (_ p0)) (inv_V p)^ q
           @ (transport_arrow_toconst&#39; p^ B&#39;)^).</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk96" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk96"><span class="kn">Definition</span> <span class="nf">Book_2_17_ii_sigma</span> `{Univalence}
    : {a : A &amp; B a} &lt;~&gt; {a&#39; : A&#39; &amp; B&#39; a&#39;}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; B a} &lt;~&gt; {a&#39; : A&#39; &amp; B&#39; a&#39;}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk97"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; B a} &lt;~&gt; {a&#39; : A&#39; &amp; B&#39; a&#39;}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk98" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk98"><span class="nb">apply</span> equiv_path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A &amp; B a} = {a&#39; : A&#39; &amp; B&#39; a&#39;}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk99">snapply ap011D.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A = A&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk9a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk9a"><hr></label><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A -&gt; <span class="kt">Type</span>) <span class="nl">?p</span>
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; B a) = (<span class="kr">fun</span> <span class="nv">a&#39;</span> : A&#39; =&gt; B&#39; a&#39;)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9b">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A = A&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (path_universe_uncurried f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">A</span> : <span class="kt">Type</span> =&gt; A -&gt; <span class="kt">Type</span>)
  (path_universe_uncurried f) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; B a) =
(<span class="kr">fun</span> <span class="nv">a&#39;</span> : A&#39; =&gt; B&#39; a&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9d"><span class="nb">apply</span> Book_2_17_path_fibr_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B =
(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
 B&#39; (transport idmap (path_universe_uncurried f) x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9e"><span class="nb">apply</span> path_arrow; <span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B a =
B&#39; (transport idmap (path_universe_uncurried f) a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk9f"><span class="nb">apply</span> path_universe_uncurried.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B a &lt;~&gt;
B&#39; (transport idmap (path_universe_uncurried f) a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka0"><span class="nb">apply</span> (transport (<span class="kr">fun</span> <span class="nv">f0</span> =&gt; _ &lt;~&gt; _ (f0 _))
        (transport_idmap_path_universe_uncurried _)^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B a &lt;~&gt; B&#39; (f a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka1"><span class="kn">Definition</span> <span class="nf">Book_2_17_eq_sigma&#39;</span> (<span class="nv">p</span> : A = A&#39;)
    (<span class="nv">q</span> : B = B&#39; o (transport idmap p))
    : transport idmap (ap011D (@sig) p (Book_2_17_path_fibr_1 p q))
      = functor_sigma (transport idmap p)
          (<span class="kr">fun</span> <span class="nv">a</span> =&gt; transport idmap (ap10 q a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A = A&#39;</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39; o transport idmap p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D (@sig) p (Book_2_17_path_fibr_1 p q)) =
functor_sigma (transport idmap p)
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; transport idmap (ap10 q a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A = A&#39;</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39; o transport idmap p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D (@sig) p (Book_2_17_path_fibr_1 p q)) =
functor_sigma (transport idmap p)
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; transport idmap (ap10 q a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka3"><span class="nb">unfold</span> Book_2_17_path_fibr_1; <span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B, B'</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; B&#39; (transport idmap <span class="mi">1</span> x))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D (@sig) <span class="mi">1</span>
     (moveR_transport_p (<span class="kr">fun</span> <span class="nv">x</span> : <span class="kt">Type</span> =&gt; x -&gt; <span class="kt">Type</span>) <span class="mi">1</span>
        B B&#39;
        (transport
           (<span class="kr">fun</span> <span class="nv">p0</span> : A = A =&gt;
            B =
            (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; B&#39; (transport idmap p0 x)))
           (inv_V <span class="mi">1</span>)^ q @
         (transport_arrow_toconst&#39; <span class="mi">1</span>^ B&#39;)^))) =
functor_sigma (transport idmap <span class="mi">1</span>)
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; transport idmap (ap10 q a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka4"><span class="nb">change</span> (B = B&#39;) <span class="kr">in</span> q; <span class="nb">destruct</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B (f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D (@sig) <span class="mi">1</span>
     (moveR_transport_p (<span class="kr">fun</span> <span class="nv">x</span> : <span class="kt">Type</span> =&gt; x -&gt; <span class="kt">Type</span>) <span class="mi">1</span>
        B B
        (transport
           (<span class="kr">fun</span> <span class="nv">p0</span> : A = A =&gt;
            B =
            (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; B (transport idmap p0 x)))
           (inv_V <span class="mi">1</span>)^ <span class="mi">1</span> @
         (transport_arrow_toconst&#39; <span class="mi">1</span>^ B)^))) =
functor_sigma (transport idmap <span class="mi">1</span>)
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; transport idmap (ap10 <span class="mi">1</span> a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka5"><span class="kn">Theorem</span> <span class="nf">Book_2_17_eq_sigma</span> `{Univalence}
    : Book_2_17_ii_sigma = Book_2_17_i_sigma.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_sigma = Book_2_17_i_sigma</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_sigma = Book_2_17_i_sigma</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka7"><span class="nb">apply</span> path_equiv; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D (@sig) (path_universe_uncurried f)
     (Book_2_17_path_fibr_1
        (path_universe_uncurried f)
        (path_arrow B
           (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
            B&#39;
              (transport idmap
                 (path_universe_uncurried f) x))
           (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt;
            path_universe_uncurried
              (transport
                 (<span class="kr">fun</span> <span class="nv">f0</span> : A -&gt; A&#39; =&gt;
                  B a &lt;~&gt; B&#39; (f0 a))
                 (transport_idmap_path_universe_uncurried
                    f)^ (g a)))))) =
functor_sigma f (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; g a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka8">lhs napply Book_2_17_eq_sigma&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_sigma
  (transport idmap (path_universe_uncurried f))
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt;
   transport idmap
     (ap10
        (path_arrow B
           (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
            B&#39;
              (transport idmap
                 (path_universe_uncurried f) x))
           (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt;
            path_universe_uncurried
              (transport
                 (<span class="kr">fun</span> <span class="nv">f0</span> : A -&gt; A&#39; =&gt;
                  B a0 &lt;~&gt; B&#39; (f0 a0))
                 (transport_idmap_path_universe_uncurried
                    f)^ (g a0)))) a)) =
functor_sigma f (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; g a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chka9">snapply ap011D.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkaa" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chkaa"><hr></label><div class="goal-conclusion">transport
  (<span class="kr">fun</span> <span class="nv">f</span> : A -&gt; A&#39; =&gt;
   <span class="kr">forall</span> <span class="nv">a</span> : A, (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt; B a0) a -&gt; B&#39; (f a))
  <span class="nl">?p</span>
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt;
   transport idmap
     (ap10
        (path_arrow B
           (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
            B&#39;
              (transport idmap
                 (path_universe_uncurried f) x))
           (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt;
            path_universe_uncurried
              (transport
                 (<span class="kr">fun</span> <span class="nv">f0</span> : A -&gt; A&#39; =&gt;
                  B a0 &lt;~&gt; B&#39; (f0 a0))
                 (transport_idmap_path_universe_uncurried
                    f)^ (g a0)))) a)) =
(<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; g a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkab" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkab">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> transport_idmap_path_universe_uncurried.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkac">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B a &lt;~&gt; B&#39; (f a)</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport
  (<span class="kr">fun</span> <span class="nv">f</span> : A -&gt; A&#39; =&gt;
   <span class="kr">forall</span> <span class="nv">a</span> : A, (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt; B a0) a -&gt; B&#39; (f a))
  (transport_idmap_path_universe_uncurried f)
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt;
   transport idmap
     (ap10
        (path_arrow B
           (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
            B&#39;
              (transport idmap
                 (path_universe_uncurried f) x))
           (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt;
            path_universe_uncurried
              (transport
                 (<span class="kr">fun</span> <span class="nv">f0</span> : A -&gt; A&#39; =&gt;
                  B a0 &lt;~&gt; B&#39; (f0 a0))
                 (transport_idmap_path_universe_uncurried
                    f)^ (g a0)))) a)) =
(<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; g a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkad"><span class="nb">destruct</span> (transport_idmap_path_universe_uncurried f); <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A,
B a &lt;~&gt;
B&#39; (transport idmap (path_universe_uncurried f) a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">a</span> : A =&gt;
 transport idmap
   (ap10
      (path_arrow B
         (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
          B&#39;
            (transport idmap
               (path_universe_uncurried f) x))
         (<span class="kr">fun</span> <span class="nv">a0</span> : A =&gt; path_universe_uncurried (g a0)))
      a)) = (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; g a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkae"><span class="nb">apply</span> path_forall; <span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A,
B a &lt;~&gt;
B&#39; (transport idmap (path_universe_uncurried f) a)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap10
     (path_arrow B
        (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
         B&#39;
           (transport idmap
              (path_universe_uncurried f) x))
        (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; path_universe_uncurried (g a)))
     a) = g a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkaf">lhs napply (ap (<span class="kr">fun</span> <span class="nv">h</span> =&gt; _ (h _)) (eisretr _ _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A,
B a &lt;~&gt;
B&#39; (transport idmap (path_universe_uncurried f) a)</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried (g a)) = g a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> transport_idmap_path_universe_uncurried.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_2_17_sigma</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_2_17_arrow</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> `{Funext} {A A&#39; B B&#39; : <span class="kt">Type</span>} (f : A&#39; &lt;~&gt; A) (g : B &lt;~&gt; B&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_17_i_arrow</span> : (A -&gt; B) &lt;~&gt; (A&#39; -&gt; B&#39;)
    := HoTT.Types.Arrow.equiv_functor_arrow&#39; f g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb0"><span class="kn">Definition</span> <span class="nf">Book_2_17_ii_arrow</span> `{Univalence} : (A -&gt; B) &lt;~&gt; (A&#39; -&gt; B&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(A -&gt; B) &lt;~&gt; (A&#39; -&gt; B&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(A -&gt; B) &lt;~&gt; (A&#39; -&gt; B&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb2"><span class="nb">apply</span> equiv_path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(A -&gt; B) = (A&#39; -&gt; B&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap011 arrow (path_universe_uncurried f)^ (path_universe_uncurried g)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb3"><span class="kn">Definition</span> <span class="nf">Book_2_17_eq_arrow&#39;</span> (<span class="nv">p</span> : A&#39; = A) (<span class="nv">q</span> : B = B&#39;)
    : transport idmap (ap011 arrow p^ q)
      = functor_arrow (transport idmap p) (transport idmap q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A&#39; = A</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 arrow p^ q) =
functor_arrow (transport idmap p) (transport idmap q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A&#39; = A</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 arrow p^ q) =
functor_arrow (transport idmap p) (transport idmap q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb5"><span class="nb">clear</span> f g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A&#39; = A</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 arrow p^ q) =
functor_arrow (transport idmap p) (transport idmap q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb6"><span class="nb">destruct</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A', B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 arrow <span class="mi">1</span>^ <span class="mi">1</span>) =
functor_arrow (transport idmap <span class="mi">1</span>) (transport idmap <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb7"><span class="kn">Theorem</span> <span class="nf">Book_2_17_eq_arrow</span> `{Univalence}
    : Book_2_17_ii_arrow = Book_2_17_i_arrow.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_arrow = Book_2_17_i_arrow</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_arrow = Book_2_17_i_arrow</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkb9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkb9"><span class="nb">apply</span> path_equiv; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011 arrow (path_universe_uncurried f)^
     (path_universe_uncurried g)) =
functor_forall f (<span class="kr">fun</span> <span class="nv">_</span> : A&#39; =&gt; g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkba">lhs napply Book_2_17_eq_arrow&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_arrow
  (transport idmap (path_universe_uncurried f))
  (transport idmap (path_universe_uncurried g)) =
functor_forall f (<span class="kr">fun</span> <span class="nv">_</span> : A&#39; =&gt; g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkbb">snapply ap011.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkbc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chkbc"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">_</span> : A&#39; =&gt;
 transport idmap (path_universe_uncurried g)) =
(<span class="kr">fun</span> <span class="nv">_</span> : A&#39; =&gt; g)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkbd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> transport_idmap_path_universe_uncurried.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkbe">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">_</span> : A&#39; =&gt;
 transport idmap (path_universe_uncurried g)) =
(<span class="kr">fun</span> <span class="nv">_</span> : A&#39; =&gt; g)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap (<span class="kr">fun</span> <span class="nv">g0</span> <span class="nv">_</span> =&gt; g0)
        (transport_idmap_path_universe_uncurried g)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_2_17_arrow</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_2_17_forall</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> `{Funext} {A A&#39; : <span class="kt">Type</span>} {B : A -&gt; <span class="kt">Type</span>} {B&#39; : A&#39; -&gt; <span class="kt">Type</span>}
    (f : A&#39; &lt;~&gt; A) (g : <span class="kr">forall</span> <span class="nv">a&#39;</span>, B (f a&#39;) &lt;~&gt; B&#39; a&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_17_i_forall</span> : (<span class="kr">forall</span> <span class="nv">a</span>, B a) &lt;~&gt; (<span class="kr">forall</span> <span class="nv">a&#39;</span>, B&#39; a&#39;)
    := HoTT.Types.Forall.equiv_functor_forall&#39; f g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_17_path_fibr_2</span> (<span class="nv">p</span> : A&#39; = A)
    (<span class="nv">q</span> : B o (transport idmap p) = B&#39;)
    : (transport (<span class="kr">fun</span> <span class="nv">A0</span> =&gt; A0 -&gt; <span class="kt">Type</span>) p^ B) = B&#39;
    := (transport_arrow_toconst&#39; p^ B)
       @ (transport (<span class="kr">fun</span> <span class="nv">p0</span> =&gt; B o (_ p0) = B&#39;) (inv_V p)^ q).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkbf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkbf"><span class="kn">Definition</span> <span class="nf">Book_2_17_ii_forall</span> `{Univalence}
    : (<span class="kr">forall</span> <span class="nv">a</span>, B a) &lt;~&gt; (<span class="kr">forall</span> <span class="nv">a&#39;</span>, B&#39; a&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, B a) &lt;~&gt; (<span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B&#39; a&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc0"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, B a) &lt;~&gt; (<span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B&#39; a&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc1"><span class="nb">apply</span> equiv_path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, B a) = (<span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B&#39; a&#39;)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc2">snapply (ap011D (<span class="kr">fun</span> <span class="nv">A0</span> <span class="nv">B0</span> =&gt; <span class="kr">forall</span> <span class="nv">a0</span>, B0 a0)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A = A&#39;</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkc3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chkc3"><hr></label><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0 -&gt; <span class="kt">Type</span>) <span class="nl">?p</span> B = B&#39;</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A = A&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (path_universe_uncurried f)^.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">A0</span> : <span class="kt">Type</span> =&gt; A0 -&gt; <span class="kt">Type</span>)
  (path_universe_uncurried f)^ B = B&#39;</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc6"><span class="nb">apply</span> Book_2_17_path_fibr_2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt;
 B (transport idmap (path_universe_uncurried f) x)) =
B&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc7"><span class="nb">apply</span> path_arrow; <span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B (transport idmap (path_universe_uncurried f) a) =
B&#39; a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc8"><span class="nb">apply</span> path_universe_uncurried.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B (transport idmap (path_universe_uncurried f) a) &lt;~&gt;
B&#39; a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkc9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkc9">napply (transport (<span class="kr">fun</span> <span class="nv">f0</span> =&gt; B (f0 _) &lt;~&gt; _)
        (transport_idmap_path_universe_uncurried f)^).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B (f a) &lt;~&gt; B&#39; a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkca"><span class="kn">Definition</span> <span class="nf">Book_2_17_eq_forall&#39;</span> (<span class="nv">p</span> : A&#39; = A)
    (<span class="nv">q</span> : B o (transport idmap p) = B&#39;)
    : transport idmap
      (ap011D (<span class="kr">fun</span> <span class="nv">A0</span> <span class="nv">B0</span> =&gt; <span class="kr">forall</span> <span class="nv">a0</span>, B0 a0) p^ (Book_2_17_path_fibr_2 p q))
      = functor_forall (transport idmap p)
          (<span class="kr">fun</span> <span class="nv">a</span> =&gt; transport idmap (ap10 q a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A&#39; = A</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B o transport idmap p = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D
     (<span class="kr">fun</span> (<span class="nv">A0</span> : <span class="kt">Type</span>)
        (<span class="nv">B0</span> : (<span class="kr">fun</span> <span class="nv">A1</span> : <span class="kt">Type</span> =&gt; A1 -&gt; <span class="kt">Type</span>) A0) =&gt;
      <span class="kr">forall</span> <span class="nv">a0</span> : A0, B0 a0) p^
     (Book_2_17_path_fibr_2 p q)) =
functor_forall (transport idmap p)
  (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt; transport idmap (ap10 q a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkcb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkcb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A&#39; = A</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B o transport idmap p = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D
     (<span class="kr">fun</span> (<span class="nv">A0</span> : <span class="kt">Type</span>)
        (<span class="nv">B0</span> : (<span class="kr">fun</span> <span class="nv">A1</span> : <span class="kt">Type</span> =&gt; A1 -&gt; <span class="kt">Type</span>) A0) =&gt;
      <span class="kr">forall</span> <span class="nv">a0</span> : A0, B0 a0) p^
     (Book_2_17_path_fibr_2 p q)) =
functor_forall (transport idmap p)
  (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt; transport idmap (ap10 q a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkcc"><span class="nb">unfold</span> Book_2_17_path_fibr_2; <span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B, B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt; B (transport idmap <span class="mi">1</span> x)) = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D
     (<span class="kr">fun</span> (<span class="nv">A0</span> : <span class="kt">Type</span>) (<span class="nv">B0</span> : A0 -&gt; <span class="kt">Type</span>) =&gt;
      <span class="kr">forall</span> <span class="nv">a0</span> : A0, B0 a0) <span class="mi">1</span>^
     (transport_arrow_toconst&#39; <span class="mi">1</span>^ B @
      transport
        (<span class="kr">fun</span> <span class="nv">p0</span> : A&#39; = A&#39; =&gt;
         (<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt; B (transport idmap p0 x)) = B&#39;)
        (inv_V <span class="mi">1</span>)^ q)) =
functor_forall (transport idmap <span class="mi">1</span>)
  (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt; transport idmap (ap10 q a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkcd"><span class="nb">simpl</span> <span class="kr">in</span> q; <span class="nb">destruct</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D
     (<span class="kr">fun</span> (<span class="nv">A0</span> : <span class="kt">Type</span>) (<span class="nv">B0</span> : A0 -&gt; <span class="kt">Type</span>) =&gt;
      <span class="kr">forall</span> <span class="nv">a0</span> : A0, B0 a0) <span class="mi">1</span>^
     (transport_arrow_toconst&#39; <span class="mi">1</span>^ B @
      transport
        (<span class="kr">fun</span> <span class="nv">p0</span> : A&#39; = A&#39; =&gt;
         (<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt; B (transport idmap p0 x)) =
         (<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt; B x)) (inv_V <span class="mi">1</span>)^ <span class="mi">1</span>)) =
functor_forall (transport idmap <span class="mi">1</span>)
  (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt; transport idmap (ap10 <span class="mi">1</span> a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkce"><span class="kn">Theorem</span> <span class="nf">Book_2_17_eq_forall</span> `{Univalence}
    : Book_2_17_ii_forall = Book_2_17_i_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_forall = Book_2_17_i_forall</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkcf"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_forall = Book_2_17_i_forall</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd0"><span class="nb">apply</span> path_equiv; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011D
     (<span class="kr">fun</span> (<span class="nv">A0</span> : <span class="kt">Type</span>) (<span class="nv">B0</span> : A0 -&gt; <span class="kt">Type</span>) =&gt;
      <span class="kr">forall</span> <span class="nv">a0</span> : A0, B0 a0)
     (path_universe_uncurried f)^
     (Book_2_17_path_fibr_2
        (path_universe_uncurried f)
        (path_arrow
           (<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt;
            B
              (transport idmap
                 (path_universe_uncurried f) x)) B&#39;
           (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt;
            path_universe_uncurried
              (transport
                 (<span class="kr">fun</span> <span class="nv">f0</span> : A&#39; -&gt; A =&gt;
                  B (f0 a) &lt;~&gt; B&#39; a)
                 (transport_idmap_path_universe_uncurried
                    f)^ (g a)))))) =
functor_forall f (<span class="kr">fun</span> <span class="nv">b</span> : A&#39; =&gt; g b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd1">lhs napply Book_2_17_eq_forall&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_forall
  (transport idmap (path_universe_uncurried f))
  (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt;
   transport idmap
     (ap10
        (path_arrow
           (<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt;
            B
              (transport idmap
                 (path_universe_uncurried f) x)) B&#39;
           (<span class="kr">fun</span> <span class="nv">a0</span> : A&#39; =&gt;
            path_universe_uncurried
              (transport
                 (<span class="kr">fun</span> <span class="nv">f0</span> : A&#39; -&gt; A =&gt;
                  B (f0 a0) &lt;~&gt; B&#39; a0)
                 (transport_idmap_path_universe_uncurried
                    f)^ (g a0)))) a)) =
functor_forall f (<span class="kr">fun</span> <span class="nv">b</span> : A&#39; =&gt; g b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd2">snapply ap011D.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkd3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chkd3"><hr></label><div class="goal-conclusion">transport
  (<span class="kr">fun</span> <span class="nv">f0</span> : A&#39; -&gt; A =&gt;
   <span class="kr">forall</span> <span class="nv">b</span> : A&#39;, B (f0 b) -&gt; (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt; B&#39; a) b)
  <span class="nl">?p</span>
  (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt;
   transport idmap
     (ap10
        (path_arrow
           (<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt;
            B
              (transport idmap
                 (path_universe_uncurried f) x)) B&#39;
           (<span class="kr">fun</span> <span class="nv">a0</span> : A&#39; =&gt;
            path_universe_uncurried
              (transport
                 (<span class="kr">fun</span> <span class="nv">f0</span> : A&#39; -&gt; A =&gt;
                  B (f0 a0) &lt;~&gt; B&#39; a0)
                 (transport_idmap_path_universe_uncurried
                    f)^ (g a0)))) a)) =
(<span class="kr">fun</span> <span class="nv">b</span> : A&#39; =&gt; g b)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> transport_idmap_path_universe_uncurried.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;, B (f a&#39;) &lt;~&gt; B&#39; a&#39;</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport
  (<span class="kr">fun</span> <span class="nv">f0</span> : A&#39; -&gt; A =&gt;
   <span class="kr">forall</span> <span class="nv">b</span> : A&#39;, B (f0 b) -&gt; (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt; B&#39; a) b)
  (transport_idmap_path_universe_uncurried f)
  (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt;
   transport idmap
     (ap10
        (path_arrow
           (<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt;
            B
              (transport idmap
                 (path_universe_uncurried f) x)) B&#39;
           (<span class="kr">fun</span> <span class="nv">a0</span> : A&#39; =&gt;
            path_universe_uncurried
              (transport
                 (<span class="kr">fun</span> <span class="nv">f0</span> : A&#39; -&gt; A =&gt;
                  B (f0 a0) &lt;~&gt; B&#39; a0)
                 (transport_idmap_path_universe_uncurried
                    f)^ (g a0)))) a)) =
(<span class="kr">fun</span> <span class="nv">b</span> : A&#39; =&gt; g b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd6"><span class="nb">destruct</span> (transport_idmap_path_universe_uncurried f); <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;,
B (transport idmap (path_universe_uncurried f) a&#39;) &lt;~&gt;
B&#39; a&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt;
 transport idmap
   (ap10
      (path_arrow
         (<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt;
          B
            (transport idmap
               (path_universe_uncurried f) x)) B&#39;
         (<span class="kr">fun</span> <span class="nv">a0</span> : A&#39; =&gt;
          path_universe_uncurried (g a0))) a)) =
(<span class="kr">fun</span> <span class="nv">b</span> : A&#39; =&gt; g b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd7"><span class="nb">apply</span> path_forall; <span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;,
B (transport idmap (path_universe_uncurried f) a&#39;) &lt;~&gt;
B&#39; a&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap10
     (path_arrow
        (<span class="kr">fun</span> <span class="nv">x</span> : A&#39; =&gt;
         B
           (transport idmap
              (path_universe_uncurried f) x)) B&#39;
        (<span class="kr">fun</span> <span class="nv">a</span> : A&#39; =&gt; path_universe_uncurried (g a)))
     a) = g a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd8">lhs napply (ap (<span class="kr">fun</span> <span class="nv">h</span> =&gt; _ (h _)) (eisretr _ _)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A, A'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>B'</var><span class="hyp-type"><b>: </b><span>A&#39; -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A&#39; &lt;~&gt; A</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a&#39;</span> : A&#39;,
B (transport idmap (path_universe_uncurried f) a&#39;) &lt;~&gt;
B&#39; a&#39;</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried (g a)) = g a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> transport_idmap_path_universe_uncurried.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_2_17_forall</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_2_17_sum</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">A</span> <span class="nv">A&#39;</span> <span class="nv">B</span> <span class="nv">B&#39;</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A &lt;~&gt; A&#39;) (<span class="nv">g</span> : B &lt;~&gt; B&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_17_i_sum</span> : A + B &lt;~&gt; A&#39; + B&#39;
    := HoTT.Types.Sum.equiv_functor_sum&#39; f g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkd9"><span class="kn">Definition</span> <span class="nf">Book_2_17_ii_sum</span> `{Univalence} : A + B &lt;~&gt; A&#39; + B&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A + B &lt;~&gt; A&#39; + B&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkda"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A + B &lt;~&gt; A&#39; + B&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkdb"><span class="nb">apply</span> equiv_path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A + B = A&#39; + B&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap011 sum (path_universe_uncurried f) (path_universe_uncurried g)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkdc"><span class="kn">Definition</span> <span class="nf">Book_2_17_eq_sum&#39;</span> `{Funext} (p : A = A&#39;) (q : B = B&#39;)
    : transport idmap (ap011 sum p q)
      = functor_sum (transport idmap p) (transport idmap q).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A = A&#39;</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 sum p q) =
functor_sum (transport idmap p) (transport idmap q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkdd"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A = A&#39;</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 sum p q) =
functor_sum (transport idmap p) (transport idmap q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkde"><span class="nb">clear</span> f g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A = A&#39;</span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>B = B&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 sum p q) =
functor_sum (transport idmap p) (transport idmap q)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkdf"><span class="nb">destruct</span> p, q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (ap011 sum <span class="mi">1</span> <span class="mi">1</span>) =
functor_sum (transport idmap <span class="mi">1</span>) (transport idmap <span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_arrow; <span class="nb">intros</span> [?|?]; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke0"><span class="kn">Theorem</span> <span class="nf">Book_2_17_eq_sum</span> `{Univalence}
    : Book_2_17_ii_sum = Book_2_17_i_sum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_sum = Book_2_17_i_sum</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_2_17_ii_sum = Book_2_17_i_sum</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke2"><span class="nb">apply</span> path_equiv; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap
  (ap011 sum (path_universe_uncurried f)
     (path_universe_uncurried g)) = functor_sum f g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke3">lhs napply Book_2_17_eq_sum&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_sum
  (transport idmap (path_universe_uncurried f))
  (transport idmap (path_universe_uncurried g)) =
functor_sum f g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke4">snapply ap011.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chke5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chke5"><hr></label><div class="goal-conclusion">transport idmap (path_universe_uncurried g) = g</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried f) = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> transport_idmap_path_universe_uncurried.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, A', B, B'</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A&#39;</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B &lt;~&gt; B&#39;</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried g) = g</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> transport_idmap_path_universe_uncurried.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_2_17_sum</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:dep-htpy-natural *)</span>
<span class="sd">(** Exercise 2.18 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_2_18</span> := @HoTT.Basics.PathGroupoids.apD_natural.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:equiv-functor-set *)</span>
<span class="sd">(** Exercise 3.1 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_1_solution_1</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A &lt;~&gt; B) (<span class="nv">H</span> : IsHSet A)
  := @HoTT.Basics.Trunc.istrunc_equiv_istrunc A B f <span class="mi">0</span> H.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Alternative solutions: [Book_3_1_solution_2] using UA, and [Book_3_1_solution_3] using two easy lemmas that may be of independent interest *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke8"><span class="kn">Lemma</span> <span class="nf">Book_3_1_solution_2</span> `{Univalence} {A B} : A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chke9"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkea"><span class="nb">intro</span> e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A -&gt; IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkeb"><span class="nb">rewrite</span> (path_universe_uncurried e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet B -&gt; IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> idmap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkec"><span class="kn">Lemma</span> <span class="nf">retr_f_g_path_in_B</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A -&gt; B)  (<span class="nv">g</span> : B -&gt; A)
  (<span class="nv">alpha</span> : f o g == idmap) (<span class="nv">x</span> <span class="nv">y</span> : B) (<span class="nv">p</span> : x = y)
  :  p = (alpha x)^ @ (ap f (ap g p)) @ (alpha y).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>alpha</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = ((alpha x)^ @ ap f (ap g p)) @ alpha y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chked"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>alpha</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = ((alpha x)^ @ ap f (ap g p)) @ alpha y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkee" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkee"><span class="nb">destruct</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>alpha</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = ((alpha x)^ @ ap f (ap g <span class="mi">1</span>)) @ alpha x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkef"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>alpha</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = ((alpha x)^ @ <span class="mi">1</span>) @ alpha x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf0"><span class="nb">rewrite</span> concat_p1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>alpha</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = (alpha x)^ @ alpha x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf1"><span class="nb">rewrite</span> concat_Vp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>alpha</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf2"><span class="kn">Lemma</span> <span class="nf">retr_f_g_isHSet_A_so_B</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A -&gt; B)  (<span class="nv">g</span> : B -&gt; A)
      : f o g == idmap -&gt; IsHSet A -&gt; IsHSet B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o g == idmap -&gt; IsHSet A -&gt; IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf3"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f o g == idmap -&gt; IsHSet A -&gt; IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf4"><span class="nb">intros</span> retr_f_g isHSet_A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf5">srapply hset_axiomK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">axiomK B</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf6"><span class="nb">unfold</span> axiomK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">x</span> : B) (<span class="nv">p</span> : x = x), p = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf7"><span class="nb">intros</span> x p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkf8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkf8"><span class="nb">assert</span> (ap g p = <span class="mi">1</span>) <span class="kr">as</span> g_p_is_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap g p = <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkf9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chkf9"><hr></label><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkfa">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap g p = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (axiomK_hset isHSet_A).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkfb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkfc"><span class="nb">assert</span> (<span class="mi">1</span> = (retr_f_g x) ^ @ (ap f (ap g p)) @ (retr_f_g x)) <span class="kr">as</span> rhs_is_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = ((retr_f_g x)^ @ ap f (ap g p)) @ retr_f_g x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chkfd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br><span><var>rhs_is_1</var><span class="hyp-type"><b>: </b><span><span class="mi">1</span> =
((retr_f_g x)^ @ ap f (ap g p)) @
retr_f_g x</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chkfd"><hr></label><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkfe">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = ((retr_f_g x)^ @ ap f (ap g p)) @ retr_f_g x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chkff"><span class="nb">rewrite</span> g_p_is_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = ((retr_f_g x)^ @ ap f <span class="mi">1</span>) @ retr_f_g x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk100"><span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = ((retr_f_g x)^ @ <span class="mi">1</span>) @ retr_f_g x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk101"><span class="nb">rewrite</span> concat_p1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = (retr_f_g x)^ @ retr_f_g x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk102"><span class="nb">rewrite</span> concat_Vp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk103">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br><span><var>rhs_is_1</var><span class="hyp-type"><b>: </b><span><span class="mi">1</span> =
((retr_f_g x)^ @ ap f (ap g p)) @
retr_f_g x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk104"><span class="nb">rewrite</span> (rhs_is_1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>f o g == idmap</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>g_p_is_1</var><span class="hyp-type"><b>: </b><span>ap g p = <span class="mi">1</span></span></span></span><br><span><var>rhs_is_1</var><span class="hyp-type"><b>: </b><span><span class="mi">1</span> =
((retr_f_g x)^ @ ap f (ap g p)) @
retr_f_g x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = ((retr_f_g x)^ @ ap f (ap g p)) @ retr_f_g x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (retr_f_g_path_in_B f g retr_f_g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk105"><span class="kn">Lemma</span> <span class="nf">Book_3_1_solution_3</span> {<span class="nv">A</span> <span class="nv">B</span>} : A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk106"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk107"><span class="nb">intros</span> equivalent_A_B isHSet_A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>equivalent_A_B</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; B</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk108"><span class="nb">elim</span> equivalent_A_B; <span class="nb">intros</span> f isequiv_f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>equivalent_A_B</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; B</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>isequiv_f</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk109"><span class="nb">elim</span> isequiv_f; <span class="nb">intros</span> g retr_f_g sect_f_g coh.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>equivalent_A_B</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; B</span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>isequiv_f</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>retr_f_g</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; f (g x)) == idmap</span></span></span><br><span><var>sect_f_g</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g (f x)) == idmap</span></span></span><br><span><var>coh</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, retr_f_g (f x) = ap f (sect_f_g x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet B</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (retr_f_g_isHSet_A_so_B f g); <span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:isset-coprod *)</span>
<span class="sd">(** Exercise 3.2 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_2_solution_1</span> := @HoTT.Types.Sum.ishset_sum.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Alternative solution for replaying *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10a"><span class="kn">Lemma</span> <span class="nf">Book_3_2_solution_2</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) : IsHSet A -&gt; IsHSet B -&gt; IsHSet (A+B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A -&gt; IsHSet B -&gt; IsHSet (A + B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A -&gt; IsHSet B -&gt; IsHSet (A + B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10c"><span class="nb">intros</span> isHSet_A isHSet_B.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet (A + B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10d">srapply hset_axiomK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">axiomK (A + B)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10e"><span class="nb">unfold</span> axiomK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">x</span> : A + B) (<span class="nv">p</span> : x = x), p = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk10f"><span class="nb">intros</span> x p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A + B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk110"><span class="nb">destruct</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>inl a = inl a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk111" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>inr b = inr b</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk111"><hr></label><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk112">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>inl a = inl a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk113"><span class="nb">rewrite</span> (inverse (eisretr_path_sum p)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>inl a = inl a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">path_sum (path_sum_inv p) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk114"><span class="nb">rewrite</span> (axiomK_hset isHSet_A a (path_sum_inv p)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>inl a = inl a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">path_sum <span class="mi">1</span> = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">simpl</span>; <span class="bp">exact</span> idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk115">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>inr b = inr b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk116"><span class="nb">rewrite</span> (inverse (eisretr_path_sum p)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>inr b = inr b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">path_sum (path_sum_inv p) = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk117"><span class="nb">rewrite</span> (axiomK_hset isHSet_B b (path_sum_inv p)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>isHSet_B</var><span class="hyp-type"><b>: </b><span>IsHSet B</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>inr b = inr b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">path_sum <span class="mi">1</span> = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">simpl</span>; <span class="bp">exact</span> idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:isset-sigma *)</span>
<span class="sd">(** Exercise 3.3 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_3_solution_1</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">B</span> : A -&gt; <span class="kt">Type</span>)
   := @HoTT.Types.Sigma.istrunc_sigma A B <span class="mi">0</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** This exercise is hard because 2-paths over Sigma types are not treated in the first three chapters of the book. Consult theories/Types/Sigma.v *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk118"><span class="kn">Lemma</span> <span class="nf">Book_3_3_solution_2</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">B</span> : A -&gt; <span class="kt">Type</span>) :
  IsHSet A -&gt; (<span class="kr">forall</span> <span class="nv">x</span>:A, IsHSet (B x)) -&gt; IsHSet { x:A | B x}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)) -&gt; IsHSet {x : A &amp; B x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk119"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)) -&gt; IsHSet {x : A &amp; B x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11a"><span class="nb">intros</span> isHSet_A allBx_HSet.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>allBx_HSet</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet {x : A &amp; B x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11b">srapply hset_axiomK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>allBx_HSet</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">axiomK {x : A &amp; B x}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11c"><span class="nb">intros</span> x xx.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>allBx_HSet</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>{x : A &amp; B x}</span></span></span><br><span><var>xx</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">xx = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11d"><span class="nb">pose</span> (path_path_sigma B x x xx <span class="mi">1</span>) <span class="kr">as</span> useful.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>isHSet_A</var><span class="hyp-type"><b>: </b><span>IsHSet A</span></span></span><br><span><var>allBx_HSet</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : A, IsHSet (B x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>{x : A &amp; B x}</span></span></span><br><span><var>xx</var><span class="hyp-type"><b>: </b><span>x = x</span></span></span><br><span><var>useful</var><span><span class="hyp-body"><b>:= </b><span>path_path_sigma B x x xx <span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">r</span> : xx ..<span class="mi">1</span> = <span class="mi">1</span> ..<span class="mi">1</span>,
transport
  (<span class="kr">fun</span> <span class="nv">x0</span> : x.<span class="mi">1</span> = x.<span class="mi">1</span> =&gt;
   transport B x0 x.<span class="mi">2</span> = x.<span class="mi">2</span>) r 
  xx ..<span class="mi">2</span> = <span class="mi">1</span> ..<span class="mi">2</span> -&gt; xx = <span class="mi">1</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">xx = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> (useful (axiomK_hset _ _ _) (hset_path2 _ _)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:prop-endocontr *)</span>
<span class="sd">(** Exercise 3.4 *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11e"><span class="kn">Lemma</span> <span class="nf">Book_3_4_solution_1</span> `{Funext} (A : <span class="kt">Type</span>) : IsHProp A &lt;-&gt; Contr (A -&gt; A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp A &lt;-&gt; Contr (A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk11f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp A &lt;-&gt; Contr (A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk120"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp A -&gt; Contr (A -&gt; A)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk121" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk121"><hr></label><div class="goal-conclusion">Contr (A -&gt; A) -&gt; IsHProp A</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk122">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp A -&gt; Contr (A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk123"><span class="nb">intro</span> isHProp_A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk124"><span class="nb">apply</span> (Build_Contr _ idmap).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">y</span> : A -&gt; A, idmap = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_ishprop. <span class="c">(* automagically, from IsHProp A *)</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk125">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (A -&gt; A) -&gt; IsHProp A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk126"><span class="nb">intro</span> contr_AA.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>contr_AA</var><span class="hyp-type"><b>: </b><span>Contr (A -&gt; A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk127"><span class="nb">apply</span> hprop_allpath; <span class="nb">intros</span> a1 a2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>contr_AA</var><span class="hyp-type"><b>: </b><span>Contr (A -&gt; A)</span></span></span><br><span><var>a1, a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">a1 = a2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap10 (path_contr (<span class="kr">fun</span> <span class="nv">x</span>:A =&gt; a1) (<span class="kr">fun</span> <span class="nv">x</span>:A =&gt; a2)) a1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:prop-inhabcontr *)</span>
<span class="sd">(** Exercise 3.5 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_5_solution_1</span> := @HoTT.Universes.HProp.equiv_hprop_inhabited_contr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:lem-mereprop *)</span>
<span class="sd">(** Exercise 3.6 *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk128"><span class="kn">Lemma</span> <span class="nf">Book_3_6_solution_1</span> `{Funext} (A : <span class="kt">Type</span>) : IsHProp A -&gt; IsHProp (A + ~A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp A -&gt; IsHProp (A + ~ A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk129" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk129"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp A -&gt; IsHProp (A + ~ A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12a"><span class="nb">intro</span> isHProp_A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (A + ~ A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12b"><span class="nb">apply</span> hprop_allpath.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : A + ~ A, x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12c"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A + ~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12d"><span class="nb">destruct</span> x <span class="kr">as</span> [a1|n1]; <span class="nb">destruct</span> y <span class="kr">as</span> [a2|n2]; <span class="nb">apply</span> path_sum; <span class="kp">try</span> <span class="nb">apply</span> path_ishprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">code_sum (inl a1) (inr n2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk12e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk12e"><hr></label><div class="goal-conclusion">code_sum (inr n1) (inl a2)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk12f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>n2</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">code_sum (inl a1) (inr n2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (n2 a1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk130" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk130">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>n1</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">code_sum (inr n1) (inl a2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (n1 a2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:disjoint-or *)</span>
<span class="sd">(** Exercise 3.7 *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk131"><span class="kn">Lemma</span> <span class="nf">Book_3_7_solution_1</span> (<span class="nv">A</span> <span class="nv">B</span>: <span class="kt">Type</span>) :
  IsHProp A -&gt; IsHProp B -&gt; ~(A*B) -&gt; IsHProp (A+B).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp A -&gt; IsHProp B -&gt; ~ (A * B) -&gt; IsHProp (A + B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk132"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp A -&gt; IsHProp B -&gt; ~ (A * B) -&gt; IsHProp (A + B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk133"><span class="nb">intros</span> isHProp_A isProp_B nab.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>isProp_B</var><span class="hyp-type"><b>: </b><span>IsHProp B</span></span></span><br><span><var>nab</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (A + B)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk134"><span class="nb">apply</span> hprop_allpath.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>isProp_B</var><span class="hyp-type"><b>: </b><span>IsHProp B</span></span></span><br><span><var>nab</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : A + B, x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk135"><span class="nb">intros</span> x y.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>isProp_B</var><span class="hyp-type"><b>: </b><span>IsHProp B</span></span></span><br><span><var>nab</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A + B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk136"><span class="nb">destruct</span> x <span class="kr">as</span> [a1|b1]; <span class="nb">destruct</span> y <span class="kr">as</span> [a2|b2]; <span class="nb">apply</span> path_sum; <span class="kp">try</span> <span class="nb">apply</span> path_ishprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>isProp_B</var><span class="hyp-type"><b>: </b><span>IsHProp B</span></span></span><br><span><var>nab</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b2</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">code_sum (inl a1) (inr b2)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk137" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>isProp_B</var><span class="hyp-type"><b>: </b><span>IsHProp B</span></span></span><br><span><var>nab</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk137"><hr></label><div class="goal-conclusion">code_sum (inr b1) (inl a2)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk138" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk138">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>isProp_B</var><span class="hyp-type"><b>: </b><span>IsHProp B</span></span></span><br><span><var>nab</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>a1</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>b2</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">code_sum (inl a1) (inr b2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (nab (a1,b2)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk139">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>isHProp_A</var><span class="hyp-type"><b>: </b><span>IsHProp A</span></span></span><br><span><var>isProp_B</var><span class="hyp-type"><b>: </b><span>IsHProp B</span></span></span><br><span><var>nab</var><span class="hyp-type"><b>: </b><span>~ (A * B)</span></span></span><br><span><var>b1</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br><span><var>a2</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">code_sum (inr b1) (inl a2)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (nab (a2,b1)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:brck-qinv *)</span>
<span class="sd">(** Exercise 3.8 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_8_qinv</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B) : <span class="kt">Type</span>
  := {g : B -&gt; A &amp; (f o g == idmap) * (g o f == idmap)}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_3_8_ctx</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">isequiv</span> : <span class="kr">forall</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>}, (A -&gt; B) -&gt; <span class="kt">Type</span>}
    {<span class="nv">cond_i</span> : <span class="kr">forall</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B), isequiv f -&gt; Book_3_8_qinv f}
    {<span class="nv">cond_ii</span> : <span class="kr">forall</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B), Book_3_8_qinv f -&gt; isequiv f}
    {<span class="nv">cond_iii</span> : <span class="kr">forall</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B), IsHProp (isequiv f)}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13a"><span class="kn">Definition</span> <span class="nf">Book_3_8_cond_i</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B)
    : Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f) -&gt; Book_3_8_qinv f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f) -&gt; Book_3_8_qinv f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f) -&gt; Book_3_8_qinv f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13c"><span class="nb">refine</span> (cond_i _ _ f o _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f) -&gt; isequiv A B f</div></blockquote></div></div></small><span class="alectryon-wsp">  
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Trunc_rec, cond_ii.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_8_cond_ii</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B)
    : Book_3_8_qinv f -&gt; Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f)
    := tr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_8_cond_iii</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A-&gt; B)
    : IsHProp (Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f))
    := _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13d"><span class="kn">Definition</span> <span class="nf">Book_3_8_equiv</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B)
    : Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f) &lt;~&gt; (isequiv _ _ f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f) &lt;~&gt; isequiv A B f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f) &lt;~&gt; isequiv A B f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk13f">snapply equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk140" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk140"><hr></label><div class="goal-conclusion">IsHProp (isequiv A B f)</div></blockquote><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk141" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk141"><hr></label><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f) -&gt; isequiv A B f</div></blockquote><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk142" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk142"><hr></label><div class="goal-conclusion">isequiv A B f -&gt; Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk143">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk144">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (isequiv A B f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> cond_iii.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk145">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f) -&gt; isequiv A B f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> Trunc_rec, cond_ii.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk146">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">isequiv A B f -&gt; Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk147"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>isequiv</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, (A -&gt; B) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>cond_i</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
isequiv A B f -&gt; Book_3_8_qinv f</span></span></span><br><span><var>cond_ii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
Book_3_8_qinv f -&gt; isequiv A B f</span></span></span><br><span><var>cond_iii</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
IsHProp (isequiv A B f)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>isequiv A B f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Book_3_8_qinv f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> tr, cond_i, x.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_3_8_ctx</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:lem-impl-prop-equiv-bool *)</span>
<span class="sd">(** Exercise 3.9 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">LEM</span> := <span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>), IsHProp A -&gt; A + ~A.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">LEM_hProp_Bool</span> (<span class="nv">lem</span> : LEM) (<span class="nv">hprop</span> : HProp) : Bool
  := <span class="kr">match</span> (lem hprop _) <span class="kr">with</span> inl _ =&gt; true | inr _ =&gt; false <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk148"><span class="kn">Lemma</span> <span class="nf">Book_3_9_solution_1</span> `{Univalence} : LEM -&gt; HProp &lt;~&gt; Bool.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LEM -&gt; HProp &lt;~&gt; Bool</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk149"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LEM -&gt; HProp &lt;~&gt; Bool</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14a"><span class="nb">intro</span> lem.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HProp &lt;~&gt; Bool</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14b"><span class="nb">apply</span> (equiv_adjointify (LEM_hProp_Bool lem) is_true).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; LEM_hProp_Bool lem (is_true x)) ==
idmap</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk14c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk14c"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : HProp =&gt; is_true (LEM_hProp_Bool lem x)) ==
idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : Bool =&gt; LEM_hProp_Bool lem (is_true x)) ==
idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk14e"><span class="nb">intros</span> []; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LEM_hProp_Bool lem Unit_hp = true</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk14f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk14f"><hr></label><div class="goal-conclusion">LEM_hProp_Bool lem False_hp = false</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk150">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LEM_hProp_Bool lem Unit_hp = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk151"><span class="nb">unfold</span> LEM_hProp_Bool.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> lem Unit_hp (trunctype_istrunc Unit_hp) <span class="kr">with</span>
| inl _ =&gt; true
| inr _ =&gt; false
<span class="kr">end</span> = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk152"><span class="nb">elim</span> (lem Unit_hp _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Unit_hp -&gt; true = true</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk153" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk153"><hr></label><div class="goal-conclusion">~ Unit_hp -&gt; false = true</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk154">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Unit_hp -&gt; true = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">_</span> =&gt; <span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk155">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ Unit_hp -&gt; false = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk156"><span class="nb">intro</span> nUnit.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>nUnit</var><span class="hyp-type"><b>: </b><span>~ Unit_hp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">false = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (nUnit tt).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk157">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">LEM_hProp_Bool lem False_hp = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk158"><span class="nb">unfold</span> LEM_hProp_Bool.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span> lem False_hp (trunctype_istrunc False_hp) <span class="kr">with</span>
| inl _ =&gt; true
| inr _ =&gt; false
<span class="kr">end</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk159"><span class="nb">elim</span> (lem False_hp _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False_hp -&gt; true = false</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk15a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk15a"><hr></label><div class="goal-conclusion">~ False_hp -&gt; false = false</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15b">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">False_hp -&gt; true = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15c"><span class="nb">intro</span> fals.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>fals</var><span class="hyp-type"><b>: </b><span>False_hp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">true = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> fals.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15d">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ False_hp -&gt; false = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">_</span> =&gt; <span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : HProp =&gt; is_true (LEM_hProp_Bool lem x)) ==
idmap</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk15f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk15f"><span class="nb">intro</span> hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_true (LEM_hProp_Bool lem hprop) = hprop</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk160"><span class="nb">unfold</span> LEM_hProp_Bool.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_true
  <span class="kr">match</span> lem hprop (trunctype_istrunc hprop) <span class="kr">with</span>
  | inl _ =&gt; true
  | inr _ =&gt; false
  <span class="kr">end</span> = hprop</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk161"><span class="nb">elim</span> (lem hprop _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hprop -&gt; is_true true = hprop</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk162" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk162"><hr></label><div class="goal-conclusion">~ hprop -&gt; is_true false = hprop</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk163">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">hprop -&gt; is_true true = hprop</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk164" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk164"><span class="nb">intro</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>hprop</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_true true = hprop</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk165"><span class="nb">apply</span> path_hprop; <span class="nb">simpl</span>. <span class="c">(* path_prop is silent *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>hprop</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Unit &lt;~&gt; hprop</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((if_hprop_then_equiv_Unit hprop p)^-<span class="mi">1</span>)%equiv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk166">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ hprop -&gt; is_true false = hprop</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk167"><span class="nb">intro</span> np.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ hprop</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_true false = hprop</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk168"><span class="nb">apply</span> path_hprop; <span class="nb">simpl</span>. <span class="c">(* path_prop is silent *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>lem</var><span class="hyp-type"><b>: </b><span>LEM</span></span></span><br><span><var>hprop</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>np</var><span class="hyp-type"><b>: </b><span>~ hprop</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty &lt;~&gt; hprop</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((if_not_hprop_then_equiv_Empty hprop np)^-<span class="mi">1</span>)%equiv.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:lem-impred *)</span>
<span class="sd">(** Exercise 3.10 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_10_LEM</span>@{j} := <span class="kr">forall</span> <span class="nv">A</span> : HProp@{j}, A + ~ A.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_10_Lift</span>@{i j | i &lt; j} (A : HProp@{i}) : HProp@{j}
  := @Build_HProp A (trunctype_istrunc A).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk169"><span class="kn">Definition</span> <span class="nf">Book_3_10_impred</span>@{i j k | i &lt; j, j &lt; k} `{Univalence}
  (LEM : Book_3_10_LEM@{j})
  : IsEquiv@{j k} Book_3_10_Lift@{i j}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv Book_3_10_Lift</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv Book_3_10_Lift</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16b">snapply isequiv_adjointify.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HProp -&gt; HProp</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk16c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk16c"><hr></label><div class="goal-conclusion">Book_3_10_Lift o <span class="nl">?g</span> == idmap</div></blockquote><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk16d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk16d"><hr></label><div class="goal-conclusion"><span class="nl">?g</span> o Book_3_10_Lift == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16e">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HProp -&gt; HProp</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk16f"><span class="nb">intro</span> A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HProp</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk170"><span class="nb">destruct</span> (LEM A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HProp</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk171" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk171"><hr></label><div class="goal-conclusion">HProp</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk172">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HProp</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Build_HProp Unit).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk173">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">HProp</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Build_HProp Empty).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk174">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_3_10_Lift
o (<span class="kr">fun</span> <span class="nv">A</span> : HProp =&gt;
   <span class="kr">let</span> <span class="nv">s</span> := LEM A <span class="kr">in</span>
   <span class="kr">match</span> s <span class="kr">with</span>
   | inl t =&gt; (<span class="kr">fun</span> <span class="nv">_</span> : A =&gt; Build_HProp Unit) t
   | inr n =&gt; (<span class="kr">fun</span> <span class="nv">_</span> : ~ A =&gt; Build_HProp Empty) n
   <span class="kr">end</span>) == idmap</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk175" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk175"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">A</span> : HProp =&gt;
 <span class="kr">let</span> <span class="nv">s</span> := LEM A <span class="kr">in</span>
 <span class="kr">match</span> s <span class="kr">with</span>
 | inl t =&gt; (<span class="kr">fun</span> <span class="nv">_</span> : A =&gt; Build_HProp Unit) t
 | inr n =&gt; (<span class="kr">fun</span> <span class="nv">_</span> : ~ A =&gt; Build_HProp Empty) n
 <span class="kr">end</span>) o Book_3_10_Lift == idmap</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk176" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk176"><span class="mi">1</span>-<span class="mi">2</span>: <span class="nb">intro</span> A; <span class="nb">destruct</span> (LEM _) <span class="kr">as</span> [a|na];
    <span class="nb">apply</span> path_hprop, equiv_inverse; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A &lt;~&gt; Unit</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk177" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk177"><hr></label><div class="goal-conclusion">A &lt;~&gt; Empty</div></blockquote><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk178" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Book_3_10_Lift A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk178"><hr></label><div class="goal-conclusion">A &lt;~&gt; Unit</div></blockquote><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk179" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ Book_3_10_Lift A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk179"><hr></label><div class="goal-conclusion">A &lt;~&gt; Empty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17a"><span class="mi">1</span>,<span class="mi">3</span>: <span class="bp">exact</span> (if_hprop_then_equiv_Unit A a).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A &lt;~&gt; Empty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk17b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span>Book_3_10_LEM</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>HProp</span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ Book_3_10_Lift A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk17b"><hr></label><div class="goal-conclusion">A &lt;~&gt; Empty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="mi">1</span>,<span class="mi">2</span>: <span class="bp">exact</span> (if_not_hprop_then_equiv_Empty A na).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:not-brck-A-impl-A *)</span>
<span class="sd">(** Exercise 3.11 *)</span>

<span class="sd">(** This theorem extracts the main idea leading to the contradiction constructed</span>
<span class="sd">    in the proof of Theorem 3.2.2, that univalence implies that all functions are</span>
<span class="sd">    natural with respect to equivalences.</span>

<span class="sd">    The terms are complicated, but it pretty much follows the proof in the book,</span>
<span class="sd">    step by step.</span>
<span class="sd"> *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17c"><span class="kn">Lemma</span> <span class="nf">univalence_func_natural_equiv</span> `{Univalence}
  : <span class="kr">forall</span> (<span class="nv">C</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>) (<span class="nv">all_contr</span> : <span class="kr">forall</span> <span class="nv">A</span>, Contr (C A -&gt; C A))
      (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">A</span>, C A -&gt; A) {<span class="nv">A</span> : <span class="kt">Type</span>}  (<span class="nv">e</span> : A &lt;~&gt; A),
    e o (g A) = (g A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)) -&gt;
<span class="kr">forall</span> (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A) (<span class="nv">A</span> : <span class="kt">Type</span>)
(<span class="nv">e</span> : A &lt;~&gt; A), e o g A = g A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">C</span> : <span class="kt">Type</span> -&gt; <span class="kt">Type</span>,
(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)) -&gt;
<span class="kr">forall</span> (<span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A) (<span class="nv">A</span> : <span class="kt">Type</span>)
(<span class="nv">e</span> : A &lt;~&gt; A), e o g A = g A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17e"><span class="nb">intros</span> C all_contr g A e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>all_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e o g A = g A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk17f"><span class="nb">apply</span> path_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>all_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : C A =&gt; e (g A x)) == g A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk180"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>all_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e (g A x) = g A x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk181"><span class="nb">pose</span> (p := path_universe_uncurried e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>all_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C A</span></span></span><br><span><var>p</var><span><span class="hyp-body"><b>:= </b><span>path_universe_uncurried e</span></span><span class="hyp-type"><b>: </b><span>A = A</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e (g A x) = g A x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* The propositional computation rule for univalence of section 2.10 *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk182"><span class="nb">refine</span> (concat (happly (transport_idmap_path_universe_uncurried e)^ (g A x)) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>all_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C A</span></span></span><br><span><var>p</var><span><span class="hyp-body"><b>:= </b><span>path_universe_uncurried e</span></span><span class="hyp-type"><b>: </b><span>A = A</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried e) (g A x) =
g A x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** To obtain the situation of 2.9.4, we rewrite x using</span>

<span class="sd">&lt;&lt;</span>
<span class="sd">        x = transport (fun A : Type =&gt; C A) p^ x</span>
<span class="sd">&gt;&gt;</span>

<span class="sd">      This equality holds because [(C A) -&gt; (C A)] is contractible, so</span>

<span class="sd">&lt;&lt;</span>
<span class="sd">        transport (fun A : Type =&gt; C A) p^ = idmap</span>
<span class="sd">&gt;&gt;</span>

<span class="sd">      In both Theorem 3.2.2 and the following result, the hypothesis</span>
<span class="sd">      [Contr ((C A) -&gt; (C A))] will follow from the contractibility of [(C A)].</span>
<span class="sd">   *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk183"><span class="nb">refine</span> (concat (ap _ (ap _ (happly (@path_contr _ (all_contr A)
                                                  idmap (transport _ p^)) x))) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>all_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C A</span></span></span><br><span><var>p</var><span><span class="hyp-body"><b>:= </b><span>path_universe_uncurried e</span></span><span class="hyp-type"><b>: </b><span>A = A</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport idmap (path_universe_uncurried e)
  (g A (transport C p^ x)) = g A x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(* Equation 2.9.4 is called transport_arrow in the library. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk184"><span class="nb">refine</span> (concat (@transport_arrow _ (<span class="kr">fun</span> <span class="nv">A</span> =&gt; C A) idmap _ _ p (g A) x)^ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> -&gt; <span class="kt">Type</span></span></span></span><br><span><var>all_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (C A -&gt; C A)</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, C A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>A &lt;~&gt; A</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>C A</span></span></span><br><span><var>p</var><span><span class="hyp-body"><b>:= </b><span>path_universe_uncurried e</span></span><span class="hyp-type"><b>: </b><span>A = A</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">x</span> : <span class="kt">Type</span> =&gt; C x -&gt; x) p (g A) x = g A x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (happly (apD g p) x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** For this proof, we closely follow the proof of Theorem 3.2.2</span>
<span class="sd">    from the text, replacing ¬¨¬¨A ‚Üí A by ‚à•A‚à• ‚Üí A. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk185" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk185"><span class="kn">Lemma</span> <span class="nf">Book_3_11</span> `{Univalence} : ~ (<span class="kr">forall</span> <span class="nv">A</span>, Trunc (-<span class="mi">1</span>) A -&gt; A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk186"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* The proof is by contradiction. We&#39;ll assume we have such a</span>
<span class="c">     function, and obtain an element of 0. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk187"><span class="nb">intros</span> g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk188"><span class="nb">assert</span> (end_contr : <span class="kr">forall</span> <span class="nv">A</span>, Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk189" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span><br><span><var>end_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk189"><hr></label><div class="goal-conclusion">Empty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18a">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18b"><span class="nb">intros</span> A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18c"><span class="nb">apply</span> Book_3_4_solution_1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (Trunc (-<span class="mi">1</span>) A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> istrunc_truncation.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18d">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span><br><span><var>end_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** There are no fixpoints of the fix-point free autoequivalence of 2 (called</span>
<span class="sd">      negb). We will derive a contradiction by showing there must be such a fixpoint</span>
<span class="sd">      by naturality of g.</span>

<span class="sd">      We parametrize over b to emphasize that this proof depends only on the fact</span>
<span class="sd">      that Bool is inhabited, not on any specific value (we use &quot;true&quot; below).</span>
<span class="sd">   *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18e"><span class="nb">pose</span>
    (contr b :=
        (not_fixed_negb (g Bool b))
        (happly (univalence_func_natural_equiv _ end_contr g equiv_negb) b)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) A -&gt; A</span></span></span><br><span><var>end_contr</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>,
Contr (Trunc (-<span class="mi">1</span>) A -&gt; Trunc (-<span class="mi">1</span>) A)</span></span></span><br><span><var>contr</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">b</span> : Trunc (-<span class="mi">1</span>) Bool =&gt;
not_fixed_negb (g Bool b)
  (ap10
     (univalence_func_natural_equiv
        (Trunc (-<span class="mi">1</span>)) end_contr g equiv_negb) b)</span></span><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) Bool -&gt; Empty</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">contradiction</span> (contr (tr true)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:lem-impl-simple-ac *)</span>
<span class="sd">(** Exercise 3.12 *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk18f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk18f"><span class="kn">Definition</span> <span class="nf">Book_3_12</span> (<span class="nv">LEM</span>: <span class="kr">forall</span> <span class="nv">A</span>, IsHProp A -&gt; A + ~ A)
  : <span class="kr">forall</span> <span class="nv">A</span>, Trunc (-<span class="mi">1</span>) (Trunc (-<span class="mi">1</span>) A -&gt; A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) (Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk190"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, Trunc (-<span class="mi">1</span>) (Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk191" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk191"><span class="nb">intro</span> A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk192"><span class="nb">destruct</span> (LEM (Trunc (-<span class="mi">1</span>) A) _) <span class="kr">as</span> [a|na].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk193" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk193"><hr></label><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk194">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk195"><span class="nb">revert</span> a; <span class="nb">apply</span> Trunc_rec; <span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> tr, (<span class="kr">fun</span> <span class="nv">a0</span> =&gt; a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk196">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) (Trunc (-<span class="mi">1</span>) A -&gt; A)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk197"><span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) A -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk198"><span class="nb">intro</span> a0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>na</var><span class="hyp-type"><b>: </b><span>~ Trunc (-<span class="mi">1</span>) A</span></span></span><br><span><var>a0</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (na a0).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:naive-lem-impl-ac *)</span>
<span class="sd">(** Exercise 3.13 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_3_13</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">naive_LEM_impl_DN_elim</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">LEM</span> : A + ~A)
  : ~~A -&gt; A
    := <span class="kr">fun</span> <span class="nv">nna</span> =&gt; <span class="kr">match</span> LEM <span class="kr">with</span>
                    | inl a =&gt; a
                    | inr na =&gt; <span class="kr">match</span> nna na <span class="kr">with</span> <span class="kr">end</span>
                  <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk199"><span class="kn">Lemma</span> <span class="nf">naive_LEM_implies_AC</span>
  : (<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~A)
    -&gt; <span class="kr">forall</span> <span class="nv">X</span> <span class="nv">A</span> <span class="nv">P</span>,
         (<span class="kr">forall</span> <span class="nv">x</span> : X, ~~{ a : A x | P x a })
         -&gt; { g : <span class="kr">forall</span> <span class="nv">x</span>, A x | <span class="kr">forall</span> <span class="nv">x</span>, P x (g x) }.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A) -&gt;
<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">A</span> : X -&gt; <span class="kt">Type</span>)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}) -&gt;
{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A) -&gt;
<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">A</span> : X -&gt; <span class="kt">Type</span>)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}) -&gt;
{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19b"><span class="nb">intros</span> LEM X A P H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19c"><span class="nb">pose</span> (<span class="kr">fun</span> <span class="nv">x</span> =&gt; @naive_LEM_impl_DN_elim _ (LEM _) (H x)) <span class="kr">as</span> H&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}</span></span></span><br><span><var>H'</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : X =&gt;
naive_LEM_impl_DN_elim {a : A x &amp; P x a}
  (LEM {a : A x &amp; P x a}) (H x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, {a : A x &amp; P x a}</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19d"><span class="kr">exists</span> (<span class="nv">fun</span> <span class="nv">x</span> =&gt; (H&#39; x).<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}</span></span></span><br><span><var>H'</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : X =&gt;
naive_LEM_impl_DN_elim {a : A x &amp; P x a}
  (LEM {a : A x &amp; P x a}) (H x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, {a : A x &amp; P x a}</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : X, P x (H&#39; x).<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span> =&gt; (H&#39; x).<span class="mi">2</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19e"><span class="kn">Lemma</span> <span class="nf">Book_3_13</span> `{Funext}
  : (<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~A)
    -&gt; <span class="kr">forall</span> <span class="nv">X</span> <span class="nv">A</span> <span class="nv">P</span>,
         IsHSet X
         -&gt; (<span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x))
         -&gt; (<span class="kr">forall</span> <span class="nv">x</span> (<span class="nv">a</span> : A x), IsHProp (P x a))
         -&gt; (<span class="kr">forall</span> <span class="nv">x</span>, merely { a : A x &amp; P x a })
         -&gt; merely { g : <span class="kr">forall</span> <span class="nv">x</span>, A x &amp; <span class="kr">forall</span> <span class="nv">x</span>, P x (g x) }.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A) -&gt;
<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">A</span> : X -&gt; <span class="kt">Type</span>)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span>),
IsHSet X -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)) -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)) -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}) -&gt;
merely
  {g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk19f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A) -&gt;
<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">A</span> : X -&gt; <span class="kt">Type</span>)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span>),
IsHSet X -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)) -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)) -&gt;
(<span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}) -&gt;
merely
  {g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a0"><span class="nb">intros</span> LEM X A P HX HA HP H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>HX</var><span class="hyp-type"><b>: </b><span>IsHSet X</span></span></span><br><span><var>HA</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span><br><span><var>HP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely
  {g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a1"><span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>HX</var><span class="hyp-type"><b>: </b><span>IsHSet X</span></span></span><br><span><var>HA</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span><br><span><var>HP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{g : <span class="kr">forall</span> <span class="nv">x</span> : X, A x &amp; <span class="kr">forall</span> <span class="nv">x</span> : X, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a2"><span class="nb">apply</span> (naive_LEM_implies_AC LEM).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>HX</var><span class="hyp-type"><b>: </b><span>IsHSet X</span></span></span><br><span><var>HA</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span><br><span><var>HP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ {a : A x &amp; P x a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a3"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>HX</var><span class="hyp-type"><b>: </b><span>IsHSet X</span></span></span><br><span><var>HA</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span><br><span><var>HP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, merely {a : A x &amp; P x a}</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ {a : A x &amp; P x a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a4"><span class="nb">specialize</span> (H0 x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>HX</var><span class="hyp-type"><b>: </b><span>IsHSet X</span></span></span><br><span><var>HA</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span><br><span><var>HP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>merely {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ {a : A x &amp; P x a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a5"><span class="nb">revert</span> H0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>HX</var><span class="hyp-type"><b>: </b><span>IsHSet X</span></span></span><br><span><var>HA</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span><br><span><var>HP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely {a : A x &amp; P x a} -&gt; ~~ {a : A x &amp; P x a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a6"><span class="nb">apply</span> Trunc_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>X -&gt; <span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, A x -&gt; <span class="kt">Type</span></span></span></span><br><span><var>HX</var><span class="hyp-type"><b>: </b><span>IsHSet X</span></span></span><br><span><var>HA</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, IsHSet (A x)</span></span></span><br><span><var>HP</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> : X) (<span class="nv">a</span> : A x), IsHProp (P x a)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{a : A x &amp; P x a} -&gt; ~~ {a : A x &amp; P x a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">nx</span> =&gt; nx x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_3_13</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:lem-brck *)</span>
<span class="sd">(** Exercise 3.14 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_3_14</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> `{Funext}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hypothesis</span> <span class="nv">LEM</span> : <span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~A.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a7"><span class="kn">Definition</span> <span class="nf">Book_3_14</span>
  : <span class="kr">forall</span> <span class="nv">A</span> (<span class="nv">P</span> : ~~A -&gt; <span class="kt">Type</span>),
    (<span class="kr">forall</span> <span class="nv">a</span>, P (<span class="kr">fun</span> <span class="nv">na</span> =&gt; na a))
    -&gt; (<span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> (<span class="nv">z</span> : P x) (<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w)
    -&gt; <span class="kr">forall</span> <span class="nv">x</span>, P x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : ~~ A -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)) -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) (<span class="nv">w</span> : P y),
 transport P (path_ishprop x y) z = w) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : ~~ A, P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a8"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">P</span> : ~~ A -&gt; <span class="kt">Type</span>),
(<span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)) -&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) (<span class="nv">w</span> : P y),
 transport P (path_ishprop x y) z = w) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : ~~ A, P x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1a9"><span class="nb">intros</span> A P base p nna.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P nna</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1aa"><span class="nb">assert</span> (<span class="kr">forall</span> <span class="nv">x</span>, IsHProp (P x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1ab" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1ab"><hr></label><div class="goal-conclusion">P nna</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ac">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ad" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ad"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna, x</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (P x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ae"><span class="nb">apply</span> hprop_allpath.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna, x</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x0</span> <span class="nv">y</span> : P x, x0 = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1af" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1af"><span class="nb">intros</span> x&#39; y&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna, x</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>x', y'</var><span class="hyp-type"><b>: </b><span>P x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x&#39; = y&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b0"><span class="nb">etransitivity</span>; [ <span class="nb">symmetry</span>; <span class="nb">apply</span> (p x x y&#39; x&#39;) | ].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna, x</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>x', y'</var><span class="hyp-type"><b>: </b><span>P x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport P (path_ishprop x x) y&#39; = y&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">     <span class="c">(* Without this it somehow proves [H&#39;] using the wrong universe for hprop_Empty and fails when we do [Defined].</span>
<span class="c">        See Coq #4862. *)</span>
</span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b1"><span class="nb">set</span> (path := path_ishprop x x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna, x</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>x', y'</var><span class="hyp-type"><b>: </b><span>P x</span></span></span><br><span><var>path</var><span><span class="hyp-body"><b>:= </b><span>path_ishprop x x</span></span><span class="hyp-type"><b>: </b><span>x = x</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport P path y&#39; = y&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b2"><span class="nb">assert</span> (H&#39; : idpath = path) <span class="bp">by</span> <span class="nb">apply</span> path_ishprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna, x</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>x', y'</var><span class="hyp-type"><b>: </b><span>P x</span></span></span><br><span><var>path</var><span><span class="hyp-body"><b>:= </b><span>path_ishprop x x</span></span><span class="hyp-type"><b>: </b><span>x = x</span></span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span><span class="mi">1</span> = path</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport P path y&#39; = y&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b3"><span class="nb">destruct</span> H&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna, x</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>x', y'</var><span class="hyp-type"><b>: </b><span>P x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport P <span class="mi">1</span> y&#39; = y&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P nna</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b5"><span class="nb">destruct</span> (LEM (P nna) _) <span class="kr">as</span> [pnna|npnna]; <span class="nb">trivial</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span><br><span><var>npnna</var><span class="hyp-type"><b>: </b><span>~ P nna</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P nna</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b6"><span class="nb">refine</span> (<span class="kr">match</span> _ : Empty <span class="kr">with</span> <span class="kr">end</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span><br><span><var>npnna</var><span class="hyp-type"><b>: </b><span>~ P nna</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b7"><span class="nb">apply</span> nna.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span><br><span><var>npnna</var><span class="hyp-type"><b>: </b><span>~ P nna</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b8"><span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span><br><span><var>npnna</var><span class="hyp-type"><b>: </b><span>~ P nna</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1b9"><span class="nb">apply</span> npnna.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>~~ A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>base</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (<span class="kr">fun</span> <span class="nv">na</span> : ~ A =&gt; na a)</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> : P x) 
(<span class="nv">w</span> : P y), transport P (path_ishprop x y) z = w</span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : ~~ A, IsHProp (P x)</span></span></span><br><span><var>npnna</var><span class="hyp-type"><b>: </b><span>~ P nna</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P nna</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (transport P (path_ishprop _ _) (base a)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ba" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ba"><span class="kn">Lemma</span> <span class="nf">Book_3_14_equiv</span> <span class="nv">A</span> : merely A &lt;~&gt; ~~A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely A &lt;~&gt; ~~ A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1bb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely A &lt;~&gt; ~~ A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1bc"><span class="nb">apply</span> equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely A -&gt; ~~ A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1bd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1bd"><hr></label><div class="goal-conclusion">~~ A -&gt; merely A</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1be">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely A -&gt; ~~ A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1bf"><span class="nb">apply</span> Trunc_rec.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A -&gt; ~~ A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">a</span> <span class="nv">na</span> =&gt; na a).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c0">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ A -&gt; merely A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c1"><span class="nb">intro</span> nna.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c2"><span class="nb">apply</span> (@Book_3_14 A (<span class="kr">fun</span> <span class="nv">_</span> =&gt; merely A)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A -&gt; merely A</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1c3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1c3"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> <span class="nv">w</span> : merely A),
transport (<span class="kr">fun</span> <span class="nv">_</span> : ~~ A =&gt; merely A)
  (path_ishprop x y) z = w</div></blockquote><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1c4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1c4"><hr></label><div class="goal-conclusion">~~ A</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c5">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A -&gt; merely A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> tr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c6">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">x</span> <span class="nv">y</span> : ~~ A) (<span class="nv">z</span> <span class="nv">w</span> : merely A),
transport (<span class="kr">fun</span> <span class="nv">_</span> : ~~ A =&gt; merely A)
  (path_ishprop x y) z = w</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c7"><span class="nb">intros</span> x y z w.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nna, x, y</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br><span><var>z, w</var><span class="hyp-type"><b>: </b><span>merely A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">_</span> : ~~ A =&gt; merely A)
  (path_ishprop x y) z = w</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_ishprop.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c8">*</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>nna</var><span class="hyp-type"><b>: </b><span>~~ A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ A</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> nna.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_3_14</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:impred-brck *)</span>
<span class="sd">(** Exercise 3.15 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_15</span> := @HoTT.Metatheory.ImpredicativeTruncation.resized_Trm_rec_beta.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:lem-impl-dn-commutes *)</span>
<span class="sd">(** Exercise 3.16 *)</span>

<span class="sd">(** This result holds in general when [Y x] is stable for each [x : X] *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1c9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1c9"><span class="kn">Definition</span> <span class="nf">Book_3_16</span> `{Funext} (LEM : <span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A)
  (X : HSet) (Y : X -&gt; HProp)
  : (<span class="kr">forall</span> <span class="nv">x</span>, ~~ Y x) &lt;~&gt; ~~ (<span class="kr">forall</span> <span class="nv">x</span>, Y x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x) &lt;~&gt; ~~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ca"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x) &lt;~&gt; ~~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1cb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1cb">rapply equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x) -&gt; ~~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1cc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1cc"><hr></label><div class="goal-conclusion">~~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x) -&gt; <span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1cd">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x) -&gt; ~~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ce" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ce"><span class="nb">intros</span> f g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1cf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1cf"><span class="nb">apply</span> g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : X, Y x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d0"><span class="nb">intro</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Y x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d1"><span class="nb">destruct</span> (LEM (Y x)) <span class="kr">as</span> [y|ny].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Y x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1d2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>ny</var><span class="hyp-type"><b>: </b><span>~ Y x</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1d2"><hr></label><div class="goal-conclusion">Y x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d3">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>y</var><span class="hyp-type"><b>: </b><span>Y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Y x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d4">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>ny</var><span class="hyp-type"><b>: </b><span>~ Y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Y x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (f x ny).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x) -&gt; <span class="kr">forall</span> <span class="nv">x</span> : X, ~~ Y x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d6"><span class="nb">intros</span> f x ny.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>ny</var><span class="hyp-type"><b>: </b><span>~ Y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d7"><span class="nb">apply</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>ny</var><span class="hyp-type"><b>: </b><span>~ Y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d8"><span class="nb">intro</span> g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : HProp, A + ~ A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>HSet</span></span></span><br><span><var>Y</var><span class="hyp-type"><b>: </b><span>X -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>~~ (<span class="kr">forall</span> <span class="nv">x</span> : X, Y x)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>X</span></span></span><br><span><var>ny</var><span class="hyp-type"><b>: </b><span>~ Y x</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : X, Y x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ny (g x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:prop-trunc-ind *)</span>
<span class="sd">(** Exercise 3.17 *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1d9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1d9"><span class="kn">Definition</span> <span class="nf">Book_3_17</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">B</span> : Trunc (-<span class="mi">1</span>) A -&gt; HProp}
  : (<span class="kr">forall</span> <span class="nv">a</span> : A, B (tr a)) -&gt; (<span class="kr">forall</span> <span class="nv">x</span> : Trunc (-<span class="mi">1</span>) A, B x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A -&gt; HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, B (tr a)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : Trunc (-<span class="mi">1</span>) A, B x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1da"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A -&gt; HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, B (tr a)) -&gt;
<span class="kr">forall</span> <span class="nv">x</span> : Trunc (-<span class="mi">1</span>) A, B x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1db" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1db"><span class="nb">intros</span> f x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B (tr a)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1dc">napply (Trunc_rec _ x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B (tr a)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (B x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1dd" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B (tr a)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1dd"><hr></label><div class="goal-conclusion">A -&gt; B x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1de" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1de">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B (tr a)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (B x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1df" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1df">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B (tr a)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A -&gt; B x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e0"><span class="nb">intro</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>B</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, B (tr a)</span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) A</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">B x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (transport B (path_ishprop (tr a) x) (f a)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:lem-ldn *)</span>
<span class="sd">(** Exercise 3.18 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_18_i</span> := @HoTT.ExcludedMiddle.LEM_to_DNE.</span><span class="alectryon-wsp">  
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_18_ii</span> := @HoTT.ExcludedMiddle.DNE_to_LEM.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:decidable-choice *)</span>
<span class="sd">(** Exercise 3.19 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_19</span> := @HoTT.Misc.BoundedSearch.minimal_n.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:omit-contr2 *)</span>
<span class="sd">(** Exercise 3.20 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_20</span> := @HoTT.Types.Sigma.equiv_contr_sigma.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:isprop-equiv-equiv-bracket *)</span>
<span class="sd">(** Exercise 3.21 *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e1"><span class="kn">Definition</span> <span class="nf">Book_3_21</span> `{Funext} (P : <span class="kt">Type</span>) : IsHProp P &lt;~&gt; (P &lt;~&gt; Trunc (-<span class="mi">1</span>) P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp P &lt;~&gt; (P &lt;~&gt; Trunc (-<span class="mi">1</span>) P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp P &lt;~&gt; (P &lt;~&gt; Trunc (-<span class="mi">1</span>) P)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e3">rapply equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp P -&gt; P &lt;~&gt; Trunc (-<span class="mi">1</span>) P</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1e4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1e4"><hr></label><div class="goal-conclusion">P &lt;~&gt; Trunc (-<span class="mi">1</span>) P -&gt; IsHProp P</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e5">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp P -&gt; P &lt;~&gt; Trunc (-<span class="mi">1</span>) P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e6"><span class="nb">intro</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsHProp P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P &lt;~&gt; Trunc (-<span class="mi">1</span>) P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* See also [equiv_to_O]. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e7">rapply equiv_iff_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsHProp P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P -&gt; Trunc (-<span class="mi">1</span>) P</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1e8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsHProp P</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1e8"><hr></label><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) P -&gt; P</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1e9">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsHProp P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P -&gt; Trunc (-<span class="mi">1</span>) P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> tr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ea">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>IsHProp P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) P -&gt; P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (Trunc_rec idmap).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1eb">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P &lt;~&gt; Trunc (-<span class="mi">1</span>) P -&gt; IsHProp P</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ec"><span class="nb">intro</span> e.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>P &lt;~&gt; Trunc (-<span class="mi">1</span>) P</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp P</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (istrunc_equiv_istrunc _ e^-<span class="mi">1</span>%equiv).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:finite-choice *)</span>
<span class="sd">(** Exercise 3.22 *)</span>

<span class="sd">(** Another form of this statement is proven in the library as [finite_choice] *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ed" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ed"><span class="kn">Definition</span> <span class="nf">Book_3_22</span> {<span class="nv">n</span> : nat} {<span class="nv">A</span> : Fin n -&gt; HSet}
  (<span class="nv">P</span> : <span class="kr">forall</span> (<span class="nv">x</span> : Fin n) (<span class="nv">a</span> : A x), HProp)
  : (<span class="kr">forall</span> <span class="nv">x</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a})
    -&gt; Trunc (-<span class="mi">1</span>) {g : <span class="kr">forall</span> <span class="nv">x</span>, A x &amp; <span class="kr">forall</span> <span class="nv">x</span>, P x (g x)}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin n, A x -&gt; HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : Fin n, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin n, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin n, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ee"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin n, A x -&gt; HProp</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">x</span> : Fin n, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin n, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin n, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ef"><span class="nb">intro</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin n -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin n, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin n, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin n, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin n, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1f0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1f0"><span class="nb">induction</span> n <span class="kr">as</span> [| m IH].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, P x (g x)}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1f1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1f1"><hr></label><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, P x (g x)}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1f2">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1f3"><span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{g : <span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x &amp;
<span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1f4">snrefine (_ ; _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1f5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin <span class="mi">0</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1f5"><hr></label><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, A x =&gt;
 <span class="kr">forall</span> <span class="nv">x</span> : Fin <span class="mi">0</span>, P x (g x)) <span class="nl">?proj1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="mi">1</span>-<span class="mi">2</span>: <span class="nb">intro</span> bot; <span class="nb">elim</span> bot.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1f6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1f6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1f7"><span class="nb">assert</span> (cl : Trunc (-<span class="mi">1</span>) {g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl)
      &amp; <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
  <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk1f8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
  <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk1f8"><hr></label><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, P x (g x)}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1f9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1f9">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
  <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1fa"><span class="nb">apply</span> (IH (A o inl) (<span class="kr">fun</span> <span class="nv">xl</span> <span class="nv">a</span> =&gt; P (inl xl) a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : Fin m,
Trunc (-<span class="mi">1</span>) {a : A (inl x) &amp; P (inl x) a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1fb"><span class="nb">intro</span> xl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>xl</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>) {a : A (inl xl) &amp; P (inl xl) a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> f.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1fc">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
  <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1fd"><span class="nb">pose proof</span> (cr := f (inr tt)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
  <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>Trunc (-<span class="mi">1</span>) {a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1fe">strip_truncations.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk1ff" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk1ff"><span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x &amp;
<span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, P x (g x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk200">snrefine (_ ; _); <span class="nb">intros</span> [xl|[]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br><span><var>xl</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A (inl xl)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk201" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk201"><hr></label><div class="goal-conclusion">A (inr tt)</div></blockquote><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk202" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br><span><var>xl</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk202"><hr></label><div class="goal-conclusion">P (inl xl) <span class="nl">?Goal</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk203" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk203"><hr></label><div class="goal-conclusion">P (inr tt) <span class="nl">?Goal0</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk204">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br><span><var>xl</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A (inl xl)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> cl.<span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk205">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A (inr tt)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> cr.<span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk206">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br><span><var>xl</var><span class="hyp-type"><b>: </b><span>Fin m</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inl xl) (cl.<span class="mi">1</span> xl)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> cl.<span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk207">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>m</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span>Fin m.+<span class="mi">1</span> -&gt; HSet</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, A x -&gt; HProp</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">x</span> : Fin m.+<span class="mi">1</span>, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}</span></span></span><br><span><var>IH</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> : Fin m -&gt; HSet)
(<span class="nv">P</span> : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x -&gt; HProp),
(<span class="kr">forall</span> <span class="nv">x</span> : Fin m, Trunc (-<span class="mi">1</span>) {a : A x &amp; P x a}) -&gt;
Trunc (-<span class="mi">1</span>)
  {g : <span class="kr">forall</span> <span class="nv">x</span> : Fin m, A x &amp;
  <span class="kr">forall</span> <span class="nv">x</span> : Fin m, P x (g x)}</span></span></span><br><span><var>cr</var><span class="hyp-type"><b>: </b><span>{a : A (inr tt) &amp; P (inr tt) a}</span></span></span><br><span><var>cl</var><span class="hyp-type"><b>: </b><span>{g : <span class="kr">forall</span> <span class="nv">xl</span> : Fin m, A (inl xl) &amp;
<span class="kr">forall</span> <span class="nv">xl</span> : Fin m, P (inl xl) (g xl)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">P (inr tt) cr.<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> cr.<span class="mi">2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:decidable-choice-strong *)</span>
<span class="sd">(** Exercise 3.23 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_23</span> := @HoTT.Misc.BoundedSearch.minimal_n.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:n-set *)</span>
<span class="sd">(** Exercise 3.24 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_3_24</span> := @HoTT.Spaces.Nat.Paths.equiv_path_nat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:two-sided-adjoint-equivalences *)</span>
<span class="sd">(** Exercise 4.1 *)</span>



<span class="c">(* ================================================== ex:symmetric-equiv *)</span>
<span class="sd">(** Exercise 4.2 *)</span>



<span class="c">(* ================================================== ex:qinv-autohtpy-no-univalence *)</span>
<span class="sd">(** Exercise 4.3 *)</span>



<span class="c">(* ================================================== ex:unstable-octahedron *)</span>
<span class="sd">(** Exercise 4.4 *)</span>



<span class="c">(* ================================================== ex:2-out-of-6 *)</span>
<span class="sd">(** Exercise 4.5 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_4_5</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">parts</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variables</span> <span class="nv">A</span> <span class="nv">B</span> <span class="nv">C</span> <span class="nv">D</span> : <span class="kt">Type</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">f</span> : A -&gt; B.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">g</span> : B -&gt; C.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">h</span> : C -&gt; D.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> `{IsEquiv _ _ (g o f), IsEquiv _ _ (h o g)}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk208"><span class="kn">Local Instance</span> <span class="nf">Book_4_5_g</span> : IsEquiv g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk209"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk20a"><span class="nb">apply</span> isequiv_biinv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">BiInv g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk20b"><span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{g0 : C -&gt; B &amp; (<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; g0 (g x)) == idmap}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk20c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk20c"><hr></label><div class="goal-conclusion">{h : C -&gt; B &amp; (<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; g (h x)) == idmap}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk20d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk20d">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{g0 : C -&gt; B &amp; (<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; g0 (g x)) == idmap}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk20e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk20e"><span class="kr">exists</span> ((h o g)^-<span class="mi">1</span> o h).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; (h o g)^-<span class="mi">1</span> (h (g x))) == idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (eissect (h o g)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk20f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk20f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{h : C -&gt; B &amp; (<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; g (h x)) == idmap}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk210"><span class="kr">exists</span> (<span class="nv">f</span> <span class="nv">o</span> (g o f)^-<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; g (f ((g o f)^-<span class="mi">1</span> x))) == idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">        </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (eisretr (g o f)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk211" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk211"><span class="kn">Local Instance</span> <span class="nf">Book_4_5_f</span> : IsEquiv f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk212" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk212"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk213"><span class="nb">apply</span> (isequiv_homotopic (g^-<span class="mi">1</span> o (g o f))); <span class="kp">try</span> <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g^-<span class="mi">1</span> (g (f x))) == f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span>; <span class="nb">apply</span> (eissect g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk214" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk214"><span class="kn">Local Instance</span> <span class="nf">Book_4_5_h</span> : IsEquiv h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk215"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk216" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk216"><span class="nb">apply</span> (isequiv_homotopic ((h o g) o g^-<span class="mi">1</span>)); <span class="kp">try</span> <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; h (g (g^-<span class="mi">1</span> x))) == h</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intro</span>; <span class="nb">apply</span> (ap h); <span class="nb">apply</span> (eisretr g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk217" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk217"><span class="kn">Definition</span> <span class="nf">Book_4_5_hgf</span> : IsEquiv (h o g o f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (h o g o f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk218"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B, C, D</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; C</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>C -&gt; D</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (g o f)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv (h o g)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (h o g o f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">typeclasses eauto</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">parts</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="c">(*Lemma Book_4_5 A B f `{IsEquiv A B f} (a a&#39; : A) : IsEquiv (@ap _ _ f a a&#39;).</span>
<span class="c">  Proof.</span>
<span class="c">    pose (@ap _ _ (f^-1) (f a) (f a&#39;)) as f&#39;.</span>
<span class="c">    pose (fun p : f^-1 (f a) = _ =&gt; p @ (@eissect _ _ f _ a&#39;)) as g&#39;.</span>
<span class="c">    pose (fun p : _ = a&#39; =&gt; (@eissect _ _ f _ a)^ @ p) as h&#39;.</span>
<span class="c">    pose (g&#39; o f&#39;).</span>
<span class="c">    pose (h&#39; o g&#39;).</span>
<span class="c">    admit.</span>
<span class="c">  Qed.*)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_4_5</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:qinv-univalence *)</span>
<span class="sd">(** Exercise 4.6 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_4_6_i</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">is_qinv</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} (<span class="nv">f</span> : A -&gt; B)
    := { g : B -&gt; A &amp; (f o g == idmap) * (g o f == idmap) }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">qinv</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
    := { f : A -&gt; B &amp; is_qinv f }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">qinv_id</span> <span class="nv">A</span> : qinv A A
    := (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x; (<span class="kr">fun</span> <span class="nv">x</span> =&gt; x ; (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="mi">1</span>, <span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="mi">1</span>))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">qinv_path</span> <span class="nv">A</span> <span class="nv">B</span> : (A = B) -&gt; qinv A B
    := <span class="kr">fun</span> <span class="nv">p</span> =&gt; <span class="kr">match</span> p <span class="kr">with</span> <span class="mi">1</span> =&gt; qinv_id _ <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">QInv_Univalence_type</span> := <span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>@{i}),
      is_qinv (qinv_path A B).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk219" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk219"><span class="kn">Definition</span> <span class="nf">isequiv_qinv</span> {<span class="nv">A</span> <span class="nv">B</span>} {<span class="nv">f</span> : A -&gt; B}
    : is_qinv f -&gt; IsEquiv f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_qinv f -&gt; IsEquiv f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk21a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk21a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">is_qinv f -&gt; IsEquiv f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk21b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk21b"><span class="nb">intros</span> [g [s r]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>s</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; f (g x)) == idmap</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; g (f x)) == idmap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (isequiv_adjointify f g s r).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">equiv_qinv_path</span> (<span class="nv">qua</span>: QInv_Univalence_type) (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
    : (A = B) &lt;~&gt; qinv A B
    := Build_Equiv _ _ (qinv_path A B) (isequiv_qinv (qua A B)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">qinv_isequiv</span> {<span class="nv">A</span> <span class="nv">B</span>} (<span class="nv">f</span> : A -&gt; B) `{IsEquiv _ _ f}
    : qinv A B
    := (f ; (f^-<span class="mi">1</span> ; (eisretr f , eissect f))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> `{qua : QInv_Univalence_type}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk21c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk21c"><span class="kn">Theorem</span> <span class="nf">qinv_univalence_isequiv_postcompose</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>} {<span class="nv">w</span> : A -&gt; B}
          `{H0 : IsEquiv A B w} C : IsEquiv (<span class="kr">fun</span> (<span class="nv">g</span>:C-&gt;A) =&gt; w o g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv w</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (<span class="kr">fun</span> <span class="nv">g</span> : C -&gt; A =&gt; w o g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk21d"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv w</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (<span class="kr">fun</span> <span class="nv">g</span> : C -&gt; A =&gt; w o g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk21e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk21e"><span class="nb">unfold</span> QInv_Univalence_type <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, is_qinv (qinv_path A B)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv w</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (<span class="kr">fun</span> (<span class="nv">g</span> : C -&gt; A) (<span class="nv">x</span> : C) =&gt; w (g x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk21f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk21f"><span class="nb">pose</span> (w&#39; := qinv_isequiv w).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>, is_qinv (qinv_path A B)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span>IsEquiv w</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>w'</var><span><span class="hyp-body"><b>:= </b><span>qinv_isequiv w</span></span><span class="hyp-type"><b>: </b><span>qinv A B</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (<span class="kr">fun</span> (<span class="nv">g</span> : C -&gt; A) (<span class="nv">x</span> : C) =&gt; w (g x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">refine</span> (isequiv_adjointify
              (<span class="kr">fun</span> (<span class="nv">g</span>:C-&gt;A) =&gt; w o g)
              (<span class="kr">fun</span> (<span class="nv">g</span>:C-&gt;B) =&gt; w^-<span class="mi">1</span> o g)
              _
              _);
    <span class="nb">intros</span> g;
    <span class="kp">first</span> [ <span class="nb">change</span> ((<span class="kr">fun</span> <span class="nv">x</span> =&gt; w&#39;.<span class="mi">1</span> ( w&#39;.<span class="mi">2</span>.<span class="mi">1</span> (g x))) = g)
          | <span class="nb">change</span> ((<span class="kr">fun</span> <span class="nv">x</span> =&gt; w&#39;.<span class="mi">2</span>.<span class="mi">1</span> ( w&#39;.<span class="mi">1</span> (g x))) = g) ];
    <span class="nb">clearbody</span> w&#39;; <span class="nb">clear</span> H0 w;
    <span class="nb">rewrite</span> &lt;- (@eisretr _ _ (@qinv_path A B) (isequiv_qinv (qua A B)) w&#39;);
    <span class="nb">generalize</span> ((@equiv_inv _ _ (qinv_path A B) (isequiv_qinv (qua A B))) w&#39;);
    <span class="nb">intro</span> p; <span class="nb">clear</span> w&#39;; <span class="nb">destruct</span> p; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Now the rest is basically copied from UnivalenceImpliesFunext, with name changes so as to use the current assumption of qinv-univalence rather than a global assumption of ordinary univalence. *)</span>

</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk220"><span class="kn">Local Instance</span> <span class="nf">isequiv_src_compose</span> <span class="nv">A</span> <span class="nv">B</span>
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (<span class="kr">fun</span> <span class="nv">g</span> =&gt; (fst o pr1) o g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
   fst o pr1 o g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk221" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk221"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
   fst o pr1 o g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk222" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk222">rapply @qinv_univalence_isequiv_postcompose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  (<span class="kr">fun</span> <span class="nv">x</span> : {xy : B * B &amp; fst xy = snd xy} =&gt; fst x.<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">refine</span> (isequiv_adjointify
              (fst o pr1) (<span class="kr">fun</span> <span class="nv">x</span> =&gt; ((x, x); idpath))
              (<span class="kr">fun</span> <span class="nv">_</span> =&gt; idpath)
              _);
      <span class="kr">let</span> <span class="nv">p</span> := <span class="kp">fresh</span> <span class="kr">in</span>
      <span class="nb">intros</span> [[? ?] p];
        <span class="nb">simpl</span> <span class="kr">in</span> p; <span class="nb">destruct</span> p;
        <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk223" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk223"><span class="kn">Local Instance</span> <span class="nf">isequiv_tgt_compose</span> <span class="nv">A</span> <span class="nv">B</span>
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (<span class="kr">fun</span> <span class="nv">g</span> =&gt; (snd o pr1) o g).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
   snd o pr1 o g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk224" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk224"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
   snd o pr1 o g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk225" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk225">rapply @qinv_univalence_isequiv_postcompose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv
  (<span class="kr">fun</span> <span class="nv">x</span> : {xy : B * B &amp; fst xy = snd xy} =&gt; snd x.<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">refine</span> (isequiv_adjointify
              (snd o pr1) (<span class="kr">fun</span> <span class="nv">x</span> =&gt; ((x, x); idpath))
              (<span class="kr">fun</span> <span class="nv">_</span> =&gt; idpath)
              _);
      <span class="kr">let</span> <span class="nv">p</span> := <span class="kp">fresh</span> <span class="kr">in</span>
      <span class="nb">intros</span> [[? ?] p];
        <span class="nb">simpl</span> <span class="kr">in</span> p; <span class="nb">destruct</span> p;
        <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk226" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk226"><span class="kn">Theorem</span> <span class="nf">QInv_Univalence_implies_FunextNondep</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
  : <span class="kr">forall</span> <span class="nv">f</span> <span class="nv">g</span> : A -&gt; B, f == g -&gt; f = g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">f</span> <span class="nv">g</span> : A -&gt; B, f == g -&gt; f = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk227" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk227"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">f</span> <span class="nv">g</span> : A -&gt; B, f == g -&gt; f = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk228" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk228"><span class="nb">intros</span> f g p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f == g</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk229" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk229"><span class="nb">pose</span> (d := <span class="kr">fun</span> <span class="nv">x</span> : A =&gt; exist (<span class="kr">fun</span> <span class="nv">xy</span> =&gt; fst xy = snd xy) (f x, f x) (idpath (f x))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f == g</span></span></span><br><span><var>d</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk22a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk22a"><span class="nb">pose</span> (e := <span class="kr">fun</span> <span class="nv">x</span> : A =&gt; exist (<span class="kr">fun</span> <span class="nv">xy</span> =&gt; fst xy = snd xy) (f x, g x) (p x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f == g</span></span></span><br><span><var>d</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk22b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk22b"><span class="nb">change</span> f <span class="kr">with</span> ((snd o pr1) o d).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f == g</span></span></span><br><span><var>d</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd o pr1 o d = g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk22c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk22c"><span class="nb">change</span> g <span class="kr">with</span> ((snd o pr1) o e).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f == g</span></span></span><br><span><var>d</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">snd o pr1 o d = snd o pr1 o e</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk22d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk22d">rapply (ap (<span class="kr">fun</span> <span class="nv">g</span> =&gt; snd o pr1 o g)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f == g</span></span></span><br><span><var>d</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">d = e</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk22e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk22e"><span class="nb">pose</span> (<span class="kr">fun</span> <span class="nv">A</span> <span class="nv">B</span> <span class="nv">x</span> <span class="nv">y</span>=&gt; @equiv_inv _ _ _ (@isequiv_ap _ _ _ (@isequiv_src_compose A B) x y)) <span class="kr">as</span> H&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f == g</span></span></span><br><span><var>d</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br><span><var>H'</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
  (<span class="nv">x</span> <span class="nv">y</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy}) =&gt;
(ap
   (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
    fst o pr1 o g))^-<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
(<span class="nv">x</span> <span class="nv">y</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy}),
(<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
 fst o pr1 o g) x =
(<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
 fst o pr1 o g) y -&gt; x = y</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">d = e</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk22f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk22f"><span class="nb">apply</span> H&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f, g</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>f == g</span></span></span><br><span><var>d</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, f x); <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">x</span> : A =&gt; ((f x, g x); p x)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; {xy : B * B &amp; fst xy = snd xy}</span></span></span></span><br><span><var>H'</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
  (<span class="nv">x</span> <span class="nv">y</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy}) =&gt;
(ap
   (<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
    fst o pr1 o g))^-<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>)
(<span class="nv">x</span> <span class="nv">y</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy}),
(<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
 fst o pr1 o g) x =
(<span class="kr">fun</span> <span class="nv">g</span> : A -&gt; {xy : B * B &amp; fst xy = snd xy} =&gt;
 fst o pr1 o g) y -&gt; x = y</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; fst (d x).<span class="mi">1</span>) =
(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; fst (e x).<span class="mi">1</span>)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">QInv_Univalence_implies_Funext_type</span> : Funext_type
    := NaiveNondepFunext_implies_Funext QInv_Univalence_implies_FunextNondep.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_4_6_i</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">EquivFunctorFunextType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* We need a version of [equiv_functor_forall_id] that takes a [Funext_type] rather than a global axiom [Funext].  *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> (<span class="nv">fa</span> : Funext_type).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ft_path_forall</span> {<span class="nv">A</span> : <span class="kt">Type</span>} {<span class="nv">P</span> : A -&gt; <span class="kt">Type</span>} (<span class="nv">f</span> <span class="nv">g</span> : <span class="kr">forall</span> <span class="nv">x</span> : A, P x) :
  f == g -&gt; f = g
  :=
  @equiv_inv _ _ (@apD10 A P f g) (fa _ _ _ _).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk230" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk230"><span class="kn">Local Instance</span> <span class="nf">ft_isequiv_functor_forall</span>
        {<span class="nv">A</span> <span class="nv">B</span>:<span class="kt">Type</span>} `{P : A -&gt; <span class="kt">Type</span>} `{Q : B -&gt; <span class="kt">Type</span>}
          {f : B -&gt; A} {g : <span class="kr">forall</span> <span class="nv">b</span>:B, P (f b) -&gt; Q b}
        `{IsEquiv B A f} `{<span class="kr">forall</span> <span class="nv">b</span>, @IsEquiv (P (f b)) (Q b) (g b)}
    : IsEquiv (functor_forall f g) | <span class="mi">1000</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fa</var><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (functor_forall f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk231" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk231"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fa</var><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv (functor_forall f g)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk232" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk232"><span class="nb">simple refine</span> (isequiv_adjointify
                     (functor_forall f g)
                     (functor_forall
                        (f^-<span class="mi">1</span>)
                        (<span class="kr">fun</span> (<span class="nv">x</span>:A) (<span class="nv">y</span>:Q (f^-<span class="mi">1</span> x)) =&gt; eisretr f x # (g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y
                     )) _ _);
      <span class="nb">intros</span> h.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fa</var><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, Q b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_forall f g
  (functor_forall f^-<span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : Q (f^-<span class="mi">1</span> x)) =&gt;
      transport P (eisretr f x) ((g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y)) h) =
h</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk233" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fa</var><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P a</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk233"><hr></label><div class="goal-conclusion">functor_forall f^-<span class="mi">1</span>
  (<span class="kr">fun</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : Q (f^-<span class="mi">1</span> x)) =&gt;
   transport P (eisretr f x) ((g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y))
  (functor_forall f g h) = h</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk234" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk234">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fa</var><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, Q b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_forall f g
  (functor_forall f^-<span class="mi">1</span>
     (<span class="kr">fun</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : Q (f^-<span class="mi">1</span> x)) =&gt;
      transport P (eisretr f x) ((g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y)) h) =
h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">abstract</span> (
          <span class="nb">apply</span> ft_path_forall; <span class="nb">intros</span> b; <span class="nb">unfold</span> functor_forall;
          <span class="nb">rewrite</span> eisadj;
          <span class="nb">rewrite</span> &lt;- transport_compose;
          <span class="nb">rewrite</span> ap_transport;
          <span class="nb">rewrite</span> eisretr;
          <span class="nb">apply</span> apD
        ).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk235" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk235">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>fa</var><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>A -&gt; <span class="kt">Type</span></span></span></span><br><span><var>Q</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>B -&gt; A</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, P (f b) -&gt; Q b</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv f</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">b</span> : B, IsEquiv (g b)</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P a</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">functor_forall f^-<span class="mi">1</span>
  (<span class="kr">fun</span> (<span class="nv">x</span> : A) (<span class="nv">y</span> : Q (f^-<span class="mi">1</span> x)) =&gt;
   transport P (eisretr f x) ((g (f^-<span class="mi">1</span> x))^-<span class="mi">1</span> y))
  (functor_forall f g h) = h</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kp">abstract</span> (
          <span class="nb">apply</span> ft_path_forall; <span class="nb">intros</span> a; <span class="nb">unfold</span> functor_forall;
          <span class="nb">rewrite</span> eissect;
          <span class="nb">apply</span> apD
        ).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ft_equiv_functor_forall</span>
        {<span class="nv">A</span> <span class="nv">B</span>:<span class="kt">Type</span>} `{P : A -&gt; <span class="kt">Type</span>} `{Q : B -&gt; <span class="kt">Type</span>}
        (f : B -&gt; A) `{IsEquiv B A f}
        (g : <span class="kr">forall</span> <span class="nv">b</span>:B, P (f b) -&gt; Q b)
        `{<span class="kr">forall</span> <span class="nv">b</span>, @IsEquiv (P (f b)) (Q b) (g b)}
  : (<span class="kr">forall</span> <span class="nv">a</span>, P a) &lt;~&gt; (<span class="kr">forall</span> <span class="nv">b</span>, Q b)
    := Build_Equiv _ _ (functor_forall f g) _.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">ft_equiv_functor_forall_id</span>
        {<span class="nv">A</span>:<span class="kt">Type</span>} `{P : A -&gt; <span class="kt">Type</span>} `{Q : A -&gt; <span class="kt">Type</span>}
        (g : <span class="kr">forall</span> <span class="nv">a</span>, P a &lt;~&gt; Q a)
  : (<span class="kr">forall</span> <span class="nv">a</span>, P a) &lt;~&gt; (<span class="kr">forall</span> <span class="nv">a</span>, Q a)
    := ft_equiv_functor_forall (equiv_idmap A) g.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">EquivFunctorFunextType</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Using the Kraus-Sattler space of loops rather than the version in the book, since it is simpler and avoids use of propositional truncation. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk236" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk236"><span class="kn">Definition</span> <span class="nf">Book_4_6_ii</span>
  (<span class="nv">qua1</span> <span class="nv">qua2</span> : QInv_Univalence_type) (* Two, since we need them <span class="nb">at</span> different universe levels. *)
  : ~ IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : { X : <span class="kt">Type</span> &amp; X = X }, A = A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk237" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk237"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk238" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk238"><span class="nb">pose</span> (fa := @QInv_Univalence_implies_Funext_type qua2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk239" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk239"><span class="nb">intros</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk23a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk23a"><span class="nb">pose</span> (K := <span class="kr">forall</span> (<span class="nv">X</span>:<span class="kt">Type</span>) (<span class="nv">p</span>:X=X), { q : X=X &amp; p @ q = q @ p }).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk23b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk23b"><span class="nb">assert</span> (e : K &lt;~&gt; <span class="kr">forall</span> <span class="nv">A</span> : { X : <span class="kt">Type</span> &amp; X = X }, A = A).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk23c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk23c"><hr></label><div class="goal-conclusion">Empty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk23d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk23d">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk23e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk23e"><span class="nb">unfold</span> K.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
 {q : X = X &amp; p @ q = q @ p}) &lt;~&gt;
(<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk23f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk23f"><span class="nb">refine</span> (equiv_sig_ind _ oE _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
 {q : X = X &amp; p @ q = q @ p}) &lt;~&gt;
(<span class="kr">forall</span> (<span class="nv">x</span> : <span class="kt">Type</span>) (<span class="nv">y</span> : x = x), (x; y) = (x; y))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk240" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk240"><span class="nb">refine</span> (ft_equiv_functor_forall_id fa _); <span class="nb">intros</span> X.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">p</span> : X = X, {q : X = X &amp; p @ q = q @ p}) &lt;~&gt;
(<span class="kr">forall</span> <span class="nv">y</span> : X = X, (X; y) = (X; y))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk241" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk241"><span class="nb">refine</span> (ft_equiv_functor_forall_id fa _); <span class="nb">intros</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X = X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{q : X = X &amp; p @ q = q @ p} &lt;~&gt; (X; p) = (X; p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk242" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk242"><span class="nb">refine</span> (equiv_path_sigma _ _ _ oE _); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X = X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{q : X = X &amp; p @ q = q @ p} &lt;~&gt;
{p0 : X = X &amp;
transport (<span class="kr">fun</span> <span class="nv">X</span> : <span class="kt">Type</span> =&gt; X = X) p0 p = p}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk243" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk243"><span class="nb">refine</span> (equiv_functor_sigma_id _); <span class="nb">intros</span> q.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>X = X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p @ q = q @ p &lt;~&gt;
transport (<span class="kr">fun</span> <span class="nv">X</span> : <span class="kt">Type</span> =&gt; X = X) q p = p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk244" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk244"><span class="nb">refine</span> ((equiv_concat_l (transport_paths_lr q p)^ p)^-<span class="mi">1</span> oE _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>X = X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p @ q = q @ p &lt;~&gt; (q^ @ p) @ q = p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk245" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk245"><span class="nb">refine</span> ((equiv_concat_l (concat_p_pp _ _ _) _)^-<span class="mi">1</span> oE _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>p, q</var><span class="hyp-type"><b>: </b><span>X = X</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p @ q = q @ p &lt;~&gt; q^ @ (p @ q) = p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> equiv_moveR_Vp.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk246" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk246">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk247" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk247"><span class="nb">assert</span> (HK := @istrunc_equiv_istrunc _ _ e^-<span class="mi">1</span> (-<span class="mi">1</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk248" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk248"><span class="nb">assert</span> (u : <span class="kr">forall</span> (<span class="nv">X</span>:<span class="kt">Type</span>) (<span class="nv">p</span>:X=X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk249" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk249"><hr></label><div class="goal-conclusion">Empty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk24a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk24a">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span> X p; <span class="nb">rewrite</span> concat_p1, concat_1p; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk24b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk24b">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk24c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk24c"><span class="nb">pose</span> (alpha := (<span class="kr">fun</span> <span class="nv">X</span> <span class="nv">p</span> =&gt; (idpath X ; u X p)) : K).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br><span><var>alpha</var><span><span class="hyp-body"><b>:= </b><span>(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (<span class="mi">1</span>; u X p)) : K</span></span><span class="hyp-type"><b>: </b><span>K</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk24d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk24d"><span class="nb">pose</span> (beta := (<span class="kr">fun</span> <span class="nv">X</span> <span class="nv">p</span> =&gt; (p ; <span class="mi">1</span>)) : K).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br><span><var>alpha</var><span><span class="hyp-body"><b>:= </b><span>(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (<span class="mi">1</span>; u X p)) : K</span></span><span class="hyp-type"><b>: </b><span>K</span></span></span></span><br><span><var>beta</var><span><span class="hyp-body"><b>:= </b><span>(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (p; <span class="mi">1</span>)) : K</span></span><span class="hyp-type"><b>: </b><span>K</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk24e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk24e"><span class="nb">pose</span> (isequiv_qinv (qua1 Bool Bool)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br><span><var>alpha</var><span><span class="hyp-body"><b>:= </b><span>(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (<span class="mi">1</span>; u X p)) : K</span></span><span class="hyp-type"><b>: </b><span>K</span></span></span></span><br><span><var>beta</var><span><span class="hyp-body"><b>:= </b><span>(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (p; <span class="mi">1</span>)) : K</span></span><span class="hyp-type"><b>: </b><span>K</span></span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>isequiv_qinv (qua1 Bool Bool)</span></span><span class="hyp-type"><b>: </b><span>IsEquiv (qinv_path Bool Bool)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk24f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk24f"><span class="nb">assert</span> (r := pr1_path (apD10 (apD10 (path_ishprop alpha beta) Bool)
                     ((qinv_path Bool Bool)^-<span class="mi">1</span> (qinv_isequiv equiv_negb)))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br><span><var>alpha</var><span><span class="hyp-body"><b>:= </b><span>(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (<span class="mi">1</span>; u X p)) : K</span></span><span class="hyp-type"><b>: </b><span>K</span></span></span></span><br><span><var>beta</var><span><span class="hyp-body"><b>:= </b><span>(<span class="kr">fun</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X) =&gt; (p; <span class="mi">1</span>)) : K</span></span><span class="hyp-type"><b>: </b><span>K</span></span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>isequiv_qinv (qua1 Bool Bool)</span></span><span class="hyp-type"><b>: </b><span>IsEquiv (qinv_path Bool Bool)</span></span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>(alpha Bool
   ((qinv_path Bool Bool)^-<span class="mi">1</span>
      (qinv_isequiv equiv_negb))).<span class="mi">1</span> =
(beta Bool
   ((qinv_path Bool Bool)^-<span class="mi">1</span>
      (qinv_isequiv equiv_negb))).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk250" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk250"><span class="nb">unfold</span> alpha, beta <span class="kr">in</span> r; <span class="nb">clear</span> alpha beta.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>isequiv_qinv (qua1 Bool Bool)</span></span><span class="hyp-type"><b>: </b><span>IsEquiv (qinv_path Bool Bool)</span></span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>(<span class="mi">1</span>;
u Bool
  ((qinv_path Bool Bool)^-<span class="mi">1</span>
     (qinv_isequiv equiv_negb))).<span class="mi">1</span> =
((qinv_path Bool Bool)^-<span class="mi">1</span>
   (qinv_isequiv equiv_negb); <span class="mi">1</span>).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk251" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk251"><span class="nb">apply</span> (ap (qinv_path Bool Bool)) <span class="kr">in</span> r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>isequiv_qinv (qua1 Bool Bool)</span></span><span class="hyp-type"><b>: </b><span>IsEquiv (qinv_path Bool Bool)</span></span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>qinv_path Bool Bool
  (<span class="mi">1</span>;
  u Bool
    ((qinv_path Bool Bool)^-<span class="mi">1</span>
       (qinv_isequiv equiv_negb))).<span class="mi">1</span> =
qinv_path Bool Bool
  ((qinv_path Bool Bool)^-<span class="mi">1</span>
     (qinv_isequiv equiv_negb); <span class="mi">1</span>).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk252" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk252"><span class="nb">rewrite</span> eisretr <span class="kr">in</span> r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>isequiv_qinv (qua1 Bool Bool)</span></span><span class="hyp-type"><b>: </b><span>IsEquiv (qinv_path Bool Bool)</span></span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>qinv_path Bool Bool
  (<span class="mi">1</span>;
  u Bool
    ((qinv_path Bool Bool)^-<span class="mi">1</span>
       (qinv_isequiv equiv_negb))).<span class="mi">1</span> =
qinv_isequiv equiv_negb</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk253" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk253"><span class="nb">apply</span> pr1_path <span class="kr">in</span> r; <span class="nb">cbn</span> <span class="kr">in</span> r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>fa</var><span><span class="hyp-body"><b>:= </b><span>QInv_Univalence_implies_Funext_type</span></span><span class="hyp-type"><b>: </b><span>Funext_type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>K</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X),
{q : X = X &amp; p @ q = q @ p}</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>e</var><span class="hyp-type"><b>: </b><span>K &lt;~&gt; (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</span></span></span><br><span><var>HK</var><span class="hyp-type"><b>: </b><span>IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A) -&gt;
IsHProp K</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : X = X), p @ <span class="mi">1</span> = <span class="mi">1</span> @ p</span></span></span><br><span><var>i</var><span><span class="hyp-body"><b>:= </b><span>isequiv_qinv (qua1 Bool Bool)</span></span><span class="hyp-type"><b>: </b><span>IsEquiv (qinv_path Bool Bool)</span></span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>idmap = negb</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (true_ne_false (ap10 r true)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Assuming qinv-univalence, every quasi-equivalence automatically satisfies one of the adjoint laws. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk254" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk254"><span class="kn">Definition</span> <span class="nf">allqinv_coherent</span> (<span class="nv">qua</span> : QInv_Univalence_type)
           (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : qinv A B)
  : (<span class="kr">fun</span> <span class="nv">x</span> =&gt; ap f.<span class="mi">2</span>.<span class="mi">1</span> (fst f.<span class="mi">2</span>.<span class="mi">2</span> x)) = (<span class="kr">fun</span> <span class="nv">x</span> =&gt; snd f.<span class="mi">2</span>.<span class="mi">2</span> (f.<span class="mi">2</span>.<span class="mi">1</span> x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>qinv A B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; ap (f.<span class="mi">2</span>).<span class="mi">1</span> (fst (f.<span class="mi">2</span>).<span class="mi">2</span> x)) =
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; snd (f.<span class="mi">2</span>).<span class="mi">2</span> ((f.<span class="mi">2</span>).<span class="mi">1</span> x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk255" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk255"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>qinv A B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; ap (f.<span class="mi">2</span>).<span class="mi">1</span> (fst (f.<span class="mi">2</span>).<span class="mi">2</span> x)) =
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; snd (f.<span class="mi">2</span>).<span class="mi">2</span> ((f.<span class="mi">2</span>).<span class="mi">1</span> x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="c">(* Every quasi-equivalence is the image of a path, and can therefore be assumed to be the identity equivalence, for which the claim holds immediately. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk256" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk256"><span class="nb">revert</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">f</span> : qinv A B,
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; ap (f.<span class="mi">2</span>).<span class="mi">1</span> (fst (f.<span class="mi">2</span>).<span class="mi">2</span> x)) =
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt; snd (f.<span class="mi">2</span>).<span class="mi">2</span> ((f.<span class="mi">2</span>).<span class="mi">1</span> x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk257" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk257">equiv_intro (equiv_qinv_path qua A B) p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>A = B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt;
 ap ((equiv_qinv_path qua A B p).<span class="mi">2</span>).<span class="mi">1</span>
   (fst ((equiv_qinv_path qua A B p).<span class="mi">2</span>).<span class="mi">2</span> x)) =
(<span class="kr">fun</span> <span class="nv">x</span> : B =&gt;
 snd ((equiv_qinv_path qua A B p).<span class="mi">2</span>).<span class="mi">2</span>
   (((equiv_qinv_path qua A B p).<span class="mi">2</span>).<span class="mi">1</span> x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> p; <span class="nb">cbn</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Qinv-univalence is inconsistent. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk258" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk258"><span class="kn">Definition</span> <span class="nf">Book_4_6_iii</span> (<span class="nv">qua1</span> <span class="nv">qua2</span> : QInv_Univalence_type) : Empty.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk259" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk259"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk25a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk25a"><span class="nb">apply</span> (Book_4_6_ii qua1 qua2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk25b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk25b">napply istrunc_succ.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr (<span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk25c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk25c"><span class="nb">apply</span> (Build_Contr _ (<span class="kr">fun</span> <span class="nv">A</span> =&gt; <span class="mi">1</span>)); <span class="nb">intros</span> u.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>qua1, qua2</var><span class="hyp-type"><b>: </b><span>QInv_Univalence_type</span></span></span><br><span><var>u</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X}, A = A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">fun</span> <span class="nv">A</span> : {X : <span class="kt">Type</span> &amp; X = X} =&gt; <span class="mi">1</span>) = u</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (allqinv_coherent qua2 _ _ (idmap; (idmap; (<span class="kr">fun</span> <span class="nv">A</span> =&gt; <span class="mi">1</span>, u)))).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:embedding-cancellable *)</span>
<span class="sd">(** Exercise 4.7 *)</span>



<span class="c">(* ================================================== ex:cancellable-from-bool *)</span>
<span class="sd">(** Exercise 4.8 *)</span>



<span class="c">(* ================================================== ex:funext-from-nondep *)</span>
<span class="sd">(** Exercise 4.9 *)</span>



<span class="c">(* ================================================== ex:ind-lst *)</span>
<span class="sd">(** Exercise 5.1 *)</span>



<span class="c">(* ================================================== ex:same-recurrence-not-defeq *)</span>
<span class="sd">(** Exercise 5.2 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_5_2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="sd">(** Here is one example of functions which are propositionally equal but not judgmentally equal.  They satisfy the same recurrence propositionally. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">ez</span> : Bool := true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">es</span> : nat -&gt; Bool -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> =&gt; idmap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_2_i</span> : nat -&gt; Bool := nat_ind (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Bool) ez es.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_2_ii</span> : nat -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> =&gt; true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk25d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk25d"><span class="kn">Fail</span> <span class="kn">Definition</span> <span class="nf">Book_5_2_not_defn_eq</span> : Book_5_2_i = Book_5_2_ii := idpath.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">The command has indeed failed <span class="kr">with</span> message:
In environment
ez := true : Bool
es := <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap : nat -&gt; Bool -&gt; Bool
The term <span class="s2">&quot;1&quot;</span> has type <span class="s2">&quot;Book_5_2_i = Book_5_2_i&quot;</span>
while it <span class="kr">is</span> expected to <span class="nb">have</span> type
 <span class="s2">&quot;Book_5_2_i = Book_5_2_ii&quot;</span> (cannot <span class="nb">unify</span> <span class="s2">&quot;Book_5_2_i&quot;</span>
<span class="kn">and</span> <span class="s2">&quot;Book_5_2_ii&quot;</span>).</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk25e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk25e"><span class="kn">Lemma</span> <span class="nf">Book_5_2_i_prop_eq</span> : <span class="kr">forall</span> <span class="nv">n</span>, Book_5_2_i n = Book_5_2_ii n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ez</var><span><span class="hyp-body"><b>:= </b><span>true</span></span><span class="hyp-type"><b>: </b><span>Bool</span></span></span></span><br><span><var>es</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap</span></span><span class="hyp-type"><b>: </b><span>nat -&gt; Bool -&gt; Bool</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : nat, Book_5_2_i n = Book_5_2_ii n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk25f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk25f"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ez</var><span><span class="hyp-body"><b>:= </b><span>true</span></span><span class="hyp-type"><b>: </b><span>Bool</span></span></span></span><br><span><var>es</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap</span></span><span class="hyp-type"><b>: </b><span>nat -&gt; Bool -&gt; Bool</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : nat, Book_5_2_i n = Book_5_2_ii n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">induction</span> n; <span class="nb">simpl</span>; <span class="nb">trivial</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_5_2</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_5_2&#39;</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> nat_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  <span class="sd">(** Here&#39;s another example where two functions are not (currently) definitionally equal, but satisfy the same recurrence judgmentally.  This example is a bit less robust; it fails in CoqMT. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">ez</span> : nat := <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">es</span> : nat -&gt; nat -&gt; nat := <span class="kr">fun</span> <span class="nv">_</span> =&gt; S.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_i</span> : nat -&gt; nat := <span class="kr">fun</span> <span class="nv">n</span> =&gt; n + <span class="mi">1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_ii</span> : nat -&gt; nat := <span class="kr">fun</span> <span class="nv">n</span> =&gt; <span class="mi">1</span> + n.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk260" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk260"><span class="kn">Fail</span> <span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_not_defn_eq</span> : Book_5_2&#39;_i = Book_5_2&#39;_ii := idpath.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">The command has indeed failed <span class="kr">with</span> message:
In environment
ez := <span class="mi">1</span> : nat
es := <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; S : nat -&gt; nat -&gt; nat
The term <span class="s2">&quot;1&quot;</span> has type <span class="s2">&quot;Book_5_2&#39;_i = Book_5_2&#39;_i&quot;</span>
while it <span class="kr">is</span> expected to <span class="nb">have</span> type
 <span class="s2">&quot;Book_5_2&#39;_i = Book_5_2&#39;_ii&quot;</span>
(cannot <span class="nb">unify</span> <span class="s2">&quot;Book_5_2&#39;_i&quot;</span> <span class="kn">and</span> <span class="s2">&quot;Book_5_2&#39;_ii&quot;</span>).</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_i_eq_ez</span> : Book_5_2&#39;_i <span class="mi">0</span> = ez := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_ii_eq_ez</span> : Book_5_2&#39;_ii <span class="mi">0</span> = ez := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_i_eq_es</span> <span class="nv">n</span> : Book_5_2&#39;_i (S n) = es n (Book_5_2&#39;_i n) := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_2&#39;_ii_eq_es</span> <span class="nv">n</span> : Book_5_2&#39;_ii (S n) = es n (Book_5_2&#39;_ii n) := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_5_2&#39;</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:one-function-two-recurrences *)</span>
<span class="sd">(** Exercise 5.3 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_5_3</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">ez</span> : Bool := true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">es</span> : nat -&gt; Bool -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> =&gt; idmap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">ez&#39;</span> : Bool := true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">es&#39;</span> : nat -&gt; Bool -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_3</span> : nat -&gt; Bool := <span class="kr">fun</span> <span class="nv">_</span> =&gt; true.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_3_satisfies_ez</span> : Book_5_3 <span class="mi">0</span> = ez := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_3_satisfies_ez&#39;</span> : Book_5_3 <span class="mi">0</span> = ez&#39; := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_3_satisfies_es</span> <span class="nv">n</span> : Book_5_3 (S n) = es n (Book_5_3 n) := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_3_satisfies_es&#39;</span> <span class="nv">n</span> : Book_5_3 (S n) = es&#39; n (Book_5_3 n) := idpath.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_3_es_ne_es&#39;</span> : ~(es = es&#39;)
    := <span class="kr">fun</span> <span class="nv">H</span> =&gt; false_ne_true (ap10 (ap10 H <span class="mi">0</span>) false).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_5_3</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:bool *)</span>
<span class="sd">(** Exercise 5.4 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_5_4</span> := @HoTT.Types.Bool.equiv_bool_forall_prod.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:ind-nat-not-equiv *)</span>
<span class="sd">(** Exercise 5.5 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_5_5</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">ind_nat</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>) := <span class="kr">fun</span> <span class="nv">x</span> =&gt; @nat_ind P (fst x) (snd x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk261" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk261"><span class="kn">Lemma</span> <span class="nf">Book_5_5</span> `{fs : Funext} : ~<span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
                                     IsEquiv (@ind_nat P).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (<span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>, IsEquiv (ind_nat P))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk262" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk262"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">~ (<span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>, IsEquiv (ind_nat P))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk263" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk263"><span class="nb">intro</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>, IsEquiv (ind_nat P)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk264" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk264"><span class="nb">specialize</span> (H (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Bool)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk265" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk265"><span class="nb">pose proof</span> (eissect (@ind_nat (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Bool)) (true, (<span class="kr">fun</span> <span class="nv">_</span> <span class="nv">_</span> =&gt; true))) <span class="kr">as</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk266" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk266"><span class="nb">pose proof</span> (eissect (@ind_nat (<span class="kr">fun</span> <span class="nv">_</span> =&gt; Bool)) (true, (<span class="kr">fun</span> <span class="nv">_</span> =&gt; idmap))) <span class="kr">as</span> H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk267" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk267"><span class="nb">cut</span> (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)
         = (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap))).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) -&gt; Empty</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk268" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk268"><hr></label><div class="goal-conclusion">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk269" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk269">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) -&gt; Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk26a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk26a"><span class="nb">intro</span> H&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk26b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk26b"><span class="nb">apply</span> true_ne_false.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">true = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (ap10 (apD10 (ap snd (H1^ @ ap _ H&#39; @ H2)) <span class="mi">0</span>) false).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk26c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk26c">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk26d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk26d"><span class="nb">apply</span> path_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) ==
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk26e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk26e"><span class="nb">intro</span> n; <span class="nb">induction</span> n; <span class="nb">trivial</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv (ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) =
idmap (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>((ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))^-<span class="mi">1</span>
 o ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool))
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) =
idmap (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n.+<span class="mi">1</span> =
ind_nat (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool)
  (true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk26f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk26f"><span class="nb">unfold</span> ind_nat <span class="kr">in</span> *; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv
  (<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
   nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
 nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))^-<span class="mi">1</span>
  (nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
     (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)) =
(true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
 nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))^-<span class="mi">1</span>
  (nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
     (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)) =
(true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n =
nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">true =
nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk270" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk270"><span class="nb">rewrite</span> &lt;- IHn.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>ind_nat</var><span><span class="hyp-body"><b>:= </b><span><span class="kr">fun</span> (<span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>)
  (<span class="nv">x</span> : P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>))
=&gt; nat_ind P (fst x) (snd x)</span></span><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">P</span> : nat -&gt; <span class="kt">Type</span>,
P <span class="mi">0</span> * (<span class="kr">forall</span> <span class="nv">n</span> : nat, P n -&gt; P n.+<span class="mi">1</span>) -&gt;
<span class="kr">forall</span> <span class="nv">n</span> : nat, P n</span></span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>IsEquiv
  (<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
   nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
 nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))^-<span class="mi">1</span>
  (nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
     (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)) =
(true, <span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true)</span></span></span><br><span><var>H2</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Bool * (nat -&gt; Bool -&gt; Bool) =&gt;
 nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) (fst x) (snd x))^-<span class="mi">1</span>
  (nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
     (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)) =
(true, <span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap)</span></span></span><br><span><var>n</var><span class="hyp-type"><b>: </b><span>nat</span></span></span><br><span><var>IHn</var><span class="hyp-type"><b>: </b><span>nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n =
nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; idmap) n</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">true =
nat_ind (<span class="kr">fun</span> <span class="nv">_</span> : nat =&gt; Bool) true
  (<span class="kr">fun</span> (<span class="nv">_</span> : nat) (<span class="nv">_</span> : Bool) =&gt; true) n</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> n; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_5_5</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:no-dep-uniqueness-failure *)</span>
<span class="sd">(** Exercise 5.6 *)</span>



<span class="c">(* ================================================== ex:loop *)</span>
<span class="sd">(** Exercise 5.7 *)</span>



<span class="c">(* ================================================== ex:loop2 *)</span>
<span class="sd">(** Exercise 5.8 *)</span>



<span class="c">(* ================================================== ex:inductive-lawvere *)</span>
<span class="sd">(** Exercise 5.9 *)</span>



<span class="c">(* ================================================== ex:ilunit *)</span>
<span class="sd">(** Exercise 5.10 *)</span>



<span class="c">(* ================================================== ex:empty-inductive-type *)</span>
<span class="sd">(** Exercise 5.11 *)</span>



<span class="c">(* ================================================== ex:Wprop *)</span>
<span class="sd">(** Exercise 5.12 *)</span>



<span class="c">(* ================================================== ex:Wbounds *)</span>
<span class="sd">(** Exercise 5.13 *)</span>



<span class="c">(* ================================================== ex:Wdec *)</span>
<span class="sd">(** Exercise 5.14 *)</span>



<span class="c">(* ================================================== ex:Wbounds-loose *)</span>
<span class="sd">(** Exercise 5.15 *)</span>



<span class="c">(* ================================================== ex:Wimpred *)</span>
<span class="sd">(** Exercise 5.16 *)</span>



<span class="c">(* ================================================== ex:no-nullary-constructor *)</span>
<span class="sd">(** Exercise 5.17 *)</span>



<span class="c">(* ================================================== ex:torus *)</span>
<span class="sd">(** Exercise 6.1 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_6_1_i</span> := @HoTT.Cubical.DPath.dp_concat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_6_1_ii</span> := @HoTT.Cubical.DPath.dp_apD_pp.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="sd">(** We don&#39;t have the full induction principle for the torus *)</span>
<span class="c">(* Definition Book_6_1_iii := ? *)</span>

<span class="c">(* ================================================== ex:suspS1 *)</span>
<span class="sd">(** Exercise 6.2 *)</span>



<span class="c">(* ================================================== ex:torus-s1-times-s1 *)</span>
<span class="sd">(** Exercise 6.3 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_6_3</span> := @HoTT.Spaces.Torus.TorusEquivCircles.equiv_torus_prod_Circle.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:nspheres *)</span>
<span class="sd">(** Exercise 6.4 *)</span>



<span class="c">(* ================================================== ex:susp-spheres-equiv *)</span>
<span class="sd">(** Exercise 6.5 *)</span>



<span class="c">(* ================================================== ex:spheres-make-U-not-2-type *)</span>
<span class="sd">(** Exercise 6.6 *)</span>



<span class="c">(* ================================================== ex:monoid-eq-prop *)</span>
<span class="sd">(** Exercise 6.7 *)</span>



<span class="c">(* ================================================== ex:free-monoid *)</span>
<span class="sd">(** Exercise 6.8 *)</span>



<span class="c">(* ================================================== ex:unnatural-endomorphisms *)</span>
<span class="sd">(** Exercise 6.9 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_6_9</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Hypothesis</span> <span class="nv">LEM</span> : <span class="kr">forall</span> <span class="nv">A</span>, IsHProp A -&gt; A + ~A.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk271" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk271"><span class="kn">Definition</span> <span class="nf">Book_6_9</span> {<span class="nv">ua</span> : Univalence} : <span class="kr">forall</span> <span class="nv">X</span>, X -&gt; X.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">X</span> : <span class="kt">Type</span>, X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk272" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk272"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">X</span> : <span class="kt">Type</span>, X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk273" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk273"><span class="nb">intro</span> X.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk274" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk274"><span class="nb">pose proof</span> (@LEM (Contr { f : X &lt;~&gt; X &amp; ~(<span class="kr">forall</span> <span class="nv">x</span>, f x = x) }) _) <span class="kr">as</span> contrXEquiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>contrXEquiv</var><span class="hyp-type"><b>: </b><span>Contr
  {f : X &lt;~&gt; X &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)} +
~
Contr
  {f : X &lt;~&gt; X &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk275" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk275"><span class="nb">destruct</span> contrXEquiv <span class="kr">as</span> [C|notC].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Contr {f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; X</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk276" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>notC</var><span class="hyp-type"><b>: </b><span>~
Contr {f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk276"><hr></label><div class="goal-conclusion">X -&gt; X</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk277" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk277">- <span class="sd">(** In the case where we have exactly one autoequivalence which is not the identity, use it. *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Contr {f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> ((@center _ C).<span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk278" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk278">- <span class="sd">(** In the other case, just use the identity. *)</span></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>notC</var><span class="hyp-type"><b>: </b><span>~
Contr {f : X &lt;~&gt; X &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : X, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> idmap.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk279" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk279"><span class="kn">Lemma</span> <span class="nf">bool_map_equiv_not_idmap</span> (<span class="nv">f</span> : { f : Bool &lt;~&gt; Bool &amp; ~(<span class="kr">forall</span> <span class="nv">x</span>, f x = x) })
  : <span class="kr">forall</span> <span class="nv">b</span>, ~(f.<span class="mi">1</span> b = b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Bool, f.<span class="mi">1</span> b &lt;&gt; b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk27a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk27a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : Bool, f.<span class="mi">1</span> b &lt;&gt; b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk27b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk27b"><span class="nb">intro</span> b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f.<span class="mi">1</span> b &lt;&gt; b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk27c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk27c"><span class="nb">intro</span> H&#39;&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H''</var><span class="hyp-type"><b>: </b><span>f.<span class="mi">1</span> b = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk27d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk27d"><span class="nb">apply</span> f.<span class="mi">2</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H''</var><span class="hyp-type"><b>: </b><span>f.<span class="mi">1</span> b = b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : Bool, f.<span class="mi">1</span> x = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk27e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk27e"><span class="nb">intro</span> b&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H''</var><span class="hyp-type"><b>: </b><span>f.<span class="mi">1</span> b = b</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f.<span class="mi">1</span> b&#39; = b&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk27f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk27f"><span class="nb">pose proof</span> (eval_bool_isequiv f.<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H''</var><span class="hyp-type"><b>: </b><span>f.<span class="mi">1</span> b = b</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>f.<span class="mi">1</span> false = negb (f.<span class="mi">1</span> true)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f.<span class="mi">1</span> b&#39; = b&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> b&#39;, b, (f.<span class="mi">1</span> true), (f.<span class="mi">1</span> false);
      <span class="nb">simpl</span> <span class="kr">in</span> *;
      <span class="kr">match goal with</span>
        | _ =&gt; <span class="bp">assumption</span>
        | _ =&gt; <span class="bp">reflexivity</span>
        | [ H : true = false |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> true_ne_false H <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : false = true |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> false_ne_true H <span class="kr">with</span> <span class="kr">end</span>)
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk280" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk280"><span class="kn">Lemma</span> <span class="nf">Book_6_9_not_id</span> {<span class="nv">ua</span> : Univalence} `{fs : Funext} : Book_6_9 Bool = negb.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_6_9 Bool = negb</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk281" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk281"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_6_9 Bool = negb</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk282" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk282"><span class="nb">apply</span> path_forall; <span class="nb">intro</span> b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Book_6_9 Bool b = negb b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk283" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk283"><span class="nb">unfold</span> Book_6_9.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">match</span>
  LEM
    (Contr
       {f : Bool &lt;~&gt; Bool &amp;
       ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)})
    (ishprop_istrunc (-<span class="mi">2</span>)
       {f : Bool &lt;~&gt; Bool &amp;
       ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)})
<span class="kr">with</span>
| inl i =&gt;
    equiv_fun
      (center
         {f : Bool &lt;~&gt; Bool &amp;
         ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}).<span class="mi">1</span>
| inr _ =&gt; idmap
<span class="kr">end</span> b = negb b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk284" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk284"><span class="nb">destruct</span> (@LEM (Contr { f : Bool &lt;~&gt; Bool &amp; ~(<span class="kr">forall</span> <span class="nv">x</span>, f x = x) }) _) <span class="kr">as</span> [C|H&#39;].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(center
   {f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}).<span class="mi">1</span>
  b = negb b</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk285" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk285"><hr></label><div class="goal-conclusion">b = negb b</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk286" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk286">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(center
   {f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}).<span class="mi">1</span>
  b = negb b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk287" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk287"><span class="nb">set</span> (f := @center _ C).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>f</var><span><span class="hyp-body"><b>:= </b><span>center
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f.<span class="mi">1</span> b = negb b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk288" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk288"><span class="nb">pose proof</span> (bool_map_equiv_not_idmap f b).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>f</var><span><span class="hyp-body"><b>:= </b><span>center
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>f.<span class="mi">1</span> b &lt;&gt; b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f.<span class="mi">1</span> b = negb b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (f.<span class="mi">1</span> b), b;
      <span class="kr">match goal with</span>
        | _ =&gt; <span class="bp">assumption</span>
        | _ =&gt; <span class="bp">reflexivity</span>
        | [ H : ~(_ = _) |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> H idpath <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : true = false |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> true_ne_false H <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : false = true |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> false_ne_true H <span class="kr">with</span> <span class="kr">end</span>)
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk289" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk289">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">b = negb b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk28a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk28a"><span class="nb">refine</span> (<span class="kr">match</span> H&#39; _ <span class="kr">with</span> <span class="kr">end</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr
  {f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk28b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk28b"><span class="nb">apply</span> (Build_Contr _ (exist (<span class="kr">fun</span> <span class="nv">f</span> : Bool &lt;~&gt; Bool =&gt;
                         ~(<span class="kr">forall</span> <span class="nv">x</span>, f x = x))
                      (Build_Equiv _ _ negb _)
                      (<span class="kr">fun</span> <span class="nv">H</span> =&gt; false_ne_true (H true))));
        <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">y</span> : {f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)},
({|
   equiv_fun := negb; equiv_isequiv := isequiv_negb
 |};
<span class="kr">fun</span> <span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">x</span> : Bool, negb x = x =&gt;
false_ne_true (H true)) = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk28c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk28c"><span class="nb">intro</span> f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">({|
   equiv_fun := negb; equiv_isequiv := isequiv_negb
 |};
<span class="kr">fun</span> <span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">x</span> : Bool, negb x = x =&gt;
false_ne_true (H true)) = f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk28d" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk28d"><span class="nb">apply</span> path_sigma_uncurried; <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{p
: {|
    equiv_fun := negb; equiv_isequiv := isequiv_negb
  |} = f.<span class="mi">1</span> &amp;
transport
  (<span class="kr">fun</span> <span class="nv">f</span> : Bool &lt;~&gt; Bool =&gt;
   ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)) p
  (<span class="kr">fun</span> <span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">x</span> : Bool, negb x = x =&gt;
   false_ne_true (H true)) = f.<span class="mi">2</span>}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk28e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk28e"><span class="nb">refine</span> ((<span class="kr">fun</span> <span class="nv">H&#39;&#39;</span> =&gt;
                 (equiv_path_equiv _ _ H&#39;&#39;;
                  path_ishprop _ _))
                _);
        <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">negb = f.<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk28f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk28f"><span class="nb">apply</span> path_forall; <span class="nb">intro</span> b&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">negb b&#39; = f.<span class="mi">1</span> b&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk290" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk290"><span class="nb">pose proof</span> (bool_map_equiv_not_idmap f b&#39;).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>ua</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fs</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>H'</var><span class="hyp-type"><b>: </b><span>~
Contr
  {f : Bool &lt;~&gt; Bool &amp;
  ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>{f : Bool &lt;~&gt; Bool &amp; ~ (<span class="kr">forall</span> <span class="nv">x</span> : Bool, f x = x)}</span></span></span><br><span><var>b'</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>f.<span class="mi">1</span> b&#39; &lt;&gt; b&#39;</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">negb b&#39; = f.<span class="mi">1</span> b&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">destruct</span> (f.<span class="mi">1</span> b&#39;), b&#39;;
      <span class="kr">match goal with</span>
        | _ =&gt; <span class="bp">assumption</span>
        | _ =&gt; <span class="bp">reflexivity</span>
        | [ H : ~(_ = _) |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> H idpath <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : true = false |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> true_ne_false H <span class="kr">with</span> <span class="kr">end</span>)
        | [ H : false = true |- _ ] =&gt; <span class="bp">exact</span> (<span class="kr">match</span> false_ne_true H <span class="kr">with</span> <span class="kr">end</span>)
      <span class="kr">end</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** Simpler solution not using univalence **)</span>

</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">AllExistsOther</span>(<span class="nv">X</span> : <span class="kt">Type</span>) := <span class="kr">forall</span> <span class="nv">x</span>:X, { y:X | y &lt;&gt; x }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">centerAllExOthBool</span> : AllExistsOther Bool :=
    <span class="kr">fun</span> (<span class="nv">b</span>:Bool) =&gt; (negb b ; not_fixed_negb b).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk291" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk291"><span class="kn">Lemma</span> <span class="nf">centralAllExOthBool</span> `{Funext} (f: AllExistsOther Bool) : centerAllExOthBool = f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>AllExistsOther Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">centerAllExOthBool = f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk292" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk292"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>AllExistsOther Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">centerAllExOthBool = f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk293" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk293"><span class="nb">apply</span> path_forall.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>AllExistsOther Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">centerAllExOthBool == f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk294" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk294"><span class="nb">intro</span> b.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>AllExistsOther Bool</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">centerAllExOthBool b = f b</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk295" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk295"><span class="nb">pose proof</span> (inverse (negb_ne (f b).<span class="mi">2</span>)) <span class="kr">as</span> fst.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>AllExistsOther Bool</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>fst</var><span class="hyp-type"><b>: </b><span>negb b = (f b).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">centerAllExOthBool b = f b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk296" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk296"><span class="nb">unfold</span> centerAllExOthBool.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>AllExistsOther Bool</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>fst</var><span class="hyp-type"><b>: </b><span>negb b = (f b).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(negb b; not_fixed_negb b) = f b</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk297" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk297"><span class="nb">apply</span> (@path_sigma _ _ (negb b; not_fixed_negb b) (f b) fst); <span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>AllExistsOther Bool</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>fst</var><span class="hyp-type"><b>: </b><span>negb b = (f b).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport (<span class="kr">fun</span> <span class="nv">y</span> : Bool =&gt; y &lt;&gt; b) fst
  (not_fixed_negb b) = (f b).<span class="mi">2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk298" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk298"><span class="nb">apply</span> equiv_hprop_allpath.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>AllExistsOther Bool</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>Bool</span></span></span><br><span><var>fst</var><span class="hyp-type"><b>: </b><span>negb b = (f b).<span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp ((f b).<span class="mi">1</span> &lt;&gt; b)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> istrunc_forall.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">contrAllExOthBool</span> `{Funext} : Contr (AllExistsOther Bool) :=
  (Build_Contr _ centerAllExOthBool centralAllExOthBool).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk299" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk299"><span class="kn">Definition</span> <span class="nf">solution_6_9</span> `{Funext} : <span class="kr">forall</span> <span class="nv">X</span>, X -&gt; X.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">X</span> : <span class="kt">Type</span>, X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk29a" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk29a"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">X</span> : <span class="kt">Type</span>, X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk29b" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk29b"><span class="nb">intro</span> X.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk29c" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk29c"><span class="nb">elim</span> (@LEM (Contr (AllExistsOther X)) _); <span class="nb">intro</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Contr (AllExistsOther X)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; X</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk29d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>~ Contr (AllExistsOther X)</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk29d"><hr></label><div class="goal-conclusion">X -&gt; X</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk29e" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk29e">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>Contr (AllExistsOther X)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span>:X =&gt; (center (AllExistsOther X) x).<span class="mi">1</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk29f" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk29f">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>~ Contr (AllExistsOther X)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">X -&gt; X</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (<span class="kr">fun</span> <span class="nv">x</span>:X =&gt; x).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a0"><span class="kn">Lemma</span> <span class="nf">not_id_on_Bool</span> `{Funext} : solution_6_9 Bool &lt;&gt; idmap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">solution_6_9 Bool &lt;&gt; idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">solution_6_9 Bool &lt;&gt; idmap</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a2"><span class="nb">intro</span> Bad.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a3" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a3"><span class="nb">pose proof</span> ((happly Bad) true) <span class="kr">as</span> Ugly.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a4"><span class="nb">assert</span> ((solution_6_9 Bool true) = false) <span class="kr">as</span> Good.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">solution_6_9 Bool true = false</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk2a5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br><span><var>Good</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = false</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk2a5"><hr></label><div class="goal-conclusion">Empty</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a6">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">solution_6_9 Bool true = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a7"><span class="nb">unfold</span> solution_6_9.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">sum_rect (Contr (AllExistsOther Bool))
  (~ Contr (AllExistsOther Bool))
  (<span class="kr">fun</span>
     <span class="nv">_</span> : Contr (AllExistsOther Bool) +
         ~ Contr (AllExistsOther Bool) =&gt; Bool -&gt; Bool)
  (<span class="kr">fun</span> (<span class="nv">a</span> : Contr (AllExistsOther Bool)) (<span class="nv">x</span> : Bool) =&gt;
   (center (AllExistsOther Bool) x).<span class="mi">1</span>)
  (<span class="kr">fun</span> <span class="nv">_</span> : ~ Contr (AllExistsOther Bool) =&gt; idmap)
  (LEM (Contr (AllExistsOther Bool))
     (ishprop_istrunc (-<span class="mi">2</span>) (AllExistsOther Bool)))
  true = false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2a8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2a8"><span class="nb">destruct</span> (LEM (Contr (AllExistsOther Bool)) _) <span class="kr">as</span> [C|C];<span class="nb">simpl</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Contr (AllExistsOther Bool)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(center (AllExistsOther Bool) true).<span class="mi">1</span> = false</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk2a9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>~ Contr (AllExistsOther Bool)</span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk2a9"><hr></label><div class="goal-conclusion">true = false</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2aa" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2aa">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Contr (AllExistsOther Bool)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(center (AllExistsOther Bool) true).<span class="mi">1</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2ab" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2ab"><span class="nb">elim</span> (centralAllExOthBool (@center _ C)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>Contr (AllExistsOther Bool)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(centerAllExOthBool true).<span class="mi">1</span> = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2ac" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2ac">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br><span><var>C</var><span class="hyp-type"><b>: </b><span>~ Contr (AllExistsOther Bool)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">true = false</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">elim</span> (C contrAllExOthBool).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2ad" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2ad">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br><span><var>Good</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Empty</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2ae" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2ae"><span class="nb">apply</span> false_ne_true.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br><span><var>Good</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">false = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2af" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2af"><span class="nb">rewrite</span> (inverse Good).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>LEM</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHProp A -&gt; A + ~ A</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>Bad</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool = idmap</span></span></span><br><span><var>Ugly</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = idmap true</span></span></span><br><span><var>Good</var><span class="hyp-type"><b>: </b><span>solution_6_9 Bool true = false</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">solution_6_9 Bool true = true</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_6_9</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:funext-from-interval *)</span>
<span class="sd">(** Exercise 6.10 *)</span>



<span class="c">(* ================================================== ex:susp-lump *)</span>
<span class="sd">(** Exercise 6.11 *)</span>



<span class="c">(* ================================================== ex:alt-integers *)</span>
<span class="sd">(** Exercise 6.12 *)</span>



<span class="c">(* ================================================== ex:trunc-bool-interval *)</span>
<span class="sd">(** Exercise 6.13 *)</span>



<span class="c">(* ================================================== ex:all-types-sets *)</span>
<span class="sd">(** Exercise 7.1 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Book_7_1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b0"><span class="kn">Lemma</span> <span class="nf">Book_7_1_part_i</span> (<span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">A</span>, merely A -&gt; A) <span class="nv">A</span> : IsHSet A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b1"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHSet A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b2" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b2"><span class="nb">apply</span> (@HoTT.Universes.HSet.ishset_hrel_subpaths
             A (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> =&gt; merely (x = y)));
    <span class="kp">try</span> <span class="nb">typeclasses eauto</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Reflexive (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : A =&gt; merely (x = y))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="hottbookexercises-v-chk2b3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><label class="goal-separator" for="hottbookexercises-v-chk2b3"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : A, merely (x = y) -&gt; x = y</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b4" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b4">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Reflexive (<span class="kr">fun</span> <span class="nv">x</span> <span class="nv">y</span> : A =&gt; merely (x = y))</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b5" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b5"><span class="nb">intros</span> ?.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely (x = x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b6" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b6"><span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b7" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b7">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : A, merely (x = y) -&gt; x = y</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b8" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b8"><span class="nb">intros</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>merely (x = y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2b9" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2b9"><span class="nb">apply</span> H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x, y</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>X</var><span class="hyp-type"><b>: </b><span>merely (x = y)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">merely (x = y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">assumption</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2ba" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2ba"><span class="kn">Lemma</span> <span class="nf">Book_7_1_part_ii</span> (<span class="nv">H</span> : <span class="kr">forall</span> <span class="nv">A</span> <span class="nv">B</span> (<span class="nv">f</span> : A -&gt; B),
                                (<span class="kr">forall</span> <span class="nv">b</span>, merely (hfiber f b))
                                -&gt; <span class="kr">forall</span> <span class="nv">b</span>, hfiber f b)
  : <span class="kr">forall</span> <span class="nv">A</span>, IsHSet A.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHSet A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2bb" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2bb"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, IsHSet A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2bc" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2bc"><span class="nb">apply</span> Book_7_1_part_i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">A</span> : <span class="kt">Type</span>, merely A -&gt; A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2bd" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2bd"><span class="nb">intros</span> A a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>merely A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">A</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2be" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2be"><span class="nb">apply</span> (<span class="kr">fun</span> <span class="nv">H&#39;</span> =&gt; (@H A (merely A) tr H&#39; a).<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>merely A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : merely A, merely (hfiber tr b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2bf" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2bf"><span class="nb">clear</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">b</span> : merely A, merely (hfiber tr b)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2c0" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2c0"><span class="nb">apply</span> Trunc_ind; <span class="kp">try</span> <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A, merely (hfiber tr (tr a))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="hottbookexercises-v-chk2c1" style="display: none" type="checkbox"><label class="alectryon-input" for="hottbookexercises-v-chk2c1"><span class="nb">intro</span> x; <span class="nb">compute</span>; <span class="nb">apply</span> tr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>) (<span class="nv">f</span> : A -&gt; B),
(<span class="kr">forall</span> <span class="nv">b</span> : B, merely (hfiber f b)) -&gt;
<span class="kr">forall</span> <span class="nv">b</span> : B, hfiber f b</span></span></span><br><span><var>A</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{x0 : A &amp; tr x0 = tr x}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kr">exists</span> <span class="nv">x</span>; <span class="bp">reflexivity</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Book_7_1</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:s2-colim-unit *)</span>
<span class="sd">(** Exercise 7.2 *)</span>



<span class="c">(* ================================================== ex:ntypes-closed-under-wtypes *)</span>
<span class="sd">(** Exercise 7.3 *)</span>



<span class="c">(* ================================================== ex:connected-pointed-all-section-retraction *)</span>
<span class="sd">(** Exercise 7.4 *)</span>



<span class="c">(* ================================================== ex:ntype-from-nconn-const *)</span>
<span class="sd">(** Exercise 7.5 *)</span>



<span class="c">(* ================================================== ex:connectivity-inductively *)</span>
<span class="sd">(** Exercise 7.6 *)</span>



<span class="c">(* ================================================== ex:lemnm *)</span>
<span class="sd">(** Exercise 7.7 *)</span>



<span class="c">(* ================================================== ex:acnm *)</span>
<span class="sd">(** Exercise 7.8 *)</span>



<span class="c">(* ================================================== ex:acnm-surjset *)</span>
<span class="sd">(** Exercise 7.9 *)</span>

<span class="sd">(** Solution for the case (oo,-1). *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_7_9_oo_neg1</span> `{Univalence} (AC_oo_neg1 : <span class="kr">forall</span> <span class="nv">X</span> : HSet, HasChoice X) (A : <span class="kt">Type</span>)
  : merely (<span class="kr">exists</span> <span class="nv">X</span> : HSet, <span class="kr">exists</span> <span class="nv">p</span> : X -&gt; A, IsSurjection p)
  := @HoTT.Projective.projective_cover_AC AC_oo_neg1 _ A.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:acconn *)</span>
<span class="sd">(** Exercise 7.10 *)</span>



<span class="c">(* ================================================== ex:n-truncation-not-left-exact *)</span>
<span class="sd">(** Exercise 7.11 *)</span>



<span class="c">(* ================================================== ex:double-negation-modality *)</span>
<span class="sd">(** Exercise 7.12 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_7_12</span> := @HoTT.Modalities.Notnot.NotNot.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:prop-modalities *)</span>
<span class="sd">(** Exercise 7.13 *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_7_13_part_i</span> := @HoTT.Modalities.Open.Op.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Book_7_13_part_ii</span> := @HoTT.Modalities.Closed.Cl.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ================================================== ex:f-local-type *)</span>
<span class="sd">(** Exercise 7.14 *)</span>



<span class="c">(* ================================================== ex:trunc-spokes-no-hub *)</span>
<span class="sd">(** Exercise 7.15 *)</span>



<span class="c">(* ================================================== ex:s2-colim-unit-2 *)</span>
<span class="sd">(** Exercise 7.16 *)</span>



<span class="c">(* ================================================== ex:fiber-map-not-conn *)</span>
<span class="sd">(** Exercise 7.17 *)</span>



<span class="c">(* ================================================== ex:is-conn-trunc-functor *)</span>
<span class="sd">(** Exercise 7.18 *)</span>



<span class="c">(* ================================================== ex:categorical-connectedness *)</span>
<span class="sd">(** Exercise 7.19 *)</span>



<span class="c">(* ================================================== ex:homotopy-groups-resp-prod *)</span>
<span class="sd">(** Exercise 8.1 *)</span>



<span class="c">(* ================================================== ex:decidable-equality-susp *)</span>
<span class="sd">(** Exercise 8.2 *)</span>



<span class="c">(* ================================================== ex:contr-infinity-sphere-colim *)</span>
<span class="sd">(** Exercise 8.3 *)</span>



<span class="c">(* ================================================== ex:contr-infinity-sphere-susp *)</span>
<span class="sd">(** Exercise 8.4 *)</span>



<span class="c">(* ================================================== ex:unique-fiber *)</span>
<span class="sd">(** Exercise 8.5 *)</span>



<span class="c">(* ================================================== ex:ap-path-inversion *)</span>
<span class="sd">(** Exercise 8.6 *)</span>



<span class="c">(* ================================================== ex:pointed-equivalences *)</span>
<span class="sd">(** Exercise 8.7 *)</span>



<span class="c">(* ================================================== ex:HopfJr *)</span>
<span class="sd">(** Exercise 8.8 *)</span>



<span class="c">(* ================================================== ex:SuperHopf *)</span>
<span class="sd">(** Exercise 8.9 *)</span>



<span class="c">(* ================================================== ex:vksusppt *)</span>
<span class="sd">(** Exercise 8.10 *)</span>



<span class="c">(* ================================================== ex:vksuspnopt *)</span>
<span class="sd">(** Exercise 8.11 *)</span>



<span class="c">(* ================================================== ex:slice-precategory *)</span>
<span class="sd">(** Exercise 9.1 *)</span>



<span class="c">(* ================================================== ex:set-slice-over-equiv-functor-category *)</span>
<span class="sd">(** Exercise 9.2 *)</span>



<span class="c">(* ================================================== ex:functor-equiv-right-adjoint *)</span>
<span class="sd">(** Exercise 9.3 *)</span>



<span class="c">(* ================================================== ct:pre2cat *)</span>
<span class="sd">(** Exercise 9.4 *)</span>



<span class="c">(* ================================================== ct:2cat *)</span>
<span class="sd">(** Exercise 9.5 *)</span>



<span class="c">(* ================================================== ct:groupoids *)</span>
<span class="sd">(** Exercise 9.6 *)</span>



<span class="c">(* ================================================== ex:2strict-cat *)</span>
<span class="sd">(** Exercise 9.7 *)</span>



<span class="c">(* ================================================== ex:pre2dagger-cat *)</span>
<span class="sd">(** Exercise 9.8 *)</span>



<span class="c">(* ================================================== ct:ex:hocat *)</span>
<span class="sd">(** Exercise 9.9 *)</span>



<span class="c">(* ================================================== ex:dagger-rezk *)</span>
<span class="sd">(** Exercise 9.10 *)</span>



<span class="c">(* ================================================== ex:rezk-vankampen *)</span>
<span class="sd">(** Exercise 9.11 *)</span>



<span class="c">(* ================================================== ex:stack *)</span>
<span class="sd">(** Exercise 9.12 *)</span>



<span class="c">(* ================================================== ex:utype-ct *)</span>
<span class="sd">(** Exercise 10.1 *)</span>



<span class="c">(* ================================================== ex:surjections-have-sections-impl-ac *)</span>
<span class="sd">(** Exercise 10.2 *)</span>



<span class="c">(* ================================================== ex:well-pointed *)</span>
<span class="sd">(** Exercise 10.3 *)</span>



<span class="c">(* ================================================== ex:add-ordinals *)</span>
<span class="sd">(** Exercise 10.4 *)</span>



<span class="c">(* ================================================== ex:multiply-ordinals *)</span>
<span class="sd">(** Exercise 10.5 *)</span>



<span class="c">(* ================================================== ex:algebraic-ordinals *)</span>
<span class="sd">(** Exercise 10.6 *)</span>



<span class="c">(* ================================================== ex:prop-ord *)</span>
<span class="sd">(** Exercise 10.7 *)</span>



<span class="c">(* ================================================== ex:ninf-ord *)</span>
<span class="sd">(** Exercise 10.8 *)</span>



<span class="c">(* ================================================== ex:well-founded-extensional-simulation *)</span>
<span class="sd">(** Exercise 10.9 *)</span>



<span class="c">(* ================================================== ex:choice-function *)</span>
<span class="sd">(** Exercise 10.10 *)</span>



<span class="c">(* ================================================== ex:cumhierhit *)</span>
<span class="sd">(** Exercise 10.11 *)</span>



<span class="c">(* ================================================== ex:strong-collection *)</span>
<span class="sd">(** Exercise 10.12 *)</span>



<span class="c">(* ================================================== ex:choice-cumulative-hierarchy-choice *)</span>
<span class="sd">(** Exercise 10.13 *)</span>



<span class="c">(* ================================================== ex:plump-ordinals *)</span>
<span class="sd">(** Exercise 10.14 *)</span>



<span class="c">(* ================================================== ex:not-plump *)</span>
<span class="sd">(** Exercise 10.15 *)</span>



<span class="c">(* ================================================== ex:plump-successor *)</span>
<span class="sd">(** Exercise 10.16 *)</span>



<span class="c">(* ================================================== ex:ZF-algebras *)</span>
<span class="sd">(** Exercise 10.17 *)</span>



<span class="c">(* ================================================== ex:monos-are-split-monos-iff-LEM-holds *)</span>
<span class="sd">(** Exercise 10.18 *)</span>



<span class="c">(* ================================================== ex:alt-dedekind-reals *)</span>
<span class="sd">(** Exercise 11.1 *)</span>



<span class="c">(* ================================================== ex:RD-extended-reals *)</span>
<span class="sd">(** Exercise 11.2 *)</span>



<span class="c">(* ================================================== ex:RD-lower-cuts *)</span>
<span class="sd">(** Exercise 11.3 *)</span>



<span class="c">(* ================================================== ex:RD-interval-arithmetic *)</span>
<span class="sd">(** Exercise 11.4 *)</span>



<span class="c">(* ================================================== ex:RD-lt-vs-le *)</span>
<span class="sd">(** Exercise 11.5 *)</span>



<span class="c">(* ================================================== ex:reals-non-constant-into-Z *)</span>
<span class="sd">(** Exercise 11.6 *)</span>



<span class="c">(* ================================================== ex:traditional-archimedean *)</span>
<span class="sd">(** Exercise 11.7 *)</span>



<span class="c">(* ================================================== RC-Lipschitz-on-interval *)</span>
<span class="sd">(** Exercise 11.8 *)</span>



<span class="c">(* ================================================== ex:metric-completion *)</span>
<span class="sd">(** Exercise 11.9 *)</span>



<span class="c">(* ================================================== ex:reals-apart-neq-MP *)</span>
<span class="sd">(** Exercise 11.10 *)</span>



<span class="c">(* ================================================== ex:reals-apart-zero-divisors *)</span>
<span class="sd">(** Exercise 11.11 *)</span>



<span class="c">(* ================================================== ex:finite-cover-lebesgue-number *)</span>
<span class="sd">(** Exercise 11.12 *)</span>



<span class="c">(* ================================================== ex:mean-value-theorem *)</span>
<span class="sd">(** Exercise 11.13 *)</span>



<span class="c">(* ================================================== ex:knuth-surreal-check *)</span>
<span class="sd">(** Exercise 11.14 *)</span>



<span class="c">(* ================================================== ex:reals-into-surreals *)</span>
<span class="sd">(** Exercise 11.15 *)</span>



<span class="c">(* ================================================== ex:ord-into-surreals *)</span>
<span class="sd">(** Exercise 11.16 *)</span>



<span class="c">(* ================================================== ex:hiit-plump *)</span>
<span class="sd">(** Exercise 11.17 *)</span>



<span class="c">(* ================================================== ex:pseudo-ordinals *)</span>
<span class="sd">(** Exercise 11.18 *)</span>



<span class="c">(* ================================================== ex:double-No-recursion *)</span>
<span class="sd">(** Exercise 11.19 *)</span></span></pre>
</div>
</div></body>
</html>
