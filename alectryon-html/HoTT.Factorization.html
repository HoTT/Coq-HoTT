<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Factorization.v</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.19.0+0.19.3. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><div class="document">


<pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><span class="sd">(** * Factorizations and factorization systems. *)</span>

</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk0"><span class="kn">Require Import</span> HoTT.Basics HoTT.Types.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[Loading ML file number_string_notation_plugin.cmxs (<span class="nb">using</span> legacy method) ... <span class="bp">done</span>]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Require Import</span> Extensions Homotopy.IdentitySystems.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local</span> <span class="kn">Open Scope</span> path_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

<span class="sd">(** ** Factorizations *)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">Factorization</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input">Universes ctxi.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">class1</span> <span class="nv">class2</span> : <span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{ctxi}), (X -&gt; Y) -&gt; <span class="kt">Type</span>@{ctxi}}
          `{<span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{ctxi}) (<span class="nv">g</span>:X-&gt;Y), IsHProp (class1 _ _ g)}
          `{<span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{ctxi}) (<span class="nv">g</span>:X-&gt;Y), IsHProp (class2 _ _ g)}
          {A B : <span class="kt">Type</span>@{ctxi}} {f : A -&gt; B}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** A factorization of [f] into a first factor lying in [class1] and a second factor lying in [class2]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">Factorization</span> :=
    { intermediate : <span class="kt">Type</span>@{ctxi} ;
      factor1 : A -&gt; intermediate ;
      factor2 : intermediate -&gt; B ;
      fact_factors : factor2 o factor1 == f ;
      inclass1 : class1 _ _ factor1 ;
      inclass2 : class2 _ _ factor2
    }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk1"><span class="kn">Lemma</span> <span class="nf">issig_Factorization</span> :
    { I : <span class="kt">Type</span> &amp; { g : A -&gt; I &amp; { h : I -&gt; B &amp; { p : h o g == f &amp;
      { gin1 : class1 _ _ g &amp; class2 _ _ h }}}}}
      &lt;~&gt; Factorization.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{I : <span class="kt">Type</span> &amp;
{g : A -&gt; I &amp;
{h : I -&gt; B &amp;
{_ : h o g == f &amp; {_ : class1 A I g &amp; class2 I B h}}}}} &lt;~&gt;
Factorization</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk2"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{I : <span class="kt">Type</span> &amp;
{g : A -&gt; I &amp;
{h : I -&gt; B &amp;
{_ : h o g == f &amp; {_ : class1 A I g &amp; class2 I B h}}}}} &lt;~&gt;
Factorization</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">issig.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** A path between factorizations is equivalent to a structure of the following sort. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">PathFactorization</span> {<span class="nv">fact</span> <span class="nv">fact&#39;</span> : Factorization} :=
    { path_intermediate : intermediate fact &lt;~&gt; intermediate fact&#39; ;
      path_factor1 : path_intermediate o factor1 fact == factor1 fact&#39; ;
      path_factor2 : factor2 fact == factor2 fact&#39; o path_intermediate ;
      path_fact_factors : <span class="kr">forall</span> <span class="nv">a</span>, path_factor2 (factor1 fact a)
                          @ ap (factor2 fact&#39;) (path_factor1 a)
                          @ fact_factors fact&#39; a
                          = fact_factors fact a
    }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> PathFactorization fact fact&#39; : <span class="kn">clear implicits</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk3"><span class="kn">Lemma</span> <span class="nf">issig_PathFactorization</span> (<span class="nv">fact</span> <span class="nv">fact&#39;</span> : Factorization) :
    { path_intermediate : intermediate fact &lt;~&gt; intermediate fact&#39; &amp;
    { path_factor1 : path_intermediate o factor1 fact == factor1 fact&#39; &amp;
    { path_factor2 : factor2 fact == factor2 fact&#39; o path_intermediate &amp;
       <span class="kr">forall</span> <span class="nv">a</span>, path_factor2 (factor1 fact a)
                              @ ap (factor2 fact&#39;) (path_factor1 a)
                              @ fact_factors fact&#39; a
                 = fact_factors fact a }}}
      &lt;~&gt; PathFactorization fact fact&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>fact, fact'</var><span class="hyp-type"><b>: </b><span>Factorization</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{path_intermediate
: intermediate fact &lt;~&gt; intermediate fact&#39; &amp;
{path_factor1
: path_intermediate o factor1 fact == factor1 fact&#39; &amp;
{path_factor2
: factor2 fact == factor2 fact&#39; o path_intermediate &amp;
<span class="kr">forall</span> <span class="nv">a</span> : A,
(path_factor2 (factor1 fact a) @
 ap (factor2 fact&#39;) (path_factor1 a)) @
fact_factors fact&#39; a = fact_factors fact a}}} &lt;~&gt;
PathFactorization fact fact&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk4"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>fact, fact'</var><span class="hyp-type"><b>: </b><span>Factorization</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{path_intermediate
: intermediate fact &lt;~&gt; intermediate fact&#39; &amp;
{path_factor1
: path_intermediate o factor1 fact == factor1 fact&#39; &amp;
{path_factor2
: factor2 fact == factor2 fact&#39; o path_intermediate &amp;
<span class="kr">forall</span> <span class="nv">a</span> : A,
(path_factor2 (factor1 fact a) @
 ap (factor2 fact&#39;) (path_factor1 a)) @
fact_factors fact&#39; a = fact_factors fact a}}} &lt;~&gt;
PathFactorization fact fact&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input">issig.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk5"><span class="kn">Definition</span> <span class="nf">equiv_path_factorization</span> `{Univalence}
             (fact fact&#39; : Factorization)
    : PathFactorization fact fact&#39; &lt;~&gt; fact = fact&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fact, fact'</var><span class="hyp-type"><b>: </b><span>Factorization</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PathFactorization fact fact&#39; &lt;~&gt; fact = fact&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk6"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fact, fact'</var><span class="hyp-type"><b>: </b><span>Factorization</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PathFactorization fact fact&#39; &lt;~&gt; fact = fact&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk7"><span class="nb">refine</span> (_ oE (issig_PathFactorization fact fact&#39;)^-<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>fact, fact'</var><span class="hyp-type"><b>: </b><span>Factorization</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{path_intermediate
: intermediate fact &lt;~&gt; intermediate fact&#39; &amp;
{path_factor1
: (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; path_intermediate (factor1 fact x)) ==
  factor1 fact&#39; &amp;
{path_factor2
: factor2 fact ==
  (<span class="kr">fun</span> <span class="nv">x</span> : intermediate fact =&gt;
   factor2 fact&#39; (path_intermediate x)) &amp;
<span class="kr">forall</span> <span class="nv">a</span> : A,
(path_factor2 (factor1 fact a) @
 ap (factor2 fact&#39;) (path_factor1 a)) @
fact_factors fact&#39; a = fact_factors fact a}}} &lt;~&gt;
fact = fact&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk8"><span class="nb">revert</span> fact fact&#39;; <span class="nb">apply</span> (equiv_path_issig_contr issig_Factorization).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">b</span> : {I : <span class="kt">Type</span> &amp;
    {g : A -&gt; I &amp;
    {h : I -&gt; B &amp;
    {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; h (g x)) == f &amp;
    {_ : class1 A I g &amp; class2 I B h}}}}},
{path_intermediate
: intermediate (issig_Factorization b) &lt;~&gt;
  intermediate (issig_Factorization b) &amp;
{path_factor1
: (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
   path_intermediate
     (factor1 (issig_Factorization b) x)) ==
  factor1 (issig_Factorization b) &amp;
{path_factor2
: factor2 (issig_Factorization b) ==
  (<span class="kr">fun</span> <span class="nv">x</span> : intermediate (issig_Factorization b) =&gt;
   factor2 (issig_Factorization b)
     (path_intermediate x)) &amp;
<span class="kr">forall</span> <span class="nv">a</span> : A,
(path_factor2 (factor1 (issig_Factorization b) a) @
 ap (factor2 (issig_Factorization b)) (path_factor1 a)) @
fact_factors (issig_Factorization b) a =
fact_factors (issig_Factorization b) a}}}</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="factorization-v-chk9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><label class="goal-separator" for="factorization-v-chk9"><hr></label><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">b1</span> : {I : <span class="kt">Type</span> &amp;
     {g : A -&gt; I &amp;
     {h : I -&gt; B &amp;
     {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; h (g x)) == f &amp;
     {_ : class1 A I g &amp; class2 I B h}}}}},
Contr
  {b2
  : {I : <span class="kt">Type</span> &amp;
    {g : A -&gt; I &amp;
    {h : I -&gt; B &amp;
    {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; h (g x)) == f &amp;
    {_ : class1 A I g &amp; class2 I B h}}}}} &amp;
  {path_intermediate
  : intermediate (issig_Factorization b1) &lt;~&gt;
    intermediate (issig_Factorization b2) &amp;
  {path_factor1
  : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
     path_intermediate
       (factor1 (issig_Factorization b1) x)) ==
    factor1 (issig_Factorization b2) &amp;
  {path_factor2
  : factor2 (issig_Factorization b1) ==
    (<span class="kr">fun</span> <span class="nv">x</span> : intermediate (issig_Factorization b1) =&gt;
     factor2 (issig_Factorization b2)
       (path_intermediate x)) &amp;
  <span class="kr">forall</span> <span class="nv">a</span> : A,
  (path_factor2 (factor1 (issig_Factorization b1) a) @
   ap (factor2 (issig_Factorization b2))
     (path_factor1 a)) @
  fact_factors (issig_Factorization b2) a =
  fact_factors (issig_Factorization b1) a}}}}</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chka">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">b</span> : {I : <span class="kt">Type</span> &amp;
    {g : A -&gt; I &amp;
    {h : I -&gt; B &amp;
    {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; h (g x)) == f &amp;
    {_ : class1 A I g &amp; class2 I B h}}}}},
{path_intermediate
: intermediate (issig_Factorization b) &lt;~&gt;
  intermediate (issig_Factorization b) &amp;
{path_factor1
: (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
   path_intermediate
     (factor1 (issig_Factorization b) x)) ==
  factor1 (issig_Factorization b) &amp;
{path_factor2
: factor2 (issig_Factorization b) ==
  (<span class="kr">fun</span> <span class="nv">x</span> : intermediate (issig_Factorization b) =&gt;
   factor2 (issig_Factorization b)
     (path_intermediate x)) &amp;
<span class="kr">forall</span> <span class="nv">a</span> : A,
(path_factor2 (factor1 (issig_Factorization b) a) @
 ap (factor2 (issig_Factorization b)) (path_factor1 a)) @
fact_factors (issig_Factorization b) a =
fact_factors (issig_Factorization b) a}}}</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chkb"><span class="nb">intros</span> [I [f1 [f2 [ff [oc1 oc2]]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{path_intermediate
: intermediate
    (issig_Factorization (I; f1; f2; ff; oc1; oc2)) &lt;~&gt;
  intermediate
    (issig_Factorization (I; f1; f2; ff; oc1; oc2)) &amp;
{path_factor1
: (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
   path_intermediate
     (factor1
        (issig_Factorization (I; f1; f2; ff; oc1; oc2))
        x)) ==
  factor1
    (issig_Factorization (I; f1; f2; ff; oc1; oc2)) &amp;
{path_factor2
: factor2
    (issig_Factorization (I; f1; f2; ff; oc1; oc2)) ==
  (<span class="kr">fun</span>
     <span class="nv">x</span> : intermediate
           (issig_Factorization
              (I; f1; f2; ff; oc1; oc2)) =&gt;
   factor2
     (issig_Factorization (I; f1; f2; ff; oc1; oc2))
     (path_intermediate x)) &amp;
<span class="kr">forall</span> <span class="nv">a</span> : A,
(path_factor2
   (factor1
      (issig_Factorization (I; f1; f2; ff; oc1; oc2))
      a) @
 ap
   (factor2
      (issig_Factorization (I; f1; f2; ff; oc1; oc2)))
   (path_factor1 a)) @
fact_factors
  (issig_Factorization (I; f1; f2; ff; oc1; oc2)) a =
fact_factors
  (issig_Factorization (I; f1; f2; ff; oc1; oc2)) a}}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chkc"><span class="kr">exists</span> (<span class="nv">equiv_idmap</span> <span class="nv">I</span>); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{path_factor1 : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f1 x) == f1 &amp;
{path_factor2 : f2 == (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; f2 x) &amp;
<span class="kr">forall</span> <span class="nv">a</span> : A,
(path_factor2 (f1 a) @ ap f2 (path_factor1 a)) @ ff a =
ff a}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chkd"><span class="kr">exists</span> (<span class="nv">fun</span> <span class="nv">x</span>:A =&gt; <span class="mi">1</span>%path); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{path_factor2 : f2 == (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; f2 x) &amp;
<span class="kr">forall</span> <span class="nv">a</span> : A, (path_factor2 (f1 a) @ <span class="mi">1</span>) @ ff a = ff a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chke"><span class="kr">exists</span> (<span class="nv">fun</span> <span class="nv">x</span>:I =&gt; <span class="mi">1</span>%path); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : A, <span class="mi">1</span> @ ff a = ff a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">intros</span>; <span class="nb">apply</span> concat_1p.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chkf">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">b1</span> : {I : <span class="kt">Type</span> &amp;
     {g : A -&gt; I &amp;
     {h : I -&gt; B &amp;
     {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; h (g x)) == f &amp;
     {_ : class1 A I g &amp; class2 I B h}}}}},
Contr
  {b2
  : {I : <span class="kt">Type</span> &amp;
    {g : A -&gt; I &amp;
    {h : I -&gt; B &amp;
    {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; h (g x)) == f &amp;
    {_ : class1 A I g &amp; class2 I B h}}}}} &amp;
  {path_intermediate
  : intermediate (issig_Factorization b1) &lt;~&gt;
    intermediate (issig_Factorization b2) &amp;
  {path_factor1
  : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
     path_intermediate
       (factor1 (issig_Factorization b1) x)) ==
    factor1 (issig_Factorization b2) &amp;
  {path_factor2
  : factor2 (issig_Factorization b1) ==
    (<span class="kr">fun</span> <span class="nv">x</span> : intermediate (issig_Factorization b1) =&gt;
     factor2 (issig_Factorization b2)
       (path_intermediate x)) &amp;
  <span class="kr">forall</span> <span class="nv">a</span> : A,
  (path_factor2 (factor1 (issig_Factorization b1) a) @
   ap (factor2 (issig_Factorization b2))
     (path_factor1 a)) @
  fact_factors (issig_Factorization b2) a =
  fact_factors (issig_Factorization b1) a}}}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk10"><span class="nb">intros</span> [I [f1 [f2 [ff [oc1 oc2]]]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr
  {b2
  : {I : <span class="kt">Type</span> &amp;
    {g : A -&gt; I &amp;
    {h : I -&gt; B &amp;
    {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; h (g x)) == f &amp;
    {_ : class1 A I g &amp; class2 I B h}}}}} &amp;
  {path_intermediate
  : intermediate
      (issig_Factorization (I; f1; f2; ff; oc1; oc2)) &lt;~&gt;
    intermediate (issig_Factorization b2) &amp;
  {path_factor1
  : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt;
     path_intermediate
       (factor1
          (issig_Factorization
             (I; f1; f2; ff; oc1; oc2)) x)) ==
    factor1 (issig_Factorization b2) &amp;
  {path_factor2
  : factor2
      (issig_Factorization (I; f1; f2; ff; oc1; oc2)) ==
    (<span class="kr">fun</span>
       <span class="nv">x</span> : intermediate
             (issig_Factorization
                (I; f1; f2; ff; oc1; oc2)) =&gt;
     factor2 (issig_Factorization b2)
       (path_intermediate x)) &amp;
  <span class="kr">forall</span> <span class="nv">a</span> : A,
  (path_factor2
     (factor1
        (issig_Factorization (I; f1; f2; ff; oc1; oc2))
        a) @
   ap (factor2 (issig_Factorization b2))
     (path_factor1 a)) @
  fact_factors (issig_Factorization b2) a =
  fact_factors
    (issig_Factorization (I; f1; f2; ff; oc1; oc2)) a}}}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk11">contr_sigsig I (equiv_idmap I); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr
  {y
  : {g : A -&gt; I &amp;
    {h : I -&gt; B &amp;
    {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; h (g x)) == f &amp;
    {_ : class1 A I g &amp; class2 I B h}}}} &amp;
  {path_factor1 : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f1 x) == y.<span class="mi">1</span> &amp;
  {path_factor2 : f2 == (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; (y.<span class="mi">2</span>).<span class="mi">1</span> x) &amp;
  <span class="kr">forall</span> <span class="nv">a</span> : A,
  (path_factor2 (f1 a) @ ap (y.<span class="mi">2</span>).<span class="mi">1</span> (path_factor1 a)) @
  ((y.<span class="mi">2</span>).<span class="mi">2</span>).<span class="mi">1</span> a = ff a}}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk12">contr_sigsig f1 (<span class="kr">fun</span> <span class="nv">x</span>:A =&gt; idpath (f1 x)); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr
  {y
  : {h : I -&gt; B &amp;
    {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; h (f1 x)) == f &amp;
    {_ : class1 A I f1 &amp; class2 I B h}}} &amp;
  {path_factor2 : f2 == (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; y.<span class="mi">1</span> x) &amp;
  <span class="kr">forall</span> <span class="nv">a</span> : A,
  (path_factor2 (f1 a) @ <span class="mi">1</span>) @ (y.<span class="mi">2</span>).<span class="mi">1</span> a = ff a}}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk13">contr_sigsig f2 (<span class="kr">fun</span> <span class="nv">x</span>:I =&gt; idpath (f2 x)); <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr
  {y
  : {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f &amp;
    {_ : class1 A I f1 &amp; class2 I B f2}} &amp;
  <span class="kr">forall</span> <span class="nv">a</span> : A, <span class="mi">1</span> @ y.<span class="mi">1</span> a = ff a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk14"><span class="nb">refine</span> (contr_equiv&#39; {ff&#39; : f2 o f1 == f &amp; ff == ff&#39;} _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{ff&#39; : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f &amp; ff == ff&#39;} &lt;~&gt;
{y
: {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f &amp;
  {_ : class1 A I f1 &amp; class2 I B f2}} &amp;
<span class="kr">forall</span> <span class="nv">a</span> : A, <span class="mi">1</span> @ y.<span class="mi">1</span> a = ff a}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk15"><span class="nb">symmetry</span>; srefine (equiv_functor_sigma&#39; (equiv_sigma_contr _) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f,
Contr
  ((<span class="kr">fun</span> <span class="nv">_</span> : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f =&gt;
    {_ : class1 A I f1 &amp; class2 I B f2}) a)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="factorization-v-chk16" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><label class="goal-separator" for="factorization-v-chk16"><hr></label><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">a</span> : {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f &amp;
    {_ : class1 A I f1 &amp; class2 I B f2}},
(<span class="kr">fun</span>
   <span class="nv">y</span> : {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f &amp;
       {_ : class1 A I f1 &amp; class2 I B f2}} =&gt;
 <span class="kr">forall</span> <span class="nv">a0</span> : A, <span class="mi">1</span> @ y.<span class="mi">1</span> a0 = ff a0) a &lt;~&gt;
(<span class="kr">fun</span> <span class="nv">ff&#39;</span> : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f =&gt; ff == ff&#39;)
  (equiv_sigma_contr
     (<span class="kr">fun</span> <span class="nv">_</span> : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f =&gt;
      {_ : class1 A I f1 &amp; class2 I B f2}) a)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk17">{</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">a</span> : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f,
Contr
  ((<span class="kr">fun</span> <span class="nv">_</span> : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f =&gt;
    {_ : class1 A I f1 &amp; class2 I B f2}) a)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk18"><span class="nb">intros</span> h; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr {_ : class1 A I f1 &amp; class2 I B f2}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><span class="alectryon-input">srefine (@istrunc_sigma _ _ _ _ _); [ | <span class="nb">intros</span> a];
        <span class="nb">apply</span> contr_inhabited_hprop; <span class="kp">try</span> <span class="bp">exact</span> _; <span class="bp">assumption</span>.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk19">}</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">a</span> : {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f &amp;
    {_ : class1 A I f1 &amp; class2 I B f2}},
(<span class="kr">fun</span>
   <span class="nv">y</span> : {_ : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f &amp;
       {_ : class1 A I f1 &amp; class2 I B f2}} =&gt;
 <span class="kr">forall</span> <span class="nv">a0</span> : A, <span class="mi">1</span> @ y.<span class="mi">1</span> a0 = ff a0) a &lt;~&gt;
(<span class="kr">fun</span> <span class="nv">ff&#39;</span> : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f =&gt; ff == ff&#39;)
  (equiv_sigma_contr
     (<span class="kr">fun</span> <span class="nv">_</span> : (<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f =&gt;
      {_ : class1 A I f1 &amp; class2 I B f2}) a)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk1a"><span class="nb">intros</span> [ff&#39; [oc1&#39; oc2&#39;]]; <span class="nb">cbn</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br><span><var>ff'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1'</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2'</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">a</span> : A, <span class="mi">1</span> @ ff&#39; a = ff a) &lt;~&gt; ff == ff&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk1b"><span class="nb">refine</span> (equiv_functor_forall&#39; (equiv_idmap _) _); <span class="nb">intros</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br><span><var>ff'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1'</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2'</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> @ ff&#39; (<span class="mi">1</span>%equiv a) = ff (<span class="mi">1</span>%equiv a) &lt;~&gt; ff a = ff&#39; a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk1c"><span class="nb">refine</span> (equiv_path_inverse _ _ oE _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>class1, class2</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>, (X -&gt; Y) -&gt; <span class="kt">Type</span></span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class1 X Y g)</span></span></span><br><span><var>H0</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> (<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>) (<span class="nv">g</span> : X -&gt; Y),
IsHProp (class2 X Y g)</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>H1</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>A -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; B</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br><span><var>ff'</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : A =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>oc1'</var><span class="hyp-type"><b>: </b><span>class1 A I f1</span></span></span><br><span><var>oc2'</var><span class="hyp-type"><b>: </b><span>class2 I B f2</span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">1</span> @ ff&#39; (<span class="mi">1</span>%equiv a) = ff (<span class="mi">1</span>%equiv a) &lt;~&gt; ff&#39; a = ff a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> equiv_concat_l; <span class="nb">symmetry</span>; <span class="nb">apply</span> concat_1p.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">path_factorization</span> `{Univalence} (fact fact&#39; : Factorization)
    : PathFactorization fact fact&#39; -&gt; fact = fact&#39;
    := equiv_path_factorization fact fact&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">Factorization</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> Factorization class1 class2 {A B} f.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Arguments</span> PathFactorization {class1 class2 A B f} fact fact&#39;.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* This enables us to talk about &quot;the image of a map&quot; as a factorization but also as the intermediate object appearing in it, as is common in informal mathematics. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Coercion</span> <span class="nf">intermediate</span> : Factorization &gt;-&gt; <span class="kt">Sortclass</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** ** Factorization Systems *)</span>

<span class="sd">(** A (&quot;unique&quot; or &quot;orthogonal&quot;) factorization system consists of a couple of classes of maps, closed under composition, such that every map admits a unique factorization. *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Record</span> <span class="nf">FactorizationSystem</span>@{i j k} :=
  { class1 : <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{i}}, (X -&gt; Y) -&gt; <span class="kt">Type</span>@{j} ;
    ishprop_class1 :: <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{i}} (<span class="nv">g</span>:X-&gt;Y), IsHProp (class1 g) ;
    class1_isequiv : <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{i}} (<span class="nv">g</span>:X-&gt;Y) {<span class="nv">geq</span>:IsEquiv g}, class1 g ;
    class1_compose : <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> <span class="nv">Z</span> : <span class="kt">Type</span>@{i}} (<span class="nv">g</span>:X-&gt;Y) (<span class="nv">h</span>:Y-&gt;Z),
                       class1 g -&gt; class1 h -&gt; class1 (h o g) ;
    class2 : <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{i}}, (X -&gt; Y) -&gt; <span class="kt">Type</span>@{k} ;
    ishprop_class2 :: <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{i}} (<span class="nv">g</span>:X-&gt;Y), IsHProp (class2 g) ;
    class2_isequiv : <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{i}} (<span class="nv">g</span>:X-&gt;Y) {<span class="nv">geq</span>:IsEquiv g}, class2 g ;
    class2_compose : <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> <span class="nv">Z</span> : <span class="kt">Type</span>@{i}} (<span class="nv">g</span>:X-&gt;Y) (<span class="nv">h</span>:Y-&gt;Z),
                       class2 g -&gt; class2 h -&gt; class2 (h o g) ;
    <span class="sd">(** Morally, the uniqueness of factorizations says that [Factorization class1 class2 f] is contractible.  However, in practice we always *prove* that by way of [path_factorization], and we frequently want to *use* the components of a [PathFactorization] as well.  Thus, as data we store the canonical factorization and a [PathFactorization] between any two such, and prove in a moment that this implies contractibility of the space of factorizations. *)</span>
    factor : <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{i}} (<span class="nv">f</span>:X-&gt;Y), Factorization@{i} (@class1) (@class2) f ;
    path_factor : <span class="kr">forall</span> {<span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{i}} (<span class="nv">f</span>:X-&gt;Y)
                         (<span class="nv">fact</span> : Factorization@{i} (@class1) (@class2) f)
                         (<span class="nv">fact&#39;</span> : Factorization@{i} (@class1) (@class2) f),
                    PathFactorization@{i} fact fact&#39;
  }.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(** The type of factorizations is, as promised, contractible. *)</span>
</span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk1d"><span class="kn">Theorem</span> <span class="nf">contr_factor</span> `{Univalence} (factsys : FactorizationSystem)
        {X Y : <span class="kt">Type</span>} (f : X -&gt; Y)
  : Contr (Factorization (@class1 factsys) (@class2 factsys) f).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr
  (Factorization (@class1 factsys) (@class2 factsys) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk1e"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Contr
  (Factorization (@class1 factsys) (@class2 factsys) f)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk1f"><span class="nb">apply</span> contr_inhabited_hprop.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp
  (Factorization (@class1 factsys) (@class2 factsys) f)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="factorization-v-chk20" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br></div><label class="goal-separator" for="factorization-v-chk20"><hr></label><div class="goal-conclusion">Factorization (@class1 factsys) (@class2 factsys) f</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk21">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsHProp
  (Factorization (@class1 factsys) (@class2 factsys) f)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk22"><span class="nb">apply</span> hprop_allpath.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span>
<span class="nv">x</span>
 <span class="nv">y</span> : Factorization (@class1 factsys) (@class2 factsys)
       f, x = y</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk23"><span class="nb">intros</span> fact fact&#39;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>fact, fact'</var><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">fact = fact&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk24"><span class="nb">apply</span> path_factorization; <span class="kp">try</span> <span class="bp">exact</span> _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>fact, fact'</var><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) f</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">PathFactorization fact fact&#39;</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> path_factor.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk25">-</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>H</var><span class="hyp-type"><b>: </b><span>Univalence</span></span></span><br><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Factorization (@class1 factsys) (@class2 factsys) f</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> factor.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">FactSys</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> (<span class="nv">factsys</span> : FactorizationSystem).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Build_Factorization&#39;</span> {<span class="nv">X</span> <span class="nv">Y</span>}
    := @Build_Factorization (@class1 factsys) (@class2 factsys) X Y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">Build_PathFactorization&#39;</span> {<span class="nv">X</span> <span class="nv">Y</span>}
    := @Build_PathFactorization (@class1 factsys) (@class2 factsys) X Y.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** The left class is right-cancellable and the right class is left-cancellable. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk26" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk26"><span class="kn">Definition</span> <span class="nf">cancelR_class1</span> `{Funext} {X Y Z} (f : X -&gt; Y) (g : Y -&gt; Z)
  : class1 factsys f -&gt; class1 factsys (g o f) -&gt; class1 factsys g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class1 factsys f -&gt;
class1 factsys (g o f) -&gt; class1 factsys g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk27"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class1 factsys f -&gt;
class1 factsys (g o f) -&gt; class1 factsys g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk28"><span class="nb">intros</span> c1f c1gf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>c1gf</var><span class="hyp-type"><b>: </b><span>class1 factsys (g o f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class1 factsys g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk29"><span class="nb">destruct</span> (factor factsys g) <span class="kr">as</span> [I g1 g2 gf c1g1 c2g2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>c1gf</var><span class="hyp-type"><b>: </b><span>class1 factsys (g o f)</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g1</var><span class="hyp-type"><b>: </b><span>Y -&gt; I</span></span></span><br><span><var>g2</var><span class="hyp-type"><b>: </b><span>I -&gt; Z</span></span></span><br><span><var>gf</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; g2 (g1 x)) == g</span></span></span><br><span><var>c1g1</var><span class="hyp-type"><b>: </b><span>class1 factsys g1</span></span></span><br><span><var>c2g2</var><span class="hyp-type"><b>: </b><span>class2 factsys g2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class1 factsys g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk2a"><span class="nb">pose</span> (fact  := Build_Factorization&#39; (g o f) Z (g o f) (idmap)
                     (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="mi">1</span>) c1gf (class2_isequiv factsys idmap)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>c1gf</var><span class="hyp-type"><b>: </b><span>class1 factsys (g o f)</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g1</var><span class="hyp-type"><b>: </b><span>Y -&gt; I</span></span></span><br><span><var>g2</var><span class="hyp-type"><b>: </b><span>I -&gt; Z</span></span></span><br><span><var>gf</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; g2 (g1 x)) == g</span></span></span><br><span><var>c1g1</var><span class="hyp-type"><b>: </b><span>class1 factsys g1</span></span></span><br><span><var>c2g2</var><span class="hyp-type"><b>: </b><span>class2 factsys g2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (g o f) Z 
  (g o f) idmap (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>) c1gf
  (class2_isequiv factsys idmap)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (g o f)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class1 factsys g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk2b" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk2b"><span class="nb">pose</span> (fact&#39; := Build_Factorization&#39; (g o f) I (g1 o f) g2
                     (<span class="kr">fun</span> <span class="nv">x</span> =&gt; gf (f x))
                     (class1_compose factsys f g1 c1f c1g1) c2g2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>c1gf</var><span class="hyp-type"><b>: </b><span>class1 factsys (g o f)</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g1</var><span class="hyp-type"><b>: </b><span>Y -&gt; I</span></span></span><br><span><var>g2</var><span class="hyp-type"><b>: </b><span>I -&gt; Z</span></span></span><br><span><var>gf</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; g2 (g1 x)) == g</span></span></span><br><span><var>c1g1</var><span class="hyp-type"><b>: </b><span>class1 factsys g1</span></span></span><br><span><var>c2g2</var><span class="hyp-type"><b>: </b><span>class2 factsys g2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (g o f) Z 
  (g o f) idmap (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>) c1gf
  (class2_isequiv factsys idmap)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (g o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (g o f) I 
  (g1 o f) g2 (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; gf (f x))
  (class1_compose factsys f g1 c1f c1g1) c2g2</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (g o f)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class1 factsys g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk2c"><span class="nb">destruct</span> (path_factor factsys (g o f) fact&#39; fact)
             <span class="kr">as</span> [q q1 q2 qf]; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>c1gf</var><span class="hyp-type"><b>: </b><span>class1 factsys (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g1</var><span class="hyp-type"><b>: </b><span>Y -&gt; I</span></span></span><br><span><var>g2</var><span class="hyp-type"><b>: </b><span>I -&gt; Z</span></span></span><br><span><var>gf</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; g2 (g1 x)) == g</span></span></span><br><span><var>c1g1</var><span class="hyp-type"><b>: </b><span>class1 factsys g1</span></span></span><br><span><var>c2g2</var><span class="hyp-type"><b>: </b><span>class2 factsys g2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) Z
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) idmap 
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>) c1gf
  (class2_isequiv factsys idmap)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) I
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g1 (f x)) g2
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; gf (f x))
  (class1_compose factsys f g1 c1f c1g1) c2g2</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>I &lt;~&gt; Z</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; q (g1 (f x))) ==
(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>q2</var><span class="hyp-type"><b>: </b><span>g2 == (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; q x)</span></span></span><br><span><var>qf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : X,
(q2 (g1 (f a)) @ ap idmap (q1 a)) @ <span class="mi">1</span> = gf (f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class1 factsys g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk2d"><span class="nb">refine</span> (transport (class1 factsys) (path_arrow _ _ gf) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>c1gf</var><span class="hyp-type"><b>: </b><span>class1 factsys (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g1</var><span class="hyp-type"><b>: </b><span>Y -&gt; I</span></span></span><br><span><var>g2</var><span class="hyp-type"><b>: </b><span>I -&gt; Z</span></span></span><br><span><var>gf</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; g2 (g1 x)) == g</span></span></span><br><span><var>c1g1</var><span class="hyp-type"><b>: </b><span>class1 factsys g1</span></span></span><br><span><var>c2g2</var><span class="hyp-type"><b>: </b><span>class2 factsys g2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) Z
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) idmap 
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>) c1gf
  (class2_isequiv factsys idmap)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) I
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g1 (f x)) g2
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; gf (f x))
  (class1_compose factsys f g1 c1f c1g1) c2g2</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>I &lt;~&gt; Z</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; q (g1 (f x))) ==
(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>q2</var><span class="hyp-type"><b>: </b><span>g2 == (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; q x)</span></span></span><br><span><var>qf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : X,
(q2 (g1 (f a)) @ ap idmap (q1 a)) @ <span class="mi">1</span> = gf (f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class1 factsys (<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; g2 (g1 x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk2e"><span class="nb">refine</span> (class1_compose factsys g1 g2 c1g1 _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>c1gf</var><span class="hyp-type"><b>: </b><span>class1 factsys (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g1</var><span class="hyp-type"><b>: </b><span>Y -&gt; I</span></span></span><br><span><var>g2</var><span class="hyp-type"><b>: </b><span>I -&gt; Z</span></span></span><br><span><var>gf</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; g2 (g1 x)) == g</span></span></span><br><span><var>c1g1</var><span class="hyp-type"><b>: </b><span>class1 factsys g1</span></span></span><br><span><var>c2g2</var><span class="hyp-type"><b>: </b><span>class2 factsys g2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) Z
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) idmap 
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>) c1gf
  (class2_isequiv factsys idmap)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) I
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g1 (f x)) g2
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; gf (f x))
  (class1_compose factsys f g1 c1f c1g1) c2g2</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>I &lt;~&gt; Z</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; q (g1 (f x))) ==
(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>q2</var><span class="hyp-type"><b>: </b><span>g2 == (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; q x)</span></span></span><br><span><var>qf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : X,
(q2 (g1 (f a)) @ ap idmap (q1 a)) @ <span class="mi">1</span> = gf (f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class1 factsys g2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk2f"><span class="nb">apply</span> class1_isequiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>c1gf</var><span class="hyp-type"><b>: </b><span>class1 factsys (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>g1</var><span class="hyp-type"><b>: </b><span>Y -&gt; I</span></span></span><br><span><var>g2</var><span class="hyp-type"><b>: </b><span>I -&gt; Z</span></span></span><br><span><var>gf</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : Y =&gt; g2 (g1 x)) == g</span></span></span><br><span><var>c1g1</var><span class="hyp-type"><b>: </b><span>class1 factsys g1</span></span></span><br><span><var>c2g2</var><span class="hyp-type"><b>: </b><span>class2 factsys g2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) Z
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) idmap 
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>) c1gf
  (class2_isequiv factsys idmap)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) I
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g1 (f x)) g2
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; gf (f x))
  (class1_compose factsys f g1 c1f c1g1) c2g2</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>I &lt;~&gt; Z</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; q (g1 (f x))) ==
(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>q2</var><span class="hyp-type"><b>: </b><span>g2 == (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; q x)</span></span></span><br><span><var>qf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : X,
(q2 (g1 (f a)) @ ap idmap (q1 a)) @ <span class="mi">1</span> = gf (f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv g2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (isequiv_homotopic _ (<span class="kr">fun</span> <span class="nv">i</span> =&gt; (q2 i)^)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk30"><span class="kn">Definition</span> <span class="nf">cancelL_class2</span> `{Funext} {X Y Z} (f : X -&gt; Y) (g : Y -&gt; Z)
  : class2 factsys g -&gt; class2 factsys (g o f) -&gt; class2 factsys f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class2 factsys g -&gt;
class2 factsys (g o f) -&gt; class2 factsys f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk31"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class2 factsys g -&gt;
class2 factsys (g o f) -&gt; class2 factsys f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk32"><span class="nb">intros</span> c2g c2gf.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c2g</var><span class="hyp-type"><b>: </b><span>class2 factsys g</span></span></span><br><span><var>c2gf</var><span class="hyp-type"><b>: </b><span>class2 factsys (g o f)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class2 factsys f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk33"><span class="nb">destruct</span> (factor factsys f) <span class="kr">as</span> [I f1 f2 ff c1f1 c2f2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c2g</var><span class="hyp-type"><b>: </b><span>class2 factsys g</span></span></span><br><span><var>c2gf</var><span class="hyp-type"><b>: </b><span>class2 factsys (g o f)</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>X -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>c1f1</var><span class="hyp-type"><b>: </b><span>class1 factsys f1</span></span></span><br><span><var>c2f2</var><span class="hyp-type"><b>: </b><span>class2 factsys f2</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class2 factsys f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk34"><span class="nb">pose</span> (fact  := Build_Factorization&#39; (g o f) X (idmap) (g o f)
                     (<span class="kr">fun</span> <span class="nv">x</span> =&gt; <span class="mi">1</span>) (class1_isequiv factsys idmap) c2gf).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c2g</var><span class="hyp-type"><b>: </b><span>class2 factsys g</span></span></span><br><span><var>c2gf</var><span class="hyp-type"><b>: </b><span>class2 factsys (g o f)</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>X -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>c1f1</var><span class="hyp-type"><b>: </b><span>class1 factsys f1</span></span></span><br><span><var>c2f2</var><span class="hyp-type"><b>: </b><span>class2 factsys f2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (g o f) X idmap 
  (g o f) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>)
  (class1_isequiv factsys idmap) c2gf</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (g o f)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class2 factsys f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk35"><span class="nb">pose</span> (fact&#39; := Build_Factorization&#39; (g o f) I f1 (g o f2)
                     (<span class="kr">fun</span> <span class="nv">x</span> =&gt; ap g (ff x))
                     c1f1 (class2_compose factsys f2 g c2f2 c2g)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c2g</var><span class="hyp-type"><b>: </b><span>class2 factsys g</span></span></span><br><span><var>c2gf</var><span class="hyp-type"><b>: </b><span>class2 factsys (g o f)</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>X -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>c1f1</var><span class="hyp-type"><b>: </b><span>class1 factsys f1</span></span></span><br><span><var>c2f2</var><span class="hyp-type"><b>: </b><span>class2 factsys f2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (g o f) X idmap 
  (g o f) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>)
  (class1_isequiv factsys idmap) c2gf</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (g o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (g o f) I f1 
  (g o f2) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; ap g (ff x)) c1f1
  (class2_compose factsys f2 g c2f2 c2g)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (g o f)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class2 factsys f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk36"><span class="nb">destruct</span> (path_factor factsys (g o f) fact fact&#39;)
             <span class="kr">as</span> [q q1 q2 qf]; <span class="nb">simpl</span> <span class="kr">in</span> *.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c2g</var><span class="hyp-type"><b>: </b><span>class2 factsys g</span></span></span><br><span><var>c2gf</var><span class="hyp-type"><b>: </b><span>class2 factsys (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>X -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>c1f1</var><span class="hyp-type"><b>: </b><span>class1 factsys f1</span></span></span><br><span><var>c2f2</var><span class="hyp-type"><b>: </b><span>class2 factsys f2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) X
  idmap (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) 
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>)
  (class1_isequiv factsys idmap) c2gf</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) I
  f1 (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; g (f2 x))
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; ap g (ff x)) c1f1
  (class2_compose factsys f2 g c2f2 c2g)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>X &lt;~&gt; I</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; q x) == f1</span></span></span><br><span><var>q2</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) ==
(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f2 (q x)))</span></span></span><br><span><var>qf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : X,
(q2 a @ ap (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; g (f2 x)) (q1 a)) @
ap g (ff a) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class2 factsys f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk37"><span class="nb">refine</span> (transport (class2 factsys) (path_arrow _ _ ff) _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c2g</var><span class="hyp-type"><b>: </b><span>class2 factsys g</span></span></span><br><span><var>c2gf</var><span class="hyp-type"><b>: </b><span>class2 factsys (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>X -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>c1f1</var><span class="hyp-type"><b>: </b><span>class1 factsys f1</span></span></span><br><span><var>c2f2</var><span class="hyp-type"><b>: </b><span>class2 factsys f2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) X
  idmap (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) 
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>)
  (class1_isequiv factsys idmap) c2gf</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) I
  f1 (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; g (f2 x))
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; ap g (ff x)) c1f1
  (class2_compose factsys f2 g c2f2 c2g)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>X &lt;~&gt; I</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; q x) == f1</span></span></span><br><span><var>q2</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) ==
(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f2 (q x)))</span></span></span><br><span><var>qf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : X,
(q2 a @ ap (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; g (f2 x)) (q1 a)) @
ap g (ff a) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class2 factsys (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f2 (f1 x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk38"><span class="nb">refine</span> (class2_compose factsys f1 f2 _ c2f2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c2g</var><span class="hyp-type"><b>: </b><span>class2 factsys g</span></span></span><br><span><var>c2gf</var><span class="hyp-type"><b>: </b><span>class2 factsys (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>X -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>c1f1</var><span class="hyp-type"><b>: </b><span>class1 factsys f1</span></span></span><br><span><var>c2f2</var><span class="hyp-type"><b>: </b><span>class2 factsys f2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) X
  idmap (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) 
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>)
  (class1_isequiv factsys idmap) c2gf</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) I
  f1 (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; g (f2 x))
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; ap g (ff x)) c1f1
  (class2_compose factsys f2 g c2f2 c2g)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>X &lt;~&gt; I</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; q x) == f1</span></span></span><br><span><var>q2</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) ==
(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f2 (q x)))</span></span></span><br><span><var>qf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : X,
(q2 a @ ap (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; g (f2 x)) (q1 a)) @
ap g (ff a) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">class2 factsys f1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk39"><span class="nb">apply</span> class2_isequiv.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>H</var><span class="hyp-type"><b>: </b><span>Funext</span></span></span><br><span><var>X, Y, Z</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>Y -&gt; Z</span></span></span><br><span><var>c2g</var><span class="hyp-type"><b>: </b><span>class2 factsys g</span></span></span><br><span><var>c2gf</var><span class="hyp-type"><b>: </b><span>class2 factsys (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span><br><span><var>I</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f1</var><span class="hyp-type"><b>: </b><span>X -&gt; I</span></span></span><br><span><var>f2</var><span class="hyp-type"><b>: </b><span>I -&gt; Y</span></span></span><br><span><var>ff</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; f2 (f1 x)) == f</span></span></span><br><span><var>c1f1</var><span class="hyp-type"><b>: </b><span>class1 factsys f1</span></span></span><br><span><var>c2f2</var><span class="hyp-type"><b>: </b><span>class2 factsys f2</span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) X
  idmap (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) 
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; <span class="mi">1</span>)
  (class1_isequiv factsys idmap) c2gf</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) I
  f1 (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; g (f2 x))
  (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; ap g (ff x)) c1f1
  (class2_compose factsys f2 g c2f2 c2g)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x))</span></span></span></span><br><span><var>q</var><span class="hyp-type"><b>: </b><span>X &lt;~&gt; I</span></span></span><br><span><var>q1</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; q x) == f1</span></span></span><br><span><var>q2</var><span class="hyp-type"><b>: </b><span>(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f x)) ==
(<span class="kr">fun</span> <span class="nv">x</span> : X =&gt; g (f2 (q x)))</span></span></span><br><span><var>qf</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : X,
(q2 a @ ap (<span class="kr">fun</span> <span class="nv">x</span> : I =&gt; g (f2 x)) (q1 a)) @
ap g (ff a) = <span class="mi">1</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">IsEquiv f1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (isequiv_homotopic _ q1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** The two classes of maps are automatically orthogonal, i.e. any commutative square from a [class1] map to a [class2] map has a unique diagonal filler.  For now, we only bother to define the lift; in principle we ought to show that the type of lifts is contractible. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Universe</span> <span class="nf">ctxi</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">A</span> <span class="nv">B</span> <span class="nv">X</span> <span class="nv">Y</span> : <span class="kt">Type</span>@{ctxi}}
          (<span class="nv">i</span> : A -&gt; B) (<span class="nv">c1i</span> : class1 factsys i)
          (<span class="nv">p</span> : X -&gt; Y) (<span class="nv">c2p</span> : class2 factsys p)
          (<span class="nv">f</span> : A -&gt; X) (<span class="nv">g</span> : B -&gt; Y) (<span class="nv">h</span> : p o f == g o i).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** First we factor [f] *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">C</span>  : <span class="kt">Type</span>         := intermediate (factor factsys f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">f1</span> : A -&gt; C       := factor1      (factor factsys f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">f2</span> : C -&gt; X       := factor2      (factor factsys f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">ff</span> : f2 o f1 == f := fact_factors (factor factsys f).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** and [g] *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">D</span>  : <span class="kt">Type</span>         := intermediate (factor factsys g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">g1</span> : B -&gt; D       := factor1      (factor factsys g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">g2</span> : D -&gt; Y       := factor2      (factor factsys g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">gf</span> : g2 o g1 == g := fact_factors (factor factsys g).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Now we observe that [p o f2] and [f1], and [g2] and [g1 o i], are both factorizations of the common diagonal of the commutative square (for which we use [p o f], but we could equally well use [g o i]. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">fact</span>  : Factorization (@class1 factsys) (@class2 factsys) (p o f)
            := Build_Factorization&#39; (p o f) C f1 (p o f2)
                 (<span class="kr">fun</span> <span class="nv">a</span> =&gt; ap p (ff a))
                 (inclass1 (factor factsys f))
                 (class2_compose factsys f2 p
                                 (inclass2 (factor factsys f))
                                 c2p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">fact&#39;</span> : Factorization (@class1 factsys) (@class2 factsys) (p o f)
            := Build_Factorization&#39; (p o f) D (g1 o i) g2
                 (<span class="kr">fun</span> <span class="nv">a</span> =&gt; gf (i a) @ (h a)^)
                 (class1_compose factsys i g1 c1i
                                 (inclass1 (factor factsys g)))
                 (inclass2 (factor factsys g)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Therefore, by the uniqueness of factorizations, we have an equivalence [q] relating them. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">q</span>  : C &lt;~&gt; D          := path_intermediate
                                 (path_factor factsys (p o f) fact fact&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">q1</span> : q o f1 == g1 o i := path_factor1
                                 (path_factor factsys (p o f) fact fact&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Let</span> <span class="nf">q2</span> : p o f2 == g2 o q := path_factor2
                                 (path_factor factsys (p o f) fact fact&#39;).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** Using this, we can define the lift. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">lift_factsys</span> : B -&gt; X
    := f2 o q^-<span class="mi">1</span> o g1.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** And the commutative triangles making it a lift *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk3a"><span class="kn">Definition</span> <span class="nf">lift_factsys_tri1</span> : lift_factsys o i == f.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">lift_factsys o i == f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk3b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">lift_factsys o i == f</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk3c"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">lift_factsys (i x) = f x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk3d"><span class="nb">refine</span> (ap (f2 o q^-<span class="mi">1</span>) (q1 x)^ @ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f2 (q^-<span class="mi">1</span> (q (f1 x))) = f x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk3e"><span class="nb">transitivity</span> (f2 (f1 x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f2 (q^-<span class="mi">1</span> (q (f1 x))) = f2 (f1 x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="factorization-v-chk3f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><label class="goal-separator" for="factorization-v-chk3f"><hr></label><div class="goal-conclusion">f2 (f1 x) = f x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk40">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f2 (q^-<span class="mi">1</span> (q (f1 x))) = f2 (f1 x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ap, eissect.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk41">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">f2 (f1 x) = f x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ff.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk42"><span class="kn">Definition</span> <span class="nf">lift_factsys_tri2</span> : p o lift_factsys == g.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o lift_factsys == g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk43"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p o lift_factsys == g</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk44"><span class="nb">intros</span> x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">p (lift_factsys x) = g x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk45"><span class="nb">refine</span> (q2 _ @ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">g2 (q (q^-<span class="mi">1</span> (g1 x))) = g x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk46"><span class="nb">transitivity</span> (g2 (g1 x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">g2 (q (q^-<span class="mi">1</span> (g1 x))) = g2 (g1 x)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="factorization-v-chk47" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><label class="goal-separator" for="factorization-v-chk47"><hr></label><div class="goal-conclusion">g2 (g1 x) = g x</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk48">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">g2 (q (q^-<span class="mi">1</span> (g1 x))) = g2 (g1 x)</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> ap, eisretr.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk49">+</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>B</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">g2 (g1 x) = g x</div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span> gf.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** And finally prove that these two triangles compose to the given commutative square. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk4a"><span class="kn">Definition</span> <span class="nf">lift_factsys_square</span> (<span class="nv">x</span> : A)
  : ap p (lift_factsys_tri1 x)^ @ lift_factsys_tri2 (i x) = h x.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p (lift_factsys_tri1 x)^ @ lift_factsys_tri2 (i x) =
h x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk4b"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p (lift_factsys_tri1 x)^ @ lift_factsys_tri2 (i x) =
h x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk4c"><span class="nb">unfold</span> lift_factsys_tri1, lift_factsys_tri2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a) @ (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p
  (ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; f2 (q^-<span class="mi">1</span> x)) (q1 x)^ @
   (ap f2 (eissect q (f1 x)) @ ff x))^ @
(q2 (q^-<span class="mi">1</span> (g1 (i x))) @
 (ap g2 (eisretr q (g1 (i x))) @ gf (i x))) = h x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk4d"><span class="kn">Open Scope</span> long_path_scope.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p
  (ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; f2 (q^-<span class="mi">1</span> x)) (q1 x)^
   @&#39; (ap f2 (eissect q (f1 x))
       @&#39; ff x))^
@&#39; (q2 (q^-<span class="mi">1</span> (g1 (i x)))
    @&#39; (ap g2 (eisretr q (g1 (i x)))
        @&#39; gf (i x))) = h x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* First we use the one aspect of the uniqueness of factorizations that we haven&#39;t mentioned yet. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk4e"><span class="nb">pose</span> (r := path_fact_factors (path_factor factsys (p o f) fact fact&#39;) x
            : q2 (f1 x) @ ap g2 (q1 x) @ (gf (i x) @ (h x)^) = ap p (ff x)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>r</var><span><span class="hyp-body"><b>:= </b><span>path_fact_factors
  (path_factor factsys (p o f) fact fact&#39;) x
:
q2 (f1 x)
@&#39; ap g2 (q1 x)
@&#39; (gf (i x)
    @&#39; (h x)^) = ap p (ff x)</span></span><span class="hyp-type"><b>: </b><span>q2 (f1 x)
@&#39; ap g2 (q1 x)
@&#39; (gf (i x)
    @&#39; (h x)^) = ap p (ff x)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p
  (ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; f2 (q^-<span class="mi">1</span> x)) (q1 x)^
   @&#39; (ap f2 (eissect q (f1 x))
       @&#39; ff x))^
@&#39; (q2 (q^-<span class="mi">1</span> (g1 (i x)))
    @&#39; (ap g2 (eisretr q (g1 (i x)))
        @&#39; gf (i x))) = h x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk4f"><span class="nb">rewrite</span> concat_p_pp <span class="kr">in</span> r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>q2 (f1 x)
@&#39; ap g2 (q1 x)
@&#39; gf (i x)
@&#39; (h x)^ = ap p (ff x)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p
  (ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; f2 (q^-<span class="mi">1</span> x)) (q1 x)^
   @&#39; (ap f2 (eissect q (f1 x))
       @&#39; ff x))^
@&#39; (q2 (q^-<span class="mi">1</span> (g1 (i x)))
    @&#39; (ap g2 (eisretr q (g1 (i x)))
        @&#39; gf (i x))) = h x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk50"><span class="nb">apply</span> moveL_pM, moveR_Vp <span class="kr">in</span> r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>r</var><span class="hyp-type"><b>: </b><span>(ap p (ff x))^
@&#39; (q2 (f1 x)
    @&#39; ap g2 (q1 x)
    @&#39; gf (i x)) = h x</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p
  (ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; f2 (q^-<span class="mi">1</span> x)) (q1 x)^
   @&#39; (ap f2 (eissect q (f1 x))
       @&#39; ff x))^
@&#39; (q2 (q^-<span class="mi">1</span> (g1 (i x)))
    @&#39; (ap g2 (eisretr q (g1 (i x)))
        @&#39; gf (i x))) = h x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk51"><span class="nb">refine</span> (_ @ r); <span class="nb">clear</span> r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p
  (ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; f2 (q^-<span class="mi">1</span> x)) (q1 x)^
   @&#39; (ap f2 (eissect q (f1 x))
       @&#39; ff x))^
@&#39; (q2 (q^-<span class="mi">1</span> (g1 (i x)))
    @&#39; (ap g2 (eisretr q (g1 (i x)))
        @&#39; gf (i x))) =
(ap p (ff x))^
@&#39; (q2 (f1 x)
    @&#39; ap g2 (q1 x)
    @&#39; gf (i x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Now we can cancel some whiskered paths on both sides. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk52"><span class="kp">repeat</span> <span class="nb">rewrite</span> inv_pp; <span class="kp">repeat</span> <span class="nb">rewrite</span> ap_pp; <span class="nb">rewrite</span> ap_V.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ap p (ff x))^
@&#39; ap p (ap f2 (eissect q (f1 x)))^
@&#39; ap p (ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; f2 (q^-<span class="mi">1</span> x)) (q1 x)^)^
@&#39; (q2 (q^-<span class="mi">1</span> (g1 (i x)))
    @&#39; (ap g2 (eisretr q (g1 (i x)))
        @&#39; gf (i x))) =
(ap p (ff x))^
@&#39; (q2 (f1 x)
    @&#39; ap g2 (q1 x)
    @&#39; gf (i x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk53"><span class="kp">repeat</span> <span class="nb">rewrite</span> concat_pp_p; <span class="nb">apply</span> whiskerL.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p (ap f2 (eissect q (f1 x)))^
@&#39; (ap p (ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; f2 (q^-<span class="mi">1</span> x)) (q1 x)^)^
    @&#39; (q2 (q^-<span class="mi">1</span> (g1 (i x)))
        @&#39; (ap g2 (eisretr q (g1 (i x)))
            @&#39; gf (i x)))) =
q2 (f1 x)
@&#39; (ap g2 (q1 x)
    @&#39; gf (i x))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk54"><span class="kp">repeat</span> <span class="nb">rewrite</span> concat_p_pp; <span class="nb">apply</span> whiskerR.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p (ap f2 (eissect q (f1 x)))^
@&#39; ap p (ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; f2 (q^-<span class="mi">1</span> x)) (q1 x)^)^
@&#39; q2 (q^-<span class="mi">1</span> (g1 (i x)))
@&#39; ap g2 (eisretr q (g1 (i x))) =
q2 (f1 x)
@&#39; ap g2 (q1 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Next we set up for a naturality. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk55"><span class="nb">rewrite</span> (ap_compose q^-<span class="mi">1</span> f2), &lt;- ap_pp, &lt;- inv_pp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p
  (ap f2 (ap q^-<span class="mi">1</span> (q1 x)^)
   @&#39; ap f2 (eissect q (f1 x)))^
@&#39; q2 (q^-<span class="mi">1</span> (g1 (i x)))
@&#39; ap g2 (eisretr q (g1 (i x))) =
q2 (f1 x)
@&#39; ap g2 (q1 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* The next line appears to do nothing, but in fact it is necessary for the subsequent [rewrite] to succeed, because [lift_factsys] appears in the invisible implicit point-arguments of [paths].  One way to discover issues of that sort is to turn on printing of all implicit arguments with [Set Printing All]; another is to use [Set Debug Tactic Unification] and inspect the output to see what [rewrite] is trying and failing to unify. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk56"><span class="nb">unfold</span> lift_factsys.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p
  (ap f2 (ap q^-<span class="mi">1</span> (q1 x)^)
   @&#39; ap f2 (eissect q (f1 x)))^
@&#39; q2 (q^-<span class="mi">1</span> (g1 (i x)))
@&#39; ap g2 (eisretr q (g1 (i x))) =
q2 (f1 x)
@&#39; ap g2 (q1 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk57"><span class="nb">rewrite</span> &lt;- ap_pp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap p (ap f2 (ap q^-<span class="mi">1</span> (q1 x)^
             @&#39; eissect q (f1 x)))^
@&#39; q2 (q^-<span class="mi">1</span> (g1 (i x)))
@&#39; ap g2 (eisretr q (g1 (i x))) =
q2 (f1 x)
@&#39; ap g2 (q1 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk58"><span class="nb">rewrite</span> &lt;- ap_V, &lt;- ap_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; p (f2 x))
  (ap q^-<span class="mi">1</span> (q1 x)^
   @&#39; eissect q (f1 x))^
@&#39; q2 (q^-<span class="mi">1</span> (g1 (i x)))
@&#39; ap g2 (eisretr q (g1 (i x))) =
q2 (f1 x)
@&#39; ap g2 (q1 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk59"><span class="nb">rewrite</span> (concat_Ap q2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">q2 (f1 x)
@&#39; ap (<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; g2 (q x))
     (ap q^-<span class="mi">1</span> (q1 x)^
      @&#39; eissect q (f1 x))^
@&#39; ap g2 (eisretr q (g1 (i x))) =
q2 (f1 x)
@&#39; ap g2 (q1 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Now we can cancel another path *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk5a"><span class="nb">rewrite</span> concat_pp_p; <span class="nb">apply</span> whiskerL.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (<span class="kr">fun</span> <span class="nv">x</span> : C =&gt; g2 (q x))
  (ap q^-<span class="mi">1</span> (q1 x)^
   @&#39; eissect q (f1 x))^
@&#39; ap g2 (eisretr q (g1 (i x))) = ap g2 (q1 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* And set up for an application of [ap]. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk5b"><span class="nb">rewrite</span> ap_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap g2 (ap q (ap q^-<span class="mi">1</span> (q1 x)^
             @&#39; eissect q (f1 x))^)
@&#39; ap g2 (eisretr q (g1 (i x))) = ap g2 (q1 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk5c"><span class="nb">rewrite</span> &lt;- ap_pp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap g2
  (ap q (ap q^-<span class="mi">1</span> (q1 x)^
         @&#39; eissect q (f1 x))^
   @&#39; eisretr q (g1 (i x))) = ap g2 (q1 x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk5d"><span class="nb">apply</span> ap.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap q (ap q^-<span class="mi">1</span> (q1 x)^
      @&#39; eissect q (f1 x))^
@&#39; eisretr q (g1 (i x)) = q1 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Now we apply the triangle identity [eisadj]. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk5e"><span class="nb">rewrite</span> inv_pp, ap_pp, ap_V.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(ap q (eissect q (f1 x)))^
@&#39; ap q (ap q^-<span class="mi">1</span> (q1 x)^)^
@&#39; eisretr q (g1 (i x)) = q1 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk5f"><span class="nb">rewrite</span> &lt;- eisadj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(eisretr q (q (f1 x)))^
@&#39; ap q (ap q^-<span class="mi">1</span> (q1 x)^)^
@&#39; eisretr q (g1 (i x)) = q1 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    <span class="c">(* Finally, we rearrange and it becomes a naturality square. *)</span>
</span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk60"><span class="nb">rewrite</span> concat_pp_p; <span class="nb">apply</span> moveR_Vp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap q (ap q^-<span class="mi">1</span> (q1 x)^)^
@&#39; eisretr q (g1 (i x)) = eisretr q (q (f1 x))
                          @&#39; q1 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk61"><span class="nb">rewrite</span> &lt;- ap_V, inv_V, &lt;- ap_compose.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B, X, Y</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>i</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1i</var><span class="hyp-type"><b>: </b><span>class1 factsys i</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>X -&gt; Y</span></span></span><br><span><var>c2p</var><span class="hyp-type"><b>: </b><span>class2 factsys p</span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; X</span></span></span><br><span><var>g</var><span class="hyp-type"><b>: </b><span>B -&gt; Y</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>p o f == g o i</span></span></span><br><span><var>C</var><span><span class="hyp-body"><b>:= </b><span>factor factsys f</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>f1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>A -&gt; C</span></span></span></span><br><span><var>f2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>C -&gt; X</span></span></span></span><br><span><var>ff</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys f)</span></span><span class="hyp-type"><b>: </b><span>f2 o f1 == f</span></span></span></span><br><span><var>D</var><span><span class="hyp-body"><b>:= </b><span>factor factsys g</span></span><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span></span><br><span><var>g1</var><span><span class="hyp-body"><b>:= </b><span>factor1 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; D</span></span></span></span><br><span><var>g2</var><span><span class="hyp-body"><b>:= </b><span>factor2 (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>D -&gt; Y</span></span></span></span><br><span><var>gf</var><span><span class="hyp-body"><b>:= </b><span>fact_factors (factor factsys g)</span></span><span class="hyp-type"><b>: </b><span>g2 o g1 == g</span></span></span></span><br><span><var>fact</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) C f1 
  (p o f2) (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; ap p (ff a))
  (inclass1 (factor factsys f))
  (class2_compose factsys f2 p
     (inclass2 (factor factsys f)) c2p)</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>fact'</var><span><span class="hyp-body"><b>:= </b><span>Build_Factorization&#39; (p o f) D 
  (g1 o i) g2 (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; gf (i a)
                      @&#39; (h a)^)
  (class1_compose factsys i g1 c1i
     (inclass1 (factor factsys g)))
  (inclass2 (factor factsys g))</span></span><span class="hyp-type"><b>: </b><span>Factorization (@class1 factsys)
  (@class2 factsys) (p o f)</span></span></span></span><br><span><var>q</var><span><span class="hyp-body"><b>:= </b><span>path_intermediate
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>C &lt;~&gt; D</span></span></span></span><br><span><var>q1</var><span><span class="hyp-body"><b>:= </b><span>path_factor1
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>q o f1 == g1 o i</span></span></span></span><br><span><var>q2</var><span><span class="hyp-body"><b>:= </b><span>path_factor2
  (path_factor factsys (p o f) fact fact&#39;)</span></span><span class="hyp-type"><b>: </b><span>p o f2 == g2 o q</span></span></span></span><br><span><var>x</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ap (<span class="kr">fun</span> <span class="nv">x</span> : D =&gt; q (q^-<span class="mi">1</span> x)) (q1 x)
@&#39; eisretr q (g1 (i x)) = eisretr q (q (f1 x))
                          @&#39; q1 x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (concat_A1p (eisretr q) (q1 x)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Close Scope</span> long_path_scope.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">FactSys</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">FactsysExtensions</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Context</span> {<span class="nv">factsys</span> : FactorizationSystem}.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
  <span class="sd">(** We can deduce the lifting property in terms of extensions fairly easily from the version in terms of commutative squares. *)</span>
</span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk62"><span class="kn">Definition</span> <span class="nf">extension_factsys</span> {<span class="nv">A</span> <span class="nv">B</span> : <span class="kt">Type</span>}
             (<span class="nv">f</span> : A -&gt; B) {<span class="nv">c1f</span> : class1 factsys f}
             (<span class="nv">P</span> : B -&gt; <span class="kt">Type</span>) (<span class="nv">c2P</span> : class2 factsys (@pr1 B P))
             (<span class="nv">d</span> : <span class="kr">forall</span> <span class="nv">a</span>:A, P (f a))
  : ExtensionAlong f P d.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>c2P</var><span class="hyp-type"><b>: </b><span>class2 factsys pr1</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ExtensionAlong f P d</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk63"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>c2P</var><span class="hyp-type"><b>: </b><span>class2 factsys pr1</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (f a)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ExtensionAlong f P d</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk64"><span class="nb">pose</span> (e := lift_factsys factsys f c1f pr1 c2P
                            (<span class="kr">fun</span> <span class="nv">a</span> =&gt; (f a ; d a)) idmap
                            (<span class="kr">fun</span> <span class="nv">a</span> =&gt; <span class="mi">1</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>c2P</var><span class="hyp-type"><b>: </b><span>class2 factsys pr1</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (f a)</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; {x : _ &amp; P x}</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ExtensionAlong f P d</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk65"><span class="nb">pose</span> (e2 := lift_factsys_tri2 factsys f c1f pr1 c2P
                            (<span class="kr">fun</span> <span class="nv">a</span> =&gt; (f a ; d a)) idmap
                            (<span class="kr">fun</span> <span class="nv">a</span> =&gt; <span class="mi">1</span>)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>c2P</var><span class="hyp-type"><b>: </b><span>class2 factsys pr1</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (f a)</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; {x : _ &amp; P x}</span></span></span></span><br><span><var>e2</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys_tri2 factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>pr1
o lift_factsys factsys f c1f pr1 c2P
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) == idmap</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ExtensionAlong f P d</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk66"><span class="kr">exists</span> (<span class="nv">fun</span> <span class="nv">a</span> =&gt; (e2 a) # (e a).<span class="mi">2</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>c2P</var><span class="hyp-type"><b>: </b><span>class2 factsys pr1</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (f a)</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; {x : _ &amp; P x}</span></span></span></span><br><span><var>e2</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys_tri2 factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>pr1
o lift_factsys factsys f c1f pr1 c2P
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) == idmap</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">x</span> : A, transport P (e2 (f x)) (e (f x)).<span class="mi">2</span> = d x</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk67"><span class="nb">intros</span> a.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>c2P</var><span class="hyp-type"><b>: </b><span>class2 factsys pr1</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (f a)</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; {x : _ &amp; P x}</span></span></span></span><br><span><var>e2</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys_tri2 factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>pr1
o lift_factsys factsys f c1f pr1 c2P
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) == idmap</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport P (e2 (f a)) (e (f a)).<span class="mi">2</span> = d a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk68"><span class="nb">pose</span> (e1 := lift_factsys_tri1 factsys f c1f pr1 c2P
                            (<span class="kr">fun</span> <span class="nv">a</span> =&gt; (f a ; d a)) idmap
                            (<span class="kr">fun</span> <span class="nv">a</span> =&gt; <span class="mi">1</span>) a
                : e (f a) = (f a ; d a)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>c2P</var><span class="hyp-type"><b>: </b><span>class2 factsys pr1</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (f a)</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; {x : _ &amp; P x}</span></span></span></span><br><span><var>e2</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys_tri2 factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>pr1
o lift_factsys factsys f c1f pr1 c2P
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) == idmap</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>e1</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys_tri1 factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) a
:
e (f a) = (f a; d a)</span></span><span class="hyp-type"><b>: </b><span>e (f a) = (f a; d a)</span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport P (e2 (f a)) (e (f a)).<span class="mi">2</span> = d a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk69"><span class="nb">pose</span> (e3 := moveL_M1 _ _ (((ap_V _ _)^ @@ <span class="mi">1</span>)
                @ lift_factsys_square factsys f c1f pr1 c2P
                            (<span class="kr">fun</span> <span class="nv">a</span> =&gt; (f a ; d a)) idmap
                            (<span class="kr">fun</span> <span class="nv">a</span> =&gt; <span class="mi">1</span>) a)
                : e2 (f a) = pr1_path e1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>c2P</var><span class="hyp-type"><b>: </b><span>class2 factsys pr1</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (f a)</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; {x : _ &amp; P x}</span></span></span></span><br><span><var>e2</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys_tri2 factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>pr1
o lift_factsys factsys f c1f pr1 c2P
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) == idmap</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>e1</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys_tri1 factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) a
:
e (f a) = (f a; d a)</span></span><span class="hyp-type"><b>: </b><span>e (f a) = (f a; d a)</span></span></span></span><br><span><var>e3</var><span><span class="hyp-body"><b>:= </b><span>moveL_M1
  (lift_factsys_tri2 factsys f c1f pr1 c2P
     (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
     (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) (f a))
  (ap pr1
     (lift_factsys_tri1 factsys f c1f pr1 c2P
        (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
        (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) a))
  (((ap_V pr1
       (lift_factsys_tri1 factsys f c1f pr1 c2P
          (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
          (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) a))^ @@ <span class="mi">1</span>) @
   lift_factsys_square factsys f c1f pr1 c2P
     (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
     (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) a)
:
e2 (f a) = e1 ..<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span>e2 (f a) = e1 ..<span class="mi">1</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport P (e2 (f a)) (e (f a)).<span class="mi">2</span> = d a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="factorization-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="factorization-v-chk6a"><span class="nb">refine</span> (ap (<span class="kr">fun</span> <span class="nv">p</span> =&gt; transport P p (e (f a)).<span class="mi">2</span>) e3 @ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>factsys</var><span class="hyp-type"><b>: </b><span>FactorizationSystem</span></span></span><br><span><var>A, B</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span></span></span></span><br><span><var>f</var><span class="hyp-type"><b>: </b><span>A -&gt; B</span></span></span><br><span><var>c1f</var><span class="hyp-type"><b>: </b><span>class1 factsys f</span></span></span><br><span><var>P</var><span class="hyp-type"><b>: </b><span>B -&gt; <span class="kt">Type</span></span></span></span><br><span><var>c2P</var><span class="hyp-type"><b>: </b><span>class2 factsys pr1</span></span></span><br><span><var>d</var><span class="hyp-type"><b>: </b><span><span class="kr">forall</span> <span class="nv">a</span> : A, P (f a)</span></span></span><br><span><var>e</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>B -&gt; {x : _ &amp; P x}</span></span></span></span><br><span><var>e2</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys_tri2 factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>)</span></span><span class="hyp-type"><b>: </b><span>pr1
o lift_factsys factsys f c1f pr1 c2P
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
    (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) == idmap</span></span></span></span><br><span><var>a</var><span class="hyp-type"><b>: </b><span>A</span></span></span><br><span><var>e1</var><span><span class="hyp-body"><b>:= </b><span>lift_factsys_tri1 factsys f c1f pr1 c2P
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap 
  (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) a
:
e (f a) = (f a; d a)</span></span><span class="hyp-type"><b>: </b><span>e (f a) = (f a; d a)</span></span></span></span><br><span><var>e3</var><span><span class="hyp-body"><b>:= </b><span>moveL_M1
  (lift_factsys_tri2 factsys f c1f pr1 c2P
     (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
     (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) (f a))
  (ap pr1
     (lift_factsys_tri1 factsys f c1f pr1 c2P
        (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
        (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) a))
  (((ap_V pr1
       (lift_factsys_tri1 factsys f c1f pr1 c2P
          (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
          (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) a))^ @@ <span class="mi">1</span>) @
   lift_factsys_square factsys f c1f pr1 c2P
     (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; (f a; d a)) idmap
     (<span class="kr">fun</span> <span class="nv">a</span> : A =&gt; <span class="mi">1</span>) a)
:
e2 (f a) = e1 ..<span class="mi">1</span></span></span><span class="hyp-type"><b>: </b><span>e2 (f a) = e1 ..<span class="mi">1</span></span></span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">transport P e1 ..<span class="mi">1</span> (e (f a)).<span class="mi">2</span> = d a</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">exact</span> (pr2_path e1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Defined</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">FactsysExtensions</span>.</span></span></pre>
</div>
</div></body>
</html>
