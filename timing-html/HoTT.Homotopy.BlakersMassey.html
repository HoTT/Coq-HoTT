<html>
<head>
<title>BlakersMassey.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for BlakersMassey.v</h1>

<div class="code" title="File: BlakersMassey.v
Line: 1
Time: 0.043s">
<div class="time" style="width: 50%"></div>
<pre>Require Import HoTT.Basics HoTT.Types HFiber.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 1
Time: 0.018s">
<div class="time" style="width: 20.93023255814%"></div>
<pre>
Require Import Colimits.Pushout.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 2
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
Require Import Colimits.SpanPushout.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 3
Time: 0.027s">
<div class="time" style="width: 31.395348837209%"></div>
<pre>
Require Import Homotopy.Suspension.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Limits.Pullback.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 5
Time: 0.009s">
<div class="time" style="width: 10.46511627907%"></div>
<pre>
Require Import Homotopy.Join.Core.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 6
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>
Require Import Truncations.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * The Generalized Blakers-Massey Theorem *)

(** This file follows the paper "A Generalized Blakers-Massey Theorem" (https://arxiv.org/abs/1703.09050) by Mathieu Anel, Georg Biedermann, Eric Finster, Andr√© Joyal, hereafter referred to as ABFJ. We also follow "A Mechanization of the Blakers-Massey Connectivity Theorem in Homotopy Type Theory" by Favonia, Eric Finster, Dan Licata, and Peter LeFanu Lumsdaine, hereafter referred to as HFLL. *)

(** ** Path algebra helper lemma *)

(** Here is a strange-looking path algebra helper lemma that is easier to prove by lifting to a general case and doing a path-induction blast.  It says something about what happens when we transport from the center of a based path-space to some other point, assuming we know a particular way to "compute" the action of the type family in question. *)

</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 16
Time: 0.006s">
<div class="time" style="width: 6.9767441860465%"></div>
<pre>Definition transport_singleton `{Univalence}
           {A : Type} {x : A} (B : forall (y : A), (x = y) -&gt; Type)
           {y : A} (p : x = y) (u : B x idpath)
           (f : forall (q:x=x), B x q &lt;~&gt; B y (q @ p))
           (ev : ap10 (apD B p) p =
   transport_arrow_toconst p (B x) p @
   path_universe_uncurried
     (@equiv_transport _ (B y) ((p @ p^) @ p) p (concat_pV_p p p)
      oE (f (p @ p^))
      oE @equiv_transport _ (B x)
           (transport (fun y =&gt; x = y) p^ p)
           (p @ p^) (transport_paths_r p^ p)))
  : transport (fun yp:{y:A &amp; x=y} =&gt; B yp.1 yp.2)
              (path_contr (A := {y:A &amp; x=y}) (x;idpath) (y;p)) u
    = transport (B y) (concat_1p _) (f idpath u).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 31
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
  destruct p; cbn in *.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (fun e =&gt; e @ concat_1p _) in ev.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 33
Time: 0.007s">
<div class="time" style="width: 8.1395348837209%"></div>
<pre>
  apply moveR_equiv_V in ev.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (ap equiv_fun) in ev.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply ap10 in ev.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  specialize (ev u).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  cbn in ev.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact ev.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 39
Time: 0.006s">
<div class="time" style="width: 6.9767441860465%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Setup *)

</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section GBM.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context {X Y : Type} (Q : X -&gt; Y -&gt; Type).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Here's the hypothesis of ABFJ's generalized Blakers-Massey theorem.  It works for any reflective subuniverse, not only modalities!  In the application, [O] will be [Tr (n +2+ m)] and we'll use [isconnected_join] to verify [isconnected_cogap]. *)
   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context (O : ReflectiveSubuniverse).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 47
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
    Context
      (isconnected_cogap :
         forall (x1 x3 : X) (y2 y4 : Y)
                (q12 : Q x1 y2) (q32 : Q x3 y2) (q34 : Q x3 y4),
           IsConnected O (Join ((x1;q12) = (x3;q32) :&gt; {x:X &amp; Q x y2})
                               ((y2;q32) = (y4;q34) :&gt; {y:Y &amp; Q x3 y}))).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Let P := SPushout Q.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Local Notation left := (spushl Q).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Local Notation right := (spushr Q).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Local Notation glue := (spglue Q).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Here's a lemma that's a sort of "singleton contractibility" equivalence, but expressed in a particularly strange way.  As we'll see, this form of the lemma comes up naturally *twice* in the proof, and proving it once here to use in both places is crucial so that the two uses can be identified later on. *)

   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 62
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Local Definition frobnicate {x0 x1 : X} (r : left x0 = left x1)
          (s : x0 = x1) (y : Y) (q1 : Q x1 y)
      : {q0 : Q x0 y &amp;
              {w : transport (fun x =&gt; Q x y) s q0 = q1 &amp;
                   glue q0 @ (glue q1)^ = r } }
          &lt;~&gt; ap left s = r.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE equiv_sigma_assoc' _ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 69
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
      refine (_ oE equiv_functor_sigma'
                (Q := fun qt =&gt; glue qt.1 @ (glue q1)^ = r)
                (equiv_functor_sigma_id
                   (fun q0 : Q x0 y =&gt;
                      equiv_moveL_transport_V
                        (fun x =&gt; Q x y) s q0 q1))
                (fun qt =&gt; equiv_idmap)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 76
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>
      refine (_ oE equiv_contr_sigma _); cbn.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 77
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
      rewrite (ap_transport s^ (fun x q =&gt; glue q) q1).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 78
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
      rewrite (transport_paths_FlFr s^ (glue q1)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 79
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>
      rewrite ap_V, inv_V, ap_const, concat_p1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (equiv_concat_l (concat_pp_V _ _)^ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** Although we proved this lemma with [rewrite], we make it transparent, not so that *we* can reason about it, but so that Coq can evaluate it. *)
   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 83
Time: 0.006s">
<div class="time" style="width: 6.9767441860465%"></div>
<pre>Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (* But except in one place, we don't want it to try (otherwise things get really slow). *)
   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Opaque frobnicate.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Codes *)

    (** *** Right-hand codes *)

    (** The right-hand codes family is easy. *)
   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 92
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Definition coderight {x0 : X} {y : Y} (r : left x0 = right y) : Type
      := O (hfiber glue r).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** Left-hand codes *)

    (** We enhance the HFLL and ABFJ theorems by defining a version of code-left that doesn't depend on one map being surjective. *)

   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section CodeLeft.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Context {x0 x1 : X} (r : left x0 = left x1).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

      (** The left codes are themselves a pushout, of what is morally also a dependent span, but we formulate it as an ordinary pushout of projections between iterated Sigma-types, most of which we express as records for performance reasons.  The span is [codeleft1] &lt;- [codeleft0] -&gt; [codeleft2]. *)

     </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition codeleft1 : Type
        := { s : x0 = x1 &amp;
          (* v : *) ap left s = r}.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 106
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>

      Record codeleft2
        := { codeleft2_y0  : Y ;
             codeleft2_q00 : Q x0 codeleft2_y0 ;
             codeleft2_q10 : Q x1 codeleft2_y0 ;
             codeleft2_u   : glue codeleft2_q00 @ (glue codeleft2_q10)^ = r }.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 112
Time: 0.006s">
<div class="time" style="width: 6.9767441860465%"></div>
<pre>

      Record codeleft0
        := { codeleft0_s   : x0 = x1 ;
             codeleft0_y0  : Y ;
             codeleft0_v   : ap left codeleft0_s = r ;
             codeleft0_q00 : Q x0 codeleft0_y0 ;
             codeleft0_q10 : Q x1 codeleft0_y0 ;
             codeleft0_w   : transport (fun x =&gt; Q x codeleft0_y0) codeleft0_s codeleft0_q00
                             = codeleft0_q10 ;
             codeleft0_u   : glue codeleft0_q00 @ (glue codeleft0_q10)^ = r ;
                   (** Note the first use of frobnicate here. *)
             codeleft0_d   : frobnicate r codeleft0_s codeleft0_y0 codeleft0_q10
                                        (codeleft0_q00 ; codeleft0_w ; codeleft0_u) = codeleft0_v }.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

      Definition codeleft01 : codeleft0 -&gt; codeleft1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        intros [s y0 v q00 q10 w u d].</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (s;v).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

      Definition codeleft02 : codeleft0 -&gt; codeleft2.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 134
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        intros [s y0 v q00 q10 w u d].</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (Build_codeleft2 y0 q00 q10 u).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

      Definition codeleft : Type
        := O (Pushout codeleft01 codeleft02).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

      (** *** Codes for glue *)

     </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section CodeGlue.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Context {y1 : Y} (q11 : Q x1 y1).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        (** We prove that codes respect glue as a chain of equivalences between types built from pushouts and double-pushouts.  The first step is to add the data of our hypothesized-to-be-connected type inside [codeleft2]. *)

       </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 149
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Definition codeleft2plus :=
          {yqqu : codeleft2 &amp;
                  Join ((x0; codeleft2_q00 yqqu) = (x1; codeleft2_q10 yqqu)
                                           :&gt; {x:X &amp; Q x (codeleft2_y0 yqqu)})
                       ((codeleft2_y0 yqqu; codeleft2_q10 yqqu) = (y1; q11)
                                           :&gt; {y:Y &amp; Q x1 y})}.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        (** Since this connected type is itself a join, hence a pushout, the second step is to distribute this and re-express the whole thing as another pushout of iterated Sigma-types (again mostly expressed as records for performance reasons). *)

       </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 158
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>Record Ocodeleft2b
        := { Ocodeleft2b_s   : x0 = x1 ;
             Ocodeleft2b_y0  : Y ;
             Ocodeleft2b_q00 : Q x0 Ocodeleft2b_y0 ;
             Ocodeleft2b_q10 : Q x1 Ocodeleft2b_y0 ;
             Ocodeleft2b_w   : transport (fun x =&gt; Q x Ocodeleft2b_y0) Ocodeleft2b_s Ocodeleft2b_q00
                               = Ocodeleft2b_q10 ;
             Ocodeleft2b_u   : glue Ocodeleft2b_q00 @ (glue Ocodeleft2b_q10)^ = r }.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        Definition Ocodeleft2c
          := { q01 : Q x0 y1 &amp;
            (* u: *) glue q01 @ (glue q11)^ = r }.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 169
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>

        Record Ocodeleft2a
        := { Ocodeleft2a_s   : x0 = x1 ;
             Ocodeleft2a_q01 : Q x0 y1 ;
             Ocodeleft2a_w   : transport (fun x =&gt; Q x y1) Ocodeleft2a_s Ocodeleft2a_q01 = q11 ;
             Ocodeleft2a_u   : glue Ocodeleft2a_q01 @ (glue q11)^ = r }.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        Definition Ocodeleft2ab : Ocodeleft2a -&gt; Ocodeleft2b.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          intros [s q01 w u].</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          exact (Build_Ocodeleft2b s y1 q01 q11 w u).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        Definition Ocodeleft2ac : Ocodeleft2a -&gt; Ocodeleft2c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          intros [s q01 w u].</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          exact (q01;u).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        (** This proof is basically just rearranging Sigma-types/records and paths in Sigma-types and contracting based path spaces. *)
       </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition equiv_Ocodeleft2plus
          : Pushout Ocodeleft2ab Ocodeleft2ac &lt;~&gt; codeleft2plus.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine ((equiv_sigma_pushout _ _ _ _ _)^-1 oE _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          srefine (equiv_pushout _ _ _ _ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> srefine (equiv_functor_sigma_id _ oE _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
            2:intro; refine (equiv_functor_prod' _ _); apply equiv_path_sigma.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 196
Time: 0.08s">
<div class="time" style="width: 93.023255813953%"></div>
<pre>
            make_equiv_contr_basedpaths.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> srefine (equiv_functor_sigma_id _ oE _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
            2:intro; apply equiv_path_sigma.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 199
Time: 0.008s">
<div class="time" style="width: 9.3023255813953%"></div>
<pre>
            make_equiv.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> srefine (equiv_functor_sigma_id _ oE _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
            2:intro; apply equiv_path_sigma.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 202
Time: 0.035s">
<div class="time" style="width: 40.697674418605%"></div>
<pre>
            make_equiv_contr_basedpaths.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 204
Time: 0.019s">
<div class="time" style="width: 22.093023255814%"></div>
<pre> intros; reflexivity.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 205
Time: 0.019s">
<div class="time" style="width: 22.093023255814%"></div>
<pre> intros; reflexivity.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 205
Time: 0.071s">
<div class="time" style="width: 82.558139534884%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        (** Now we combine this equivalence with the insertion of our connected type. *)
       </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition equiv_Ocodeleft2
          : O (Pushout Ocodeleft2ab Ocodeleft2ac) &lt;~&gt; O codeleft2.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (_ oE equiv_O_functor O equiv_Ocodeleft2plus).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (_ oE (equiv_O_sigma_O O _)^-1).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply equiv_O_functor.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 214
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
          rapply equiv_sigma_contr.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 215
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        (** The next step is to reassociate the resulting double-pushout and "contract" both of them, one after the other, because they are pushouts along equivalences.  In order to do this, we need first of all to know that the resulting map from [codeleft0] to the above pushout factors through [Ocodeleft2b] via an equivalence.  Here's the equivalence: *)

       </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Ocodeleft02b : codeleft0 &lt;~&gt; Ocodeleft2b.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 221
Time: 0.011s">
<div class="time" style="width: 12.790697674419%"></div>
<pre>
          make_equiv_contr_basedpaths.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 222
Time: 0.01s">
<div class="time" style="width: 11.627906976744%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        Definition Ocodeleft02 (c : codeleft0)
          : Pushout Ocodeleft2ab Ocodeleft2ac
          := pushl' Ocodeleft2ab Ocodeleft2ac (Ocodeleft02b c).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        Definition Ocodeleft02plus_02b (c : codeleft0)
          : (equiv_Ocodeleft2plus (Ocodeleft02 c)).1 = codeleft02 c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          destruct c; reflexivity.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 232
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
        Qed.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        (** And here we show that this equivalence is indeed a factor of the relevant map in the original pushout. *)

       </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Ocodeleft02_02b (c : codeleft0)
          : equiv_Ocodeleft2 (to O _ (Ocodeleft02 c)) = to O _ (codeleft02 c).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          destruct c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 240
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold equiv_Ocodeleft2.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          Opaque equiv_Ocodeleft2plus.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 242
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
          cbn.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (ap _ (ap _ (to_O_natural _ _ _)) @ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (ap _ (to_O_natural _ _ _) @ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          refine (to_O_natural _ _ _ @ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply ap.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          rapply Ocodeleft02plus_02b.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 248
Time: 0.01s">
<div class="time" style="width: 11.627906976744%"></div>
<pre>
        Qed.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        (** Thus, our pushout in which one vertex is itself a pushout can be written as a "double pushout"

[codeleft1] &lt;- [codeleft0] -&gt; [codeleft2b] &lt;- [codeleft2a] -&gt; [codeleft2c].

Since the map [codeleft0] -&gt; [codeleft2b] is an equivalence, the pushout of the left-hand span is equivalent to [codeleft1], and thus the whole thing is equivalent to a pushout

[codeleft1] &lt;- [codeleft2a] -&gt; [codeleft2c]

Now we claim that the left-hand map of this span is also an equivalence.  Rather than showing this directly, it seems to be much easier to first construct *an* equivalence from [codeleft2a] to [codeleft1] and then show that it is equal (as a function) to the induced one.  Here's the equivalence: *)

       </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Ocodeleft2a1 : Ocodeleft2a &lt;~&gt; codeleft1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 262
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          etransitivity.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          2:{</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rapply equiv_functor_sigma_id; intros s.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
              (** Here's frobnicate showing up again! *)
             </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>apply frobnicate.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 266
Time: 0.01s">
<div class="time" style="width: 11.627906976744%"></div>
<pre>
          make_equiv.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 267
Time: 0.006s">
<div class="time" style="width: 6.9767441860465%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        (** And now we check that the two are equal.  Because we used the same proof of [frobnicate] in two places, this equality becomes definitional after simply decomposing up a Sigma-type! *)
       </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 271
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Definition Ocodeleft2a1_through_2b0
          : Ocodeleft2a1 == codeleft01 o Ocodeleft02b^-1 o Ocodeleft2ab.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          intros; reflexivity.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 274
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 275
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        (** Now we're finally ready to prove the glue equivalence.  Since later on we'll have to compute its action on inputs from [codeleft1], we decompose it into seven steps, each of which with a corresponding computation lemma.  (These lemmas seem to be much easier to prove step-by-step than all at once if we proved the whole equivalence in a big shebang.) *)

       </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 279
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition codeglue1
          : codeleft &lt;~&gt; O (Pushout (O_functor O codeleft01)
                                    (O_functor O codeleft02))
        := equiv_O_pushout O _ _.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 282
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>

        Definition codeglue1_pushl (s : x0 = x1) (v : ap left s = r)
          : codeglue1 (to O _ (pushl (s;v))) =
            to O _ (pushl (to O _ (s; v)))
          := equiv_O_pushout_to_O_pushl _ _ _ _.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        Definition codeglue2
          : O (Pushout (O_functor O codeleft01) (O_functor O codeleft02))
        &lt;~&gt; O (Pushout (O_functor O codeleft01) (O_functor O Ocodeleft02)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          srefine (equiv_O_functor O
                    (equiv_inverse
                    (equiv_pushout (f := O_functor O codeleft01)
                                   (g := O_functor O Ocodeleft02)
                                   1%equiv 1%equiv equiv_Ocodeleft2 _ _))).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x; reflexivity.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_indpaths; intros x.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 299
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>
            abstract (rewrite !to_O_natural; apply Ocodeleft02_02b).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 300
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 301
Time: 0.004s">
<div class="time" style="width: 4.6511627906977%"></div>
<pre>

        Definition codeglue2_pushl (s : x0 = x1) (v : ap left s = r)
          : codeglue2 (to O _ (pushl (to O _ (s;v))))
            = to O _ (pushl (to O _ (s;v)))
          := to_O_equiv_natural _ _ _.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 306
Time: 0.003s">
<div class="time" style="width: 3.4883720930233%"></div>
<pre>

        Definition codeglue3
          : O (Pushout (O_functor O codeleft01) (O_functor O Ocodeleft02))
              &lt;~&gt; O (Pushout codeleft01 Ocodeleft02)
          := equiv_inverse (equiv_O_pushout O _ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 311
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>

        Definition codeglue3_pushl (s : x0 = x1) (v : ap left s = r)
          : codeglue3 (to O _ (pushl (to O _ (s;v))))
            = to O _ (pushl (s;v))
          := inverse_equiv_O_pushout_to_O_pushl _ _ _ _.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 316
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>

        Definition codeglue4
          : O (Pushout codeleft01 Ocodeleft02)
            &lt;~&gt; O (Pushout
                     (fun x : Ocodeleft2a =&gt;
                        pushr' codeleft01 Ocodeleft02b (Ocodeleft2ab x))
                     Ocodeleft2ac)
          := equiv_O_functor O (equiv_inverse (equiv_pushout_assoc _ _ _ _)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 324
Time: 0.003s">
<div class="time" style="width: 3.4883720930233%"></div>
<pre>

        Definition codeglue4_pushl (s : x0 = x1) (v : ap left s = r)
          : codeglue4 (to O _ (pushl (s;v)))
            = to O _ (pushl (pushl (s;v)))
          := to_O_equiv_natural _ _ _.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        Definition codeglue5
          : O (Pushout
                 (fun x : Ocodeleft2a =&gt;
                    pushr' codeleft01 Ocodeleft02b (Ocodeleft2ab x))
                 Ocodeleft2ac)
        &lt;~&gt; O (Pushout Ocodeleft2a1 Ocodeleft2ac).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          srefine (equiv_O_functor O
                     (equiv_inverse
                        (equiv_pushout (f := Ocodeleft2a1) (g := Ocodeleft2ac)
                                       1%equiv _ 1%equiv _ _))).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 342
Time: 0.003s">
<div class="time" style="width: 3.4883720930233%"></div>
<pre> exact (Build_Equiv _ _ (pushl' codeleft01 Ocodeleft02b) _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
            refine (ap _ (Ocodeleft2a1_through_2b0 x) @ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
            refine (pglue' codeleft01 Ocodeleft02b _ @ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
            apply ap, eisretr.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 346
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x; reflexivity.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 347
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 348
Time: 0.005s">
<div class="time" style="width: 5.8139534883721%"></div>
<pre>

        Definition codeglue5_pushl (s : x0 = x1) (v : ap left s = r)
          : codeglue5 (to O _ (pushl (pushl (s;v))))
            = to O _ (pushl (s;v))
        := to_O_equiv_natural _ _ _.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 353
Time: 0.004s">
<div class="time" style="width: 4.6511627906977%"></div>
<pre>

        Definition codeglue6
          : O (Pushout Ocodeleft2a1 Ocodeleft2ac) &lt;~&gt; O Ocodeleft2c
          := equiv_O_functor
               O (equiv_inverse
                    (Build_Equiv _ _ (pushr' Ocodeleft2a1 Ocodeleft2ac) _)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 359
Time: 0.006s">
<div class="time" style="width: 6.9767441860465%"></div>
<pre>

        Definition codeglue6_pushl (s : x0 = x1) (v : ap left s = r)
          : codeglue6 (to O _ (pushl (s;v)))
            = let z := (frobnicate r s y1 q11)^-1 v in
              to O Ocodeleft2c (Ocodeleft2ac (Build_Ocodeleft2a s z.1 z.2.1 z.2.2))
          := to_O_equiv_natural _ _ _.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 365
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

        Definition codeglue7
          : O Ocodeleft2c &lt;~&gt; coderight (r @ glue q11).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 368
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 369
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold coderight, Ocodeleft2c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply equiv_O_functor.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 371
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply equiv_functor_sigma_id; intros q01.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 372
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply equiv_moveL_pM.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 373
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 374
Time: 0.005s">
<div class="time" style="width: 5.8139534883721%"></div>
<pre>

        Definition codeglue7_to_O
                   (q01 : Q x0 y1) (u : glue q01 @ (glue q11)^ = r)
          : codeglue7 (to O _ (q01;u))
            = to O (hfiber glue (r @ glue q11))
                 (q01 ; moveL_pM (glue q11) (glue q01) r u)
          := to_O_equiv_natural _ _ _.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 381
Time: 0.003s">
<div class="time" style="width: 3.4883720930233%"></div>
<pre>

        Definition codeglue
          : codeleft &lt;~&gt; coderight (r @ glue q11)
          := codeglue7 oE
             codeglue6 oE
             codeglue5 oE
             codeglue4 oE
             codeglue3 oE
             codeglue2 oE
             codeglue1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 391
Time: 0.01s">
<div class="time" style="width: 11.627906976744%"></div>
<pre>

      End CodeGlue.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 393
Time: 0.019s">
<div class="time" style="width: 22.093023255814%"></div>
<pre>

    End CodeLeft.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** Completion of codes *)

   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context `{Univalence}.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context (x0 : X).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The equivalence [codeglue] requires a bit of massaging to put it into the form needed by the actual definition of [code] from pushout-induction and univalence. *)

   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 404
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Definition ap_code_glue (x1 : X) (y1 : Y) (q11 : Q x1 y1)
      : transport (fun p : SPushout Q =&gt; left x0 = p -&gt; Type)
                  (glue q11) codeleft
        = coderight.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_arrow; intros z.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 409
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine ((transport_arrow_toconst _ _ _) @ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 410
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_universe_uncurried.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE equiv_transport codeleft (transport_paths_r _ _)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ oE codeglue _ q11).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 413
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (equiv_transport coderight _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 414
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (concat_pV_p z (glue q11)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 415
Time: 0.011s">
<div class="time" style="width: 12.790697674419%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 416
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Here's the final definition of [code]. *)

   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 420
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Definition code (p : P) (r : left x0 = p) : Type
        := spushout_ind Q (fun p =&gt; left x0 = p -&gt; Type)
                        (@codeleft x0) (@coderight x0)
                        ap_code_glue p r.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 423
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** When we compute with [code], we'll need to extract from it the actual behavior of the function [codeglue].  Here's the mess of path algebra that we "naturally" get out when we try to do that; later we'll see how to deal with it. *)
   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 426
Time: 0.006s">
<div class="time" style="width: 6.9767441860465%"></div>
<pre>Definition code_beta_glue (x1 : X) (y1 : Y) (q11 : Q x1 y1)
               (r : left x0 = right y1)
      : ap10 (apD code (glue q11)) r
        = transport_arrow_toconst (glue q11) codeleft r
        @ path_universe_uncurried
           (@equiv_transport _ coderight ((r @ (glue q11)^) @ glue q11) r
                            (concat_pV_p r (glue q11))
            oE (codeglue (r @ (glue q11)^) q11)
            oE @equiv_transport _ codeleft
                 (transport (fun y : SPushout Q =&gt; left x0 = y) (glue q11)^ r)
                 (r @ (glue q11)^) (transport_paths_r (glue q11)^ r)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 436
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 437
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>
      refine (ap (fun h =&gt; ap10 h r)
             (spushout_ind_beta_spglue Q (fun p =&gt; left x0 = p -&gt; Type)
                                  (@codeleft x0) (@coderight x0)
                                  ap_code_glue
                                  x1 y1 q11) @ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 442
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (ap10_path_arrow _ _ _ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 443
Time: 0.005s">
<div class="time" style="width: 5.8139534883721%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 444
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Contractibility of codes *)

    (** To construct a center for every type of codes, we construct one in an easy case and transport it around. *)

   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition center_code1 : code (left x0) 1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 451
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      change (codeleft (idpath (left x0))).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 452
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold codeleft.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply to, pushl.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold codeleft1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (idpath; idpath).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 456
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 457
Time: 0.007s">
<div class="time" style="width: 8.1395348837209%"></div>
<pre>

    Definition center_code (p : P) (r : left x0 = p) : code p r
      := transport (fun (pr : {p : P &amp; left x0 = p}) =&gt; code pr.1 pr.2)
                   (path_contr (A := {p : P &amp; left x0 = p})
                               (left x0; idpath) (p;r))
                   center_code1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 463
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** As in HFLL, we first construct a contraction in the "partially general" case of an arbitrary path from left to right. *)

   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 467
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Definition contraction_code_right (y1 : Y) (r : left x0 = right y1)
               (c : code (right y1) r)
      : center_code (right y1) r = c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 469
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 470
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      change (coderight r) in c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 471
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold coderight in c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 472
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
      revert c; refine (O_indpaths _ _ _); intros [q01 t].</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 473
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold center_code, center_code1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 474
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** Here's how we use the apparently-unmanageable [code_beta_glue].  First we destruct the path [t] to make things simpler. *)
     </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 476
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>destruct t.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 476
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** Then we notice that if we tried rewriting with [code_beta_glue] here, the unmanageable-looking result is actually fully general over the path [glue q01], so we can prove by path induction that it equals the nicer expression we'd like to see.  This is the purpose of the lemma [transport_singleton]. *)
     </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 478
Time: 0.004s">
<div class="time" style="width: 4.6511627906977%"></div>
<pre>rewrite (transport_singleton
                 code (glue q01) _
                 (fun r =&gt; @codeglue x0 x0 r y1 q01)
                 (code_beta_glue x0 y1 q01 (glue q01))).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 481
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold codeglue.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 482
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** Now we evaluate [codeglue] step by step using our lemmas. *)
     </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 484
Time: 0.008s">
<div class="time" style="width: 9.3023255813953%"></div>
<pre>do 6 change_apply_equiv_compose.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 484
Time: 0.027s">
<div class="time" style="width: 31.395348837209%"></div>
<pre>
      rewrite codeglue1_pushl, codeglue2_pushl, codeglue3_pushl,
      codeglue4_pushl, codeglue5_pushl, codeglue6_pushl, codeglue7_to_O.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 486
Time: 0.005s">
<div class="time" style="width: 5.8139534883721%"></div>
<pre>
      rewrite &lt;- (ap_transport (concat_1p (glue q01))
                               (fun r =&gt; to O (hfiber glue r)) _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 488
Time: 0.003s">
<div class="time" style="width: 3.4883720930233%"></div>
<pre>
      apply ap; unfold hfiber; rewrite transport_sigma'.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 489
Time: 0.008s">
<div class="time" style="width: 9.3023255813953%"></div>
<pre>
      apply ap; rewrite transport_paths_r.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 490
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (** Finally, we have another terrible-looking thing involving [frobnicate].  However, there are enough identity paths that [frobnicate] evaluates to something we can prove with path-induction. *)
     </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 492
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Transparent frobnicate.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 492
Time: 0.022s">
<div class="time" style="width: 25.581395348837%"></div>
<pre>
      simpl.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 493
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      Opaque frobnicate.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 494
Time: 0.007s">
<div class="time" style="width: 8.1395348837209%"></div>
<pre>
      destruct (glue q01); reflexivity.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 495
Time: 0.086s">
<div class="time" style="width: 100%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** It should be possible to prove an analogous [contraction_code_left] directly, but for now we follow HFLL and ABFJ by introducing a surjectivity assumption. *)

   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 500
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Definition contraction_code {y0 : Y} (q00 : Q x0 y0)
               (pr : { p : P &amp; left x0 = p }) (c : code pr.1 pr.2)
      : center_code pr.1 pr.2 = c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      revert c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 504
Time: 0.007s">
<div class="time" style="width: 8.1395348837209%"></div>
<pre>
      srefine (transport (fun pr' =&gt; forall c, center_code pr'.1 pr'.2 = c)
                         (path_contr (right y0 ; glue q00) pr) _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      clear pr; cbn; intros c.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 507
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply contraction_code_right.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 508
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 509
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition contr_code_inhab (inh : merely { y0 : Y &amp; Q x0 y0 })
               (p : P) (r : left x0 = p)
      : Contr (code p r).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 513
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 514
Time: 0.009s">
<div class="time" style="width: 10.46511627907%"></div>
<pre>
      strip_truncations.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct inh as [y0 q00].</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 516
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (Build_Contr _ (center_code p r) (contraction_code q00 (p;r))).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 517
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 518
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** This version is sufficient for the classical Blakers-Massey theorem, as we'll see below, since its leg-wise connectivity hypothesis implies the above surjectivity assumption.  Anel-Biedermann-Finster-Joyal have a different method for eliminating the surjectivity assumption using a lemma about pushouts of monos also being pullbacks, though it seems to only work for coderight. *)

</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 521
Time: 0.085s">
<div class="time" style="width: 98.837209302326%"></div>
<pre>End GBM.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 521
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** The classical Blakers-Massey Theorem *)

(** We first state a version that gracefully extends to the bottom by assuming that path types in [{ x : X &amp; Q x y }] are connected rather than the types themselves. *)</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 525
Time: 0.053s">
<div class="time" style="width: 61.627906976744%"></div>
<pre>Definition blakers_massey_connected_paths `{Univalence}
  (m n : trunc_index) {X Y : Type} (Q : X -&gt; Y -&gt; Type)
  `{forall x, IsConnected m.+1 { y : Y &amp; Q x y }}
  `{forall y x1 qx1y x2 qx2y, IsConnected n ((x1; qx1y) = (x2; qx2y) :&gt; { x : X &amp; Q x y })}
  (x : X) (y : Y)
  : IsConnMap (n +2+ m) (@spglue X Y Q x y)
  := contr_code_inhab Q (n +2+ m) _ x (merely_isconnected m _) (spushr Q y).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 531
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* Typeclass search finds [isconnected_join]. *)

(** Here is the classical statement where we instead assume that the types are connected.  [m] and [n] here match the usage in the previous result. *)</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 534
Time: 0.012s">
<div class="time" style="width: 13.953488372093%"></div>
<pre>Instance blakers_massey `{Univalence}
  (m n : trunc_index) {X Y : Type} (Q : X -&gt; Y -&gt; Type)
  `{forall x, IsConnected m.+1 { y : Y &amp; Q x y }}
  `{forall y, IsConnected n.+1 { x : X &amp; Q x y }}
  (x : X) (y : Y)
  : IsConnMap (n +2+ m) (@spglue X Y Q x y)
  := blakers_massey_connected_paths m n Q x y.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 540
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We can in fact reduce [m] by one in both the statement and the conclusion.  When [m] is [-2], this is one step weaker than what [blakers_massey_connected_paths] gives, but it is convenient to have this uniform statement.  We'll use this convention for the later results as well. *)</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 542
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Instance blakers_massey' `{Univalence}
  (m n : trunc_index) {X Y : Type} (Q : X -&gt; Y -&gt; Type)
  `{forall x, IsConnected m.+1 { y : Y &amp; Q x y }}
  `{forall y, IsConnected n { x : X &amp; Q x y }}
  (x : X) (y : Y)
  : IsConnMap (n +2+ m).-1 (@spglue X Y Q x y).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 547
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 548
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct n.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 549
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 550
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply isconnmap_pred'.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 550
Time: 0.003s">
<div class="time" style="width: 3.4883720930233%"></div>
<pre>
    rapply blakers_massey_connected_paths.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 551
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 552
Time: 0.013s">
<div class="time" style="width: 15.116279069767%"></div>
<pre> rapply blakers_massey_connected_paths.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 552
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 553
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A sigma functor is connected if its fibers are, so we have the following. *)</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 555
Time: 0.035s">
<div class="time" style="width: 40.697674418605%"></div>
<pre>Definition blakers_massey_total_map `{Univalence} (m n : trunc_index)
  {X Y : Type} (Q : X -&gt; Y -&gt; Type)
  `{forall x, IsConnected m.+1 { y : Y &amp; Q x y } }
  `{forall y, IsConnected n { x : X &amp; Q x y } }
  : IsConnMap (Tr (n +2+ m).-1) (spushout_sjoin_map Q)
  := _.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 560
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>

Definition blakers_massey_po `{Univalence} (m n : trunc_index)
  {X Y Z : Type} (f : X -&gt; Y) (g : X -&gt; Z)
  `{H1 : !IsConnMap m.+1 f} `{H2 : !IsConnMap n g}
  : IsConnMap (n +2+ m).-1 (pullback_corec (pglue (f:=f) (g:=g))).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 565
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 566
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** We postcompose our map with an equivalence from the pullback of the pushout of [f] and [g] to the pullback of an equivalent [SPushout] over a family [Q]. *)
 </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 568
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>pose (Q := fun y z =&gt; {x : X &amp; f x = y /\ g x = z}).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 568
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
  snapply cancelL_equiv_conn_map.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 569
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: exact (Pullback (spushl Q) (spushr Q)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 570
Time: 0.005s">
<div class="time" style="width: 5.8139534883721%"></div>
<pre>
  1: by snapply (equiv_pullback (equiv_pushout_spushout _ _)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Next we precompose with the equivalence from the total space of [Q] to [X]. *)
 </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 573
Time: 0.027s">
<div class="time" style="width: 31.395348837209%"></div>
<pre>rapply (cancelR_conn_map _ (equiv_double_fibration_replacement f g)^-1%equiv).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 573
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Next we prove that this composition is homotopic to [spushout_sjoin_map Q]. *)
 </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 575
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>snapply (conn_map_homotopic _ (spushout_sjoin_map Q)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 575
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 576
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre> intros [y [z [x [[] []]]]].</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 576
Time: 0.01s">
<div class="time" style="width: 11.627906976744%"></div>
<pre>
    snapply (path_sigma' _ 1 (path_sigma' _ 1 _)); simpl; symmetry.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 577
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
    lhs napply concat_1p.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 578
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
    lhs napply concat_p1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 579
Time: 0.004s">
<div class="time" style="width: 4.6511627906977%"></div>
<pre>
    lhs napply functor_coeq_beta_cglue.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 580
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
    lhs napply concat_p1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 581
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
    napply concat_1p.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 582
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 582
Time: 0.016s">
<div class="time" style="width: 18.604651162791%"></div>
<pre>
  rapply blakers_massey_total_map.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 583
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** What's left is to check that the partial total spaces of [Q] are connected, which we get since [f] and [g] are connected maps. We just have to strip off the irrelevant parts of [Q] to get the hfiber in each case. *)
 </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros y.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    nrefine (isconnected_equiv' _ _ _ (H1 y)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 586
Time: 0.005s">
<div class="time" style="width: 5.8139534883721%"></div>
<pre>
    make_equiv_contr_basedpaths.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 587
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 588
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros z.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 588
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    nrefine (isconnected_equiv' _ _ _ (H2 z)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 589
Time: 0.005s">
<div class="time" style="width: 5.8139534883721%"></div>
<pre>
    make_equiv_contr_basedpaths.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 590
Time: 0.049s">
<div class="time" style="width: 56.976744186047%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A version that requires [g] to be surjective instead of [f]. *)</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 593
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Definition blakers_massey_po' `{Univalence} (m n : trunc_index)
  {X Y Z : Type} (f : X -&gt; Y) (g : X -&gt; Z)
  `{H1 : !IsConnMap m f} `{H2 : !IsConnMap n.+1 g}
  : IsConnMap (n +2+ m).-1 (pullback_corec (pglue (f:=f) (g:=g))).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite trunc_index_add_comm.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 598
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* We will postcompose with an equivalence to the symmetrical pullback. *)
 </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 600
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>snapply cancelL_equiv_conn_map.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 600
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* And we'll show that the composite is homotopic to the symmetrical [pullback_corec] map, which we already know is connected. *)
 </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 602
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>3: rapply (conn_map_homotopic _ _ _ _ (blakers_massey_po n m g f)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 602
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 603
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* We give the equivalence between the pullbacks. *)
   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>refine (_ oE equiv_pullback_symm _ _).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 604
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
    snapply (equiv_pullback pushout_sym equiv_idmap equiv_idmap (fun _ =&gt; 1) (fun _ =&gt; 1)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 605
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 606
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* We show that the composite is homotopic to the symmetrical [pullback_corec] map. *)
   </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 607
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>intro x; cbn; unfold pullback_corec, functor_sigma; cbn.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 607
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (ap (fun w =&gt; (g x; f x; w))).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 608
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>
    symmetry; lhs napply concat_1p; lhs napply concat_p1.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 609
Time: 0.002s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>
    lhs napply (ap_V pushout_sym_map (pglue x)).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 610
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rhs_V napply inv_V.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 611
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply inverse2.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 612
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
    napply Pushout_rec_beta_pglue.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 613
Time: 0.016s">
<div class="time" style="width: 18.604651162791%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** The Freudenthal Suspension Theorem *)

(** The Freudenthal suspension theorem is a fairly trivial corollary of the Blakers-Massey theorem.  It says that [merid : X -&gt; North = South] is highly connected. *)</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 618
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>Instance freudenthal `{Univalence} (n : trunc_index)
           (X : Type@{u}) `{IsConnected n.+1 X}
  : IsConnMap (n +2+ n) (@merid X).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 620
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 621
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* If we post-compose [merid : X -&gt; North = South] with an equivalence [North = South &lt;~&gt; P], where [P] is the pullback of the inclusions [Unit -&gt; Susp X] hitting [North] and [South], we get the canonical comparison map [X -&gt; P] whose connectivity follows from the Blakers-Massey theorem. *)
 </pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 623
Time: 0.031s">
<div class="time" style="width: 36.046511627907%"></div>
<pre>rapply (cancelL_equiv_conn_map _ _ (equiv_pullback_unit_unit_paths _ _)^-1%equiv).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 623
Time: 0.003s">
<div class="time" style="width: 3.4883720930233%"></div>
<pre>
  rapply (blakers_massey_po n n.+1).</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 624
Time: 0.001s">
<div class="time" style="width: 1.1627906976744%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: BlakersMassey.v
Line: 626
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

