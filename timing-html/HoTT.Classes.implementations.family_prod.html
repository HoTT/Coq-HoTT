<html>
<head>
<title>family_prod.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for family_prod.v</h1>

<div class="code" title="File: family_prod.v
Line: 1
Time: 0.027s">
<div class="time" style="width: 100%"></div>
<pre>Require Import
  HoTT.Utf8Minimal
  HoTT.Basics.Overture Types.Unit
  HoTT.Spaces.List.Core.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope list_scope.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The following section implements a datatype [FamilyProd] which
    is a kind of product/tuple. *)

</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section family_prod.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {I : Type}.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** [FamilyProd F ℓ] is a product type defined by
  
&lt;&lt;
        FamilyProd F [i1;i2;...;in] = F i1 * F i2 * ... * F in * Unit
&gt;&gt;

      It is convenient to have the [Unit] in the end.
  *)

 </pre>
</div>
<div class="code" title="File: family_prod.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition FamilyProd (F : I → Type) : list I → Type
    := fold_right (λ (i:I) (A:Type), F i * A) Unit.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Map function for [FamilyProd F ℓ],

&lt;&lt;
        map_family_prod f (x1, x2, ..., xn, tt)
        = (f x1, f x2, ..., f xn, tt)
&gt;&gt;
*)

 </pre>
</div>
<div class="code" title="File: family_prod.v
Line: 33
Time: 0.002s">
<div class="time" style="width: 7.4074074074074%"></div>
<pre>Fixpoint map_family_prod {F G : I → Type} {ℓ : list I}
      (f : ∀ i, F i → G i)
      : FamilyProd F ℓ → FamilyProd G ℓ :=
    match ℓ with
    | nil =&gt; const_tt _
    | i :: ℓ' =&gt; λ '(x,s), (f i x, map_family_prod f s)
    end.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** [for_all_family_prod F P (x1, ..., xn, tt) = True] if
      [P i1 x1 ∧ P i2 x2 ∧ ... ∧ P in xn] holds. *)

 </pre>
</div>
<div class="code" title="File: family_prod.v
Line: 44
Time: 0.001s">
<div class="time" style="width: 3.7037037037037%"></div>
<pre>Fixpoint for_all_family_prod (F : I → Type) {ℓ : list I}
      (P : ∀ i, F i -&gt; Type) : FamilyProd F ℓ → Type :=
    match ℓ with
    | nil =&gt; λ _, Unit
    | i :: _ =&gt; λ '(x,s), P i x ∧ for_all_family_prod F P s
    end.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** [for_all_2_family_prod F G R (x1,...,xn,tt) (y1,...,yn,tt) = True]
      if [R i1 x1 y1 ∧ R i2 x2 y2 ∧ ... ∧ P in xn yn] holds. *)

 </pre>
</div>
<div class="code" title="File: family_prod.v
Line: 54
Time: 0.002s">
<div class="time" style="width: 7.4074074074074%"></div>
<pre>Fixpoint for_all_2_family_prod (F G : I → Type) {ℓ : list I}
      (R : ∀ i, F i -&gt; G i -&gt; Type)
      : FamilyProd F ℓ → FamilyProd G ℓ → Type :=
    match ℓ with
    | nil =&gt; λ _ _, Unit 
    | i :: _ =&gt; λ '(x,s) '(y,t), R i x y ∧ for_all_2_family_prod F G R s t
    end.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** If [R : ∀ i, relation (F i)] is a family of relations indexed by
      [i:I] and [R i] is reflexive for all [i], then

&lt;&lt;
        for_all_2_family_prod F F R s s
&gt;&gt;

      holds. *)
 </pre>
</div>
<div class="code" title="File: family_prod.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma reflexive_for_all_2_family_prod (F : I → Type)
    (R : ∀ i, Relation (F i)) `{!∀ i, Reflexive (R i)}
    {ℓ : list I} (s : FamilyProd F ℓ)
    : for_all_2_family_prod F F R s s.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof with try reflexivity.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 74
Time: 0.002s">
<div class="time" style="width: 7.4074074074074%"></div>
<pre>
    induction ℓ...</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    split...</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply IHℓ.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End family_prod.</pre>
</div>
<div class="code" title="File: family_prod.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

