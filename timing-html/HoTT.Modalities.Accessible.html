<html>
<head>
<title>Accessible.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Accessible.v</h1>

<div class="code" title="File: Accessible.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** * Accessible subuniverses and modalities *)

</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 2
Time: 0.039s">
<div class="time" style="width: 100%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 2
Time: 0.023s">
<div class="time" style="width: 58.974358974359%"></div>
<pre>
Require Import Extensions NullHomotopy.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 3
Time: 0.005s">
<div class="time" style="width: 12.820512820513%"></div>
<pre>
Require Import Modality.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** ** Accessible reflective subuniverses *)

(** An accessible reflective subuniverse is one that is the localization at a small family of maps.  Accessibility is necessary for some constructions, and in practice it's a reasonable hypothesis that includes most examples (though a few examples, such as double negation, may only be accessible if we assume propositional resizing).

We now give the basic definitions related to accessibility, using [ooExtendableAlong] as our notion of equivalence as we did with reflective subuniverses.  The actual construction of a reflective subuniverse by localization will be in [Localization]. *)

</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 15
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>Record LocalGenerators@{a} :=
  { lgen_indices : Type@{a} ;
    lgen_domain : lgen_indices -&gt; Type@{a} ;
    lgen_codomain : lgen_indices -&gt; Type@{a} ;
    lgenerator : forall i, lgen_domain i -&gt; lgen_codomain i
  }.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Coercion lgenerator : LocalGenerators &gt;-&gt; Funclass.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We put this definition in a module so that no one outside of this file will use it accidentally.  It will be redefined in [Localization] to refer to the localization reflective subuniverse, which is judgmentally the same but will also pick up typeclass inference for [In]. *)</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Import IsLocal_Internal.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition IsLocal f X :=
    (forall (i : lgen_indices f), ooExtendableAlong (f i) (fun _ =&gt; X)).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End IsLocal_Internal.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 27
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>

Class IsAccRSU@{a i} (O : Subuniverse@{i}) :=
{
  acc_lgen : LocalGenerators@{a} ;
  inO_iff_islocal : forall (X : Type@{i}),
      (** We call [iff] explicitly to control the number of universe parameters. *)
      iff@{i i i} (In O X) (IsLocal acc_lgen X) ;
}.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments acc_lgen O {_}.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments inO_iff_islocal O {_} X.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Instance O_inverts_generators {O : ReflectiveSubuniverse} `{IsAccRSU O}
             (i : lgen_indices (acc_lgen O))
  : O_inverts O (acc_lgen O i).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (ext_dom := fst (inO_iff_islocal O (O (lgen_domain (acc_lgen O) i))) _).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (ext_cod := fst (inO_iff_islocal O (O (lgen_codomain (acc_lgen O) i))) _).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simple refine (isequiv_adjointify _ _ _ _).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rec.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact ((fst (ext_dom i 1%nat) (to O _)).1).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_indpaths; intros x; simpl.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 50
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>
      refine ((fst (snd (ext_cod i 2)
                        (fun x =&gt; O_functor O (acc_lgen O i)
                                            ((fst (ext_dom i 1%nat) (to O _)).1 x))
                        _) _).1 x); intros a.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 54
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>
      rewrite ((fst (ext_dom i 1%nat) (to O _)).2 a).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply to_O_natural.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_indpaths; intros x; simpl.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite (to_O_natural O (acc_lgen O i) x).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact ((fst (ext_dom i 1%nat) (to O _)).2 x).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 60
Time: 0.003s">
<div class="time" style="width: 7.6923076923077%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The construction of the localization reflective subuniverse for any family of maps will be in [Localization]. *)


(** ** Accessible modalities *)

(** A modality is accessible just when its underlying reflective subuniverse is accessible.  However, for modalities we have a simpler characterization in terms of families of generating connected objects rather than families of generating inverted maps.  We call an object [S]-null if it is local with respect to the maps [S i -&gt; Unit]. *)

</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Record NullGenerators :=
  { ngen_indices : Type@{a} ;
    ngen_type : ngen_indices -&gt; Type@{a}
  }.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Coercion ngen_type : NullGenerators &gt;-&gt; Funclass.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition null_to_local_generators : NullGenerators@{a1} -&gt; LocalGenerators@{a2}
  := fun S =&gt; Build_LocalGenerators (ngen_indices S) (ngen_type S) (fun _ =&gt; Unit) (fun _ _ =&gt; tt).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** As with [IsLocal], the real version of this notation will be defined in [Nullification]. *)</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Import IsNull_Internal.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition IsNull (S : NullGenerators@{a}) (X : Type@{i})
    := IsLocal@{i i a} (null_to_local_generators@{a a} S) X.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End IsNull_Internal.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A central fact: if a type [X] is null for all the fibers of a map [f], then it is [f]-local.  (NB: the converse is *not* generally true.)  TODO: Should this go in [Extensions]? *)</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition extendable_isnull_fibers (n : nat)
           {A B} (f : A -&gt; B) (C : B -&gt; Type)
: (forall b, ooExtendableAlong (const_tt (hfiber f b))
                               (fun _ =&gt; C b))
  -&gt; ExtendableAlong n f C.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert C.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  simple_induction n n IHn; intros C null; [exact tt | split].</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros g.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 92
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>
    exists (fun b =&gt; (fst (null b 1%nat) (fun x =&gt; x.2 # g x.1)).1 tt).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite (path_unit tt (const_tt _ a)).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact ((fst (null (f a) 1%nat) _).2 (a ; 1)).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros h k.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply IHn; intros b.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ooextendable_homotopy, null.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 99
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 100
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>

Definition ooextendable_isnull_fibers {A B} (f : A -&gt; B) (C : B -&gt; Type)
: (forall b, ooExtendableAlong (const_tt (hfiber f b))
                               (fun _ =&gt; C b))
  -&gt; ooExtendableAlong f C
:= fun null n =&gt; extendable_isnull_fibers n f C null.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We define a modality to be accessible if it consists of the null types for some family of generators as above. *)

</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 109
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>Class IsAccModality@{a i} (O : Subuniverse@{i}) :=
{
  acc_ngen : NullGenerators@{a} ;
  inO_iff_isnull : forall (X : Type@{i}),
      iff@{i i i} (In O X) (IsNull acc_ngen X) ;
}.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments acc_ngen O {_}.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments inO_iff_isnull O {_} X.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section AccessibleModalities.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context (O : Modality) {acco : IsAccModality O}.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Unsurprisingly, the generators are connected. *)
 </pre>
</div>
<div class="code" title="File: Accessible.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>#[export] Instance isconnected_acc_ngen i : IsConnected O (acc_ngen O i).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply isconnected_from_elim_to_O.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 125
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>
    pose (H := fst (fst (inO_iff_isnull O (O (acc_ngen O i))) _ i 1%nat)
                   (to O ((acc_ngen O) i))).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (H.1 tt).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (fun x =&gt; (H.2 x)^).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** If all the generators are inhabited, some things become a bit simpler. *)
 </pre>
</div>
<div class="code" title="File: Accessible.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section InhabitedGenerators.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Context (inhab : forall i, acc_ngen O i).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** For testing modal-ness of types, it suffices for all maps out of a generator to be constant.  Probably one could do without [Funext].  *)
   </pre>
</div>
<div class="code" title="File: Accessible.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition inO_const_fromgen `{Funext} A
               (c : forall i (f : acc_ngen O i -&gt; A), NullHomotopy f)
    : In O A.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (snd (inO_iff_isnull O A)); intros i.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ((equiv_ooextendable_isequiv _ _)^-1%equiv).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      snapply isequiv_adjointify.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f []; exact (c i f).1.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f; apply path_arrow; intros x.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        simpl; unfold composeD.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        symmetry; exact ((c i f).2 x).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros g; apply path_arrow; intros [].</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        pose ((c i (g oD (null_to_local_generators (acc_ngen O)) i)).2).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        simpl in p; unfold composeD in p.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        symmetry; apply p, inhab.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 152
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** In particular, all hprops are modal. *)
   </pre>
</div>
<div class="code" title="File: Accessible.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition inO_hprop_inhab_gen `{Funext} (A : Type) `{IsHProp A}
    : In O A.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_const_fromgen; intros i f.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exists (f (inhab i)).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros; apply path_ishprop.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  End InhabitedGenerators.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 164
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>

End AccessibleModalities.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We will now show that a modality is accessible in this sense if and only if its underlying reflective subuniverse is accessible in the sense previously defined.  We (almost?) never need to actually use this, though; in practice accessible modalities usually seem to be given to us with the appropriate sort of generators. *)

(** One direction of this implication is trivial. *)</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance acc_rsu_modality (O : Modality) `{IsAccModality O}
  : IsAccRSU O
  := Build_IsAccRSU O (null_to_local_generators (acc_ngen O)) (fun X =&gt; inO_iff_isnull O X).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For the less trivial converse, the idea is as follows.  By [ooextendable_isnull_fibers], we can detect locality with respect to a map by nullity with respect to its fibers.  Therefore, our first thought might be to just consider all the fibers of all the maps that we are localizing at.  However, this doesn't quite work because [ooextendable_isnull_fibers] is not an if-and-only-if, so not every modal type would necessarily be null for that type family.

     We do know, however, that if [f] is an [O]-connected map, then any [O]-modal type is null for its fibers (since they are [O]-connected types).  There is no *a priori* why all the maps we localize at should end up being connected for the modality; they will always be inverted, but not every inverted map is connected (unless the modality is lex).  But if [f : A -&gt; B] is [O]-inverted, then the [O]-connected map [to O A] is (up to equivalence) the composite of [f] with the [O]-connected map [to O B].  Thus, if [X] is null for the fibers of [to O A] and [to O B], it will be [f]-local and hence [O]-modal, while all [O]-modal types will be null for these fibers since they are connected. *)

(** We don't make this an [Instance] since it is rarely used, and would cause loops when combined with the previous one. *)</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition acc_modality_rsu (O : Modality) `{IsAccRSU O}
  : IsAccModality O.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unshelve econstructor.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (Build_NullGenerators
              (  { i : lgen_indices@{a} (acc_lgen O)
                   &amp; O (lgen_domain@{a} (acc_lgen O) i) }
               + { i : lgen_indices@{a} (acc_lgen O)
                   &amp; O (lgen_codomain@{a} (acc_lgen O) i) })
              _).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [ [i x] | [i x] ]; exact (hfiber (to O _) x).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert (cm := @conn_map_to_O O).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    split.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 191
Time: 0.006s">
<div class="time" style="width: 15.384615384615%"></div>
<pre> intros X_inO [ [i x] | [i x] ];
        exact (ooextendable_const_isconnected_inO O _ _).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros Xnull.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (snd (inO_iff_islocal O X)); intros i.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 194
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre>
      refine (cancelL_ooextendable (fun _ =&gt; X) (acc_lgen O i)
                                   (to O (lgen_codomain (acc_lgen O) i)) _ _).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ooextendable_isnull_fibers; intros x.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (Xnull (inr (i;x))).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 199
Time: 0.001s">
<div class="time" style="width: 2.5641025641026%"></div>
<pre> refine (ooextendable_homotopic _
                                       (O_functor O (acc_lgen O i)
                                                  o to O (lgen_domain (acc_lgen O) i)) _ _).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        1:apply to_O_natural.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply ooextendable_compose.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ooextendable_equiv, O_inverts_generators.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ooextendable_isnull_fibers; intros x.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          exact (Xnull (inl (i;x))).</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 206
Time: 0.005s">
<div class="time" style="width: 12.820512820513%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Accessible.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The construction of the nullification modality for any family of types will be in [Nullification]. *)

</pre>
</div>
</body>
</html>

