<html>
<head>
<title>FreeProduct.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for FreeProduct.v</h1>

<div class="code" title="File: FreeProduct.v
Line: 1
Time: 0.037s">
<div class="time" style="width: 17.209302325581%"></div>
<pre>From HoTT Require Import Basics Types.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 1
Time: 0.029s">
<div class="time" style="width: 13.488372093023%"></div>
<pre>
Require Import WildCat.Core WildCat.Coproducts.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Cubical.DPath.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 3
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
Require Import Spaces.List.Core Spaces.List.Theory.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 4
Time: 0.006s">
<div class="time" style="width: 2.7906976744186%"></div>
<pre>
Require Import Colimits.Pushout.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 5
Time: 0.009s">
<div class="time" style="width: 4.1860465116279%"></div>
<pre>
Require Import Truncations.Core Truncations.SeparatedTrunc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 6
Time: 0.02s">
<div class="time" style="width: 9.3023255813953%"></div>
<pre>
Require Import Algebra.Groups.Group.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope list_scope.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope mc_scope.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope mc_mult_scope.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** In this file we define the amalgamated free product of a span of group homomorphisms as a HIT. *)

(** We wish to define the amalgamated free product of a span of group homomorphisms f : G -&gt; H, g : G -&gt; K as the following HIT:

&lt;&lt;
  HIT M(f,g)
   | amal_eta : list (H + K) -&gt; M(f,g)
   | mu_H : forall (x y : list (H + K)) (h1 h2 : H),
      amal_eta (x ++ [inl h1, inl h2] ++ y) = amal_eta (x ++ [inl (h1 * h2)] ++ y)
   | mu_K : forall (x y : list (H + K)) (k1 k2 : K),
      amal_eta (x ++ [inr k1, inr k2] ++ y) = amal_eta (x ++ [inr (k1 * k2)] ++ y)
   | tau : forall (x y : list (H + K)) (z : G),
      amal_eta (x ++ [inl (f z)] ++ y) = amal_eta (x ++ [inr (g z)] ++ y)
   | omega_H : forall (x y : list (H + K)),
      amal_eta (x ++ [inl mon_unit] ++ y) = amal_eta (x ++ y)
   | omega_K : forall (x y : list (H + K)),
      amal_eta (x ++ [inr mon_unit] ++ y) = amal_eta (x ++ y).
&gt;&gt;

  We will build this HIT up successively out of coequalizers. *)

(** We will call M [amal_type] and prefix all the constructors with [amal_] (for amalgamated free product). *)

</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section AmalgamatedFreeProduct.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context {G H K : Group}
    (f : GroupHomomorphism G H) (g : GroupHomomorphism G K).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition Words : Type := list (H + K).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Fixpoint word_inverse (x : Words) : Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct x as [|x xs].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact nil.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct x as [h|k].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact ((word_inverse xs) ++ [inl h^]).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact ((word_inverse xs) ++ [inr k^]).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Inversion changes order of concatenation. *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition word_inverse_ww (x y : Words)
    : word_inverse (x ++ y) = word_inverse y ++ word_inverse x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x as [|x xs].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: symmetry; apply app_nil.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 57
Time: 0.005s">
<div class="time" style="width: 2.3255813953488%"></div>
<pre>
    destruct x; rhs napply app_assoc; f_ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 58
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** There are five source types for the path constructors. We will construct this HIT as the colimit of five forks going into [Words]. We can bundle up this colimit as a single coequalizer. *)

  (** Source types of path constructors *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition pc1 : Type := Words * H * H * Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Local Definition pc2 : Type := Words * K * K * Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Local Definition pc3 : Type := Words * G * Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Local Definition pc4 : Type := Words * Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Local Definition pc5 : Type := Words * Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** End points of the first path constructor *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition m1 : pc1 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[[x h1] h2] y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ (inl h1 :: [inl h2]) ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition m1' : pc1 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[[x h1] h2] y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ [inl (h1 * h2)] ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** End points of the second path construct *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition m2 : pc2 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[[x k1] k2] y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ (inr k1 :: [inr k2]) ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition m2' : pc2 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[[x k1] k2] y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ [inr (k1 * k2)] ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** End points of the third path constructor *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition m3 : pc3 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[x z] y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ [inl (f z)] ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition m3' : pc3 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[x z] y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ [inr (g z)] ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** End points of the fourth path constructor *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition m4 : pc4 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [x y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ [inl mon_unit] ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition m4' : pc4 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [x y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** End points of the fifth path constructor *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition m5 : pc5 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [x y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ [inr mon_unit] ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition m5' : pc5 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [x y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (x ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We can then define maps going into words consisting of the corresponding endpoints of the path constructors. *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition map1 : pc1 + pc2 + pc3 + pc4 + pc5 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[[[x|x]|x]|x]|x].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m1 x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m2 x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m3 x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m4 x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m5 x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Definition map2 : pc1 + pc2 + pc3 + pc4 + pc5 -&gt; Words.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [[[[x|x]|x]|x]|x].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m1' x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m2' x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m3' x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m4' x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (m5' x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Finally we can define our type as the 0-truncation of the coequalizer of these maps *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition amal_type : Type := Tr 0 (Coeq map1 map2).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We can define the constructors *)

 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 161
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>Definition amal_eta : Words -&gt; amal_type := tr o coeq.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 161
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>

  Definition amal_mu_H (x y : Words) (h1 h2 : H)
    : amal_eta (x ++ [inl h1, inl h2] ++ y) = amal_eta (x ++ [inl (h1 * h2)] ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold amal_eta.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_Tr, tr.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (cglue (inl (inl (inl (inl (x,h1,h2,y)))))).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 168
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 169
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>

  Definition amal_mu_K (x y : Words) (k1 k2 : K)
    : amal_eta (x ++ [inr k1, inr k2] ++ y) = amal_eta (x ++ [inr (k1 * k2)] ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold amal_eta.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_Tr, tr.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (cglue (inl (inl (inl (inr (x,k1,k2,y)))))).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 176
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 177
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>

  Definition amal_tau (x y : Words) (z : G)
    : amal_eta (x ++ [inl (f z)] ++ y) = amal_eta (x ++ [inr (g z)] ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold amal_eta.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_Tr, tr.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (cglue (inl (inl (inr (x,z,y))))).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 184
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition amal_omega_H (x y : Words)
    : amal_eta (x ++ [inl mon_unit] ++ y) = amal_eta (x ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold amal_eta.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_Tr, tr.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (cglue (inl (inr (x,y)))).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition amal_omega_K (x y : Words)
    : amal_eta (x ++ [inr mon_unit] ++ y) = amal_eta (x ++ y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold amal_eta.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_Tr, tr.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 199
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (cglue (inr (x,y))).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now we can derive the dependent eliminator *)

 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 205
Time: 0.008s">
<div class="time" style="width: 3.7209302325581%"></div>
<pre>Definition amal_type_ind (P : amal_type -&gt; Type) `{forall x, IsHSet (P x)}
    (e : forall w, P (amal_eta w))
    (mh : forall (x y : Words) (h1 h2 : H),
      DPath P (amal_mu_H x y h1 h2) (e (x ++ [inl h1, inl h2] ++ y)) (e (x ++ [inl (h1 * h2)] ++ y)))
    (mk : forall (x y : Words) (k1 k2 : K),
      DPath P (amal_mu_K x y k1 k2) (e (x ++ [inr k1, inr k2] ++ y)) (e (x ++ [inr (k1 * k2)] ++ y)))
    (t : forall (x y : Words) (z : G),
      DPath P (amal_tau x y z) (e (x ++ [inl (f z)] ++ y)) (e (x ++ [inr (g z)] ++ y)))
    (oh : forall (x y : Words),
      DPath P (amal_omega_H x y) (e (x ++ [inl mon_unit] ++ y)) (e (x ++ y)))
    (ok : forall (x y : Words),
      DPath P (amal_omega_K x y) (e (x ++ [inr mon_unit] ++ y)) (e (x ++ y)))
    : forall x, P x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 218
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    snapply Trunc_ind; [exact _|].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 219
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    snapply Coeq_ind.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact e.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro a.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 222
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    destruct a as [ [ [ [a | a ] | a] | a ] | a ].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 224
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre> destruct a as [[[x h1] h2] y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 224
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      apply dp_compose.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (mh x y h1 h2).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 227
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre> destruct a as [[[x k1] k2] y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 227
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      apply dp_compose.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 228
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      exact (mk x y k1 k2).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 230
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre> destruct a as [[x z] y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 230
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      apply dp_compose.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 231
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      exact (t x y z).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct a as [x y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 233
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      apply dp_compose.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (oh x y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 235
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct a as [x y].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 236
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      apply dp_compose.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (ok x y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 238
Time: 0.015s">
<div class="time" style="width: 6.9767441860465%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition amal_type_ind_hprop (P : amal_type -&gt; Type) `{forall x, IsHProp (P x)}
    (e : forall w, P (amal_eta w))
    : forall x, P x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 244
Time: 0.004s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
    snapply amal_type_ind.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact _.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact e.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 247
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    all: intros; apply path_ishprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 248
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** From which we can derive the non-dependent eliminator / recursion principle *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 252
Time: 0.006s">
<div class="time" style="width: 2.7906976744186%"></div>
<pre>Definition amal_type_rec (P : Type) `{IsHSet P} (e : Words -&gt; P)
    (eh : forall (x y : Words) (h1 h2 : H),
      e (x ++ [inl h1, inl h2] ++ y) = e (x ++ [inl (h1 * h2)] ++ y))
    (ek : forall (x y : Words) (k1 k2 : K),
      e (x ++ [inr k1, inr k2] ++ y) = e (x ++ [inr (k1 * k2)] ++ y))
    (t : forall (x y : Words) (z : G),
      e (x ++ [inl (f z)] ++ y) = e (x ++ [inr (g z)] ++ y))
    (oh : forall (x y : Words), e (x ++ [inl mon_unit] ++ y) = e (x ++ y))
    (ok : forall (x y : Words), e (x ++ [inr mon_unit] ++ y) = e (x ++ y))
    : amal_type -&gt; P.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 262
Time: 0.004s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
    snapply amal_type_ind.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 263
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    1: exact _.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact e.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 265
Time: 0.017s">
<div class="time" style="width: 7.906976744186%"></div>
<pre>
    all: intros; apply dp_const.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: apply eh.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: apply ek.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: apply t.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: apply oh.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 270
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ok.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 271
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now for the group structure *)

  (** We will frequently need to use that path types in [amal_type] are hprops, and so it speeds things up to create this instance.  It is fast to use [_] here, but when the terms are large below, it becomes slower. *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 277
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>Local Instance ishprop_paths_amal_type (x y : amal_type) : IsHProp (x = y) := _.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 277
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The group operation is concatenation of the underlying list. Most of the work is spent showing that it respects the path constructors. *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Instance sgop_amal_type : SgOp amal_type.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x y; revert x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 282
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
    snapply amal_type_rec; only 1: exact _; intros x; revert y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 284
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre> snapply amal_type_rec; only 1: exact _; intros y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: exact (amal_eta (x ++ y)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros z h1 h2.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply amal_mu_H.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros z k1 k2.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply amal_mu_K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros w z.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 295
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply amal_tau.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros z.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply amal_omega_H.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros z.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply amal_omega_K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros r y h1 h2; revert r.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 306
Time: 0.02s">
<div class="time" style="width: 9.3023255813953%"></div>
<pre>
      rapply amal_type_ind_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 307
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      intros z;
      change (amal_eta ((x ++ [inl h1, inl h2] ++ y) ++ z)
        = amal_eta ((x ++ [inl (h1 * h2)] ++ y) ++ z)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _ @ ap amal_eta _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta (ap (app x) _)^ @ _ @ ap amal_eta (ap (app x) _)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_mu_H.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros r y k1 k2; revert r.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 316
Time: 0.031s">
<div class="time" style="width: 14.418604651163%"></div>
<pre>
      rapply amal_type_ind_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 317
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      intros z;
      change (amal_eta ((x ++ [inr k1, inr k2] ++ y) ++ z)
        = amal_eta ((x ++ [inr (k1 * k2)] ++ y) ++ z)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _ @ ap amal_eta _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 322
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta (ap (app x) _)^ @ _ @ ap amal_eta (ap (app x) _)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 323
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_mu_K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros r y z; revert r.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 326
Time: 0.018s">
<div class="time" style="width: 8.3720930232558%"></div>
<pre>
      rapply amal_type_ind_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 327
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      intros w;
      change (amal_eta ((x ++ [inl (f z)] ++ y) ++ w)
        = amal_eta ((x ++ [inr (g z)] ++ y) ++ w)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _ @ ap amal_eta _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta (ap (app x) _)^ @ _ @ ap amal_eta (ap (app x) _)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_tau.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros r z; revert r.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 336
Time: 0.016s">
<div class="time" style="width: 7.4418604651163%"></div>
<pre>
      rapply amal_type_ind_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 337
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      intros w;
      change (amal_eta ((x ++ [inl mon_unit] ++ z) ++ w) = amal_eta ((x ++ z) ++ w)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 339
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _ @ ap amal_eta _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta (ap (app x) _)^ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_omega_H.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros r z; revert r.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 345
Time: 0.02s">
<div class="time" style="width: 9.3023255813953%"></div>
<pre>
      rapply amal_type_ind_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 346
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      intros w;
      change (amal_eta ((x ++ [inr mon_unit] ++ z) ++ w) = amal_eta ((x ++ z) ++ w)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 348
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _ @ ap amal_eta _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 350
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta (ap (app x) _)^ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_omega_K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 353
Time: 0.097s">
<div class="time" style="width: 45.116279069767%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 354
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The identity element is the empty list *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 357
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Instance monunit_amal_type : MonUnit amal_type.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 357
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 358
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (amal_eta nil).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 359
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 360
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Instance inverse_amal_type : Inverse amal_type.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 362
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 363
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
    srapply amal_type_rec.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 364
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 365
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros w.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 365
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (amal_eta (word_inverse w)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 367
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf; intros x y h1 h2.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 367
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 368
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: refine (word_inverse_ww _ _ @ ap (fun s =&gt; s ++ _) _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 369
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: apply word_inverse_ww.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 371
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (word_inverse_ww _ _ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 371
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply ap; simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 372
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply (ap (fun s =&gt; [s])).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 373
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 374
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply inverse_sg_op.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 375
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 375
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _ @ ap amal_eta _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_mu_H.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 379
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 379
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf; intros x y k1 k2.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: refine (word_inverse_ww _ _ @ ap (fun s =&gt; s ++ _) _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: apply word_inverse_ww.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 384
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (word_inverse_ww _ _ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 384
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply ap; simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 385
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply (ap (fun s =&gt; [s])).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 386
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 387
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply inverse_sg_op.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 388
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 388
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 389
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _ @ ap amal_eta _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 390
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 391
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_mu_K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf; intros x y z.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: refine (word_inverse_ww _ _ @ ap (fun s =&gt; s ++ _) _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,2: cbn; refine (ap _ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 396
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      1,2: rapply (ap (fun s =&gt; [s])).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 397
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,2: apply ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 398
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,2: symmetry; apply grp_homo_inv.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _ @ ap amal_eta _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 401
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_tau.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf; intros x z.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply word_inverse_ww.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (ap (fun s =&gt; s ++ _) _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply word_inverse_ww.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 409
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 410
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite inverse_mon_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_omega_H.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 413
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 413
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 414
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf; intros x z.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 414
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _ @ _ @ ap amal_eta _^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 415
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,3: apply word_inverse_ww.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 416
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 417
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 418
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (ap (fun s =&gt; s ++ _) _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 418
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply word_inverse_ww.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 419
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 419
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (ap amal_eta _^ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: apply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 421
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 422
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite inverse_mon_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 423
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_omega_K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 424
Time: 0.01s">
<div class="time" style="width: 4.6511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 425
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Instance associative_sgop_m : Associative sg_op.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 429
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    rapply amal_type_ind_hprop; intro z; revert y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 430
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    rapply amal_type_ind_hprop; intro y; revert x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 431
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    rapply amal_type_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 432
Time: 0.049s">
<div class="time" style="width: 22.790697674419%"></div>
<pre>
    napply (ap amal_eta).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 433
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rapply app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 434
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 435
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Instance leftidentity_sgop_amal_type : LeftIdentity sg_op mon_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 437
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 438
Time: 0.004s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
    rapply amal_type_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 439
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Instance rightidentity_sgop_amal_type : RightIdentity sg_op mon_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 443
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 444
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    rapply amal_type_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 445
Time: 0.023s">
<div class="time" style="width: 10.697674418605%"></div>
<pre>
    napply (ap amal_eta).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 446
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    napply app_nil.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 447
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 448
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma amal_eta_word_concat_Vw (x : Words) : amal_eta (word_inverse x ++ x) = mon_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 451
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x as [|x xs].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 452
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: reflexivity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct x as [h|k].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> change (amal_eta (word_inverse ([inl h] ++ xs) ++ [inl h] ++ xs) = mon_unit).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite word_inverse_ww.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 456
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 457
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (amal_mu_H _ _ _ _ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite left_inverse.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 459
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite amal_omega_H.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 460
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact IHxs.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 461
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 462
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> change (amal_eta (word_inverse ([inr k] ++ xs) ++ [inr k] ++ xs) = mon_unit).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 462
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite word_inverse_ww.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 463
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 464
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (amal_mu_K _ _ _ _ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 465
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite left_inverse.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 466
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite amal_omega_K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 467
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact IHxs.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 468
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 469
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma amal_eta_word_concat_wV (x : Words) : amal_eta (x ++ word_inverse x) = mon_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 471
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 472
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x as [|x xs].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 473
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: reflexivity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 474
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct x as [h|k].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 475
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 476
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 476
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 477
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      change (amal_eta ([inl h]) * amal_eta ((xs ++ word_inverse xs)) * amal_eta ([inl h^]) = mon_unit).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 478
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite IHxs.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 479
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite rightidentity_sgop_amal_type.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 480
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- (app_nil (cons _ _)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 481
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      change (amal_eta (([inl h] ++ [inl h^]) ++ nil) = mon_unit).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 482
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 483
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      change (amal_eta (nil ++ [inl h] ++ [inl h^] ++ nil) = mon_unit).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 484
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (amal_mu_H _ _ _ _ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 485
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 486
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 487
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 487
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply (ap (fun x =&gt; x ++ _)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 488
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply (ap (fun x =&gt; [x])).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 489
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 490
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply right_inverse.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 491
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 491
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_omega_H.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 492
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 493
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  cbn.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 493
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 494
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      change (amal_eta ([inr k]) * amal_eta ((xs ++ word_inverse xs)) * amal_eta ([inr k^]) = mon_unit).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 495
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite IHxs.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite rightidentity_sgop_amal_type.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- (app_nil (cons _ _)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 498
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      change (amal_eta (([inr k] ++ [inr k^]) ++ nil) = mon_unit).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 499
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- app_assoc.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 500
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      change (amal_eta (nil ++ [inr k] ++ [inr k^] ++ nil) = mon_unit).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (amal_mu_K _ _ _ _ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (_ @ _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 504
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 504
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply (ap (fun x =&gt; x ++ _)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 505
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        rapply (ap (fun x =&gt; [x])).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 507
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply right_inverse.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 508
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 508
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply amal_omega_K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 509
Time: 0.004s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 510
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Instance leftinverse_sgop_amal_type : LeftInverse (.*.) (^) mon_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 512
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 513
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    rapply amal_type_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 514
Time: 0.036s">
<div class="time" style="width: 16.744186046512%"></div>
<pre>
    apply amal_eta_word_concat_Vw.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 516
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Instance rightinverse_sgop_amal_type : RightInverse (.*.) (^) mon_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 518
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 519
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    rapply amal_type_ind_hprop; intro x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 520
Time: 0.035s">
<div class="time" style="width: 16.279069767442%"></div>
<pre>
    apply amal_eta_word_concat_wV.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 521
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition AmalgamatedFreeProduct : Group.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 524
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 525
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    snapply (Build_Group amal_type); repeat split; exact _.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 526
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 527
Time: 0.116s">
<div class="time" style="width: 53.953488372093%"></div>
<pre>

End AmalgamatedFreeProduct.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 529
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments amal_eta {G H K f g} x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 531
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments amal_mu_H {G H K f g} x y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 532
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments amal_mu_K {G H K f g} x y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 533
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments amal_tau {G H K f g} x y z.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 534
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments amal_omega_H {G H K f g} x y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 535
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments amal_omega_K {G H K f g} x y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 536
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section RecInd.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 538
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context {G H K : Group}
    {f : GroupHomomorphism G H} {g : GroupHomomorphism G K}.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 541
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Using foldr. It's important that we use foldr as foldl is near impossible to reason about. *)
 </pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 544
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>Definition AmalgamatedFreeProduct_rec' (X : Group)
    (h : GroupHomomorphism H X) (k : GroupHomomorphism K X)
    (p : h o f == k o g)
    : AmalgamatedFreeProduct f g -&gt; X.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 547
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 548
Time: 0.013s">
<div class="time" style="width: 6.046511627907%"></div>
<pre>
    srapply amal_type_rec.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 549
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 550
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro w.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 550
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (fold_right _ _ w).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 551
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 552
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [l|r] x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 552
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 553
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (h l * x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 553
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 554
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (k r * x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 554
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 554
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact mon_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 556
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y h1 h2; hnf.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 556
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
      rewrite ?fold_right_app.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 557
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
      f_ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 558
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 559
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
      rewrite simple_associativity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 560
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      f_ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 561
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      symmetry.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (grp_homo_op h h1 h2).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 563
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 563
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 564
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y k1 k2; hnf.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 564
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
      rewrite ?fold_right_app.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 565
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
      f_ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 566
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 567
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
      rewrite simple_associativity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 568
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      f_ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 569
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      symmetry.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 570
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (grp_homo_op k k1 k2).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 572
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y z; hnf.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 572
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
      rewrite ?fold_right_app.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 573
Time: 0.004s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
      f_ap; simpl; f_ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 574
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 574
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 575
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y; hnf.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 575
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
      rewrite ?fold_right_app.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 576
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
      f_ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 577
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 577
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite grp_homo_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 577
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      rapply left_identity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 578
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 578
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 579
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y; hnf.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 579
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
      rewrite ?fold_right_app.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 580
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
      f_ap.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite grp_homo_unit.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 581
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      rapply left_identity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 582
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 582
Time: 0.015s">
<div class="time" style="width: 6.9767441860465%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 583
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>

  Local Instance issemigrouppreserving_AmalgamatedFreeProduct_rec'
    (X : Group) (h : GroupHomomorphism H X) (k : GroupHomomorphism K X)
    (p : h o f == k o g)
    : IsSemiGroupPreserving (AmalgamatedFreeProduct_rec' X h k p).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 588
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 589
Time: 0.083s">
<div class="time" style="width: 38.604651162791%"></div>
<pre>
    intros x; srapply amal_type_ind_hprop; intro y; revert x;
    srapply amal_type_ind_hprop; intro x; simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite fold_right_app.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 592
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    set (s := (fold_right
     (fun X0 : H + K =&gt; match X0 with
                        | inl l =&gt; fun x0 : X =&gt; h l * x0
                        | inr r =&gt; fun x0 : X =&gt; k r * x0
                        end) mon_unit y)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction x as [|a x].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 598
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    1: symmetry; apply left_identity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 599
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 600
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite IHx.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 601
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
    destruct a; apply simple_associativity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 602
Time: 0.004s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 603
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>

  Definition AmalgamatedFreeProduct_rec (X : Group)
    (h : H $-&gt; X) (k : K $-&gt; X)
    (p : h $o f $== k $o g)
    : AmalgamatedFreeProduct f g $-&gt; X.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 608
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 609
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply Build_GroupHomomorphism.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 610
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: srapply (AmalgamatedFreeProduct_rec' X h k p).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 611
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact _.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 612
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 613
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition amal_inl : H $-&gt; AmalgamatedFreeProduct f g.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 615
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply Build_GroupHomomorphism.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 617
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 618
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 618
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (amal_eta [inl x]).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 619
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 619
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 620
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite &lt;- (app_nil [inl (x * y)]).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 621
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite &lt;- (amal_mu_H nil nil x y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 622
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite app_nil.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 623
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 624
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 625
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition amal_inr : K $-&gt; AmalgamatedFreeProduct f g.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 627
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 628
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply Build_GroupHomomorphism.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 629
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 630
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 630
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (amal_eta [inr x]).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 631
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 631
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x y.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 632
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite &lt;- (app_nil [inr (x * y)]).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 633
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite &lt;- (amal_mu_K nil nil x y).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 634
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite app_nil.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 635
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 636
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 637
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  
  Definition amal_glue : amal_inl $o f $== amal_inr $o g.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 640
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
    hnf; apply (amal_tau nil nil).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 641
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 642
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>

  Theorem equiv_amalgamatedfreeproduct_rec `{Funext} (X : Group)
    : {h : H $-&gt; X &amp; {k : K $-&gt; X &amp; h $o f $== k $o g }}
      &lt;~&gt; (AmalgamatedFreeProduct f g $-&gt; X).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 646
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 647
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply equiv_adjointify.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 648
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: intros [h [k p]]; exact (AmalgamatedFreeProduct_rec X h k p).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 649
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 650
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros r.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 650
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exists (grp_homo_compose r amal_inl).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 651
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exists (grp_homo_compose r amal_inr).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 652
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 653
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (ap r).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 654
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 655
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- (app_nil [inl (f x)]).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 656
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- (app_nil [inr (g x)]).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 657
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (amal_tau nil nil x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 659
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros r.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 659
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_path_grouphomomorphism.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 660
Time: 0.017s">
<div class="time" style="width: 7.906976744186%"></div>
<pre>
      srapply amal_type_ind_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 661
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 662
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      induction x as [|a x].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 663
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: symmetry; exact (grp_homo_unit r).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 664
Time: 0.009s">
<div class="time" style="width: 4.1860465116279%"></div>
<pre>
      simpl in *.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 665
Time: 0.025s">
<div class="time" style="width: 11.627906976744%"></div>
<pre>
      rewrite IHx.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 666
Time: 0.073s">
<div class="time" style="width: 33.953488372093%"></div>
<pre>
      destruct a; symmetry;
      rapply (grp_homo_op r (amal_eta [_]) (amal_eta x)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 668
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 668
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro hkp.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 669
Time: 0.01s">
<div class="time" style="width: 4.6511627906977%"></div>
<pre>
    simpl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 670
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>
    tapply (equiv_ap' (equiv_sigma_prod
      (fun hk : (H $-&gt; X) * (K $-&gt; X)
        =&gt; fst hk o f == snd hk o g)) _ _)^-1%equiv.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 673
Time: 0.011s">
<div class="time" style="width: 5.1162790697674%"></div>
<pre>
    rapply path_sigma_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 674
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
    destruct hkp as [h [k p]].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 675
Time: 0.012s">
<div class="time" style="width: 5.5813953488372%"></div>
<pre>
    apply path_prod; cbn;
    apply equiv_path_grouphomomorphism;
    intro; simpl; rapply right_identity.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 678
Time: 0.018s">
<div class="time" style="width: 8.3720930232558%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 679
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  
  Definition amalgamatedfreeproduct_ind_hprop (P : AmalgamatedFreeProduct f g -&gt; Type)
    `{forall x, IsHProp (P x)}
    (l : forall a, P (amal_inl a)) (r : forall b, P (amal_inr b))
    (Hop : forall x y, P x -&gt; P y -&gt; P (x * y))
    : forall x, P x.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 685
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 686
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    rapply amal_type_ind_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 687
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros w.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 688
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simple_list_induction w a w IH.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 689
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 690
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite &lt;- (amal_omega_H nil nil).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 690
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply l.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 691
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 692
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct a as [a|b].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 692
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 693
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> change (P (amal_inl a * amal_eta w)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 693
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        by apply Hop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 695
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> change (P (amal_inr b * amal_eta w)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 695
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        by apply Hop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 696
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 697
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>

  Definition amalgamatedfreeproduct_ind_homotopy {P : Group}
    {k k' : AmalgamatedFreeProduct f g $-&gt; P}
    (l : k $o amal_inl $== k' $o amal_inl)
    (r : k $o amal_inr $== k' $o amal_inr)
    : k $== k'.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 703
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 704
Time: 0.008s">
<div class="time" style="width: 3.7209302325581%"></div>
<pre>
    rapply (amalgamatedfreeproduct_ind_hprop _ l r).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 705
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x y; napply grp_homo_op_agree.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 706
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 707
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>

  Definition equiv_amalgamatedfreeproduct_ind_homotopy `{Funext} {P : Group}
    (k k' : AmalgamatedFreeProduct f g $-&gt; P)
    : (k $o amal_inl $== k' $o amal_inl) * (k $o amal_inr $== k' $o amal_inr)
      &lt;~&gt; k $== k'.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 712
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 713
Time: 0.055s">
<div class="time" style="width: 25.581395348837%"></div>
<pre>
    rapply equiv_iff_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 714
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 715
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (uncurry amalgamatedfreeproduct_ind_homotopy).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 715
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 716
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre> intros p; split; exact (p $@R _).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 716
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 717
Time: 0.024s">
<div class="time" style="width: 11.162790697674%"></div>
<pre>

End RecInd.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 719
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition FreeProduct (G H : Group) : Group
  := AmalgamatedFreeProduct (grp_trivial_rec G) (grp_trivial_rec H).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 722
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition freeproduct_inl {G H : Group} : GroupHomomorphism G (FreeProduct G H)
  := amal_inl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 725
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition freeproduct_inr {G H : Group} : GroupHomomorphism H (FreeProduct G H)
  := amal_inr.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 728
Time: 0.215s">
<div class="time" style="width: 100%"></div>
<pre>

Definition freeproduct_ind_hprop {G H} (P : FreeProduct G H -&gt; Type)
  `{forall x, IsHProp (P x)}
  (l : forall g, P (freeproduct_inl g))
  (r : forall h, P (freeproduct_inr h))
  (Hop : forall x y, P x -&gt; P y -&gt; P (x * y))
  : forall x, P x
  := amalgamatedfreeproduct_ind_hprop P l r Hop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 736
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(* The above is slow, ~0.15s. *)

</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 738
Time: 0.008s">
<div class="time" style="width: 3.7209302325581%"></div>
<pre>Definition freeproduct_ind_homotopy {G H K : Group}
  {f f' : FreeProduct G H $-&gt; K}
  (l : f $o freeproduct_inl $== f' $o freeproduct_inl)
  (r : f $o freeproduct_inr $== f' $o freeproduct_inr)
  : f $== f'
  := amalgamatedfreeproduct_ind_homotopy l r.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 743
Time: 0.004s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>

Definition equiv_freeproduct_ind_homotopy {Funext : Funext} {G H K : Group}
  (f f' : FreeProduct G H $-&gt; K)
  : (f $o freeproduct_inl $== f' $o freeproduct_inl)
    * (f $o freeproduct_inr $== f' $o freeproduct_inr)
    &lt;~&gt; f $== f'
  := equiv_amalgamatedfreeproduct_ind_homotopy _ _.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 750
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition FreeProduct_rec {G H K : Group} (f : G $-&gt; K) (g : H $-&gt; K)
  : FreeProduct G H $-&gt; K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 753
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 754
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  srapply (AmalgamatedFreeProduct_rec _ f g).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 755
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros [].</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 756
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (grp_homo_unit f @ (grp_homo_unit g)^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 757
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 758
Time: 0.009s">
<div class="time" style="width: 4.1860465116279%"></div>
<pre>

Definition freeproduct_rec_beta_inl {G H K : Group}
  (f : G $-&gt; K) (g : H $-&gt; K)
  : FreeProduct_rec f g $o freeproduct_inl $== f
  := fun x =&gt; right_identity (f x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 763
Time: 0.008s">
<div class="time" style="width: 3.7209302325581%"></div>
<pre>

Definition freeproduct_rec_beta_inr {G H K : Group}
  (f : G $-&gt; K) (g : H $-&gt; K)
  : FreeProduct_rec f g $o freeproduct_inr $== g
  := fun x =&gt; right_identity (g x).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 768
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition equiv_freeproduct_rec `{funext : Funext} (G H K : Group)
  : (GroupHomomorphism G K) * (GroupHomomorphism H K)
  &lt;~&gt; GroupHomomorphism (FreeProduct G H) K.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 772
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 773
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (equiv_amalgamatedfreeproduct_rec K oE _^-1).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 774
Time: 0.012s">
<div class="time" style="width: 5.5813953488372%"></div>
<pre>
  refine (equiv_sigma_prod0 _ _ oE equiv_functor_sigma_id (fun _ =&gt; equiv_sigma_contr _)).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 775
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros f.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 776
Time: 0.009s">
<div class="time" style="width: 4.1860465116279%"></div>
<pre>
  rapply contr_forall.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 777
Time: 0.006s">
<div class="time" style="width: 2.7906976744186%"></div>
<pre>
  intros []; rapply contr_inhabited_hprop.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 778
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (grp_homo_unit _ @ (grp_homo_unit _)^).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 779
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 780
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The free product is the coproduct in the category of groups. *)</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 782
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance hasbinarycoproducts : HasBinaryCoproducts Group.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 782
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 783
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros G H.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 784
Time: 0.025s">
<div class="time" style="width: 11.627906976744%"></div>
<pre>
  snapply Build_BinaryCoproduct.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 785
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 786
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (FreeProduct G H).</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 786
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 787
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact freeproduct_inl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 787
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 788
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact freeproduct_inr.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 788
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 789
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros Z; exact FreeProduct_rec.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 789
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 790
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros; apply freeproduct_rec_beta_inl.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 790
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 791
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros; apply freeproduct_rec_beta_inr.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 791
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 792
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros Z f g p q.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 792
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    by snapply freeproduct_ind_homotopy.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 793
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: FreeProduct.v
Line: 795
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

