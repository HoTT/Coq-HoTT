<html>
<head>
<title>HoTTBookExercises.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for HoTTBookExercises.v</h1>

<div class="code" title="File: HoTTBookExercises.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** The HoTT Book Exercises formalization. *)

(** This file records formalized solutions to the HoTT Book exercises. *)

(*  See HoTTBook.v for an IMPORTANT NOTE FOR THE HoTT DEVELOPERS.

    PROCEDURE FOR UPDATING THE FILE:

   1. Compile the latest version of the HoTT Book to update the LaTeX
      labels. Do not forget to pull in changes from HoTT/HoTT.

   2. Run `etc/Book.py` using the `--exercises` flag (so your command
      should look like `cat ../book/*.aux | etc/Book.py --exercises contrib/HoTTBookExercises.v`)
      If it complains, fix things.

   3. Add contents to new entries.

   4. Run `etc/Book.py` again to make sure it is happy.

   5. Compile this file with `make contrib` or `make contrib/HoTTBookExercises.vo`.

   6. Do the git thing to submit your changes.

*)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 25
Time: 0.121s">
<div class="time" style="width: 100%"></div>
<pre>From HoTT Require Import Basics Types HProp HSet Projective
     TruncType Truncations Modalities.Notnot Modalities.Open Modalities.Closed
     Misc.BoundedSearch Equiv.BiInv Spaces.Nat Spaces.Torus.TorusEquivCircles
     Classes.implementations.peano_naturals Metatheory.Core Metatheory.FunextVarieties
     Metatheory.ImpredicativeTruncation Spaces.Finite.Fin ExcludedMiddle.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope type_scope.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* END OF PREAMBLE *)
(* ================================================== ex:composition *)
(** Exercise 1.1 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_1 := (fun (A B C : Type) (f : A -&gt; B) (g : B -&gt; C) =&gt; g o f).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 38
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

Theorem Book_1_1_refl : forall (A B C D : Type) (f : A -&gt; B) (g : B -&gt; C) (h : C -&gt; D),
                          h o (g o f) = (h o g) o f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:pr-to-rec *)
(** Exercise 1.2 *)

(** Recursor as equivalence. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_2_prod_lib := @HoTT.Types.Prod.equiv_uncurry.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Section Book_1_2_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable A B : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Recursor with projection functions instead of pattern-matching. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Let prod_rec_proj C (g : A -&gt; B -&gt; C) (p : A * B) : C
    := g (fst p) (snd p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_1_2_prod := prod_rec_proj.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_2_prod_fst : fst = prod_rec_proj A (fun a b =&gt; a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_2_prod_snd : snd = prod_rec_proj B (fun a b =&gt; b).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_2_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Recursor as (dependent) equivalence. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_2_sig_lib := @HoTT.Types.Sigma.equiv_sig_ind.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Section Book_1_2_sig.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable A : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable B : A -&gt; Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Non-dependent recursor with projection functions instead of pattern matching. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Let sig_rec_proj C (g : forall (x : A), B x -&gt; C) (p : exists (x : A), B x) : C
    := g (pr1 p) (pr2 p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_1_2_sig := @sig_rec_proj.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_2_sig_fst : @pr1 A B = sig_rec_proj A (fun a =&gt; fun b =&gt; a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** NB: You cannot implement pr2 with only the recursor, so it is not possible
      to check its definitional equality as the exercise suggests. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>End Book_1_2_sig.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:pr-to-ind *)
(** Exercise 1.3 *)

(** The propositional uniqueness principles are named with an
    'eta' postfix in the HoTT library. *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_3_prod_lib := @HoTT.Types.Prod.prod_ind.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Section Book_1_3_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable A B : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Let prod_ind_eta (C : A * B -&gt; Type) (g : forall (x : A) (y : B), C (x, y)) (x : A * B) : C x
    := transport C (HoTT.Types.Prod.eta_prod x) (g (fst x) (snd x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_1_3_prod := prod_ind_eta.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_3_prod_refl : forall C g a b, prod_ind_eta C g (a, b) = g a b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_3_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_1_3_sig_lib := @HoTT.Basics.Overture.sig_ind.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Section Book_1_3_sig.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable A : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable B : A -&gt; Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 109
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Let sig_ind_eta (C : (exists (a : A), B a) -&gt; Type)
                          (g : forall (a : A) (b : B a), C (a; b))
                          (x : exists (a : A), B a) : C x
    := transport C (HoTT.Types.Sigma.eta_sigma x) (g (pr1 x) (pr2 x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_1_3_sig := sig_ind_eta.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_3_sig_refl : forall C g a b, sig_ind_eta C g (a; b) = g a b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_3_sig.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:iterator *)
(** Exercise 1.4 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_1_4.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Fixpoint Book_1_4_iter (C : Type) (c0 : C) (cs : C -&gt; C) (n : nat) : C
    := match n with
      | O =&gt; c0
      | S m =&gt; cs (Book_1_4_iter C c0 cs m)
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_4_rec' (C : Type) (c0 : C) (cs : nat -&gt; C -&gt; C) : nat -&gt; nat * C
    := Book_1_4_iter (nat * C) (O, c0) (fun x =&gt; (S (fst x), cs (fst x) (snd x))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  
  Definition Book_1_4_rec (C : Type) (c0 : C) (cs : nat -&gt; C -&gt; C) (n : nat) : C
    := snd (Book_1_4_rec' C c0 cs n).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma Book_1_4_aux : forall C c0 cs n, fst (Book_1_4_rec' C c0 cs n) = n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros C c0 cs n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> induction n as [| m IH].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (ap S IH).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Proposition Book_1_4_eq
    : forall C c0 cs n, Book_1_4_rec C c0 cs n = nat_rect (fun _ =&gt; C) c0 cs n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
    intros C c0 cs n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> induction n as [| m IH].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> change (cs (fst (Book_1_4_rec' C c0 cs m)) (Book_1_4_rec C c0 cs m)
              = cs m (nat_rect (fun _ =&gt; C) c0 cs m)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 151
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
      lhs rapply (ap (fun x =&gt; cs x _) (Book_1_4_aux _ _ _ _)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (ap (cs m) IH).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_4.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:sum-via-bool *)
(** Exercise 1.5 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_1_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_1_5_sum (A B : Type) := { x : Bool &amp; if x then A else B }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Notation "'inl' a" := (true; a) (at level 0).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Notation "'inr' b" := (false; b) (at level 0).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 163
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Definition Book_1_5_ind (A B : Type) (C : Book_1_5_sum A B -&gt; Type) (f : forall a, C (inl a))
   (g : forall b, C (inr b)) : forall x : Book_1_5_sum A B, C x := fun x =&gt; match x with
   | inl a =&gt; f a
   | inr b =&gt; g b
   end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem inl_red {A B : Type} {C : Book_1_5_sum A B -&gt; Type} f g { a : A }
  : Book_1_5_ind A B C f g (inl a) = f a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem inr_red {A B : Type} {C : Book_1_5_sum A B -&gt; Type} f g { b : B }
  : Book_1_5_ind A B C f g (inr b) = g b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:prod-via-bool *)
(** Exercise 1.6 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_1_6.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Funext}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_6_prod (A B : Type) := forall x : Bool, (if x then A else B).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_6_mk_pair {A B : Type} (a : A) (b : B) : Book_1_6_prod A B
    := fun x =&gt; match x with
              | true =&gt; a
              | false =&gt; b
              end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Notation "( a , b )" := (Book_1_6_mk_pair a b) (at level 0).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Notation "'pr1' p" := (p true) (at level 0).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Notation "'pr2' p" := (p false) (at level 0).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 195
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Definition Book_1_6_eq {A B : Type} (p : Book_1_6_prod A B) : (pr1 p, pr2 p) == p
    := fun x =&gt; match x with
              | true =&gt; 1
              | false =&gt; 1
              end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_1_6_id {A B : Type} (a : A) (b : B) : Book_1_6_eq (a, b) = (fun x =&gt; 1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct x; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_6_eta {A B : Type} (p : Book_1_6_prod A B) : (pr1 p, pr2 p) = p
    := path_forall (pr1 p, pr2 p) p (Book_1_6_eq p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 209
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Definition Book_1_6_ind {A B : Type} (C : Book_1_6_prod A B -&gt; Type) (f : forall a b, C (a, b))
    (p : Book_1_6_prod A B) : C p
    := transport C (Book_1_6_eta p) (f (pr1 p) (pr2 p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_1_6_red {A B : Type} (C : Book_1_6_prod A B -&gt; Type) f a b
    : Book_1_6_ind C f (a, b) = f a b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold Book_1_6_ind, Book_1_6_eta.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 218
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    rewrite Book_1_6_id, path_forall_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 220
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_6.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:pm-to-ml *)
(** Exercise 1.7 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_1_7.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 226
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Definition Book_1_7_id {A : Type}
    : forall {x y : A} (p : x = y), (x; 1) = (y; p) :&gt; { a : A &amp; x = a }
    := paths_ind' (fun (x y : A) (p : x = y) =&gt; (x; 1) = (y; p)) (fun x =&gt; 1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_7_transport {A : Type} (P : A -&gt; Type)
    : forall {x y : A} (p : x = y), P x -&gt; P y
    := paths_ind' (fun (x y : A) (p : x = y) =&gt; P x -&gt; P y) (fun x =&gt; idmap).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 233
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Definition Book_1_7_ind' {A : Type} (a : A) (C : forall x, (a = x) -&gt; Type)
    (c : C a 1) (x : A) (p : a = x)
    : C x p
    := Book_1_7_transport (fun r =&gt; C (pr1 r) (pr2 r)) (Book_1_7_id p) c.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_7_eq {A : Type} (a : A) (C : forall x, (a = x) -&gt; Type) (c : C a 1)
    : Book_1_7_ind' a C c a 1 = c
    := 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_7.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:nat-semiring *)
(** Exercise 1.8 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_1_8.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Fixpoint Book_1_8_rec_nat (C : Type) c0 cs (n : nat) : C
    := match n with
      | O =&gt; c0
      | S m =&gt; cs m (Book_1_8_rec_nat C c0 cs m)
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_8_add : nat -&gt; nat -&gt; nat
    := Book_1_8_rec_nat (nat -&gt; nat) (fun m =&gt; m) (fun n g m =&gt; (S (g m))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_8_mult : nat -&gt; nat -&gt; nat
    := Book_1_8_rec_nat (nat -&gt; nat) (fun m =&gt; 0) (fun n g m =&gt; Book_1_8_add m (g m)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (* [Book_1_8_rec_nat] gives back a function with the wrong argument order, so we flip the order of the arguments [p] and [q]. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_8_exp : nat -&gt; nat -&gt; nat
    := fun p q =&gt;
        (Book_1_8_rec_nat (nat -&gt; nat) (fun m =&gt; (S 0)) (fun n g m =&gt; Book_1_8_mult m (g m))) q p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Example add_example: Book_1_8_add 32 17 = 49 := 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 265
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Example mult_example: Book_1_8_mult 20 5 = 100 := 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 266
Time: 0.007s">
<div class="time" style="width: 5.7851239669421%"></div>
<pre>
  Example exp_example: Book_1_8_exp 2 10 = 1024 := 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_8_semiring := HoTT.Classes.implementations.peano_naturals.nat_semiring.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 269
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
End Book_1_8.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 270
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:fin *)
(** Exercise 1.9 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 274
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_1_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 274
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Fixpoint Book_1_9_Fin (n : nat) : Type
    := match n with
      | O =&gt; Empty
      | S m =&gt; (Book_1_9_Fin m) + Unit
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 279
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_1_9_fmax (n : nat) : Book_1_9_Fin (S n) := inr tt.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:ackermann *)
(** Exercise 1.10 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 286
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Fixpoint ack (n m : nat) : nat 
  := match n with
    | O =&gt; S m
    | S p =&gt; let fix ackn (m : nat)
              := match m with
                | O =&gt; ack p 1
                | S q =&gt; ack p (ackn q)
                end
            in ackn m
    end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 295
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_1_10 := ack.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:neg-ldn *)
(** Exercise 1.11 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_1_11.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Theorem dblneg : forall A, (~~~A) -&gt; ~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A f a; apply f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros g; apply g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 307
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_11.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:tautologies *)
(** Exercise 1.12 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_1_12.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Theorem Book_1_12_part1 : forall A B, A -&gt; (B -&gt; A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros ? ? a ?.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 317
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_1_12_part2 : forall A, A -&gt; ~~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A a f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (f a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 322
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 323
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_1_12_part3 : forall A B, ((~A) + (~B)) -&gt; ~(A * B).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A B [na | nb] [a b].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 328
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (na a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 328
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (nb b).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_12.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:not-not-lem *)
(** Exercise 1.13 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_1_13.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Lemma Book_1_13_aux: forall A B, ~(A + B) -&gt; ~A * ~B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A B nAorB; split.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 339
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro a; exact (nAorB (inl a)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 339
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro b; exact (nAorB (inr b)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_1_13 : forall P, ~~(P + ~P).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros P f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply Book_1_13_aux in f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct f as [np nnp].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (nnp np).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 346
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_1_13_direct : forall P, ~~(P + ~P).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 350
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros P f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply inr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (inl p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 354
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_1_13.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:without-K *)
(** Exercise 1.14 *)

(** There is no adequate type family C : Pi_{x, y, p} U  such that C(x, x, p) is p = refl x definitionally. *)

(* ================================================== ex:subtFromPathInd *)
(** Exercise 1.15 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 364
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_15_paths_rec {A : Type} {C : A -&gt; Type} {x y : A} (p : x = y) : C x -&gt; C y 
  := match p with 1 =&gt; idmap end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 365
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** This is exactly the definition of [transport] from Basics.Overture. *)

(* ================================================== ex:add-nat-commutative *)
(** Exercise 1.16 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_1_16 := HoTT.Spaces.Nat.Core.nat_add_comm.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:basics:concat *)
(** Exercise 2.1 *)

(* Book_2_1_concatenation1 is equivalent to the proof given in the text *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 375
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_1_concatenation1 :
    forall {A : Type} {x y z : A}, x = y -&gt; y = z -&gt; x = z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A x y z x_eq_y y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction x_eq_y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 379
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_2_1_concatenation2 :
    forall {A : Type} {x y z : A}, x = y -&gt; y = z -&gt; x = z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 385
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 386
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A x y z x_eq_y y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 387
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction x_eq_y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 388
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 389
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 390
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_2_1_concatenation3 :
    forall {A : Type} {x y z : A}, x = y -&gt; y = z -&gt; x = z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A x y z x_eq_y y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 396
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact x_eq_y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 397
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 398
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Notation "p *1 q" := (Book_2_1_concatenation1 p q) (at level 10).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Notation "p *2 q" := (Book_2_1_concatenation2 p q) (at level 10).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 401
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Notation "p *3 q" := (Book_2_1_concatenation3 p q) (at level 10).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Book_2_1_Proofs_Are_Equal.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {A : Type} {x y z : A}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable (p : x = y) (q : y = z).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_2_1_concatenation1_eq_Book_2_1_concatenation2 : p *1 q = p *2 q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 409
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 410
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_1_concatenation2_eq_Book_2_1_concatenation3 : p *2 q =  p *3 q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 413
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 414
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 415
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 416
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 417
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_1_concatenation1_eq_Book_2_1_concatenation3 : p *1 q = p *3 q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 419
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 421
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 422
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 423
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_2_1_Proofs_Are_Equal.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:eq-proofs-commute *)
(** Exercise 2.2 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_2 :
  forall {A : Type} {x y z : A} (p : x = y) (q : y = z),
    (Book_2_1_concatenation1_eq_Book_2_1_concatenation2 p q) *1
    (Book_2_1_concatenation2_eq_Book_2_1_concatenation3 p q) =
    (Book_2_1_concatenation1_eq_Book_2_1_concatenation3 p q).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 432
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 433
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 434
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 435
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 436
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:fourth-concat *)
(** Exercise 2.3 *)

(* Since we have x_eq_y : x = y we can transport y_eq_z : y = z along
   x_eq_y⁻¹ : y = x in the type family λw.(w = z) to obtain a term
   of type x = z. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 443
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_1_concatenation4
    {A : Type} {x y z : A} : x = y -&gt; y = z -&gt; x = z :=
  fun x_eq_y y_eq_z =&gt; transport (fun w =&gt; w = z) (inverse x_eq_y) y_eq_z.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 445
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Notation "p *4 q" := (Book_2_1_concatenation4 p q) (at level 10).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 447
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition Book_2_1_concatenation1_eq_Book_2_1_concatenation4 :
    forall {A : Type} {x y z : A} (p : x = y) (q : y = z), (p *1 q = p *4 q).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 449
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 451
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 452
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:npaths *)
(** Exercise 2.4 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 457
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_4_npath : nat -&gt; Type -&gt; Type
  := nat_ind (fun (n : nat) =&gt; Type -&gt; Type)
             (* 0-dimensional paths are elements *)
             (fun A =&gt; A)
             (* (n+1)-dimensional paths are paths between n-dimimensional paths *)
             (fun n f A =&gt; (exists a1 a2 : (f A), a1 = a2)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 462
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* This is the intuition behind definition of nboundary:
   As we've defined them, every (n+1)-path is a path between two n-paths. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 465
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma npath_as_sig : forall {n : nat} {A : Type},
    (Book_2_4_npath (S n) A) = (exists (p1 p2 : Book_2_4_npath n A), p1 = p2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 466
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 467
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 468
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 469
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* It can be helpful to take a look at what this definition does.
   Try uncommenting the following lines: *)
(*
Context {A : Type}.
Eval compute in (Book_2_4_npath 0 A). (* = A : Type *)
Eval compute in (Book_2_4_npath 1 A). (* = {a1 : A &amp; {a2 : A &amp; a1 = a2}} : Type *)
Eval compute in (Book_2_4_npath 2 A). (* and so on... *)
*)

(* Given an (n+1)-path, we simply project to a pair of n-paths. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 480
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition Book_2_4_nboundary
  : forall {n : nat} {A : Type}, Book_2_4_npath (S n) A -&gt;
                          (Book_2_4_npath n A * Book_2_4_npath n A)
  := fun {n} {A} p =&gt; (pr1 p, pr1 (pr2 p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 483
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:ap-to-apd-equiv-apd-to-ap *)
(** Exercise 2.5 *)

(* Note that "@" is notation for concatentation and ^ is for inversion *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 489
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition Book_eq_2_3_6 {A B : Type} {x y : A} (p : x = y) (f : A -&gt; B)
  : (f x = f y) -&gt; (transport (fun _ =&gt; B) p (f x) = f y) :=
  fun fx_eq_fy =&gt;
    (HoTT.Basics.PathGroupoids.transport_const p (f x)) @ fx_eq_fy.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 492
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

Definition Book_eq_2_3_7 {A B : Type} {x y : A} (p : x = y) (f : A -&gt; B)
  : (transport (fun _ =&gt; B) p (f x) = f y) -&gt; f x = f y :=
  fun fx_eq_fy =&gt;
    (HoTT.Basics.PathGroupoids.transport_const p (f x))^ @ fx_eq_fy.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* By induction on p, it suffices to assume that x ≡ y and p ≡ refl, so
   the above equations concatenate identity paths, which are units under
   concatenation.

   [isequiv_adjointify] is one way to prove two functions form an equivalence,
   specifically one proves that they are (category-theoretic) sections of one
   another, that is, each is a right inverse for the other. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 505
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Equivalence_Book_eq_2_3_6_and_Book_eq_2_3_6
           {A B : Type} {x y : A} (p : x = y) (f : A -&gt; B)
    : IsEquiv (Book_eq_2_3_6 p f).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 507
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 508
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
  apply (isequiv_adjointify (Book_eq_2_3_6 p f) (Book_eq_2_3_7 p f));
    unfold Book_eq_2_3_6, Book_eq_2_3_7, transport_const;
    induction p;
    intros y;
    do 2 (rewrite concat_1p);
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 514
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:equiv-concat *)
(** Exercise 2.6 *)

(* This exercise is solved in the library as
   HoTT.Types.Paths.isequiv_concat_l
 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition concat_left {A : Type} {x y : A} (z : A) (p : x = y)
    : (y = z) -&gt; (x = z) :=
  fun q =&gt; p @ q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 525
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition concat_right {A : Type} {x y : A} (z : A) (p : x = y)
    : (x = z) -&gt; (y = z) :=
  fun q =&gt; (inverse p) @ q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 529
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Again, by induction on p, it suffices to assume that x ≡ y and p ≡ refl, so
   the above equations concatenate identity paths, which are units under
   concatenation. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 533
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_6 {A : Type} {x y z : A} (p : x = y)
  : IsEquiv (concat_left z p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 534
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 535
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  apply (isequiv_adjointify (concat_left z p) (concat_right z p));
    induction p;
    unfold concat_right, concat_left;
    intros y;
    do 2 (rewrite concat_1p);
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 541
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 542
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:ap-sigma *)
(** Exercise 2.7 *)

(* Already solved as ap_functor_sigma; there is a copy here for completeness *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 548
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_2_7.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 548
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
  Definition Book_2_7 {A B : Type} {P : A -&gt; Type} {Q : B -&gt; Type}
            (f : A -&gt; B) (g : forall a, P a -&gt; Q (f a))
            (u v : sig P) (p : u.1 = v.1) (q : p # u.2 = v.2)
  : ap (functor_sigma f g) (path_sigma P u v p q)
    = path_sigma Q (functor_sigma f g u) (functor_sigma f g v)
                (ap f p)
                ((transport_compose Q f p (g u.1 u.2))^
                  @ (@ap_transport _ P (fun x =&gt; Q (f x)) _ _ p g u.2)^
                  @ ap (g v.1) q).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 557
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 558
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
    destruct u as [u1 u2]; destruct v as [v1 v2]; simpl in p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 559
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    destruct p; simpl in q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 560
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    destruct q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 561
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 562
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 563
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
End Book_2_7.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 564
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:ap-coprod *)
(** Exercise 2.8 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 568
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_8 := @HoTT.Types.Sum.ap_functor_sum.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 568
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:coprod-ump *)
(** Exercise 2.9 *)

(* This exercise is solved in the library as
   HoTT.Types.Sum.equiv_sum_ind
 *)
(* To extract a function on either summand, compose with the injections *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 576
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition coprod_ump1 {A B X} : (A + B -&gt; X) -&gt; (A -&gt; X) * (B -&gt; X) :=
  fun f =&gt; (f o inl, f o inr).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 577
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* To create a function on the direct sum from functions on the summands, work
   by cases *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 580
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition coprod_ump2 {A B X} : (A -&gt; X) * (B -&gt; X) -&gt; (A + B -&gt; X) :=
  prod_ind (fun _ =&gt; A + B -&gt; X) (fun f g =&gt; sum_ind (fun _ =&gt; X) f g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_2_9 {A B X} `{Funext} : (A -&gt; X) * (B -&gt; X) &lt;~&gt; (A + B -&gt; X).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 583
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (equiv_adjointify coprod_ump2 coprod_ump1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 584
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 586
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 586
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 587
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [a | b]; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 588
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 589
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [f g].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 589
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 590
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:sigma-assoc *)
(** Exercise 2.10 *)

(* This exercise is solved in the library as
   HoTT.Types.Sigma.equiv_sigma_assoc
 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 599
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section TwoTen.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 599
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{A : Type} {B : A -&gt; Type} {C : (exists a : A, B a) -&gt; Type}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 600
Time: 0.03s">
<div class="time" style="width: 24.793388429752%"></div>
<pre>

  Local Definition f210 : (exists a : A, (exists b : B a, (C (a; b)))) -&gt;
                          (exists (p : exists a : A, B a), (C p)) :=
    fun pairpair =&gt;
      match pairpair with (a; pp) =&gt;
        match pp with (b; c) =&gt; ((a; b); c) end
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 607
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Local Definition g210 : (exists (p : exists a : A, B a), (C p)) -&gt;
                          (exists a : A, (exists b : B a, (C (a; b)))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 610
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 611
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros pairpair.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 612
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction pairpair as [pair c].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 613
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction pair as [a b].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (a; (b; c)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 615
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_10 : (exists a : A, (exists b : B a, (C (a; b)))) &lt;~&gt;
                         (exists (p : exists a : A, B a), (C p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 619
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 620
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (equiv_adjointify f210 g210); compute; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 621
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 622
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End TwoTen.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 623
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:pullback *)
(** Exercise 2.11 *)

(** The definition of commutative squares in HoTT.Limits.Pullback is slightly different, using a homotopy between the composites instead of a path. *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 629
Time: 0.004s">
<div class="time" style="width: 3.3057851239669%"></div>
<pre>Definition Book_2_11 `{H : Funext} {X A B C} (f : A -&gt; C) (g : B -&gt; C)
  : (X -&gt; HoTT.Limits.Pullback.Pullback f g)
    &lt;~&gt; HoTT.Limits.Pullback.Pullback (fun h : X -&gt; A =&gt; f o h) (fun k : X -&gt; B =&gt; g o k)
  := HoTT.Limits.Pullback.equiv_ispullback_commsq f g
    oE (HoTT.Limits.Pullback.equiv_pullback_corec f g)^-1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 633
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:pullback-pasting *)
(** Exercise 2.12 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 637
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_12_i := @HoTT.Limits.Pullback.ispullback_pasting_left.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 637
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_2_12_ii := @HoTT.Limits.Pullback.ispullback_pasting_outer.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:eqvboolbool *)
(** Exercise 2.13 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 643
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_13 := @HoTT.Types.Bool.equiv_bool_aut_bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 643
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:equality-reflection *)
(** Exercise 2.14 *)

(** Assuming the equality reflection rule, given any [q : x = y], [x] and [y] are definitionally equal, so [q] and [refl_x] have the same type [x = x]. We can form the type [forall x y, forall q, q = refl_x]. A path induction produces an element [r], with [r x x p : p = refl_x], which is also definitional by the equality reflection rule. *)

(* ================================================== ex:strengthen-transport-is-ap *)
(** Exercise 2.15 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 652
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition Book_2_15 {A} (B : A -&gt; Type) {x y : A} (p : x = y)
  : transport B p = HoTT.Types.Universe.equiv_path _ _ (ap B p)
  := match p with 1 =&gt; 1 end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 654
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:strong-from-weak-funext *)
(** Exercise 2.16 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_16 := @HoTT.Metatheory.FunextVarieties.NaiveFunext_implies_Funext.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:equiv-functor-types *)
(** Exercise 2.17 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 662
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_2_17_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 662
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {A A' B B' : Type} (f : A &lt;~&gt; A') (g : B &lt;~&gt; B').</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 663
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_i_prod : A * B &lt;~&gt; A' * B'
    := HoTT.Types.Prod.equiv_functor_prod' f g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 666
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_ii_prod `{Univalence} : A * B &lt;~&gt; A' * B'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 668
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 669
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_path.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 670
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (ap011 prod (path_universe_uncurried f) (path_universe_uncurried g)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 671
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 672
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_eq_prod' (p : A = A') (q : B = B')
    : transport idmap (ap011 prod p q)
      = functor_prod (transport idmap p) (transport idmap q).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 676
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 677
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    clear f g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 678
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 679
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 680
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 681
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_2_17_eq_prod `{Univalence}
    : Book_2_17_ii_prod = Book_2_17_i_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 684
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 685
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_equiv; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 686
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    lhs napply Book_2_17_eq_prod'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 687
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply ap011.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 688
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 689
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply transport_idmap_path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 689
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 690
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply transport_idmap_path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 690
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 691
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_2_17_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 692
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Book_2_17_sigma.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {A A' : Type} {B : A -&gt; Type} {B' : A' -&gt; Type}
    (f : A &lt;~&gt; A') (g : forall a, B a &lt;~&gt; B' (f a)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 696
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_i_sigma : {a : A &amp; B a} &lt;~&gt; {a' : A' &amp; B' a'}
    := HoTT.Types.Sigma.equiv_functor_sigma' f g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 699
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>

  Definition Book_2_17_path_fibr_1 (p : A = A')
    (q : B = B' o (transport idmap p))
    : (transport (fun A0 =&gt; A0 -&gt; Type) p B) = B'
    := moveR_transport_p _ _ _ _
        (transport (fun p0 =&gt; B = B' o (_ p0)) (inv_V p)^ q
           @ (transport_arrow_toconst' p^ B')^).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 706
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 

  Definition Book_2_17_ii_sigma `{Univalence}
    : {a : A &amp; B a} &lt;~&gt; {a' : A' &amp; B' a'}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 709
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 710
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_path.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 711
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply ap011D.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 712
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 713
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (path_universe_uncurried f).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 713
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 714
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply Book_2_17_path_fibr_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 714
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_arrow; intro a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 715
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 716
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (transport (fun f0 =&gt; _ &lt;~&gt; _ (f0 _))
        (transport_idmap_path_universe_uncurried _)^).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 718
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 719
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 720
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Definition Book_2_17_eq_sigma' (p : A = A')
    (q : B = B' o (transport idmap p))
    : transport idmap (ap011D (@sig) p (Book_2_17_path_fibr_1 p q))
      = functor_sigma (transport idmap p)
          (fun a =&gt; transport idmap (ap10 q a)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 726
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 727
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold Book_2_17_path_fibr_1; destruct p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 728
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change (B = B') in q; destruct q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 729
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 730
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 731
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_2_17_eq_sigma `{Univalence}
    : Book_2_17_ii_sigma = Book_2_17_i_sigma.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 734
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 735
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_equiv; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 736
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    lhs napply Book_2_17_eq_sigma'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 737
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    snapply ap011D.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 738
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 739
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply transport_idmap_path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 739
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 740
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre> destruct (transport_idmap_path_universe_uncurried f); simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 740
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall; intro a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 741
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
      lhs napply (ap (fun h =&gt; _ (h _)) (eisretr _ _)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 742
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply transport_idmap_path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 743
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 744
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
End Book_2_17_sigma.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 745
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Book_2_17_arrow.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 747
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Funext} {A A' B B' : Type} (f : A' &lt;~&gt; A) (g : B &lt;~&gt; B').</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 748
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_i_arrow : (A -&gt; B) &lt;~&gt; (A' -&gt; B')
    := HoTT.Types.Arrow.equiv_functor_arrow' f g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 751
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_ii_arrow `{Univalence} : (A -&gt; B) &lt;~&gt; (A' -&gt; B').</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 753
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 754
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_path.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 755
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (ap011 arrow (path_universe_uncurried f)^ (path_universe_uncurried g)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 756
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 757
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_eq_arrow' (p : A' = A) (q : B = B')
    : transport idmap (ap011 arrow p^ q)
      = functor_arrow (transport idmap p) (transport idmap q).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 761
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 762
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    clear f g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 763
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 764
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 765
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 766
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_2_17_eq_arrow `{Univalence}
    : Book_2_17_ii_arrow = Book_2_17_i_arrow.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 769
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 770
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_equiv; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 771
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    lhs napply Book_2_17_eq_arrow'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 772
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply ap011.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 773
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 774
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply transport_idmap_path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 774
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 775
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (ap (fun g0 _ =&gt; g0)
        (transport_idmap_path_universe_uncurried g)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 776
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 777
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_2_17_arrow.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 778
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Book_2_17_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 780
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Funext} {A A' : Type} {B : A -&gt; Type} {B' : A' -&gt; Type}
    (f : A' &lt;~&gt; A) (g : forall a', B (f a') &lt;~&gt; B' a').</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 782
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_i_forall : (forall a, B a) &lt;~&gt; (forall a', B' a')
    := HoTT.Types.Forall.equiv_functor_forall' f g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 785
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>

  Definition Book_2_17_path_fibr_2 (p : A' = A)
    (q : B o (transport idmap p) = B')
    : (transport (fun A0 =&gt; A0 -&gt; Type) p^ B) = B'
    := (transport_arrow_toconst' p^ B)
       @ (transport (fun p0 =&gt; B o (_ p0) = B') (inv_V p)^ q).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 791
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_ii_forall `{Univalence}
    : (forall a, B a) &lt;~&gt; (forall a', B' a').</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 794
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 795
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_path.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 796
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    snapply (ap011D (fun A0 B0 =&gt; forall a0, B0 a0)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 797
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 798
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (path_universe_uncurried f)^.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 798
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 799
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply Book_2_17_path_fibr_2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 799
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_arrow; intro a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 800
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 801
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      napply (transport (fun f0 =&gt; B (f0 _) &lt;~&gt; _)
        (transport_idmap_path_universe_uncurried f)^).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 803
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 804
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 805
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Definition Book_2_17_eq_forall' (p : A' = A)
    (q : B o (transport idmap p) = B')
    : transport idmap
      (ap011D (fun A0 B0 =&gt; forall a0, B0 a0) p^ (Book_2_17_path_fibr_2 p q))
      = functor_forall (transport idmap p)
          (fun a =&gt; transport idmap (ap10 q a)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 812
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 813
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold Book_2_17_path_fibr_2; destruct p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 814
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl in q; destruct q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 815
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 816
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 817
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_2_17_eq_forall `{Univalence}
    : Book_2_17_ii_forall = Book_2_17_i_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 820
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 821
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_equiv; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 822
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    lhs napply Book_2_17_eq_forall'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 823
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    snapply ap011D.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 824
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 825
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply transport_idmap_path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 825
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 826
Time: 0.01s">
<div class="time" style="width: 8.2644628099174%"></div>
<pre> destruct (transport_idmap_path_universe_uncurried f); simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 826
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall; intro a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 827
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
      lhs napply (ap (fun h =&gt; _ (h _)) (eisretr _ _)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 828
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply transport_idmap_path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 829
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 830
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
End Book_2_17_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 831
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Book_2_17_sum.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 833
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {A A' B B' : Type} (f : A &lt;~&gt; A') (g : B &lt;~&gt; B').</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 834
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_i_sum : A + B &lt;~&gt; A' + B'
    := HoTT.Types.Sum.equiv_functor_sum' f g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 837
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_ii_sum `{Univalence} : A + B &lt;~&gt; A' + B'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 839
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 840
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_path.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 841
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (ap011 sum (path_universe_uncurried f) (path_universe_uncurried g)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 842
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 843
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_2_17_eq_sum' `{Funext} (p : A = A') (q : B = B')
    : transport idmap (ap011 sum p q)
      = functor_sum (transport idmap p) (transport idmap q).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 847
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 848
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    clear f g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 849
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct p, q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 850
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_arrow; intros [?|?]; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 851
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 852
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Book_2_17_eq_sum `{Univalence}
    : Book_2_17_ii_sum = Book_2_17_i_sum.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 855
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 856
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_equiv; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 857
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    lhs napply Book_2_17_eq_sum'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 858
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply ap011.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 859
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 860
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply transport_idmap_path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 860
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 861
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply transport_idmap_path_universe_uncurried.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 861
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 862
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_2_17_sum.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 863
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:dep-htpy-natural *)
(** Exercise 2.18 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 867
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_2_18 := @HoTT.Basics.PathGroupoids.apD_natural.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 867
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:equiv-functor-set *)
(** Exercise 3.1 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 871
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_1_solution_1 {A B} (f : A &lt;~&gt; B) (H : IsHSet A)
  := @HoTT.Basics.Trunc.istrunc_equiv_istrunc A B f 0 H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 872
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Alternative solutions: [Book_3_1_solution_2] using UA, and [Book_3_1_solution_3] using two easy lemmas that may be of independent interest *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 875
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_1_solution_2 `{Univalence} {A B} : A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 875
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 876
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro e.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 877
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite (path_universe_uncurried e).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 878
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 879
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 880
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

Lemma retr_f_g_path_in_B {A B} (f : A -&gt; B)  (g : B -&gt; A)
  (alpha : f o g == idmap) (x y : B) (p : x = y)
  :  p = (alpha x)^ @ (ap f (ap g p)) @ (alpha y).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 884
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 885
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 886
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 887
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite concat_p1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 888
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite concat_Vp.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 889
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 890
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 891
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma retr_f_g_isHSet_A_so_B {A B} (f : A -&gt; B)  (g : B -&gt; A)
      : f o g == idmap -&gt; IsHSet A -&gt; IsHSet B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 894
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 895
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros retr_f_g isHSet_A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 896
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  srapply hset_axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 897
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 897
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 898
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (ap g p = 1) as g_p_is_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 899
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 900
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply (axiomK_hset isHSet_A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 900
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 901
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert (1 = (retr_f_g x) ^ @ (ap f (ap g p)) @ (retr_f_g x)) as rhs_is_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 901
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 902
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite g_p_is_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 902
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 902
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite concat_p1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 902
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite concat_Vp.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 902
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 902
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 903
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite (rhs_is_1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 903
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (retr_f_g_path_in_B f g retr_f_g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 904
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 905
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma Book_3_1_solution_3 {A B} : A &lt;~&gt; B -&gt; IsHSet A -&gt; IsHSet B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 907
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 908
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros equivalent_A_B isHSet_A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 909
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  elim equivalent_A_B; intros f isequiv_f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 910
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  elim isequiv_f; intros g retr_f_g sect_f_g coh.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 911
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (retr_f_g_isHSet_A_so_B f g); assumption.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 912
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 913
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:isset-coprod *)
(** Exercise 3.2 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 917
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_2_solution_1 := @HoTT.Types.Sum.ishset_sum.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 917
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Alternative solution for replaying *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 920
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_2_solution_2 (A B : Type) : IsHSet A -&gt; IsHSet B -&gt; IsHSet (A+B).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 920
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 921
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros isHSet_A isHSet_B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 922
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  srapply hset_axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 923
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 923
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 923
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 923
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 924
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite (inverse (eisretr_path_sum p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 924
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite (axiomK_hset isHSet_A a (path_sum_inv p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 925
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl; exact idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 926
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 927
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre> rewrite (inverse (eisretr_path_sum p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 927
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite (axiomK_hset isHSet_B b (path_sum_inv p)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 928
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    simpl; exact idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 929
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 930
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:isset-sigma *)
(** Exercise 3.3 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 934
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_3_solution_1 (A : Type) (B : A -&gt; Type)
   := @HoTT.Types.Sigma.istrunc_sigma A B 0.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 935
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** This exercise is hard because 2-paths over Sigma types are not treated in the first three chapters of the book. Consult theories/Types/Sigma.v *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 938
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_3_solution_2 (A : Type) (B : A -&gt; Type) :
  IsHSet A -&gt; (forall x:A, IsHSet (B x)) -&gt; IsHSet { x:A | B x}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 939
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 940
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros isHSet_A allBx_HSet.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 941
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  srapply hset_axiomK.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 942
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x xx.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 942
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (path_path_sigma B x x xx 1) as useful.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 943
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (useful (axiomK_hset _ _ _) (hset_path2 _ _)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 944
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 945
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:prop-endocontr *)
(** Exercise 3.4 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 949
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_4_solution_1 `{Funext} (A : Type) : IsHProp A &lt;-&gt; Contr (A -&gt; A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 949
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 950
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  split.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 951
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 952
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro isHProp_A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 952
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (Build_Contr _ idmap).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 953
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 954
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* automagically, from IsHProp A *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 955
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>-</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 955
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro contr_AA.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 955
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply hprop_allpath; intros a1 a2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 956
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (ap10 (path_contr (fun x:A =&gt; a1) (fun x:A =&gt; a2)) a1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 957
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 958
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:prop-inhabcontr *)
(** Exercise 3.5 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 962
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_5_solution_1 := @HoTT.Universes.HProp.equiv_hprop_inhabited_contr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 962
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-mereprop *)
(** Exercise 3.6 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 966
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_6_solution_1 `{Funext} (A : Type) : IsHProp A -&gt; IsHProp (A + ~A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 966
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 967
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro isHProp_A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 968
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply hprop_allpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 969
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 969
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
  destruct x as [a1|n1]; destruct y as [a2|n2]; apply path_sum; try apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 970
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 971
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (n2 a1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 971
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 972
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (n1 a2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 972
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 973
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:disjoint-or *)
(** Exercise 3.7 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 977
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_7_solution_1 (A B: Type) :
  IsHProp A -&gt; IsHProp B -&gt; ~(A*B) -&gt; IsHProp (A+B).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 978
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 979
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros isHProp_A isProp_B nab.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 980
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply hprop_allpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 981
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 981
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct x as [a1|b1]; destruct y as [a2|b2]; apply path_sum; try apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 982
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 983
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (nab (a1,b2)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 983
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 984
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (nab (a2,b1)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 984
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 985
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:brck-qinv *)
(** Exercise 3.8 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 989
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition Book_3_8_qinv {A B : Type} (f : A -&gt; B) : Type
  := {g : B -&gt; A &amp; (f o g == idmap) * (g o f == idmap)}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 990
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Book_3_8_ctx.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 992
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {isequiv : forall {A B : Type}, (A -&gt; B) -&gt; Type}
    {cond_i : forall {A B : Type} (f : A -&gt; B), isequiv f -&gt; Book_3_8_qinv f}
    {cond_ii : forall {A B : Type} (f : A -&gt; B), Book_3_8_qinv f -&gt; isequiv f}
    {cond_iii : forall {A B : Type} (f : A -&gt; B), IsHProp (isequiv f)}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 996
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  
  Definition Book_3_8_cond_i {A B : Type} (f : A -&gt; B)
    : Trunc (-1) (Book_3_8_qinv f) -&gt; Book_3_8_qinv f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 999
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1000
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (cond_i _ _ f o _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1001
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  
    apply Trunc_rec, cond_ii.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1002
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1003
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_3_8_cond_ii {A B : Type} (f : A -&gt; B)
    : Book_3_8_qinv f -&gt; Trunc (-1) (Book_3_8_qinv f)
    := tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1007
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  
  Definition Book_3_8_cond_iii {A B : Type} (f : A-&gt; B)
    : IsHProp (Trunc (-1) (Book_3_8_qinv f))
    := _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1011
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_3_8_equiv {A B : Type} (f : A -&gt; B)
    : Trunc (-1) (Book_3_8_qinv f) &lt;~&gt; (isequiv _ _ f).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1014
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1015
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply equiv_iff_hprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1016
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1017
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1017
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1018
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply cond_iii.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1018
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1019
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply Trunc_rec, cond_ii.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1019
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1020
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1020
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply tr, cond_i, x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1021
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1022
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_3_8_ctx.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1023
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-impl-prop-equiv-bool *)
(** Exercise 3.9 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1027
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition LEM := forall (A : Type), IsHProp A -&gt; A + ~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1027
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

Definition LEM_hProp_Bool (lem : LEM) (hprop : HProp) : Bool
  := match (lem hprop _) with inl _ =&gt; true | inr _ =&gt; false end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1030
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma Book_3_9_solution_1 `{Univalence} : LEM -&gt; HProp &lt;~&gt; Bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1032
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1033
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro lem.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1034
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (equiv_adjointify (LEM_hProp_Bool lem) is_true).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1035
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1036
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros []; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1036
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1037
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold LEM_hProp_Bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1037
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (lem Unit_hp _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1037
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1038
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun _ =&gt; 1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1038
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1039
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro nUnit.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1039
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (nUnit tt).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1039
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1040
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold LEM_hProp_Bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1040
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (lem False_hp _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1040
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1041
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro fals.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1041
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim fals.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1041
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1042
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun _ =&gt; 1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1042
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1043
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro hprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1043
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold LEM_hProp_Bool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1044
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    elim (lem hprop _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1045
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1046
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1046
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_hprop; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1047
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* path_prop is silent *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1048
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>exact ((if_hprop_then_equiv_Unit hprop p)^-1)%equiv.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1048
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1049
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro np.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1049
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_hprop; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1050
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* path_prop is silent *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1051
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>exact ((if_not_hprop_then_equiv_Empty hprop np)^-1)%equiv.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1051
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1052
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-impred *)
(** Exercise 3.10 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1056
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_10_LEM@{j} := forall A : HProp@{j}, A + ~ A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1056
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_3_10_Lift@{i j | i &lt; j} (A : HProp@{i}) : HProp@{j}
  := @Build_HProp A (trunctype_istrunc A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1059
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition Book_3_10_impred@{i j k | i &lt; j, j &lt; k} `{Univalence}
  (LEM : Book_3_10_LEM@{j})
  : IsEquiv@{j k} Book_3_10_Lift@{i j}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1063
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1064
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply isequiv_adjointify.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1065
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1066
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1066
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct (LEM A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1066
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1067
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (Build_HProp Unit).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1067
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1068
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (Build_HProp Empty).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1068
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  }</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1069
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
  1-2: intro A; destruct (LEM _) as [a|na];
    apply path_hprop, equiv_inverse; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1071
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
  1,3: exact (if_hprop_then_equiv_Unit A a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1072
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1,2: exact (if_not_hprop_then_equiv_Empty A na).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1073
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1074
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:not-brck-A-impl-A *)
(** Exercise 3.11 *)

(** This theorem extracts the main idea leading to the contradiction constructed
    in the proof of Theorem 3.2.2, that univalence implies that all functions are
    natural with respect to equivalences.

    The terms are complicated, but it pretty much follows the proof in the book,
    step by step.
 *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1085
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma univalence_func_natural_equiv `{Univalence}
  : forall (C : Type -&gt; Type) (all_contr : forall A, Contr (C A -&gt; C A))
      (g : forall A, C A -&gt; A) {A : Type}  (e : A &lt;~&gt; A),
    e o (g A) = (g A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1088
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1089
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros C all_contr g A e.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1090
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1091
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  intros x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1093
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (p := path_universe_uncurried e).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1094
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (* The propositional computation rule for univalence of section 2.10 *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1097
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>refine (concat (happly (transport_idmap_path_universe_uncurried e)^ (g A x)) _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1097
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** To obtain the situation of 2.9.4, we rewrite x using

&lt;&lt;
        x = transport (fun A : Type =&gt; C A) p^ x
&gt;&gt;

      This equality holds because [(C A) -&gt; (C A)] is contractible, so

&lt;&lt;
        transport (fun A : Type =&gt; C A) p^ = idmap
&gt;&gt;

      In both Theorem 3.2.2 and the following result, the hypothesis
      [Contr ((C A) -&gt; (C A))] will follow from the contractibility of [(C A)].
   *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>refine (concat (ap _ (ap _ (happly (@path_contr _ (all_contr A)
                                                  idmap (transport _ p^)) x))) _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (* Equation 2.9.4 is called transport_arrow in the library. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>refine (concat (@transport_arrow _ (fun A =&gt; C A) idmap _ _ p (g A) x)^ _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  exact (happly (apD g p) x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1120
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For this proof, we closely follow the proof of Theorem 3.2.2
    from the text, replacing ¬¬A → A by ∥A∥ → A. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma Book_3_11 `{Univalence} : ~ (forall A, Trunc (-1) A -&gt; A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* The proof is by contradiction. We'll assume we have such a
     function, and obtain an element of 0. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>intros g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1128
Time: 0.009s">
<div class="time" style="width: 7.4380165289256%"></div>
<pre>

  assert (end_contr : forall A, Contr (Trunc (-1) A -&gt; Trunc (-1) A)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply Book_3_4_solution_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply istrunc_truncation.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1134
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  }</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** There are no fixpoints of the fix-point free autoequivalence of 2 (called
      negb). We will derive a contradiction by showing there must be such a fixpoint
      by naturality of g.

      We parametrize over b to emphasize that this proof depends only on the fact
      that Bool is inhabited, not on any specific value (we use "true" below).
   *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>pose
    (contr b :=
        (not_fixed_negb (g Bool b))
        (happly (univalence_func_natural_equiv _ end_contr g equiv_negb) b)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  contradiction (contr (tr true)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-impl-simple-ac *)
(** Exercise 3.12 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_12 (LEM: forall A, IsHProp A -&gt; A + ~ A)
  : forall A, Trunc (-1) (Trunc (-1) A -&gt; A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct (LEM (Trunc (-1) A) _) as [a|na].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert a; apply Trunc_rec; intro a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply tr, (fun a0 =&gt; a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro a0.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    elim (na a0).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:naive-lem-impl-ac *)
(** Exercise 3.13 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_3_13.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition naive_LEM_impl_DN_elim (A : Type) (LEM : A + ~A)
  : ~~A -&gt; A
    := fun nna =&gt; match LEM with
                    | inl a =&gt; a
                    | inr na =&gt; match nna na with end
                  end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma naive_LEM_implies_AC
  : (forall A : Type, A + ~A)
    -&gt; forall X A P,
         (forall x : X, ~~{ a : A x | P x a })
         -&gt; { g : forall x, A x | forall x, P x (g x) }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros LEM X A P H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (fun x =&gt; @naive_LEM_impl_DN_elim _ (LEM _) (H x)) as H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (fun x =&gt; (H' x).1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (fun x =&gt; (H' x).2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1186
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Lemma Book_3_13 `{Funext}
  : (forall A : Type, A + ~A)
    -&gt; forall X A P,
         IsHSet X
         -&gt; (forall x : X, IsHSet (A x))
         -&gt; (forall x (a : A x), IsHProp (P x a))
         -&gt; (forall x, merely { a : A x &amp; P x a })
         -&gt; merely { g : forall x, A x &amp; forall x, P x (g x) }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros LEM X A P HX HA HP H0.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (naive_LEM_implies_AC LEM).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1199
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    specialize (H0 x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    revert H0.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1202
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
    apply Trunc_rec.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (fun x nx =&gt; nx x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_3_13.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-brck *)
(** Exercise 3.14 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_3_14.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Funext}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Hypothesis LEM : forall A : Type, IsHProp A -&gt; A + ~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1212
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>

  Definition Book_3_14
  : forall A (P : ~~A -&gt; Type),
    (forall a, P (fun na =&gt; na a))
    -&gt; (forall x y (z : P x) (w : P y), transport P (path_ishprop x y) z = w)
    -&gt; forall x, P x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A P base p nna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assert (forall x, IsHProp (P x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply hprop_allpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x' y'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      etransitivity; [ symmetry; apply (p x x y' x') | ].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
     (* Without this it somehow proves [H'] using the wrong universe for hprop_Empty and fails when we do [Defined].
        See Coq #4862. *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>set (path := path_ishprop x x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1228
Time: 0.004s">
<div class="time" style="width: 3.3057851239669%"></div>
<pre>
      assert (H' : idpath = path) by apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> destruct (LEM (P nna) _) as [pnna|npnna]; trivial.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (match _ : Empty with end).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply nna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1235
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply npnna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1236
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
      exact (transport P (path_ishprop _ _) (base a)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma Book_3_14_equiv A : merely A &lt;~&gt; ~~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1240
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1241
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
    apply equiv_iff_hprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1243
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre> apply Trunc_rec.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (fun a na =&gt; na a).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro nna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (@Book_3_14 A (fun _ =&gt; merely A)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y z w.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply path_ishprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact nna.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_3_14.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:impred-brck *)
(** Exercise 3.15 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_15 := @HoTT.Metatheory.ImpredicativeTruncation.resized_Trm_rec_beta.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-impl-dn-commutes *)
(** Exercise 3.16 *)

(** This result holds in general when [Y x] is stable for each [x : X] *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_16 `{Funext} (LEM : forall A : HProp, A + ~ A)
  (X : HSet) (Y : X -&gt; HProp)
  : (forall x, ~~ Y x) &lt;~&gt; ~~ (forall x, Y x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1264
Time: 0.006s">
<div class="time" style="width: 4.9586776859504%"></div>
<pre>
  rapply equiv_iff_hprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct (LEM (Y x)) as [y|ny].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1270
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact y.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1270
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (f x ny).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f x ny.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1274
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (ny (g x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1275
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1276
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:prop-trunc-ind *)
(** Exercise 3.17 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1280
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition Book_3_17 {A : Type} {B : Trunc (-1) A -&gt; HProp}
  : (forall a : A, B (tr a)) -&gt; (forall x : Trunc (-1) A, B x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros f x.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  napply (Trunc_rec _ x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (transport B (path_ishprop (tr a) x) (f a)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:lem-ldn *)
(** Exercise 3.18 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_18_i := @HoTT.ExcludedMiddle.LEM_to_DNE.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  
Definition Book_3_18_ii := @HoTT.ExcludedMiddle.DNE_to_LEM.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:decidable-choice *)
(** Exercise 3.19 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_19 := @HoTT.Misc.BoundedSearch.minimal_n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:omit-contr2 *)
(** Exercise 3.20 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_20 := @HoTT.Types.Sigma.equiv_contr_sigma.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:isprop-equiv-equiv-bracket *)
(** Exercise 3.21 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_21 `{Funext} (P : Type) : IsHProp P &lt;~&gt; (P &lt;~&gt; Trunc (-1) P).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1306
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
  rapply equiv_iff_hprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1307
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro h.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (* See also [equiv_to_O]. *)
   </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>rapply equiv_iff_hprop.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (Trunc_rec idmap).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro e.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (istrunc_equiv_istrunc _ e^-1%equiv).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:finite-choice *)
(** Exercise 3.22 *)

(** Another form of this statement is proven in the library as [finite_choice] *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1320
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition Book_3_22 {n : nat} {A : Fin n -&gt; HSet}
  (P : forall (x : Fin n) (a : A x), HProp)
  : (forall x, Trunc (-1) {a : A x &amp; P x a})
    -&gt; Trunc (-1) {g : forall x, A x &amp; forall x, P x (g x)}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1323
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction n as [| m IH].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snrefine (_ ; _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1328
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1-2: intro bot; elim bot.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert (cl : Trunc (-1) {g : forall xl : Fin m, A (inl xl)
      &amp; forall xl : Fin m, P (inl xl) (g xl)}).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply (IH (A o inl) (fun xl a =&gt; P (inl xl) a)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro xl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    }</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (cr := f (inr tt)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1336
Time: 0.018s">
<div class="time" style="width: 14.876033057851%"></div>
<pre>
    strip_truncations.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snrefine (_ ; _); intros [xl|[]].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1339
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply cl.1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact cr.1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply cl.2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact cr.2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1343
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:decidable-choice-strong *)
(** Exercise 3.23 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1348
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_23 := @HoTT.Misc.BoundedSearch.minimal_n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1348
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:n-set *)
(** Exercise 3.24 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_3_24 := @HoTT.Spaces.Nat.Paths.equiv_path_nat.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:two-sided-adjoint-equivalences *)
(** Exercise 4.1 *)



(* ================================================== ex:symmetric-equiv *)
(** Exercise 4.2 *)



(* ================================================== ex:qinv-autohtpy-no-univalence *)
(** Exercise 4.3 *)



(* ================================================== ex:unstable-octahedron *)
(** Exercise 4.4 *)



(* ================================================== ex:2-out-of-6 *)
(** Exercise 4.5 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_4_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Section parts.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Variables A B C D : Type.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Variable f : A -&gt; B.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1379
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Variable g : B -&gt; C.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Variable h : C -&gt; D.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context `{IsEquiv _ _ (g o f), IsEquiv _ _ (h o g)}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Local Instance Book_4_5_g : IsEquiv g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1384
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1385
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply isequiv_biinv.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1386
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      split.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1387
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1388
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exists ((h o g)^-1 o h).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1388
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (eissect (h o g)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1389
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1390
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exists (f o (g o f)^-1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1390
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (eisretr (g o f)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1391
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Local Instance Book_4_5_f : IsEquiv f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1395
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
      apply (isequiv_homotopic (g^-1 o (g o f))); try exact _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1396
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro; apply (eissect g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1397
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1398
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Local Instance Book_4_5_h : IsEquiv h.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1401
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
      apply (isequiv_homotopic ((h o g) o g^-1)); try exact _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro; apply (ap h); apply (eisretr g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition Book_4_5_hgf : IsEquiv (h o g o f).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1407
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
      typeclasses eauto.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1409
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  End parts.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1410
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (*Lemma Book_4_5 A B f `{IsEquiv A B f} (a a' : A) : IsEquiv (@ap _ _ f a a').
  Proof.
    pose (@ap _ _ (f^-1) (f a) (f a')) as f'.
    pose (fun p : f^-1 (f a) = _ =&gt; p @ (@eissect _ _ f _ a')) as g'.
    pose (fun p : _ = a' =&gt; (@eissect _ _ f _ a)^ @ p) as h'.
    pose (g' o f').
    pose (h' o g').
    admit.
  Qed.*)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>End Book_4_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:qinv-univalence *)
(** Exercise 4.6 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_4_6_i.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition is_qinv {A B : Type} (f : A -&gt; B)
    := { g : B -&gt; A &amp; (f o g == idmap) * (g o f == idmap) }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition qinv (A B : Type)
    := { f : A -&gt; B &amp; is_qinv f }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1429
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition qinv_id A : qinv A A
    := (fun x =&gt; x; (fun x =&gt; x ; (fun x =&gt; 1, fun x =&gt; 1))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1431
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition qinv_path A B : (A = B) -&gt; qinv A B
    := fun p =&gt; match p with 1 =&gt; qinv_id _ end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1433
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition QInv_Univalence_type := forall (A B : Type@{i}),
      is_qinv (qinv_path A B).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1435
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition isequiv_qinv {A B} {f : A -&gt; B}
    : is_qinv f -&gt; IsEquiv f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1437
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1438
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [g [s r]].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1439
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (isequiv_adjointify f g s r).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition equiv_qinv_path (qua: QInv_Univalence_type) (A B : Type)
    : (A = B) &lt;~&gt; qinv A B
    := Build_Equiv _ _ (qinv_path A B) (isequiv_qinv (qua A B)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1444
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Definition qinv_isequiv {A B} (f : A -&gt; B) `{IsEquiv _ _ f}
    : qinv A B
    := (f ; (f^-1 ; (eisretr f , eissect f))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1448
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context `{qua : QInv_Univalence_type}.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem qinv_univalence_isequiv_postcompose {A B : Type} {w : A -&gt; B}
          `{H0 : IsEquiv A B w} C : IsEquiv (fun (g:C-&gt;A) =&gt; w o g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold QInv_Univalence_type in *.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (w' := qinv_isequiv w).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1456
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
    refine (isequiv_adjointify
              (fun (g:C-&gt;A) =&gt; w o g)
              (fun (g:C-&gt;B) =&gt; w^-1 o g)
              _
              _);
    intros g;
    first [ change ((fun x =&gt; w'.1 ( w'.2.1 (g x))) = g)
          | change ((fun x =&gt; w'.2.1 ( w'.1 (g x))) = g) ];
    clearbody w'; clear H0 w;
    rewrite &lt;- (@eisretr _ _ (@qinv_path A B) (isequiv_qinv (qua A B)) w');
    generalize ((@equiv_inv _ _ (qinv_path A B) (isequiv_qinv (qua A B))) w');
    intro p; clear w'; destruct p; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1468
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1469
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Now the rest is basically copied from UnivalenceImpliesFunext, with name changes so as to use the current assumption of qinv-univalence rather than a global assumption of ordinary univalence. *)

 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1473
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Local Instance isequiv_src_compose A B
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (fun g =&gt; (fst o pr1) o g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1476
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1477
Time: 0.01s">
<div class="time" style="width: 8.2644628099174%"></div>
<pre>
    rapply @qinv_univalence_isequiv_postcompose.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1478
Time: 0.007s">
<div class="time" style="width: 5.7851239669421%"></div>
<pre>
    refine (isequiv_adjointify
              (fst o pr1) (fun x =&gt; ((x, x); idpath))
              (fun _ =&gt; idpath)
              _);
      let p := fresh in
      intros [[? ?] p];
        simpl in p; destruct p;
        reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1486
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1487
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Local Instance isequiv_tgt_compose A B
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (fun g =&gt; (snd o pr1) o g).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1492
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1493
Time: 0.01s">
<div class="time" style="width: 8.2644628099174%"></div>
<pre>
    rapply @qinv_univalence_isequiv_postcompose.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1494
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
    refine (isequiv_adjointify
              (snd o pr1) (fun x =&gt; ((x, x); idpath))
              (fun _ =&gt; idpath)
              _);
      let p := fresh in
      intros [[? ?] p];
        simpl in p; destruct p;
        reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1502
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem QInv_Univalence_implies_FunextNondep (A B : Type)
  : forall f g : A -&gt; B, f == g -&gt; f = g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1507
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros f g p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1508
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (d := fun x : A =&gt; exist (fun xy =&gt; fst xy = snd xy) (f x, f x) (idpath (f x))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1509
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (e := fun x : A =&gt; exist (fun xy =&gt; fst xy = snd xy) (f x, g x) (p x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1510
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change f with ((snd o pr1) o d).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1511
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change g with ((snd o pr1) o e).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1512
Time: 0.006s">
<div class="time" style="width: 4.9586776859504%"></div>
<pre>
    rapply (ap (fun g =&gt; snd o pr1 o g)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1513
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    pose (fun A B x y=&gt; @equiv_inv _ _ _ (@isequiv_ap _ _ _ (@isequiv_src_compose A B) x y)) as H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1514
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1516
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1517
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition QInv_Univalence_implies_Funext_type : Funext_type
    := NaiveNondepFunext_implies_Funext QInv_Univalence_implies_FunextNondep.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1520
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>

End Book_4_6_i.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section EquivFunctorFunextType.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1524
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* We need a version of [equiv_functor_forall_id] that takes a [Funext_type] rather than a global axiom [Funext].  *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1526
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context (fa : Funext_type).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1526
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition ft_path_forall {A : Type} {P : A -&gt; Type} (f g : forall x : A, P x) :
  f == g -&gt; f = g
  :=
  @equiv_inv _ _ (@apD10 A P f g) (fa _ _ _ _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1531
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Instance ft_isequiv_functor_forall
        {A B:Type} `{P : A -&gt; Type} `{Q : B -&gt; Type}
          {f : B -&gt; A} {g : forall b:B, P (f b) -&gt; Q b}
        `{IsEquiv B A f} `{forall b, @IsEquiv (P (f b)) (Q b) (g b)}
    : IsEquiv (functor_forall f g) | 1000.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1537
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1538
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    simple refine (isequiv_adjointify
                     (functor_forall f g)
                     (functor_forall
                        (f^-1)
                        (fun (x:A) (y:Q (f^-1 x)) =&gt; eisretr f x # (g (f^-1 x))^-1 y
                     )) _ _);
      intros h.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1545
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1546
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre> abstract (
          apply ft_path_forall; intros b; unfold functor_forall;
          rewrite eisadj;
          rewrite &lt;- transport_compose;
          rewrite ap_transport;
          rewrite eisretr;
          apply apD
        ).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1553
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1554
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre> abstract (
          apply ft_path_forall; intros a; unfold functor_forall;
          rewrite eissect;
          apply apD
        ).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1558
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1559
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>

  Definition ft_equiv_functor_forall
        {A B:Type} `{P : A -&gt; Type} `{Q : B -&gt; Type}
        (f : B -&gt; A) `{IsEquiv B A f}
        (g : forall b:B, P (f b) -&gt; Q b)
        `{forall b, @IsEquiv (P (f b)) (Q b) (g b)}
  : (forall a, P a) &lt;~&gt; (forall b, Q b)
    := Build_Equiv _ _ (functor_forall f g) _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1567
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

  Definition ft_equiv_functor_forall_id
        {A:Type} `{P : A -&gt; Type} `{Q : A -&gt; Type}
        (g : forall a, P a &lt;~&gt; Q a)
  : (forall a, P a) &lt;~&gt; (forall a, Q a)
    := ft_equiv_functor_forall (equiv_idmap A) g.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1573
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End EquivFunctorFunextType.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1575
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Using the Kraus-Sattler space of loops rather than the version in the book, since it is simpler and avoids use of propositional truncation. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1577
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_4_6_ii
  (qua1 qua2 : QInv_Univalence_type) (* Two, since we need them at different universe levels. *)
  : ~ IsHProp (forall A : { X : Type &amp; X = X }, A = A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1579
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1580
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (fa := @QInv_Univalence_implies_Funext_type qua2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1582
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (K := forall (X:Type) (p:X=X), { q : X=X &amp; p @ q = q @ p }).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1583
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (e : K &lt;~&gt; forall A : { X : Type &amp; X = X }, A = A).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1584
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold K.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1585
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (equiv_sig_ind _ oE _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1586
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ft_equiv_functor_forall_id fa _); intros X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1587
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ft_equiv_functor_forall_id fa _); intros p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1588
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (equiv_path_sigma _ _ _ oE _); cbn.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1589
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (equiv_functor_sigma_id _); intros q.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1590
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine ((equiv_concat_l (transport_paths_lr q p)^ p)^-1 oE _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine ((equiv_concat_l (concat_p_pp _ _ _) _)^-1 oE _).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1592
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_moveR_Vp.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1593
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1593
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (HK := @istrunc_equiv_istrunc _ _ e^-1 (-1)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1594
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (u : forall (X:Type) (p:X=X), p @ 1 = 1 @ p).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1595
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros X p; rewrite concat_p1, concat_1p; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (alpha := (fun X p =&gt; (idpath X ; u X p)) : K).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (beta := (fun X p =&gt; (p ; 1)) : K).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1598
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (isequiv_qinv (qua1 Bool Bool)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1599
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  assert (r := pr1_path (apD10 (apD10 (path_ishprop alpha beta) Bool)
                     ((qinv_path Bool Bool)^-1 (qinv_isequiv equiv_negb)))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1601
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold alpha, beta in r; clear alpha beta.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1602
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (ap (qinv_path Bool Bool)) in r.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1603
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
  rewrite eisretr in r.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply pr1_path in r; cbn in r.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1605
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (true_ne_false (ap10 r true)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1606
Time: 0.008s">
<div class="time" style="width: 6.6115702479339%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1607
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Assuming qinv-univalence, every quasi-equivalence automatically satisfies one of the adjoint laws. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1609
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition allqinv_coherent (qua : QInv_Univalence_type)
           (A B : Type) (f : qinv A B)
  : (fun x =&gt; ap f.2.1 (fst f.2.2 x)) = (fun x =&gt; snd f.2.2 (f.2.1 x)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1611
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1612
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* Every quasi-equivalence is the image of a path, and can therefore be assumed to be the identity equivalence, for which the claim holds immediately. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>revert f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1614
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  equiv_intro (equiv_qinv_path qua A B) p.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1615
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct p; cbn; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1616
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1617
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Qinv-univalence is inconsistent. *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1619
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_4_6_iii (qua1 qua2 : QInv_Univalence_type) : Empty.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1619
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1620
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (Book_4_6_ii qua1 qua2).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1621
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  napply istrunc_succ.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1622
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (Build_Contr _ (fun A =&gt; 1)); intros u.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1623
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (allqinv_coherent qua2 _ _ (idmap; (idmap; (fun A =&gt; 1, u)))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1624
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1625
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:embedding-cancellable *)
(** Exercise 4.7 *)



(* ================================================== ex:cancellable-from-bool *)
(** Exercise 4.8 *)



(* ================================================== ex:funext-from-nondep *)
(** Exercise 4.9 *)



(* ================================================== ex:ind-lst *)
(** Exercise 5.1 *)



(* ================================================== ex:same-recurrence-not-defeq *)
(** Exercise 5.2 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1649
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_5_2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1649
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Here is one example of functions which are propositionally equal but not judgmentally equal.  They satisfy the same recurrence propositionally. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1651
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Let ez : Bool := true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1651
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let es : nat -&gt; Bool -&gt; Bool := fun _ =&gt; idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1652
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2_i : nat -&gt; Bool := nat_ind (fun _ =&gt; Bool) ez es.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1653
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2_ii : nat -&gt; Bool := fun _ =&gt; true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1654
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Fail Definition Book_5_2_not_defn_eq : Book_5_2_i = Book_5_2_ii := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1655
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Lemma Book_5_2_i_prop_eq : forall n, Book_5_2_i n = Book_5_2_ii n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1656
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1657
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction n; simpl; trivial.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1659
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_5_2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1660
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Book_5_2'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1662
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1663
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Here's another example where two functions are not (currently) definitionally equal, but satisfy the same recurrence judgmentally.  This example is a bit less robust; it fails in CoqMT. *)
 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1665
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Let ez : nat := 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1665
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let es : nat -&gt; nat -&gt; nat := fun _ =&gt; S.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1666
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_i : nat -&gt; nat := fun n =&gt; n + 1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1667
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_ii : nat -&gt; nat := fun n =&gt; 1 + n.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1668
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Fail Definition Book_5_2'_not_defn_eq : Book_5_2'_i = Book_5_2'_ii := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1669
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_i_eq_ez : Book_5_2'_i 0 = ez := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1670
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_ii_eq_ez : Book_5_2'_ii 0 = ez := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1671
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_i_eq_es n : Book_5_2'_i (S n) = es n (Book_5_2'_i n) := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1672
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_2'_ii_eq_es n : Book_5_2'_ii (S n) = es n (Book_5_2'_ii n) := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1673
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_5_2'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1674
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:one-function-two-recurrences *)
(** Exercise 5.3 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1678
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_5_3.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1678
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let ez : Bool := true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1679
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let es : nat -&gt; Bool -&gt; Bool := fun _ =&gt; idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1680
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let ez' : Bool := true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1681
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let es' : nat -&gt; Bool -&gt; Bool := fun _ _ =&gt; true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1682
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3 : nat -&gt; Bool := fun _ =&gt; true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1683
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_satisfies_ez : Book_5_3 0 = ez := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1684
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_satisfies_ez' : Book_5_3 0 = ez' := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1685
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_satisfies_es n : Book_5_3 (S n) = es n (Book_5_3 n) := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1686
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_satisfies_es' n : Book_5_3 (S n) = es' n (Book_5_3 n) := idpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1687
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition Book_5_3_es_ne_es' : ~(es = es')
    := fun H =&gt; false_ne_true (ap10 (ap10 H 0) false).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1689
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_5_3.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1690
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:bool *)
(** Exercise 5.4 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_5_4 := @HoTT.Types.Bool.equiv_bool_forall_prod.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:ind-nat-not-equiv *)
(** Exercise 5.5 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1698
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_5_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1698
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Let ind_nat (P : nat -&gt; Type) := fun x =&gt; @nat_ind P (fst x) (snd x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1699
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma Book_5_5 `{fs : Funext} : ~forall P : nat -&gt; Type,
                                     IsEquiv (@ind_nat P).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1702
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1703
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1704
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    specialize (H (fun _ =&gt; Bool)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1705
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (eissect (@ind_nat (fun _ =&gt; Bool)) (true, (fun _ _ =&gt; true))) as H1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1706
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (eissect (@ind_nat (fun _ =&gt; Bool)) (true, (fun _ =&gt; idmap))) as H2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1707
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    cut (ind_nat (fun _ : nat =&gt; Bool) (true, fun (_ : nat) (_ : Bool) =&gt; true)
         = (ind_nat (fun _ : nat =&gt; Bool) (true, fun _ : nat =&gt; idmap))).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1709
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1710
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro H'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1710
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply true_ne_false.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1711
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (ap10 (apD10 (ap snd (H1^ @ ap _ H' @ H2)) 0) false).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1712
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1713
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1713
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro n; induction n; trivial.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1714
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold ind_nat in *; simpl in *.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1715
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite &lt;- IHn.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1716
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct n; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1717
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1718
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_5_5.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1719
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:no-dep-uniqueness-failure *)
(** Exercise 5.6 *)



(* ================================================== ex:loop *)
(** Exercise 5.7 *)



(* ================================================== ex:loop2 *)
(** Exercise 5.8 *)



(* ================================================== ex:inductive-lawvere *)
(** Exercise 5.9 *)



(* ================================================== ex:ilunit *)
(** Exercise 5.10 *)



(* ================================================== ex:empty-inductive-type *)
(** Exercise 5.11 *)



(* ================================================== ex:Wprop *)
(** Exercise 5.12 *)



(* ================================================== ex:Wbounds *)
(** Exercise 5.13 *)



(* ================================================== ex:Wdec *)
(** Exercise 5.14 *)



(* ================================================== ex:Wbounds-loose *)
(** Exercise 5.15 *)



(* ================================================== ex:Wimpred *)
(** Exercise 5.16 *)



(* ================================================== ex:no-nullary-constructor *)
(** Exercise 5.17 *)



(* ================================================== ex:torus *)
(** Exercise 6.1 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1783
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_6_1_i := @HoTT.Cubical.DPath.dp_concat.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1783
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition Book_6_1_ii := @HoTT.Cubical.DPath.dp_apD_pp.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1784
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** We don't have the full induction principle for the torus *)
(* Definition Book_6_1_iii := ? *)

(* ================================================== ex:suspS1 *)
(** Exercise 6.2 *)



(* ================================================== ex:torus-s1-times-s1 *)
(** Exercise 6.3 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1795
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_6_3 := @HoTT.Spaces.Torus.TorusEquivCircles.equiv_torus_prod_Circle.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1795
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:nspheres *)
(** Exercise 6.4 *)



(* ================================================== ex:susp-spheres-equiv *)
(** Exercise 6.5 *)



(* ================================================== ex:spheres-make-U-not-2-type *)
(** Exercise 6.6 *)



(* ================================================== ex:monoid-eq-prop *)
(** Exercise 6.7 *)



(* ================================================== ex:free-monoid *)
(** Exercise 6.8 *)



(* ================================================== ex:unnatural-endomorphisms *)
(** Exercise 6.9 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1824
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_6_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1824
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Hypothesis LEM : forall A, IsHProp A -&gt; A + ~A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1825
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition Book_6_9 {ua : Univalence} : forall X, X -&gt; X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1827
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1828
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1829
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (@LEM (Contr { f : X &lt;~&gt; X &amp; ~(forall x, f x = x) }) _) as contrXEquiv.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1830
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct contrXEquiv as [C|notC].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1831
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1832
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (** In the case where we have exactly one autoequivalence which is not the identity, use it. *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1833
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>exact ((@center _ C).1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1833
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1834
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (** In the other case, just use the identity. *)
     </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1835
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>exact idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1835
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1836
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma bool_map_equiv_not_idmap (f : { f : Bool &lt;~&gt; Bool &amp; ~(forall x, f x = x) })
  : forall b, ~(f.1 b = b).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1839
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1840
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1841
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro H''.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1842
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply f.2.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1843
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro b'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1844
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (eval_bool_isequiv f.1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1845
Time: 0.004s">
<div class="time" style="width: 3.3057851239669%"></div>
<pre>
    destruct b', b, (f.1 true), (f.1 false);
      simpl in *;
      match goal with
        | _ =&gt; assumption
        | _ =&gt; reflexivity
        | [ H : true = false |- _ ] =&gt; exact (match true_ne_false H with end)
        | [ H : false = true |- _ ] =&gt; exact (match false_ne_true H with end)
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1853
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1854
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma Book_6_9_not_id {ua : Univalence} `{fs : Funext} : Book_6_9 Bool = negb.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1856
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1857
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_forall; intro b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1858
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold Book_6_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1859
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    destruct (@LEM (Contr { f : Bool &lt;~&gt; Bool &amp; ~(forall x, f x = x) }) _) as [C|H'].</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1860
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1861
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> set (f := @center _ C).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1861
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose proof (bool_map_equiv_not_idmap f b).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1862
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
      destruct (f.1 b), b;
      match goal with
        | _ =&gt; assumption
        | _ =&gt; reflexivity
        | [ H : ~(_ = _) |- _ ] =&gt; exact (match H idpath with end)
        | [ H : true = false |- _ ] =&gt; exact (match true_ne_false H with end)
        | [ H : false = true |- _ ] =&gt; exact (match false_ne_true H with end)
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1870
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1871
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre> refine (match H' _ with end).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1871
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (Build_Contr _ (exist (fun f : Bool &lt;~&gt; Bool =&gt;
                         ~(forall x, f x = x))
                      (Build_Equiv _ _ negb _)
                      (fun H =&gt; false_ne_true (H true))));
        simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1876
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1877
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_sigma_uncurried; simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1878
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
      refine ((fun H'' =&gt;
                 (equiv_path_equiv _ _ H'';
                  path_ishprop _ _))
                _);
        simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1883
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall; intro b'.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1884
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose proof (bool_map_equiv_not_idmap f b').</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1885
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
      destruct (f.1 b'), b';
      match goal with
        | _ =&gt; assumption
        | _ =&gt; reflexivity
        | [ H : ~(_ = _) |- _ ] =&gt; exact (match H idpath with end)
        | [ H : true = false |- _ ] =&gt; exact (match true_ne_false H with end)
        | [ H : false = true |- _ ] =&gt; exact (match false_ne_true H with end)
      end.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1893
Time: 0.003s">
<div class="time" style="width: 2.4793388429752%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1894
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Simpler solution not using univalence **)

 </pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1898
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition AllExistsOther(X : Type) := forall x:X, { y:X | y &lt;&gt; x }.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1898
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition centerAllExOthBool : AllExistsOther Bool :=
    fun (b:Bool) =&gt; (negb b ; not_fixed_negb b).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1901
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma centralAllExOthBool `{Funext} (f: AllExistsOther Bool) : centerAllExOthBool = f.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1903
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1904
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1904
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro b.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1904
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> pose proof (inverse (negb_ne (f b).2)) as fst.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1904
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold centerAllExOthBool.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1905
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (@path_sigma _ _ (negb b; not_fixed_negb b) (f b) fst); simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1906
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply equiv_hprop_allpath.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1907
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre> apply istrunc_forall.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1907
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1908
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition contrAllExOthBool `{Funext} : Contr (AllExistsOther Bool) :=
  (Build_Contr _ centerAllExOthBool centralAllExOthBool).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1911
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition solution_6_9 `{Funext} : forall X, X -&gt; X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1913
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1914
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro X.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1915
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    elim (@LEM (Contr (AllExistsOther X)) _); intro.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1916
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1917
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun x:X =&gt; (center (AllExistsOther X) x).1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1917
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1918
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun x:X =&gt; x).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1918
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1919
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma not_id_on_Bool `{Funext} : solution_6_9 Bool &lt;&gt; idmap.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1921
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1922
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro Bad.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1923
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> pose proof ((happly Bad) true) as Ugly.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1923
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assert ((solution_6_9 Bool true) = false) as Good.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1924
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1925
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold solution_6_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1925
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct (LEM (Contr (AllExistsOther Bool)) _) as [C|C];simpl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1926
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1927
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (centralAllExOthBool (@center _ C)).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1927
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1927
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1928
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> elim (C contrAllExOthBool).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1928
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1929
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply false_ne_true.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1929
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite (inverse Good).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1929
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assumption.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1929
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1930
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>

End Book_6_9.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1932
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:funext-from-interval *)
(** Exercise 6.10 *)



(* ================================================== ex:susp-lump *)
(** Exercise 6.11 *)



(* ================================================== ex:alt-integers *)
(** Exercise 6.12 *)



(* ================================================== ex:trunc-bool-interval *)
(** Exercise 6.13 *)



(* ================================================== ex:all-types-sets *)
(** Exercise 7.1 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1956
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Book_7_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1956
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Lemma Book_7_1_part_i (H : forall A, merely A -&gt; A) A : IsHSet A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1957
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1958
Time: 0.002s">
<div class="time" style="width: 1.6528925619835%"></div>
<pre>
    apply (@HoTT.Universes.HSet.ishset_hrel_subpaths
             A (fun x y =&gt; merely (x = y)));
    try typeclasses eauto.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1961
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1962
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros ?.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1962
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1963
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1964
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1965
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1965
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply H.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1966
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      assumption.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1967
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1968
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Lemma Book_7_1_part_ii (H : forall A B (f : A -&gt; B),
                                (forall b, merely (hfiber f b))
                                -&gt; forall b, hfiber f b)
  : forall A, IsHSet A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1973
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1974
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply Book_7_1_part_i.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1975
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1976
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (fun H' =&gt; (@H A (merely A) tr H' a).1).</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1977
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    clear a.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1978
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>
    apply Trunc_ind; try exact _.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1979
Time: 0.005s">
<div class="time" style="width: 4.1322314049587%"></div>
<pre>
    intro x; compute; apply tr.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1980
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists x; reflexivity.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1981
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1982
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End Book_7_1.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 1983
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:s2-colim-unit *)
(** Exercise 7.2 *)



(* ================================================== ex:ntypes-closed-under-wtypes *)
(** Exercise 7.3 *)



(* ================================================== ex:connected-pointed-all-section-retraction *)
(** Exercise 7.4 *)



(* ================================================== ex:ntype-from-nconn-const *)
(** Exercise 7.5 *)



(* ================================================== ex:connectivity-inductively *)
(** Exercise 7.6 *)



(* ================================================== ex:lemnm *)
(** Exercise 7.7 *)



(* ================================================== ex:acnm *)
(** Exercise 7.8 *)



(* ================================================== ex:acnm-surjset *)
(** Exercise 7.9 *)

(** Solution for the case (oo,-1). *)</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 2023
Time: 0.001s">
<div class="time" style="width: 0.82644628099174%"></div>
<pre>Definition Book_7_9_oo_neg1 `{Univalence} (AC_oo_neg1 : forall X : HSet, HasChoice X) (A : Type)
  : merely (exists X : HSet, exists p : X -&gt; A, IsSurjection p)
  := @HoTT.Projective.projective_cover_AC AC_oo_neg1 _ A.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 2025
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:acconn *)
(** Exercise 7.10 *)



(* ================================================== ex:n-truncation-not-left-exact *)
(** Exercise 7.11 *)



(* ================================================== ex:double-negation-modality *)
(** Exercise 7.12 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 2039
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_7_12 := @HoTT.Modalities.Notnot.NotNot.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 2039
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:prop-modalities *)
(** Exercise 7.13 *)

</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 2043
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Book_7_13_part_i := @HoTT.Modalities.Open.Op.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 2043
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition Book_7_13_part_ii := @HoTT.Modalities.Closed.Cl.</pre>
</div>
<div class="code" title="File: HoTTBookExercises.v
Line: 2045
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ================================================== ex:f-local-type *)
(** Exercise 7.14 *)



(* ================================================== ex:trunc-spokes-no-hub *)
(** Exercise 7.15 *)



(* ================================================== ex:s2-colim-unit-2 *)
(** Exercise 7.16 *)



(* ================================================== ex:fiber-map-not-conn *)
(** Exercise 7.17 *)



(* ================================================== ex:is-conn-trunc-functor *)
(** Exercise 7.18 *)



(* ================================================== ex:categorical-connectedness *)
(** Exercise 7.19 *)



(* ================================================== ex:homotopy-groups-resp-prod *)
(** Exercise 8.1 *)



(* ================================================== ex:decidable-equality-susp *)
(** Exercise 8.2 *)



(* ================================================== ex:contr-infinity-sphere-colim *)
(** Exercise 8.3 *)



(* ================================================== ex:contr-infinity-sphere-susp *)
(** Exercise 8.4 *)



(* ================================================== ex:unique-fiber *)
(** Exercise 8.5 *)



(* ================================================== ex:ap-path-inversion *)
(** Exercise 8.6 *)



(* ================================================== ex:pointed-equivalences *)
(** Exercise 8.7 *)



(* ================================================== ex:HopfJr *)
(** Exercise 8.8 *)



(* ================================================== ex:SuperHopf *)
(** Exercise 8.9 *)



(* ================================================== ex:vksusppt *)
(** Exercise 8.10 *)



(* ================================================== ex:vksuspnopt *)
(** Exercise 8.11 *)



(* ================================================== ex:slice-precategory *)
(** Exercise 9.1 *)



(* ================================================== ex:set-slice-over-equiv-functor-category *)
(** Exercise 9.2 *)



(* ================================================== ex:functor-equiv-right-adjoint *)
(** Exercise 9.3 *)



(* ================================================== ct:pre2cat *)
(** Exercise 9.4 *)



(* ================================================== ct:2cat *)
(** Exercise 9.5 *)



(* ================================================== ct:groupoids *)
(** Exercise 9.6 *)



(* ================================================== ex:2strict-cat *)
(** Exercise 9.7 *)



(* ================================================== ex:pre2dagger-cat *)
(** Exercise 9.8 *)



(* ================================================== ct:ex:hocat *)
(** Exercise 9.9 *)



(* ================================================== ex:dagger-rezk *)
(** Exercise 9.10 *)



(* ================================================== ex:rezk-vankampen *)
(** Exercise 9.11 *)



(* ================================================== ex:stack *)
(** Exercise 9.12 *)



(* ================================================== ex:utype-ct *)
(** Exercise 10.1 *)



(* ================================================== ex:surjections-have-sections-impl-ac *)
(** Exercise 10.2 *)



(* ================================================== ex:well-pointed *)
(** Exercise 10.3 *)



(* ================================================== ex:add-ordinals *)
(** Exercise 10.4 *)



(* ================================================== ex:multiply-ordinals *)
(** Exercise 10.5 *)



(* ================================================== ex:algebraic-ordinals *)
(** Exercise 10.6 *)



(* ================================================== ex:prop-ord *)
(** Exercise 10.7 *)



(* ================================================== ex:ninf-ord *)
(** Exercise 10.8 *)



(* ================================================== ex:well-founded-extensional-simulation *)
(** Exercise 10.9 *)



(* ================================================== ex:choice-function *)
(** Exercise 10.10 *)



(* ================================================== ex:cumhierhit *)
(** Exercise 10.11 *)



(* ================================================== ex:strong-collection *)
(** Exercise 10.12 *)



(* ================================================== ex:choice-cumulative-hierarchy-choice *)
(** Exercise 10.13 *)



(* ================================================== ex:plump-ordinals *)
(** Exercise 10.14 *)



(* ================================================== ex:not-plump *)
(** Exercise 10.15 *)



(* ================================================== ex:plump-successor *)
(** Exercise 10.16 *)



(* ================================================== ex:ZF-algebras *)
(** Exercise 10.17 *)



(* ================================================== ex:monos-are-split-monos-iff-LEM-holds *)
(** Exercise 10.18 *)



(* ================================================== ex:alt-dedekind-reals *)
(** Exercise 11.1 *)



(* ================================================== ex:RD-extended-reals *)
(** Exercise 11.2 *)



(* ================================================== ex:RD-lower-cuts *)
(** Exercise 11.3 *)



(* ================================================== ex:RD-interval-arithmetic *)
(** Exercise 11.4 *)



(* ================================================== ex:RD-lt-vs-le *)
(** Exercise 11.5 *)



(* ================================================== ex:reals-non-constant-into-Z *)
(** Exercise 11.6 *)



(* ================================================== ex:traditional-archimedean *)
(** Exercise 11.7 *)



(* ================================================== RC-Lipschitz-on-interval *)
(** Exercise 11.8 *)



(* ================================================== ex:metric-completion *)
(** Exercise 11.9 *)



(* ================================================== ex:reals-apart-neq-MP *)
(** Exercise 11.10 *)



(* ================================================== ex:reals-apart-zero-divisors *)
(** Exercise 11.11 *)



(* ================================================== ex:finite-cover-lebesgue-number *)
(** Exercise 11.12 *)



(* ================================================== ex:mean-value-theorem *)
(** Exercise 11.13 *)



(* ================================================== ex:knuth-surreal-check *)
(** Exercise 11.14 *)



(* ================================================== ex:reals-into-surreals *)
(** Exercise 11.15 *)



(* ================================================== ex:ord-into-surreals *)
(** Exercise 11.16 *)



(* ================================================== ex:hiit-plump *)
(** Exercise 11.17 *)



(* ================================================== ex:pseudo-ordinals *)
(** Exercise 11.18 *)



(* ================================================== ex:double-No-recursion *)
(** Exercise 11.19 *)




</pre>
</div>
</body>
</html>

