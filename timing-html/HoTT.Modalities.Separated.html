<html>
<head>
<title>Separated.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Separated.v</h1>

<div class="code" title="File: Separated.v
Line: 1
Time: 0.04s">
<div class="time" style="width: 100%"></div>
<pre>Require Import HoTT.Basics HoTT.Types HoTT.Cubical.DPath.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 1
Time: 0.027s">
<div class="time" style="width: 67.5%"></div>
<pre>
Require Import HFiber Extensions Factorization Limits.Pullback.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 2
Time: 0.005s">
<div class="time" style="width: 12.5%"></div>
<pre>
Require Import Modality Accessible Descent.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 3
Time: 0.004s">
<div class="time" style="width: 10%"></div>
<pre>
Require Import Truncations.Core.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 4
Time: 0.002s">
<div class="time" style="width: 5%"></div>
<pre>
Require Import Homotopy.Suspension.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope subuniverse_scope.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Subuniverses of separated types *)

(** The basic reference for subuniverses of separated types is
  - Christensen, Opie, Rijke, and Scoccola, "Localization in Homotopy Type Theory", https://arxiv.org/abs/1807.04155.
hereinafter referred to as "CORS".  *)

(** ** Definition *)

(** The definition is in [ReflectiveSubuniverse.v]. *)

(** ** Basic properties *)

(** A function is (fiberwise) in [Sep O] exactly when its diagonal is in [O]. *)

</pre>
</div>
<div class="code" title="File: Separated.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Diagonal.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context (O : Subuniverse) {X Y : Type} (f : X -&gt; Y).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition mapinO_diagonal `{MapIn (Sep O) _ _ f} : MapIn O (diagonal f).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros p.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 28
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre>
    exact (inO_equiv_inO' _ (hfiber_diagonal f p)^-1).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition mapinO_from_diagonal `{MapIn O _ _ (diagonal f)} : MapIn (Sep O) f.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x1 u v.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct v as [x2 p].</pre>
</div>
<div class="code" title="File: Separated.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct p.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 36
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre>
    exact (inO_equiv_inO' _ (hfiber_diagonal f (u.1; x2; u.2))).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Diagonal.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Lemma 2.15 of CORS: If [O] is accessible, so is [Sep O].  Its generators are the suspension of those of [O], in the following sense: *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition susp_localgen (f : LocalGenerators@{a}) : LocalGenerators@{a}.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  econstructor; intros i.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (functor_susp (f i)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Instance isaccrsu_sep (O : Subuniverse) `{IsAccRSU O}
  : IsAccRSU (Sep O).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists (susp_localgen (acc_lgen O)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A; split; intros A_inO.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Separated.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros i.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 53
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre>
    apply (ooextendable_iff_functor_susp (acc_lgen O i)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  
    intros [x y].</pre>
</div>
<div class="code" title="File: Separated.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn in *.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ooextendable_postcompose' _ _ _ _ _).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    2:apply inO_iff_islocal; exact (A_inO x y).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact dp_const.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Separated.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Separated.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (inO_iff_islocal O); intros i.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    specialize (A_inO i).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ooextendable_postcompose' _ _ _ _ _).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 63
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre>
    2:exact (fst (ooextendable_iff_functor_susp (acc_lgen O i) _) A_inO (x,y)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    symmetry; exact dp_const.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Separated.v
Line: 66
Time: 0.002s">
<div class="time" style="width: 5%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition susp_nullgen (S : NullGenerators@{a}) : NullGenerators@{a}.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  econstructor; intros i.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (Susp (S i)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Instance isaccmodality_sep (O : Subuniverse) `{IsAccModality O}
  : IsAccModality (Sep O).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists (susp_nullgen (acc_ngen O)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A; split; intros A_inO.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Separated.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros i.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (ooextendable_compose _ (functor_susp (fun _:acc_ngen O i =&gt; tt)) (fun _:Susp Unit =&gt; tt)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1:apply ooextendable_equiv, isequiv_contr_contr.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (ooextendable_iff_functor_susp (fun _:acc_ngen O i =&gt; tt)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  
    intros [x y].</pre>
</div>
<div class="code" title="File: Separated.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ooextendable_postcompose' _ _ _ _ _).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    2:apply inO_iff_isnull; exact (A_inO x y).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact dp_const.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Separated.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Separated.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (inO_iff_isnull O); intros i.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    specialize (A_inO i).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assert (ee : ooExtendableAlong (functor_susp (fun _:acc_ngen O i =&gt; tt)) (fun _ =&gt; A)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: Separated.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (cancelL_ooextendable _ _ (fun _ =&gt; tt) _ A_inO).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ooextendable_equiv.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply isequiv_contr_contr.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Separated.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assert (e := fst (ooextendable_iff_functor_susp (fun _:acc_ngen O i =&gt; tt) _) ee (x,y)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    cbn in e.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (ooextendable_postcompose' _ _ _ _ e).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    symmetry; exact dp_const.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Separated.v
Line: 100
Time: 0.002s">
<div class="time" style="width: 5%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Remark 2.16(1) of CORS *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance O_leq_SepO (O : ReflectiveSubuniverse)
  : O &lt;= Sep O.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 105
Time: 0.004s">
<div class="time" style="width: 10%"></div>
<pre>
  intros A ? x y; exact _.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Part of Remark 2.16(2) of CORS *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition in_SepO_embedding (O : Subuniverse)
           {A B : Type} (i : A -&gt; B) `{IsEmbedding i} `{In (Sep O) B}
  : In (Sep O) A.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x y.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (inO_equiv_inO' _ (equiv_ap_isembedding i x y)^-1).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* As a special case, if X embeds into an n-type for n &gt;= -1 then X is an n-type. Note that this doesn't hold for n = -2. *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Corollary istrunc_embedding_trunc {X Y : Type} {n : trunc_index} `{istr : IsTrunc n.+1 Y}
      (i : X -&gt; Y) `{isem : IsEmbedding i} : IsTrunc n.+1 X.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply istrunc_S.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (@in_SepO_embedding (Tr n) _ _ i isem istr).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Instance in_SepO_hprop (O : ReflectiveSubuniverse)
       {A : Type} `{IsHProp A}
  : In (Sep O) A.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 127
Time: 0.004s">
<div class="time" style="width: 10%"></div>
<pre>
  srapply (in_SepO_embedding O (const_tt _)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 128
Time: 0.004s">
<div class="time" style="width: 10%"></div>
<pre>
  intros x y; exact _.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** Remark 2.16(4) of CORS *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition sigma_closed_SepO (O : Modality) {A : Type} (B : A -&gt; Type)
           `{A_inO : In (Sep O) A} `{B_inO : forall a, In (Sep O) (B a)}
  : In (Sep O) (sig B).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros [x u] [y v].</pre>
</div>
<div class="code" title="File: Separated.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  specialize (A_inO x y).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose proof (fun p:x=y =&gt; B_inO y (p # u) v).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose @inO_sigma.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  (* Speed up typeclass search. *)
 </pre>
</div>
<div class="code" title="File: Separated.v
Line: 141
Time: 0.02s">
<div class="time" style="width: 50%"></div>
<pre>exact (inO_equiv_inO' _ (equiv_path_sigma B _ _)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 141
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Lemma 2.17 of CORS *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance issurjective_to_SepO (O : ReflectiveSubuniverse) (X : Type)
           `{Reflects (Sep O) X}
  : IsSurjection (to (Sep O) X).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (im := himage (to (Sep O) X)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose proof (in_SepO_embedding O (factor2 im)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (s := O_rec (factor1 im)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (h : factor2 im o s == idmap).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Separated.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_indpaths; intros x; subst s.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply fact_factors.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Separated.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply BuildIsSurjection.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros z.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    specialize (h z); cbn in h.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    set (w := s z) in *.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct w as [w1 w2].</pre>
</div>
<div class="code" title="File: Separated.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct h.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact w2.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 161
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Proposition 2.18 of CORS. *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition almost_inSepO_typeO@{i j} `{Univalence}
           (O : ReflectiveSubuniverse) (A B : Type_@{i j} O)
  : { Z : Type@{i} &amp; In O Z * (Z &lt;~&gt; (A = B)) }.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists (A &lt;~&gt; B); split.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Separated.v
Line: 169
Time: 0.005s">
<div class="time" style="width: 12.5%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Separated.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (equiv_path_TypeO O A B oE _).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_path_universe.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Lemma 2.21 of CORS *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance inSepO_sigma (O : ReflectiveSubuniverse)
       {X : Type} {P : X -&gt; Type} `{In (Sep O) X} `{forall x, In O (P x)}
  : In (Sep O) (sig P).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros u v.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 178
Time: 0.012s">
<div class="time" style="width: 30%"></div>
<pre>
  exact (inO_equiv_inO' _ (equiv_path_sigma P _ _)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Proposition 2.22 of CORS (in funext-free form). *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance reflectsD_SepO (O : ReflectiveSubuniverse)
       {X : Type} `{Reflects (Sep O) X}
  : ReflectsD (Sep O) O X.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 185
Time: 0.011s">
<div class="time" style="width: 27.5%"></div>
<pre>
  srapply reflectsD_from_inO_sigma.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Once we know that [Sep O] is a reflective subuniverse, this will mean that [O &lt;&lt; Sep O]. *)

(** And now the version with funext. *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 191
Time: 0.002s">
<div class="time" style="width: 5%"></div>
<pre>Definition isequiv_toSepO_inO `{Funext} (O : ReflectiveSubuniverse)
           {X : Type} `{Reflects (Sep O) X}
           (P : O_reflector (Sep O) X -&gt; Type) `{forall x, In O (P x)}
  : IsEquiv (fun g : (forall y, P y) =&gt; g o to (Sep O) X)
  := isequiv_ooextendable _ _ (extendable_to_OO P).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 195
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre>

Definition equiv_toSepO_inO `{Funext} (O : ReflectiveSubuniverse)
           {X : Type} `{Reflects (Sep O) X}
           (P : O_reflector (Sep O) X -&gt; Type) `{forall x, In O (P x)}
  : (forall y, P y) &lt;~&gt; (forall x, P (to (Sep O) X x))
  := Build_Equiv _ _ _ (isequiv_toSepO_inO O P).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** TODO: Actually prove this, and put it somewhere more appropriate. *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section JoinConstruction.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Universes i j.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {X : Type@{i}} {Y : Type@{j}} (f : X -&gt; Y)
          (ls : forall (y1 y2 : Y),
              @sig@{j j} Type@{i} (fun (Z : Type@{i}) =&gt; Equiv@{i j} Z (y1 = y2))).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition jc_image@{} : Type@{i}.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Admitted.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition jc_factor1@{} : X -&gt; jc_image.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Admitted.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition jc_factor2@{} : jc_image -&gt; Y.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Admitted.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition jc_factors@{} : jc_factor2 o jc_factor1 == f.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Admitted.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  #[export] Instance jc_factor1_issurj@{} : IsSurjection jc_factor1.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Admitted.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  #[export] Instance jc_factor2_isemb : IsEmbedding jc_factor2.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Admitted.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End JoinConstruction.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We'd like to say that the universe of [O]-modal types is [O]-separated, i.e. belongs to [Sep O].  But since a given subuniverse like [Sep O] lives only on a single universe size, trying to say that in the naive way yields a universe inconsistency. *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fail Goal forall (O : ReflectiveSubuniverse), In (Sep O) (Type_ O).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Instead, we do as in Lemma 2.19 of CORS and prove the morally-equivalent "descent" property, using Lemma 2.18 and the join construction. *)</pre>
</div>
<div class="code" title="File: Separated.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance SepO_lex_leq `{Univalence}
       (O : ReflectiveSubuniverse) {X : Type} `{Reflects (Sep O) X}
  : Descends (Sep O) O X.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (e : forall (P : X -&gt; Type_ O),
             { Q : (O_reflector (Sep O) X -&gt; Type_ O) &amp;
                   forall x, Q (to (Sep O) X x) &lt;~&gt; P x }).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  2:{</pre>
</div>
<div class="code" title="File: Separated.v
Line: 225
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre> unshelve econstructor; intros P' P_inO;
      pose (P := fun x =&gt; (P' x; P_inO x) : Type_ O);
      pose (ee := e P).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Separated.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact ee.1.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Separated.v
Line: 229
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre> simpl; exact _.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Separated.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x; cbn; apply ee.2.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Separated.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (ls : forall A B : Type_ O, { Z : Type &amp; Z &lt;~&gt; (A = B) }).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Separated.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A B.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (q := almost_inSepO_typeO O A B).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (q.1; snd q.2).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 235
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Separated.v
Line: 235
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (p := jc_factor2 P ls).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (J := jc_image P ls) in p.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (In (Sep O) J).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Separated.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (q := almost_inSepO_typeO O (p x) (p y)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 240
Time: 0.02s">
<div class="time" style="width: 50%"></div>
<pre>
    refine (inO_equiv_inO' q.1 _).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (_ oE _).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Separated.v
Line: 243
Time: 0.001s">
<div class="time" style="width: 2.5%"></div>
<pre> symmetry; srapply (equiv_ap_isembedding p).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Separated.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (snd q.2).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Separated.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  pose (O_rec (O := Sep O) (jc_factor1 P ls)).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists (p o j).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x; subst p j.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply equiv_path.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact ((jc_factors P ls x)..1).</pre>
</div>
<div class="code" title="File: Separated.v
Line: 250
Time: 0.002s">
<div class="time" style="width: 5%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Separated.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Once we know that [Sep O] is a reflective subuniverse, this will imply [O &lt;&lt;&lt; Sep O], and that if [Sep O] is accessible (such as if [O] is) then [Type_ O] belongs to its accessible lifting (see [inO_TypeO_lex_leq]. *)


(** ** Reflectiveness of [Sep O] *)

(** TODO *)


(** ** Left-exactness properties *)

(** Nearly all of these are true in the generality of a pair of reflective subuniverses with [O &lt;&lt;&lt; O'] and/or [O' &lt;= Sep O], and as such can be found in [Descent.v]. *)

</pre>
</div>
</body>
</html>

