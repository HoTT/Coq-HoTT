<html>
<head>
<title>CompactTypes.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for CompactTypes.v</h1>

<div class="code" title="File: CompactTypes.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** * Properties of compact and searchable types *)

</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 2
Time: 0.037s">
<div class="time" style="width: 100%"></div>
<pre>From HoTT Require Import Basics Types.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 2
Time: 0.035s">
<div class="time" style="width: 94.594594594595%"></div>
<pre>
Require Import Truncations.Core Truncations.Connectedness.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 3
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
Require Import Spaces.Nat.Core.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Misc.UStructures.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 5
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
Require Import Spaces.NatSeq.Core Spaces.NatSeq.UStructure.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 6
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
Require Import Homotopy.Suspension.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 7
Time: 0.018s">
<div class="time" style="width: 48.648648648649%"></div>
<pre>
Require Import Pointed.Core.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Universes.TruncType.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 9
Time: 0.003s">
<div class="time" style="width: 8.1081081081081%"></div>
<pre>
Require Import Idempotents.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope pointed_scope.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Basic definitions of compact types *)

(** A type [A] is compact if for every decidable predicate [P] on [A] we can either find an element of [A] making [P] false or we can show that [P a] always holds. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition IsCompact (A : Type)
  := forall P : A -&gt; Type, (forall a : A, Decidable (P a)) -&gt;
                              {a : A &amp; ~ P a} + (forall a : A, P a).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Any compact type is decidable. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition decidable_iscompact {A : Type} (c : IsCompact A) : Decidable A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 22
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  destruct (c (fun (_ : A) =&gt; Empty) _) as [c1|c2].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl c1.1).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr c2).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Compactness is equivalent to assuming the same for [HProp]-valued decidable predicates. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition IsCompactProps (A : Type)
  := forall P : A -&gt; HProp, (forall a : A, Decidable (P a)) -&gt;
                              {a : A &amp; ~ P a} + (forall a : A, P a).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition iscompact_iscompactprops {A} (c : IsCompactProps A) : IsCompact A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 34
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  destruct (c (merely o P) _) as [l|r].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl (l.1; fun p =&gt; l.2 (tr p))).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> right.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro a.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply merely_inhabited_iff_inhabited_stable, r.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Since decidable types are stable, it's also equivalent to negate [P] in the definition. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition IsCompact' (A : Type)
  := forall P : A -&gt; Type, (forall a : A, Decidable (P a)) -&gt;
                              {a : A &amp; P a} + (forall a : A, ~ P a).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition iff_iscompact_iscompact' (A : Type)
  : IsCompact A &lt;-&gt; IsCompact' A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 48
Time: 0.009s">
<div class="time" style="width: 24.324324324324%"></div>
<pre>
  split;
    napply (functor_forall (fun P =&gt; not o P)); intro P;
    rapply functor_forall; intro dP;
    apply functor_sum.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  2,3: exact idmap.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: apply (functor_sigma idmap).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  2: apply (functor_forall idmap).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  all: intro a; by apply stable_decidable.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 56
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Another equivalent definition of compactness: If a family over the type is decidable, then the Î£-type is decidable. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition IsSigmaCompact (A : Type)
  := forall P : A -&gt; Type, (forall a : A, Decidable (P a)) -&gt; Decidable (sig P).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition equiv_iscompact'_issigmacompact {A : Type}
  : IsCompact' A &lt;-&gt; IsSigmaCompact A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply iff_functor_forall; intro P.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply iff_functor_forall; intro dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply iff_equiv.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (equiv_functor_sum' equiv_idmap).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  napply equiv_sig_ind.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Again, it is enough to consider [HProp]-valued families. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition IsSigmaCompactProps (A : Type)
  := forall P : A -&gt; HProp,
      (forall a : A, Decidable (P a)) -&gt; Decidable (sig P).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition issigmacompactprops_issigmacompact {A : Type}
  (h : IsSigmaCompact A)
  : IsSigmaCompactProps A
  := fun P hP =&gt; h P hP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition issigmacompact_issigmacompactprops {A : Type}
  (h : IsSigmaCompactProps A)
  : IsSigmaCompact A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P hP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 85
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  refine (decidable_iff _ (h (merely o P) _)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply iff_functor_sigma; intro a.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact merely_inhabited_iff_inhabited_stable.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A weaker definition: for any decidable family, the dependent function type is decidable. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition IsPiCompact (A : Type)
  := forall (P : A -&gt; Type) (dP : forall a : A, Decidable (P a)),
      Decidable (forall a : A, P a).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition ispicompact_issigmacompact {A : Type} (c : IsSigmaCompact A)
  : IsPiCompact A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 98
Time: 0.003s">
<div class="time" style="width: 8.1081081081081%"></div>
<pre>
  destruct (c (not o P) _) as [l|r].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> right; exact (fun f =&gt; l.2 (f l.1)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> left.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro a.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (stable_decidable (P a)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (fun u =&gt; r (a; u)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Compact types are closed under retracts. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition iscompact_retract {A : Type} (R : RetractOf A) (c : IsCompact A)
  : IsCompact (retract_type R).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 109
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  intros P dP; destruct (c (P o (retract_retr R)) _) as [l|r].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl ((retract_retr R) l.1; l.2)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr (fun a =&gt;  ((retract_issect R) a) # r ((retract_sect R) a))).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition iscompact_retract' {A R : Type} {f : A -&gt; R} {g : R -&gt; A}
  (s : f o g == idmap) (c : IsCompact A)
  : IsCompact R
  := iscompact_retract (Build_RetractOf A R f g s) c.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Assuming the set truncation map has a section, a type is compact if and only if its set truncation is compact. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 120
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>Definition compact_set_trunc_compact `{Univalence} {A : Type}
  (f : (Tr 0 A) -&gt; A) (s : tr o f == idmap)
  : IsCompact A &lt;-&gt; IsCompact (Tr 0 A).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  constructor.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: exact (iscompact_retract' s).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro cpt; rapply iscompact_iscompactprops.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct (cpt (Trunc_rec P)) as [l|r].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 129
Time: 0.022s">
<div class="time" style="width: 59.459459459459%"></div>
<pre> intro a; strip_truncations.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (dP a).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 131
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre> exact (inl (f l.1; fun x =&gt; l.2 (ap (Trunc_rec P) (s l.1) # x))).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr (fun a =&gt; r (tr a))).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 132
Time: 0.002s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Basic definitions of searchable types *)

(** A type is searchable if for every decidable predicate we can find a "universal witness" for whether the predicate is always true or not. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition IsSearchable (A : Type)
  := forall (P : A -&gt; Type) (dP : forall a : A, Decidable (P a)),
      {x : A &amp; P x -&gt; forall a : A, P a}.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition IsSearchableProps (A : Type)
  := forall (P : A -&gt; HProp) (dP : forall a : A, Decidable (P a)),
      {x : A &amp; P x -&gt; forall a : A, P a}.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition issearchable_issearchableprops {A : Type} (s : IsSearchableProps A)
  : IsSearchable A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 148
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  specialize (s (merely o P) _).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists s.1.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros h a.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply merely_inhabited_iff_inhabited_stable, s.2, tr, h.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A type is searchable if and only if it is compact and inhabited. *)

</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition issearchable_iscompact_inhabited {A : Type}
  : IsCompact A -&gt; A -&gt; IsSearchable A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros c a P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction (c P _) as [l|r].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exists l.1.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro h; contradiction (l.2 h).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (a; fun _ =&gt; r).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition iscompact_issearchable {A : Type} : IsSearchable A -&gt; IsCompact A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros h P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (w := (h P dP).1).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct (dP w) as [x|y].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr ((h P dP).2 x)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl (w; y)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 173
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>

Definition inhabited_issearchable {A : Type} : IsSearchable A -&gt; A
  := fun s =&gt; (s (fun a =&gt; Unit) _).1.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 176
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>

Definition searchable_iff {A : Type} : IsSearchable A &lt;-&gt; A * (IsCompact A)
  := (fun s =&gt; (inhabited_issearchable s, iscompact_issearchable s),
        fun c =&gt; issearchable_iscompact_inhabited (snd c) (fst c)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Examples of searchable and compact types  *)

</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition issearchable_contr {A} (c : Contr A) : IsSearchable A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists (center A).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros p a.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  by induction (contr a).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition issearchable_Bool : IsSearchable Bool.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction (dP false) as [p | np]; [exists true | exists false].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  all: by intros p' [].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The empty type is trivially compact. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition iscompact_empty : IsCompact Empty
  := fun P dP =&gt; inr (fun a =&gt; Empty_rec a).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 199
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition iscompact_empty' {A : Type} (na : ~A) : IsCompact A
  := fun p dP =&gt; inr (fun a =&gt; Empty_rec (na a)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition iscompact_iff_not_or_issearchable {A : Type} :
  IsCompact A &lt;-&gt; (~ A) + IsSearchable A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  constructor.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro c.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct (decidable_iscompact c) as [l|r].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inr (issearchable_iscompact_inhabited c l)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (inl r).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [l|r].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (iscompact_empty' l).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (iscompact_issearchable r).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Assuming univalence, the type of propositions is searchable. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition issearchable_hprop `{Univalence} : IsSearchable HProp.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply issearchable_issearchableprops.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct (dP Unit_hp) as [t|f].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exists False_hp; intros p a.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rapply stable_decidable.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    by apply (not_not_constant_family_hprop P).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (Unit_hp; fun h =&gt; Empty_rec (f h)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Assuming univalence, if the domain of a surjective map is searchable, then so is its codomain. *)

</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition issearchableprops_image `{Univalence} (A B : Type)
  (s : IsSearchableProps A)
  (f : A -&gt; B) (surj : IsSurjection f)
  : IsSearchableProps B.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros P dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  specialize (s (P o f) _).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 235
Time: 0.009s">
<div class="time" style="width: 24.324324324324%"></div>
<pre>
  exact (f s.1; fun t =&gt; conn_map_elim _ f _ (s.2 t)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 237
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>

Definition issearchable_image `{Univalence} (A B : Type)
  (s : IsSearchable A)
  (f : A -&gt; B) (surj : IsSurjection f)
  : IsSearchable B
  := issearchable_issearchableprops (issearchableprops_image A B s f surj).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Assuming univalence, every connected pointed type is searchable. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 245
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>Definition issearchable_isconnected_ptype `{Univalence} (A : pType)
  (c : IsConnected 0 A)
  : IsSearchable A
  := issearchable_image Unit A (issearchable_contr _) (fun _ =&gt; pt) _.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Assuming univalence, the suspension of any type is searchable. *)</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition issearchable_suspension `{Univalence} (A : Type)
  : IsSearchable (Susp A).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snrefine (issearchable_image Bool (Susp A) issearchable_Bool _ _).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (Bool_rec _ North South).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 255
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre> snapply Susp_ind; cbn.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 255
Time: 0.002s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
    1,2: rapply contr_inhabited_hprop; apply tr.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact (true; idpath).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 257
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: exact (false; idpath).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro x; by apply path_ishprop.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 259
Time: 0.002s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 260
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition iscompact_image `{Univalence} (A B : Type)
  (c : IsCompact A)
  (f : A -&gt; B) (surj : IsSurjection f)
  : IsCompact B.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply iscompact_iff_not_or_issearchable.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct ((fst iscompact_iff_not_or_issearchable) c) as [n|s].</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 269
Time: 0.004s">
<div class="time" style="width: 10.810810810811%"></div>
<pre> left; by rapply conn_map_elim.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 270
Time: 0.002s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre> right; by rapply issearchable_image.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 270
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section Uniform_Search.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** ** Searchability of [nat -&gt; A] *)

  (** Following https://www.cs.bham.ac.uk/~mhe/TypeTopology/TypeTopology.UniformSearch.html, we prove that if [A] is searchable then [nat -&gt; A] is uniformly searchable. *)

  (** A type with a uniform structure is uniformly searchable if it is searchable over uniformly continuous predicates. Here the uniform structure on [Type] is the trivial one [trivial_us] involving the identity types at each level. *)
 </pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition uniformly_searchable (A : Type) {usA : UStructure A}
    := forall (P : A -&gt; Type) (dP : forall a : A, Decidable (P a)),
        uniformly_continuous P -&gt; exists w0 : A, (P w0 -&gt; forall u : A, P u).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context {A : Type} (issearchable_A : IsSearchable A).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The witness function for uniformly continuous predicates on [nat -&gt; A]. The first argument [n : nat] will be the modulus of uniform continuity, but we do not use the property in this definition. *)
 </pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition uniformsearch_witness (n : nat) (P : (nat -&gt; A) -&gt; Type)
    (dP : forall (f : nat -&gt; A), Decidable (P f))
    : nat -&gt; A.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction n in P, dP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun _ =&gt; inhabited_issearchable issearchable_A).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> pose (g Q dQ := Q (IHn Q dQ)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 293
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
      pose (wA := (issearchable_A (fun x =&gt; g (P o (seq_cons x)) _) _).1).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (seq_cons wA (IHn (P o (seq_cons wA)) _)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 295
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We often need to apply [P] to [uniformsearch_witness n P dP], and this saves repeating [P]. *)
 </pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition pred_uniformsearch_witness (n : nat) (P : (nat -&gt; A) -&gt; Type)
    (dP : forall (f : nat -&gt; A), Decidable (P f))
    := P (uniformsearch_witness n P dP).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The desired property of the witness function. *)
 </pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition uniformsearch_witness_spec {n : nat} (P : (nat -&gt; A) -&gt; Type)
    (dP : forall f : (nat -&gt; A), Decidable (P f))
    (is_mod : is_modulus_of_uniform_continuity n P)
    (h : pred_uniformsearch_witness n P dP)
    : forall u : nat -&gt; A, P u.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction n in P, dP, is_mod, h.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro u.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (transport idmap _ h).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* For [n = 0], [is_mod u1 u2] says that [P u1 = P u2]. *)
     </pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>apply is_mod, sequence_type_us_zero.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro u.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (transport idmap _ _).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: exact (uniformly_continuous_extensionality P (m:=0)
                  (uniformly_continuous_has_modulus is_mod)
                  (seq_cons_head_tail u)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 319
Time: 0.002s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
      rapply (IHn (P o (seq_cons (u 0)))).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1: apply cons_decreases_modulus, is_mod.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* The universality of [uniformsearch_witness] says that it is enough to check this statement with [u 0] replaced with [wA] above, and that is exactly what [h] proves, by the inductive step. *)
     </pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 323
Time: 0.014s">
<div class="time" style="width: 37.837837837838%"></div>
<pre>exact ((issearchable_A
                 (fun y =&gt; pred_uniformsearch_witness n (P o (seq_cons y)) _) _).2
                h (u 0)).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 325
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition has_uniformly_searchable_seq_issearchable
    : uniformly_searchable (nat -&gt; A).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros P dP contP.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exists (uniformsearch_witness (contP 0).1 P dP).</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply uniformsearch_witness_spec; exact (contP 0).2.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Uniform_Search.</pre>
</div>
<div class="code" title="File: CompactTypes.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

