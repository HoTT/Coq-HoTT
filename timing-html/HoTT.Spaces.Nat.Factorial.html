<html>
<head>
<title>Factorial.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Factorial.v</h1>

<div class="code" title="File: Factorial.v
Line: 1
Time: 0.037s">
<div class="time" style="width: 100%"></div>
<pre>Require Import Basics.Overture Basics.Tactics Basics.PathGroupoids
  Basics.Decidable Spaces.Nat.Core Spaces.Nat.Division Tactics.EvalIn.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Set Universe Minimization ToSet.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Factorials *)

(** ** Definition *)

</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint factorial n := 
  match n with
  | 0 =&gt; 1
  | S n =&gt; S n * factorial n
  end.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Properties *)

(** The factorial of [0] is [1]. *)</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition nat_factorial_zero : factorial 0 = 1 := idpath.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The factorial of [n + 1] is [n + 1] times the factorial of [n]. *)</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition nat_factorial_succ n : factorial n.+1 = n.+1 * factorial n
  := idpath.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A variant of [nat_factorial_succ]. *)</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition nat_factorial_pred n
  : 0 &lt; n -&gt; factorial n = n * factorial (nat_pred n).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 26
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  intros []; reflexivity.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Every factorial is positive. *)</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance lt_zero_factorial n : 0 &lt; factorial n.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 31
Time: 0.003s">
<div class="time" style="width: 8.1081081081081%"></div>
<pre>
  induction n; exact _.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Except for [factorial 0 = factorial 1], the [factorial] function is strictly monotone.  We separate out the successor case since it is used twice in the proof of the general result. *)</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition nat_factorial_strictly_monotone_succ n
  : 0 &lt; n -&gt; factorial n &lt; factorial n.+1.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro H.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite &lt;- (nat_mul_one_l (factorial n)).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 39
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  rapply (nat_mul_r_strictly_monotone _).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Instance nat_factorial_strictly_monotone n m
  : 0 &lt; n -&gt; n &lt; m -&gt; factorial n &lt; factorial m.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros H1 H2; induction H2.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rapply nat_factorial_strictly_monotone_succ.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply (lt_trans IHleq).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rapply nat_factorial_strictly_monotone_succ.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Divisibility *)

(** Any number less than or equal to [n] divides [factorial n]. *)</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance nat_divides_factorial_factor n m
  : 0 &lt; n -&gt; n &lt;= m -&gt; (n | factorial m).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 56
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  intros [] H2.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: exact _.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 58
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  induction H2; exact _.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** [factorial] is a monotone function from [nat] to [nat] with respect to [&lt;=] and divides. *)</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance nat_divides_factorial_lt n m
  : n &lt;= m -&gt; (factorial n | factorial m).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros H; induction H; exact _.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A product of factorials divides the factorial of the sum. *)</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance nat_divides_factorial_mul_factorial_add n m
  : (factorial n * factorial m | factorial (n + m)).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  remember (n + m) as k eqn:p.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert k n m p; snapply nat_ind_strong; hnf; intros k IH n m p.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct k.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_nat_add_zero in p.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct p as [p q].</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct p^, q^.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact _.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite_refl nat_factorial_succ.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite &lt;- p.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite nat_dist_r.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assert (helper : forall n' m' (p' : n' + m' = k.+1), (factorial n' * factorial m' | n' * factorial k)).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros n' m' p'.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct n'; only 1: exact _.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite nat_factorial_succ.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite &lt;- nat_mul_assoc.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 85
Time: 0.007s">
<div class="time" style="width: 18.918918918919%"></div>
<pre>
    rapply nat_divides_mul_monotone.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 86
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
    rapply IH.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (ap nat_pred p').</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> napply nat_divides_add.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply helper, p.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> rewrite nat_mul_comm.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply helper.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      lhs napply nat_add_comm; exact p.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 93
Time: 0.001s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Here is a variant of [nat_divides_factorial_mul_factorial_add] that is more suitable for binomial coefficients. *)</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance nat_divides_factorial_mul_factorial_add' n m
  : m &lt;= n -&gt; (factorial m * factorial (n - m) | factorial n).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros H.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rewrite &lt;- (ap factorial (nat_add_sub_r_cancel H)).</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply nat_divides_factorial_mul_factorial_add.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Factorial.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

