<html>
<head>
<title>Closed.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Closed.v</h1>

<div class="code" title="File: Closed.v
Line: 1
Time: 0.038s">
<div class="time" style="width: 100%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 1
Time: 0.025s">
<div class="time" style="width: 65.789473684211%"></div>
<pre>
Require Import Extensions.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 2
Time: 0.017s">
<div class="time" style="width: 44.736842105263%"></div>
<pre>
Require Import Modality Accessible Nullification Lex Topological.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 3
Time: 0.02s">
<div class="time" style="width: 52.631578947368%"></div>
<pre>
Require Import Colimits.Pushout Homotopy.Join.Core.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** * Closed modalities *)

(** We begin by characterizing the modal types. *)</pre>
</div>
<div class="code" title="File: Closed.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section ClosedModalTypes.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context (U : HProp).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition equiv_inO_closed (A : Type)
  : (U -&gt; Contr A) &lt;-&gt; IsEquiv (fun a:A =&gt; push (inr a) : Join U A).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    split.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros uac.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simple refine (isequiv_adjointify _ _ _ _).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: Closed.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simple refine (Pushout_rec A _ _ _).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros u; pose (uac u); exact (center A).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a; assumption.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [u a].</pre>
</div>
<div class="code" title="File: Closed.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          pose (uac u).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply contr.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: Closed.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros z.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> pattern z.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        simple refine (Pushout_ind _ _ _ _ z).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros u.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          pose (contr_inhabited_hprop U u).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply path_contr.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a; reflexivity.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 32
Time: 0.001s">
<div class="time" style="width: 2.6315789473684%"></div>
<pre> intros [u a]; pose (contr_inhabited_hprop U u).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 32
Time: 0.004s">
<div class="time" style="width: 10.526315789474%"></div>
<pre>
          apply path_contr.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: Closed.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros ? u.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 35
Time: 0.007s">
<div class="time" style="width: 18.421052631579%"></div>
<pre>
      refine (contr_equiv (Join U A) (fun a:A =&gt; push (inr a))^-1).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (contr_inhabited_hprop U u).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact _.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 38
Time: 0.002s">
<div class="time" style="width: 5.2631578947368%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 39
Time: 0.001s">
<div class="time" style="width: 2.6315789473684%"></div>
<pre>

End ClosedModalTypes.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Exercise 7.13(ii): Closed modalities *)</pre>
</div>
<div class="code" title="File: Closed.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Cl (U : HProp) : Modality.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 44
Time: 0.002s">
<div class="time" style="width: 5.2631578947368%"></div>
<pre>
  snapply Build_Modality.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros X; exact (U -&gt; Contr X).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 47
Time: 0.003s">
<div class="time" style="width: 7.8947368421053%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros T B T_inO f feq.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    cbn; intros u; pose (T_inO u).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (contr_equiv _ f).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros ; exact (Join U X).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros T u.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (contr_inhabited_hprop _ u).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact _.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros T x.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (push (inr x)).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A B B_inO f z.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    srefine (Pushout_ind B _ _ _ z).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros u; apply center, B_inO, u.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a; apply f.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [u a].</pre>
</div>
<div class="code" title="File: Closed.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (B_inO (push (inr a)) u).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_contr.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros; reflexivity.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A A_inO z z' u.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (A_inO u).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply contr_paths_contr.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 67
Time: 0.001s">
<div class="time" style="width: 2.6315789473684%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The closed modality is accessible. *)</pre>
</div>
<div class="code" title="File: Closed.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance accmodality_closed (U : HProp)
  : IsAccModality (Cl U).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unshelve econstructor.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> econstructor.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (fun _:U =&gt; Empty).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Closed.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros X; split.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros X_inO u.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (X_inO u).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ooextendable_contr; exact _.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Closed.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros ext u.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (Build_Contr _ ((fst (ext u 1%nat) Empty_rec).1 tt)); intros x.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold const in ext.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 82
Time: 0.001s">
<div class="time" style="width: 2.6315789473684%"></div>
<pre>
      exact ((fst (snd (ext u 2) (fst (ext u 1%nat) Empty_rec).1
                       (fun _ =&gt; x)) (Empty_ind _)).1 tt).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** In fact, it is topological, and therefore (assuming univalence) lex.  As for topological modalities generally, we don't need to declare these as global instances, but we prove them here as local instances for exposition. *)</pre>
</div>
<div class="code" title="File: Closed.v
Line: 87
Time: 0.001s">
<div class="time" style="width: 2.6315789473684%"></div>
<pre>Local Instance topological_closed (U : HProp)
  : Topological (Cl U)
  := _.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Instance lex_closed `{Univalence} (U : HProp)
  : Lex (Cl U).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 93
Time: 0.002s">
<div class="time" style="width: 5.2631578947368%"></div>
<pre>
  rapply lex_topological.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Closed.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Thus, it also has the following alternative version. *)</pre>
</div>
<div class="code" title="File: Closed.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Cl' (U : HProp) : Modality
  := Nul (Build_NullGenerators U (fun _ =&gt; Empty)).</pre>
</div>
<div class="code" title="File: Closed.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

