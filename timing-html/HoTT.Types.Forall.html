<html>
<head>
<title>Forall.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Forall.v</h1>

<div class="code" title="File: Forall.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** * Theorems about dependent products *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 2
Time: 0.025s">
<div class="time" style="width: 100%"></div>
<pre>Require Import Basics.Overture Basics.Equivalences Basics.PathGroupoids
               Basics.Tactics Basics.Contractible Basics.Iff.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 3
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Require Export Basics.Trunc (istrunc_forall).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


Generalizable Variables A B C f g e n.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section AssumeFunext.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Context `{Funext}.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Paths *)

(** Paths [p : f = g] in a function type [forall x:X, P x] are equivalent to functions taking values in path types, [H : forall x:X, f x = g x], or concisely, [H : f == g].

This equivalence, however, is just the combination of [apD10] and function extensionality [funext], and as such, [path_forall], et seq. are given in the [Overture]:  *)

(** Now we show how these things compute. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 22
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition apD10_path_forall `{P : A -&gt; Type}
  (f g : forall x, P x) (h : f == g)
  : apD10 (path_forall _ _ h) == h
  := apD10 (eisretr apD10 h).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 25
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Definition eta_path_forall `{P : A -&gt; Type}
  (f g : forall x, P x) (p : f = g)
  : path_forall _ _ (apD10 p) = p
  := eissect apD10 p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition path_forall_1 `{P : A -&gt; Type} (f : forall x, P x)
  : (path_forall f f (fun x =&gt; 1)) = 1
  := eta_path_forall f f 1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The identification of the path space of a dependent function space, up to equivalence, is of course just funext. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 37
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition equiv_apD10 {A : Type} (P : A -&gt; Type) f g
: (f = g) &lt;~&gt; (f == g)
  := Build_Equiv _ _ (@apD10 A P f g) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

#[export] Instance isequiv_path_forall `{P : A -&gt; Type} (f g : forall x, P x)
  : IsEquiv (path_forall f g) | 0
  := @isequiv_inverse _ _ (@apD10 A P f g) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition equiv_path_forall `{P : A -&gt; Type} (f g : forall x, P x)
  : (f == g)  &lt;~&gt;  (f = g)
  := Build_Equiv _ _ (path_forall f g) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Arguments equiv_path_forall {A%_type_scope P} (f g)%_function_scope.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Path algebra *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 52
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition path_forall_pp `{P : A -&gt; Type} (f g h : forall x, P x)
           (p : f == g) (q : g == h)
: path_forall f h (fun x =&gt; p x @ q x) = path_forall f g p @ path_forall g h q.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert p q.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  equiv_intro (@apD10 A P f g) p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  equiv_intro (@apD10 A P g h) q.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  transitivity (path_forall f h (apD10 (p @ q))).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, path_forall; intros x.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    symmetry; apply apD10_pp.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (eta_path_forall _ _ _ @ _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 62
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
    apply concat2; symmetry; apply eta_path_forall.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 63
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


Definition path_forall_V `{P : A -&gt; Type} (f g : forall x, P x)
           (p : f == g)
  : path_forall _ _ (fun x =&gt; (p x)^) = (path_forall _ _ p)^.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  transitivity (path_forall _ _ (fun x =&gt; (apD10 (path_forall _ _ p) x)^)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> f_ap.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply (@ap _ _ (fun h x =&gt; (h x)^)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply eisretr.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> transitivity (path_forall _ _ (apD10 (path_forall _ _ p)^)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Forall.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, inverse.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall; intros x.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply apD10_V.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Forall.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply eissect.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 75
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Transport *)

(** The concrete description of transport in sigmas and pis is rather trickier than in the other types. In particular, these cannot be described just in terms of transport in simpler types; they require the full Id-elim rule by way of "dependent transport" [transportD].

  In particular this indicates why "transport" alone cannot be fully defined by induction on the structure of types, although Id-elim/[transportD] can be (cf. Observational Type Theory). A more thorough set of lemmas, along the lines of the present ones but dealing with Id-elim rather than just transport, might be nice to have eventually? *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 82
Time: 0.003s">
<div class="time" style="width: 12%"></div>
<pre>Definition transport_forall
  {A : Type} {P : A -&gt; Type} {C : forall x, P x -&gt; Type}
  {x1 x2 : A} (p : x1 = x2) (f : forall y : P x1, C x1 y)
  : (transport (fun x =&gt; forall y : P x, C x y) p f)
    == (fun y =&gt;
       transport (C x2) (transport_pV _ _ _) (transportD _ _ p _ (f (p^ # y))))
  := match p with idpath =&gt; fun _ =&gt; 1 end.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A special case of [transport_forall] where the type [P] does not depend on [A],
    and so it is just a fixed type [B]. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 91
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition transport_forall_constant
  {A B : Type} {C : A -&gt; B -&gt; Type}
  {x1 x2 : A} (p : x1 = x2) (f : forall y : B, C x1 y)
  : (transport (fun x =&gt; forall y : B, C x y) p f)
    == (fun y =&gt; transport (fun x =&gt; C x y) p (f y))
  := match p with idpath =&gt; fun _ =&gt; 1 end.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 96
Time: 0.003s">
<div class="time" style="width: 12%"></div>
<pre>

Definition apD_transport_forall_constant
  {A B : Type} (C : A -&gt; B -&gt; Type)
  {x1 x2 : A} (p : x1 = x2) (f : forall y : B, C x1 y)
  {y1 y2 : B} (q : y1 = y2)
: apD (transport (fun x =&gt; forall y : B, C x y) p f) q
  = ap (transport (C x2) q) (transport_forall_constant p f y1)
    @ transport_transport C p q (f y1)
    @ ap (transport (fun x : A =&gt; C x y2) p) (apD f q)
    @ (transport_forall_constant p f y2)^.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 107
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
  destruct p, q; reflexivity.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 108
Time: 0.002s">
<div class="time" style="width: 8%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Maps on paths *)

(** The action of maps given by application. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ap_apply_lD {A} {B : A -&gt; Type} {f g : forall x, B x} (p : f = g) (z : A)
  : ap (fun f =&gt; f z) p = apD10 p z
:= 1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 115
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Definition ap_apply_lD2 {A} {B : A -&gt; Type} { C : forall x, B x -&gt; Type}
           {f g : forall x y, C x y} (p : f = g) (z1 : A) (z2 : B z1)
  : ap (fun f =&gt; f z1 z2) p = apD10 (apD10 p z1) z2.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    by path_induction.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** The action of maps given by lambda. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 125
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition ap_lambdaD {A B : Type} {C : B -&gt; Type} {x y : A} (p : x = y) (M : forall a b, C b)
  : ap (fun a b =&gt; M a b) p =
      path_forall _ _ (fun b =&gt; ap (fun a =&gt; M a b) p).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct p;
  symmetry;
  simpl; apply path_forall_1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The action of pre-composition on a path between dependent functions.  See also [ap10_ap_precompose] in PathGroupoids.v and [ap_precompose] in Arrow.v. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 134
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition ap_precomposeD {B Q : Type} {P : Q -&gt; Type}
  {f g : forall q, P q} (h : f = g) (i : B -&gt; Q)
  : ap (fun (k : forall q, P q) =&gt; k oD i) h
    = path_forall (f oD i) (g oD i) (apD10 h oD i)
  := ap_lambdaD _ _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Dependent paths *)

(** Usually, a dependent path over [p:x1=x2] in [P:A-&gt;Type] between [y1:P x1] and [y2:P x2] is a path [transport P p y1 = y2] in [P x2].  However, when [P] is a function space, these dependent paths have a more convenient description: rather than transporting the argument of [y1] forwards and backwards, we transport only forwards but on both sides of the equation, yielding a "naturality square". *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 143
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition dpath_forall
  {A:Type} (B:A -&gt; Type) (C:forall a, B a -&gt; Type) (x1 x2:A) (p:x1=x2)
  (f:forall y1:B x1, C x1 y1) (g:forall (y2:B x2), C x2 y2)
  : (forall (y1:B x1), transportD B C p y1 (f y1) = g (transport B p y1))
  &lt;~&gt;
  (transport (fun x =&gt; forall y:B x, C x y) p f = g).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply equiv_path_forall.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 152
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Definition dpath_forall_constant
  {A B:Type} (C : A -&gt; B -&gt; Type) (x1 x2:A) (p:x1=x2)
  (f:forall (y1:B), C x1 y1) (g:forall (y2:B), C x2 y2)
  : (forall (y1:B), transport (fun x =&gt; C x y1) p (f y1) = g y1)
  &lt;~&gt;
  (transport (fun x =&gt; forall y:B, C x y) p f = g).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply equiv_path_forall.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Functorial action *)

(** The functoriality of [forall] is slightly subtle: it is contravariant in the domain type and covariant in the codomain, but the codomain is dependent on the domain. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition functor_forall `{P : A -&gt; Type} `{Q : B -&gt; Type}
    (f0 : B -&gt; A) (f1 : forall b:B, P (f0 b) -&gt; Q b)
  : (forall a:A, P a) -&gt; (forall b:B, Q b)
  := (fun g b =&gt; f1 _ (g (f0 b))).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 171
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Definition ap_functor_forall `{P : A -&gt; Type} `{Q : B -&gt; Type}
    (f0 : B -&gt; A) (f1 : forall b:B, P (f0 b) -&gt; Q b)
    (g g' : forall a:A, P a) (h : g == g')
  : ap (functor_forall f0 f1) (path_forall _ _ h)
    = path_forall _ _ (fun b:B =&gt; (ap (f1 b) (h (f0 b)))).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  equiv_intro (@apD10 A P g g') h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  simpl.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  transitivity (idpath (functor_forall f0 f1 g)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (ap (ap (functor_forall f0 f1)) (path_forall_1 g)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  apply path_forall_1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 183
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 184
Time: 0.002s">
<div class="time" style="width: 8%"></div>
<pre>

Definition functor_forall_compose
           `{P : A -&gt; Type} `{Q : B -&gt; Type} `{R : C -&gt; Type}
           (f0 : B -&gt; A) (f1 : forall b:B, P (f0 b) -&gt; Q b)
           (g0 : C -&gt; B) (g1 : forall c:C, Q (g0 c) -&gt; R c)
           (k : forall a, P a)
  : functor_forall g0 g1 (functor_forall f0 f1 k) == functor_forall (f0 o g0) (fun c =&gt; g1 c o f1 (g0 c)) k
  := fun a =&gt; 1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Some special cases appear when one or the other of the maps are equivalences. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition functor_forall_id `{P : A -&gt; Type} `{Q : A -&gt; Type}
    (f1 : forall a:A, P a -&gt; Q a)
  : (forall a:A, P a) -&gt; (forall a:A, Q a)
  := functor_forall idmap f1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition functor_forall_pb {A B : Type} `{P : A -&gt; Type}
    (f0 : B -&gt; A)
  : (forall a:A, P a) -&gt; (forall b:B, P (f0 b))
  := functor_forall f0 (fun _ =&gt; idmap).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** If [f0] is an equivalence, then we can simply apply [functor_forall] to its inverse.  However, in this case it is sometimes more convenient to place the substitution on the other side of [f1]. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition functor_forall_equiv `{P : A -&gt; Type} `{Q : B -&gt; Type}
    (f0 : A -&gt; B) `{!IsEquiv f0} (f1 : forall a:A, P a -&gt; Q (f0 a))
  : (forall a:A, P a) -&gt; (forall b:B, Q b).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  napply (functor_forall f0^-1).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros b u.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine ((eisretr f0 b) # _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (f1 _ u).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition functor_forall_equiv_pb {A B : Type} `{Q : B -&gt; Type}
    (f0 : A -&gt; B) `{!IsEquiv f0}
  : (forall a:A, Q (f0 a)) -&gt; (forall b:B, Q b)
  := functor_forall_equiv f0 (fun _ =&gt; idmap).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Since there's a nontrivial transport here, it's useful to have a computation lemma. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition functor_forall_equiv_pb_beta {A B : Type} {P : B -&gt; Type} (f : A -&gt; B)
  `{!IsEquiv f} (h : forall a, P (f a))
  : forall a, functor_forall_equiv_pb f h (f a) = h a.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 224
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
  intro a; srapply (_ @ apD h (eissect f a)); srapply (_ @ (transport_compose _ _ _ _)^).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 225
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
  srapply ap10; apply ap; apply eisadj.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Equivalences *)

(** If *both* maps in [functor_forall] are equivalences, then so is the output. *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 231
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>#[export] Instance isequiv_functor_forall `{P : A -&gt; Type} `{Q : B -&gt; Type}
  `{IsEquiv B A f} `{forall b, @IsEquiv (P (f b)) (Q b) (g b)}
  : IsEquiv (functor_forall f g) | 1000.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply isequiv_adjointify.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 235
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 236
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre> exact (functor_forall (f^-1)
      (fun (x : A) (y : Q (f^-1 x)) =&gt; eisretr f x # (g (f^-1 x))^-1 y)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_forall; intros b; unfold functor_forall.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 239
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
    lhs napply (ap (fun p =&gt; g b (transport P p _)) (eisadj f b)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 240
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
    lhs_V napply (ap _ (transport_compose _ _ _ _)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 241
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
    lhs napply ap_transport.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    lhs napply (ap _ (eisretr (g _) _)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply apD.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_forall; intros a; unfold functor_forall.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    lhs napply (ap _ (eissect (g _) _)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply apD.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 248
Time: 0.002s">
<div class="time" style="width: 8%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 249
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Definition equiv_functor_forall `{P : A -&gt; Type} `{Q : B -&gt; Type}
  (f : B -&gt; A) `{IsEquiv B A f}
  (g : forall b, P (f b) -&gt; Q b)
  `{forall b, @IsEquiv (P (f b)) (Q b) (g b)}
  : (forall a, P a) &lt;~&gt; (forall b, Q b)
  := Build_Equiv _ _ (functor_forall f g) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 256
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Definition equiv_functor_forall' `{P : A -&gt; Type} `{Q : B -&gt; Type}
  (f : B &lt;~&gt; A) (g : forall b, P (f b) &lt;~&gt; Q b)
  : (forall a, P a) &lt;~&gt; (forall b, Q b)
  := equiv_functor_forall f g.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 261
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Definition equiv_functor_forall_id `{P : A -&gt; Type} `{Q : A -&gt; Type}
  (g : forall a, P a &lt;~&gt; Q a)
  : (forall a, P a) &lt;~&gt; (forall a, Q a)
  := equiv_functor_forall (equiv_idmap A) g.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 266
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Definition equiv_functor_forall_pb {A B : Type} {P : A -&gt; Type}
  (f : B &lt;~&gt; A)
  : (forall a, P a) &lt;~&gt; (forall b, P (f b))
  := equiv_functor_forall' (Q := P o f) f (fun b =&gt; equiv_idmap).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Similarly, we have a version of [functor_forall_equiv] that acts on on equivalences both upstairs and downstairs. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 274
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition equiv_functor_forall_covariant
           `{P : A -&gt; Type} `{Q : B -&gt; Type}
           (f : A &lt;~&gt; B) (g : forall a, P a &lt;~&gt; Q (f a))
  : (forall a, P a) &lt;~&gt; (forall b, Q b)
  := (equiv_functor_forall' f (fun a =&gt; (g a)^-1%equiv))^-1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 278
Time: 0.002s">
<div class="time" style="width: 8%"></div>
<pre>

Definition equiv_functor_forall_covariant_compose
           `{P : A -&gt; Type} `{Q : B -&gt; Type} `{R : C -&gt; Type}
           (f0 : A &lt;~&gt; B) (f1 : forall a, P a &lt;~&gt; Q (f0 a))
           (g0 : B &lt;~&gt; C) (g1 : forall b, Q b &lt;~&gt; R (g0 b))
           (h : forall a, P a)
  : equiv_functor_forall_covariant g0 g1 (equiv_functor_forall_covariant f0 f1 h)
    == equiv_functor_forall_covariant (g0 oE f0) (fun a =&gt; g1 (f0 a) oE f1 a) h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply apD10.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 288
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
  refine ((equiv_inverse_compose
             (equiv_functor_forall' g0 (fun a : B =&gt; (g1 a)^-1%equiv))
             (equiv_functor_forall' f0 (fun a : A =&gt; (f1 a)^-1%equiv))
             h)^ @ _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert h; apply equiv_inverse_homotopy; intros h.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_forall; intros c.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 294
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
  symmetry; rapply functor_forall_compose.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 295
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Functoriality on logical equivalences *)

(** At least over a fixed base *)</pre>
</div>
<div class="code" title="File: Forall.v
Line: 300
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition iff_functor_forall {A : Type} {P Q : A -&gt; Type}
           (f : forall a, P a &lt;-&gt; Q a)
  : (forall a, P a) &lt;-&gt; (forall a, Q a)
  := (functor_forall idmap (fun a =&gt; fst (f a)),
    functor_forall idmap (fun a =&gt; snd (f a))).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Two variable versions for function extensionality. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 307
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>Definition equiv_path_forall11 {A : Type} {B : A -&gt; Type} {P : forall a : A, B a -&gt; Type} (f g : forall a b, P a b)
  : (forall (a : A) (b : B a), f a b = g a b) &lt;~&gt; f = g
  := (equiv_path_forall f g) oE (equiv_functor_forall_id (fun a =&gt; equiv_path_forall (f a) (g a))).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition path_forall11 {A : Type} {B : A -&gt; Type} {P : forall a : A, B a -&gt; Type} (f g : forall a b, P a b)
  : (forall x y, f x y = g x y) -&gt; f = g
  := equiv_path_forall11 f g.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 313
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

#[export] Instance isequiv_path_forall11 {A : Type} {B : A -&gt; Type} `{P : forall a : A, B a -&gt; Type} (f g : forall a b, P a b)
  : IsEquiv (path_forall11 f g) | 0
  := _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 317
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Arguments equiv_path_forall11 {A B}%_type_scope {P} (f g)%_function_scope.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Arguments path_forall11 {A B}%_type_scope {P} (f g)%_function_scope _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Truncatedness: any dependent product of n-types is an n-type: see [contr_forall] and [istrunc_forall] in Basics.Trunc. *)

(** ** Contractibility: A product over a contractible type is equivalent to the fiber over the center. *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition equiv_contr_forall `{Contr A} `(P : A -&gt; Type)
: (forall a, P a) &lt;~&gt; P (center A).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 328
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  simple refine (equiv_adjointify (fun (f:forall a, P a) =&gt; f (center A)) _ _ _).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros p a; exact (transport P (path_contr _ _) p).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros p.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (transport2 P (q := 1) _ p).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply path_contr.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Forall.v
Line: 334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f; apply path_forall; intros a.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply apD.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 336
Time: 0.005s">
<div class="time" style="width: 20%"></div>
<pre>

End AssumeFunext.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Symmetry of curried arguments *)

(** [flip] is defined in Overture.v *)

</pre>
</div>
<div class="code" title="File: Forall.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance isequiv_flip `{P : A -&gt; B -&gt; Type}
  : IsEquiv (@flip _ _ P) | 0.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (flip_P := @flip _ _ P).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 346
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (flip_P_inv := @flip _ _ (flip P)).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (flip_P_is_sect := (fun f =&gt; 1) : flip_P_inv o flip_P == idmap).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 348
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (flip_P_is_retr := (fun g =&gt; 1) : flip_P o flip_P_inv == idmap).</pre>
</div>
<div class="code" title="File: Forall.v
Line: 349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists flip_P_inv flip_P_is_retr flip_P_is_sect.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 350
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro g.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  exact 1.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 351
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 352
Time: 0.001s">
<div class="time" style="width: 4%"></div>
<pre>

Definition equiv_flip `(P : A -&gt; B -&gt; Type)
  : (forall a b, P a b) &lt;~&gt; (forall b a, P a b)
  := Build_Equiv _ _ (@flip _ _ P) _.</pre>
</div>
<div class="code" title="File: Forall.v
Line: 357
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

