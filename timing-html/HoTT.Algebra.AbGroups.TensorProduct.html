<html>
<head>
<title>TensorProduct.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for TensorProduct.v</h1>

<div class="code" title="File: TensorProduct.v
Line: 1
Time: 0.022s">
<div class="time" style="width: 26.829268292683%"></div>
<pre>Require Import Basics.Overture Basics.Tactics.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 1
Time: 0.008s">
<div class="time" style="width: 9.7560975609756%"></div>
<pre>
Require Import Types.Forall Types.Sigma Types.Prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 2
Time: 0.012s">
<div class="time" style="width: 14.634146341463%"></div>
<pre>
Require Import WildCat.Core WildCat.Equiv WildCat.Monoidal WildCat.Bifunctor.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 3
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
Require Import WildCat.NatTrans WildCat.MonoidalTwistConstruction.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 4
Time: 0.069s">
<div class="time" style="width: 84.146341463415%"></div>
<pre>
Require Import Algebra.Groups.Group Algebra.Groups.QuotientGroup.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 5
Time: 0.01s">
<div class="time" style="width: 12.19512195122%"></div>
<pre>
Require Import Algebra.AbGroups.AbelianGroup Algebra.AbGroups.Biproduct.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 6
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
Require Import Algebra.AbGroups.AbHom Algebra.AbGroups.FreeAbelianGroup.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 7
Time: 0.008s">
<div class="time" style="width: 9.7560975609756%"></div>
<pre>
Require Import Algebra.AbGroups.Abelianization Algebra Algebra.Groups.FreeGroup.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Colimits.Quotient.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import Spaces.List.Core Spaces.Int.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Require Import AbGroups.Z.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 11
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
Require Import Truncations.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope mc_add_scope.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * The Tensor Product of Abelian Groups *)

(** Various maps [A * B → C] from the cartesian product of two abelian groups to another abelian group are "biadditive" (also called "bilinear"), meaning that they are group homomorphisms when we fix the left or right argument.

The tensor product of abelian groups is a construction that produces an abelian group [A ⊗ B] along with a biadditive map [A * B -&gt; A ⊗ B] which is initial among biadditive maps from [A * B].  This means that any biadditive map [A * B → C] factors uniquely through the tensor product via a group homomorphism [A ⊗ B -&gt; C].

Biadditive functions appear in all sorts of contexts ranging from linear algebra to analysis. Therefore having a way to systematically study them is very useful. *)

(** ** Construction *)

(** We define the tensor product of abelian groups as a quotient of the free abelian group on pairs of elements of the two groups by the subgroup generated by the biadditive pairs. *)

(** Here we define the subgroup of biadditive pairs in two steps. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition family_biadditive_pairs {A B : AbGroup}
  : FreeAbGroup (A * B) -&gt; Type.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine ((exists (a1 a2 : A) (b : B), _) + exists (a : A) (b1 b2 : B), _)%type.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 33
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre> refine (- _ + (_ + _) = x).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1-3: apply freeabgroup_in.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (a1 + a2, b).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (a1, b).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (a2, b).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 38
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre> refine (- _ + (_ + _) = x).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1-3: apply freeabgroup_in.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (a, b1 + b2).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (a, b1).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (a, b2).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 42
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition subgroup_biadditive_pairs {A B : AbGroup}
  : Subgroup (FreeAbGroup (A * B))
  := subgroup_generated family_biadditive_pairs.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The tensor product [ab_tensor_prod A B] of two abelian groups [A] and [B] is defined to be a quotient of the free abelian group on pairs of elements [A * B] by the subgroup of biadditive pairs. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ab_tensor_prod (A B : AbGroup) : AbGroup
  := QuotientAbGroup (FreeAbGroup (A * B)) subgroup_biadditive_pairs.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments ab_tensor_prod A B : simpl never.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The tensor product of [A] and [B] contains formal sums and differences of pairs of elements from [A] and [B]. We denote these pairs as "simple tensors" and name them [tensor]. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 54
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition tensor {A B : AbGroup} : A -&gt; B -&gt; ab_tensor_prod A B
  := fun a b =&gt; grp_quotient_map (freeabgroup_in (a, b)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Properties of tensors *)

(** The characterizing property of simple tensors are that they are biadditive in their arguments. *)

(** A [tensor] of a sum distributes over the sum on the left. *) </pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 61
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition tensor_dist_l {A B : AbGroup} (a : A) (b b' : B)
  : tensor a (b + b') = tensor a b + tensor a b'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 63
Time: 0.019s">
<div class="time" style="width: 23.170731707317%"></div>
<pre>
  apply qglue, tr.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply sgt_in.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  right.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 66
Time: 0.022s">
<div class="time" style="width: 26.829268292683%"></div>
<pre>
  by exists a, b, b'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 67
Time: 0.043s">
<div class="time" style="width: 52.439024390244%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A [tensor] of a sum distributes over the sum on the right. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 70
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition tensor_dist_r {A B : AbGroup} (a a' : A) (b : B)
  : tensor (a + a') b = tensor a b + tensor a' b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 72
Time: 0.018s">
<div class="time" style="width: 21.951219512195%"></div>
<pre>
  apply qglue, tr.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply sgt_in.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  left.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 75
Time: 0.016s">
<div class="time" style="width: 19.512195121951%"></div>
<pre>
  by exists a, a', b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 76
Time: 0.036s">
<div class="time" style="width: 43.90243902439%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Tensoring on the left is a group homomorphism. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition grp_homo_tensor_l {A B : AbGroup} (a : A)
  : B $-&gt; ab_tensor_prod A B.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply Build_GroupHomomorphism.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun b =&gt; tensor a b).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros b b'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    napply tensor_dist_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 

(** Tensoring on the right is a group homomorphism. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition grp_homo_tensor_r {A B : AbGroup} (b : B)
  : A $-&gt; ab_tensor_prod A B.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply Build_GroupHomomorphism.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun a =&gt; tensor a b).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a a'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    napply tensor_dist_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Tensors preserve negation in the left argument. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 97
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>Definition tensor_neg_l {A B : AbGroup} (a : A) (b : B)
  : tensor (-a) b = - tensor a b
  := grp_homo_inv (grp_homo_tensor_r b) a.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Tensors preserve negation in the right argument. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 101
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>Definition tensor_neg_r {A B : AbGroup} (a : A) (b : B)
  : tensor a (-b) = - tensor a b
  := grp_homo_inv (grp_homo_tensor_l a) b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Tensoring by zero on the left is zero. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 105
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Definition tensor_zero_l {A B : AbGroup} (b : B)
  : tensor (A:=A) 0 b = 0
  := grp_homo_unit (grp_homo_tensor_r b).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Tensoring by zero on the right is zero. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 109
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition tensor_zero_r {A B : AbGroup} (a : A)
  : tensor (B:=B) a 0 = 0
  := grp_homo_unit (grp_homo_tensor_l a).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The [tensor] map is biadditive and therefore can be written in a curried form using the internal abelian group hom. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition grp_homo_tensor `{Funext} {A B : AbGroup}
  : A $-&gt; ab_hom B (ab_tensor_prod A B).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply Build_GroupHomomorphism.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 117
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    snapply Build_GroupHomomorphism.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (tensor a).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> napply tensor_dist_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a a'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply equiv_path_grouphomomorphism.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    napply tensor_dist_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 124
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Induction principles *)

(** Here we write down some induction principles to help us prove lemmas about the tensor product. Some of these are quite specialised but are patterns that appear often in practice. *) 

(** Our main recursion principle states that in order to build a homomorphism out of the tensor product, it is sufficient to provide a map out of the direct product which is biadditive, that is, a map that preserves addition in each argument of the product. *)

(** We separate out the proof of this part, so we can make it opaque. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 133
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>Definition ab_tensor_prod_rec_helper {A B C : AbGroup}
  (f : A -&gt; B -&gt; C)
  (l : forall a b b', f a (b + b') = f a b + f a b')
  (r : forall a a' b, f (a + a') b = f a b + f a' b)
  (x : FreeAbGroup (A * B)) (insg : subgroup_biadditive_pairs x)
  : grp_homo_abel_rec (FreeGroup_rec (uncurry f)) x = mon_unit.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  set (abel_rec := grp_homo_abel_rec (FreeGroup_rec (uncurry f))).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 140
Time: 0.023s">
<div class="time" style="width: 28.048780487805%"></div>
<pre>
  strip_truncations.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction insg as [ x biad | | g h insg_g IHg insg_h IHh ].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 143
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre> destruct biad as [ [ a [ a' [ b p ] ] ] | [ a [ b [ b' p ] ] ] ].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 143
Time: 0.025s">
<div class="time" style="width: 30.487804878049%"></div>
<pre>
    all: destruct p; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 144
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    all: apply grp_moveL_M1^-1%equiv; symmetry.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: apply r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> napply grp_homo_unit.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 149
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre> rewrite grp_homo_op, grp_homo_inv.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 149
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
    apply grp_moveL_1M^-1.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (IHg @ IHh^).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 151
Time: 0.019s">
<div class="time" style="width: 23.170731707317%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Opaque ab_tensor_prod_rec_helper.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 154
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>

Definition ab_tensor_prod_rec {A B C : AbGroup}
  (f : A -&gt; B -&gt; C)
  (l : forall a b b', f a (b + b') = f a b + f a b')
  (r : forall a a' b, f (a + a') b = f a b + f a' b) 
  : ab_tensor_prod A B $-&gt; C.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold ab_tensor_prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 162
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply grp_quotient_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply FreeAbGroup_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (uncurry f).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold normalsubgroup_subgroup.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ab_tensor_prod_rec_helper; assumption.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A special case that arises. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 170
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition ab_tensor_prod_rec' {A B C : AbGroup}
  (f : A -&gt; (B $-&gt; C))
  (l : forall a a' b, f (a + a') b = f a b + f a' b)
  : ab_tensor_prod A B $-&gt; C.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ab_tensor_prod_rec f _ l).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro a; apply grp_homo_op.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We give an induction principle for an hprop-valued type family [P].  It may be surprising at first that we only require [P] to hold for the simple tensors [tensor a b] and be closed under addition.  It automatically follows that [P 0] holds (since [tensor 0 0 = 0]) and that [P] is closed under negation (since [tensor -a b = - tensor a b]). This induction principle says that the simple tensors generate the tensor product as a semigroup. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 179
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition ab_tensor_prod_ind_hprop {A B : AbGroup}
  (P : ab_tensor_prod A B -&gt; Type)
  {H : forall x, IsHProp (P x)}
  (Hin : forall a b, P (tensor a b))
  (Hop : forall x y, P x -&gt; P y -&gt; P (x + y))
  : forall x, P x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold ab_tensor_prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 186
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  srapply grp_quotient_ind_hprop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 187
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
  srapply Abel_ind_hprop; cbn beta.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 188
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  set (tensor_in := grp_quotient_map $o abel_unit : FreeGroup (A * B) $-&gt; ab_tensor_prod A B).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  change (forall x, P (tensor_in x)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 190
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  srapply FreeGroup_ind_hprop'; intros w; cbn beta.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction w.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* The goal here is [P 0], so we use [Hin 0 0 : P (tensor 0 0)]. *)
   </pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 194
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>exact (transport P (tensor_zero_l 0) (Hin 0 0)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 194
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> change (P (tensor_in (freegroup_eta [a]%list + freegroup_eta w))).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (* This [rewrite] is [reflexivity], but the [Defined] is slow if [change] is used instead. *)
   </pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 197
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>rewrite grp_homo_op.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    destruct a as [[a b]|[a b]].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 199
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre> change (P (tensor_in (freegroup_in (a, b)) + tensor_in (freegroup_eta w))).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 199
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply Hop; trivial.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 200
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
      apply Hin.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 202
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre> change (P (tensor_in (- freegroup_in (a, b)) + tensor_in (freegroup_eta w))).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (* This [rewrite] is reflexivity, but using [change] to achieve this is slow and slows down the Defined line. *)
     </pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 204
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>rewrite grp_homo_inv.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply Hop; trivial.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 205
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
      rewrite &lt;- tensor_neg_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply Hin.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 207
Time: 0.004s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** As a commonly occurring special case of the above induction principle, we have the case when the predicate in question is showing that two group homomorphisms out of the tensor product are homotopic. In order to do this, it suffices to show it only for simple tensors. The homotopy is closed under addition, so we don't need to hypothesise anything else. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 210
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition ab_tensor_prod_ind_homotopy {A B G : AbGroup}
  {f f' : ab_tensor_prod A B $-&gt; G}
  (H : forall a b, f (tensor a b) = f' (tensor a b))
  : f $== f'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 214
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  napply ab_tensor_prod_ind_hprop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 216
Time: 0.006s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact H.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y; apply grp_homo_op_agree.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 218
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** As an even more specialised case, we occasionally have the second homomorphism being a sum of abelian group homomorphisms. In those cases, it is easier to use this specialised lemma. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 221
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>Definition ab_tensor_prod_ind_homotopy_plus {A B G : AbGroup}
  {f f' f'' : ab_tensor_prod A B $-&gt; G}
  (H : forall a b, f (tensor a b) = f' (tensor a b) + f'' (tensor a b))
  : forall x, f x = f' x + f'' x
  := ab_tensor_prod_ind_homotopy (f':=f' + f'') H.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Here we give an induction principle for a triple tensor, a.k.a a dependent trilinear function. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 227
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition ab_tensor_prod_ind_hprop_triple {A B C : AbGroup}
  (P : ab_tensor_prod A (ab_tensor_prod B C) -&gt; Type)
  (H : forall x, IsHProp (P x))
  (Hin : forall a b c, P (tensor a (tensor b c)))
  (Hop : forall x y, P x -&gt; P y -&gt; P (x + y))
  : forall x, P x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 233
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  rapply (ab_tensor_prod_ind_hprop P).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 235
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 235
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
    rapply (ab_tensor_prod_ind_hprop (fun x =&gt; P (tensor _ x))).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> napply Hin.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y Hx Hy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite tensor_dist_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      by apply Hop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 240
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact Hop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Similar to before, we specialise the triple tensor induction principle for proving homotopies of trilinear/triadditive functions. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 244
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition ab_tensor_prod_ind_homotopy_triple {A B C G : AbGroup}
  {f f' : ab_tensor_prod A (ab_tensor_prod B C) $-&gt; G}
  (H : forall a b c, f (tensor a (tensor b c)) = f' (tensor a (tensor b c)))
  : f $== f'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 248
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  napply ab_tensor_prod_ind_hprop_triple.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 250
Time: 0.007s">
<div class="time" style="width: 8.5365853658537%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact H.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y; apply grp_homo_op_agree.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 252
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** As explained for the biadditive and triadditive cases, we also derive an induction principle for quadruple tensors giving us dependent quadrilinear maps. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 255
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Definition ab_tensor_prod_ind_hprop_quad {A B C D : AbGroup}
  (P : ab_tensor_prod A (ab_tensor_prod B (ab_tensor_prod C D)) -&gt; Type)
  (H : forall x, IsHProp (P x))
  (Hin : forall a b c d, P (tensor a (tensor b (tensor c d))))
  (Hop : forall x y, P x -&gt; P y -&gt; P (x + y))
  : forall x, P x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 260
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 261
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  rapply (ab_tensor_prod_ind_hprop P).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 262
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 263
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    napply (ab_tensor_prod_ind_hprop_triple (fun x =&gt; P (tensor _ x))).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x; apply H.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> napply Hin.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y Hx Hy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      rewrite tensor_dist_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      by apply Hop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 270
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact Hop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 270
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** To construct a homotopy between quadrilinear maps we need only check equality for the quadruple simple tensors. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 273
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Definition ab_tensor_prod_ind_homotopy_quad {A B C D G : AbGroup}
  {f f' : ab_tensor_prod A (ab_tensor_prod B (ab_tensor_prod C D)) $-&gt; G}
  (H : forall a b c d, f (tensor a (tensor b (tensor c d)))
    = f' (tensor a (tensor b (tensor c d))))
  : f $== f'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 277
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 278
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  napply (ab_tensor_prod_ind_hprop_quad (fun _ =&gt; _)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 279
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 280
Time: 0.008s">
<div class="time" style="width: 9.7560975609756%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact H.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y; apply grp_homo_op_agree.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 282
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Universal Property of the Tensor Product *)

(** A function of two variables is biadditive if it preserves the operation in each variable. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 287
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Class IsBiadditive {A B C : Type} `{SgOp A, SgOp B, SgOp C} (f : A -&gt; B -&gt; C) := {
  isbiadditive_l :: forall b, IsSemiGroupPreserving (flip f b);
  isbiadditive_r :: forall a, IsSemiGroupPreserving (f a);  
}.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 290
Time: 0.006s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>

Definition issig_IsBiadditive {A B C : Type} `{SgOp A, SgOp B, SgOp C}
  (f : A -&gt; B -&gt; C)
  : _ &lt;~&gt; IsBiadditive f
  := ltac:(issig).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 295
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The truncation level of the [IsBiadditive f] predicate is determined by the truncation level of the codomain. This will almost always be a hset. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance istrunc_isbiadditive `{Funext}
  {A B C : Type} `{SgOp A, SgOp B, SgOp C}
  (f : A -&gt; B -&gt; C) n `{IsTrunc n.+1 C}
  : IsTrunc n (IsBiadditive f).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  napply istrunc_equiv_istrunc.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  1: rapply issig_IsBiadditive.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold IsSemiGroupPreserving.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 304
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  exact _.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 305
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The simple tensor map is biadditive. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 308
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Instance isbiadditive_tensor (A B : AbGroup)
  : IsBiadditive (@tensor A B) := {|
  isbiadditive_l := fun b a a' =&gt; tensor_dist_r a a' b;
  isbiadditive_r := tensor_dist_l;
|}.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The type of biadditive maps. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 314
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Record Biadditive (A B C : Type) `{SgOp A, SgOp B, SgOp C} := {
  biadditive_fun :&gt; A -&gt; B -&gt; C;
  biadditive_isbiadditive :: IsBiadditive biadditive_fun;
}.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 317
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>

Definition issig_Biadditive {A B C : Type} `{SgOp A, SgOp B, SgOp C}
  : _ &lt;~&gt; Biadditive A B C
  := ltac:(issig).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 321
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>

Definition biadditive_ab_tensor_prod {A B C : AbGroup}
  : (ab_tensor_prod A B $-&gt; C) -&gt; Biadditive A B C.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 325
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros f.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exists (fun x y =&gt; f (tensor x y)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply Build_IsBiadditive.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 328
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros b a a'; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    lhs napply (ap f).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: napply tensor_dist_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 331
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    napply grp_homo_op.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a a' b; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    lhs napply (ap f).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    1: napply tensor_dist_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 335
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    napply grp_homo_op.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 336
Time: 0.004s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The universal property of the tensor product is that biadditive maps between abelian groups are in one-to-one correspondence with maps out of the tensor product. In this sense, the tensor product is the most perfect object describing biadditive maps between two abelian groups. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 339
Time: 0.004s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>Definition equiv_ab_tensor_prod_rec `{Funext} (A B C : AbGroup)
  : Biadditive A B C &lt;~&gt; (ab_tensor_prod A B $-&gt; C).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply equiv_adjointify.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [f [l r]].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (ab_tensor_prod_rec f r (fun a a' b =&gt; l b a a')).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply biadditive_ab_tensor_prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 345
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 346
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 346
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply equiv_path_grouphomomorphism.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 348
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    intros a b; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 350
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros [f [l r]].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    snapply (equiv_ap_inv' issig_Biadditive).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 352
Time: 0.009s">
<div class="time" style="width: 10.975609756098%"></div>
<pre>
    rapply path_sigma_hprop; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 354
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Functoriality of the Tensor Product *)

(** The tensor product produces a bifunctor and we will later show that it gives a symmetric monoidal structure on the category of abelian groups. *)

(** Given a pair of maps, we can produce a homomorphism between the pairwise tensor products of the domains and codomains. *) </pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 361
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition functor_ab_tensor_prod {A B A' B' : AbGroup}
  (f : A $-&gt; A') (g : B $-&gt; B')
  : ab_tensor_prod A B $-&gt; ab_tensor_prod A' B'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 363
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 364
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_rec'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 365
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro a.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (grp_homo_tensor_l (f a) $o g).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 367
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 368
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a a' b; hnf.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 368
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    rewrite grp_homo_op.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 369
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    napply tensor_dist_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 371
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** 2-functoriality of the tensor product. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 373
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition functor2_ab_tensor_prod {A B A' B' : AbGroup}
  {f f' : A $-&gt; A'} (p : f $== f') {g g' : B $-&gt; B'} (q : g $== g')
  : functor_ab_tensor_prod f g $== functor_ab_tensor_prod f' g'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 375
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 377
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
  intros a b; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (ap011 tensor (p _) (q _)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 379
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The tensor product functor preserves identity morphisms. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition functor_ab_tensor_prod_id (A B : AbGroup)
  : functor_ab_tensor_prod (Id A) (Id B) $== Id (ab_tensor_prod A B).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 384
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 385
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
  intros a b; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 386
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 387
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 388
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The tensor product functor preserves composition. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 390
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition functor_ab_tensor_prod_compose {A B C A' B' C' : AbGroup}
  (f : A $-&gt; B) (g : B $-&gt; C) (f' : A' $-&gt; B') (g' : B' $-&gt; C')
  : functor_ab_tensor_prod (g $o f) (g' $o f')
    $== functor_ab_tensor_prod g g' $o functor_ab_tensor_prod f f'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 395
Time: 0.004s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>
  intros a b; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 396
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 397
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 398
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The tensor product functor is a 0-bifunctor. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance is0bifunctor_ab_tensor_prod : Is0Bifunctor ab_tensor_prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 401
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
  rapply Build_Is0Bifunctor'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply Build_Is0Functor.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros [A B] [A' B'] [f g].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (functor_ab_tensor_prod f g).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The tensor product functor is a bifunctor. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 408
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Instance is1bifunctor_ab_tensor_prod : Is1Bifunctor ab_tensor_prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 409
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  rapply Build_Is1Bifunctor'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 410
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  snapply Build_Is1Functor.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros AB A'B' fg f'g' [p q].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 412
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
    exact (functor2_ab_tensor_prod p q).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 413
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 414
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre> intros [A B].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 414
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    exact (functor_ab_tensor_prod_id A B).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 415
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 416
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros AA' BB' CC' [f g] [f' g'].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 416
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
    exact (functor_ab_tensor_prod_compose f f' g g').</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 417
Time: 0.006s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 418
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Symmetry of the Tensor Product *)

(** The tensor product is symmetric in that the order in which we take the tensor shouldn't matter up to isomorphism. *)

(** We can define a swap map which swaps the order of simple tensors. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ab_tensor_swap {A B} : ab_tensor_prod A B $-&gt; ab_tensor_prod B A.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 425
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 426
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (flip tensor).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a b b'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply tensor_dist_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 429
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 430
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a a' b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 430
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply tensor_dist_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 431
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 432
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** [ab_tensor_swap] is involutive. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 434
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ab_tensor_swap_swap {A B}
  : ab_tensor_swap $o @ab_tensor_swap A B $== Id _.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 435
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 436
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 437
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 438
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 439
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 

(** [ab_tensor_swap] is natural in both arguments. This means that it also acts on tensor functors. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 441
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition ab_tensor_swap_natural {A B A' B' : AbGroup} (f : A $-&gt; A') (g : B $-&gt; B')
  : ab_tensor_swap $o functor_ab_tensor_prod f g
    $== functor_ab_tensor_prod g f $o ab_tensor_swap.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 443
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 444
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 445
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
  simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 446
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* This speeds up the [reflexivity] and the [Defined]. *)
 </pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 447
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 447
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 448
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The swap map gives us a symmetric braiding on the category of abelian groups. We will later show it is a full symmetric monoidal category. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance symmetricbraiding_ab_tensor_prod : SymmetricBraiding ab_tensor_prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 451
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply Build_SymmetricBraiding.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 452
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply Build_NatTrans.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro; exact ab_tensor_swap.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply Build_Is1Natural.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 455
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
      intros; napply ab_tensor_swap_natural.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 456
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 457
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre> intros; napply ab_tensor_swap_swap.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 457
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 

(** ** Twisting Triple Tensors *)

(** In order to construct the symmetric monoidal category, we will use what is termed the "Twist construction" in Monoidal.v. This simplifies the data of a symmetric monoidal category by constructing it from simpler parts. For instance, instead of having to prove full associativity [(A ⊗ B) ⊗ C $-&gt; A ⊗ (B ⊗ C)], we can provide a twist map [A ⊗ (B ⊗ C) $-&gt; B ⊗ (A ⊗ C)] and use the symmetric braiding we have so far to prove associativity. *)

(** In order to be more efficient whilst unfolding definitions, we break up the definition of a twist map into its components. *)

</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 465
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition ab_tensor_prod_twist_map {A B C : AbGroup}
  : A -&gt; (ab_tensor_prod B C $-&gt; ab_tensor_prod B (ab_tensor_prod A C)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 466
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 467
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros a.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 468
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_rec'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 469
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 470
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 470
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (grp_homo_tensor_l b $o grp_homo_tensor_l a).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 471
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 472
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros b b' c; hnf.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 472
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    napply tensor_dist_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 473
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 474
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>

Local Definition ab_tensor_prod_twist_map_additive_l {A B C : AbGroup}
  (a a' : A) (b : ab_tensor_prod B C)
  : ab_tensor_prod_twist_map (a + a') b
    = ab_tensor_prod_twist_map a b + ab_tensor_prod_twist_map a' b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 479
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 480
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  
  revert b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 481
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  napply ab_tensor_prod_ind_homotopy_plus.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 482
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros b c.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 483
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  change (tensor b (tensor (a + a') c)
    = tensor b (tensor a c) + tensor b (tensor a' c)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 485
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
  rhs_V napply tensor_dist_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 486
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  napply (ap (tensor b)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 487
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  napply tensor_dist_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 488
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 489
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Given a triple tensor product, we have a twist map which permutes the first two components. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 491
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ab_tensor_prod_twist {A B C}
  : ab_tensor_prod A (ab_tensor_prod B C) $-&gt; ab_tensor_prod B (ab_tensor_prod A C).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 492
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 493
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_rec'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 494
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 495
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact ab_tensor_prod_twist_map.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 495
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact ab_tensor_prod_twist_map_additive_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The twist map is involutive. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 499
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition ab_tensor_prod_twist_twist {A B C}
  : ab_tensor_prod_twist $o @ab_tensor_prod_twist A B C $== Id _.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 500
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy_triple.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 504
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The twist map is natural in all 3 arguments. This means that the twist map acts on the triple tensor functor in the same way. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 506
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>Definition ab_tensor_prod_twist_natural {A B C A' B' C' : AbGroup}
  (f : A $-&gt; A') (g : B $-&gt; B') (h : C $-&gt; C')
  : ab_tensor_prod_twist $o fmap11 ab_tensor_prod f (fmap11 ab_tensor_prod g h)
    $== fmap11 ab_tensor_prod g (fmap11 ab_tensor_prod f h) $o ab_tensor_prod_twist.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 509
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 510
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy_triple.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 511
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros a b c.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 512
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* This [change] speeds up the [reflexivity].  [simpl] produces a goal that looks the same, but is still slow. *)
 </pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 514
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>change (tensor (g b) (tensor (f a) (h c)) = tensor (g b) (tensor (f a) (h c))).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 514
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 515
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 516
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Unitality of [abgroup_Z] *)

(** In the symmetric monoidal structure on abelian groups, [abgroup_Z] is the unit. We show that tensoring with [abgroup_Z] on the right is isomorphic to the original group. *)

(** First we characterise the action of integers via [grp_pow] and their interaction on tensors. This is just a generalisation of the distributivity laws for tensors. *)

(** Multiplication in the first factor can be factored out. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 524
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition tensor_ab_mul_l {A B : AbGroup} (z : Int) (a : A) (b : B)
  : tensor (ab_mul z a) b = ab_mul z (tensor a b)
  := ab_mul_natural (grp_homo_tensor_r b) z a.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 526
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Multiplication in the second factor can be factored out. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 528
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition tensor_ab_mul_r {A B : AbGroup} (z : Int) (a : A) (b : B)
  : tensor a (ab_mul z b) = ab_mul z (tensor a b)
  := ab_mul_natural (grp_homo_tensor_l a) z b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 530
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Multiplication can be transferred from one factor to the other. The tensor product of [R]-modules will include this as an extra axiom, but here we have [Z]-modules and we can prove it. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 532
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition tensor_ab_mul {A B : AbGroup} (z : Int) (a : A) (b : B)
  : tensor (ab_mul z a) b = tensor a (ab_mul z b).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 533
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 534
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  rhs napply tensor_ab_mul_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 535
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  napply tensor_ab_mul_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 536
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 537
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** [abgroup_Z] is a right identity for the tensor product. *) </pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 539
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ab_tensor_prod_Z_r {A}
  : ab_tensor_prod A abgroup_Z $&lt;~&gt; A.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 540
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 541
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Checking that the inverse map is a homomorphism is easier. *)
 </pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 543
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>symmetry.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 543
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  snapply Build_GroupIsomorphism.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 544
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 545
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> napply grp_homo_tensor_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 545
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact 1%int.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 546
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 547
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply isequiv_adjointify.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 547
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 548
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply ab_tensor_prod_rec'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 548
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 549
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact grp_pow_homo.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 549
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 550
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a a' z; cbn beta.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 550
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        napply (grp_homo_op (ab_mul z)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 551
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 552
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 552
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
      change (forall x : ?A, (grp_homo_map ?f) ((grp_homo_map ?g) x) = x)
        with (f $o g $== Id _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 554
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros a z.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 556
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      change (tensor (B:=abgroup_Z) (grp_pow a z) 1%int = tensor a z).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 557
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      lhs napply tensor_ab_mul.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 558
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      napply ap.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 559
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      lhs napply abgroup_Z_ab_mul.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 560
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply int_mul_1_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 561
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact grp_unit_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 562
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 563
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We have a right unitor for the tensor product given by unit [abgroup_Z]. Naturality of [ab_tensor_prod_Z_r] is straightforward to prove. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 565
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance rightunitor_ab_tensor_prod
  : RightUnitor ab_tensor_prod abgroup_Z.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 566
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 567
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply Build_NatEquiv.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 568
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 569
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 569
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    apply ab_tensor_prod_Z_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 570
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply Build_Is1Natural.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A A' f.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 572
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 573
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a z; symmetry.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 574
Time: 0.006s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>
    exact (grp_pow_natural _ _ _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 575
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 576
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Since we have symmetry of the tensor product, we get left unitality for free. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 578
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance left_unitor_ab_tensor_prod
  : LeftUnitor ab_tensor_prod abgroup_Z.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 579
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 580
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  rapply left_unitor_twist.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 582
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Symmetric Monoidal Structure of Tensor Product *)

(** Using the twist construction we can derive an associator for the tensor product. In other words, we have associativity of the tensor product of abelian groups natural in each factor. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 586
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance associator_ab_tensor_prod : Associator ab_tensor_prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 586
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 587
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  srapply associator_twist.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 588
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 589
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact @ab_tensor_prod_twist.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 589
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 590
Time: 0.006s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre> intros; napply ab_tensor_prod_twist_twist.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 590
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 591
Time: 0.004s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre> intros; napply ab_tensor_prod_twist_natural.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 591
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 592
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The triangle identity is straightforward to prove using the custom induction principles we proved earlier. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 594
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Instance triangle_ab_tensor_prod
  : TriangleIdentity ab_tensor_prod abgroup_Z.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 595
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 596
Time: 0.008s">
<div class="time" style="width: 9.7560975609756%"></div>
<pre>
  snapply triangle_twist.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A B.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 598
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy_triple.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 599
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros a b z; symmetry.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 600
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (tensor_ab_mul z a b).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 601
Time: 0.006s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 602
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The hexagon identity is also straightforward to prove. We simply have to reduce all the involved functions on the simple tensors using our custom triple tensor induction principle. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 604
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Instance hexagon_ab_tensor_prod : HexagonIdentity ab_tensor_prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 605
Time: 0.026s">
<div class="time" style="width: 31.707317073171%"></div>
<pre>
  snapply hexagon_twist.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 606
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A B C.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 607
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy_triple.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 608
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros b a c.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 609
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  change (tensor c (tensor a b) = tensor c (tensor a b)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 610
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 611
Time: 0.006s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 612
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Finally, we can prove the pentagon identity using the quadruple tensor induction principle. As we did before, the work only involves reducing the involved functions on the simple tensor redexes. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance pentagon_ab_tensor_prod : PentagonIdentity ab_tensor_prod.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 615
Time: 0.009s">
<div class="time" style="width: 10.975609756098%"></div>
<pre>
  snapply pentagon_twist.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A B C D.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 617
Time: 0.004s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy_quad.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 618
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros a b c d.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 619
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  change (tensor c (tensor d (tensor a b)) = tensor c (tensor d (tensor a b))).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 620
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
  reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 621
Time: 0.008s">
<div class="time" style="width: 9.7560975609756%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 622
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We therefore have all the data of a monoidal category. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 624
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Instance ismonoidal_ab_tensor_prod
  : IsMonoidal AbGroup ab_tensor_prod abgroup_Z
  := {}.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 626
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** And furthermore, all the data of a symmetric monoidal category. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 628
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Instance issymmmetricmonoidal_ab_tensor_prod
  : IsSymmetricMonoidal AbGroup ab_tensor_prod abgroup_Z
  := {}.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 630
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Preservation of Coequalizers *)

(** The tensor product of abelian groups preserves coequalizers, meaning that the coequalizer of two tensored groups is the tensor of the coequalizer. We show this is the case on the left and the right. *)

(** Tensor products preserve coequalizers on the right. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 636
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition grp_iso_ab_tensor_prod_coeq_l A {B C : AbGroup} (f g : B $-&gt; C)
  : ab_coeq (fmap01 ab_tensor_prod A f) (fmap01 ab_tensor_prod A g)
    $&lt;~&gt; ab_tensor_prod A (ab_coeq f g).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 638
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 639
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  snapply cate_adjointify.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 640
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 641
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply ab_coeq_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 641
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 642
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre> rapply (fmap01 ab_tensor_prod A).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 642
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      napply ab_coeq_in.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 643
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 644
Time: 0.01s">
<div class="time" style="width: 12.19512195122%"></div>
<pre> refine (_^$ $@ fmap02 ab_tensor_prod _ _ $@ _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 644
Time: 0.075s">
<div class="time" style="width: 91.463414634146%"></div>
<pre>
      1,3: tapply fmap01_comp.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 645
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
      napply ab_coeq_glue.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 646
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 647
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply ab_tensor_prod_rec'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 647
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 648
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 648
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
      snapply functor_ab_coeq.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 649
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,2: snapply (grp_homo_tensor_l a).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 650
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      1,2: hnf; reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 651
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 652
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a a'; cbn beta.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 652
Time: 0.008s">
<div class="time" style="width: 9.7560975609756%"></div>
<pre>
      srapply ab_coeq_ind_hprop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 653
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 654
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
      exact (ap (ab_coeq_in
        (f:=fmap01 ab_tensor_prod A f)
        (g:=fmap01 ab_tensor_prod A g))
        (tensor_dist_r a a' x)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 659
Time: 0.013s">
<div class="time" style="width: 15.853658536585%"></div>
<pre> snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 659
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 660
Time: 0.017s">
<div class="time" style="width: 20.731707317073%"></div>
<pre>
    srapply ab_coeq_ind_hprop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 661
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros c.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 662
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 663
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 664
Time: 0.046s">
<div class="time" style="width: 56.09756097561%"></div>
<pre> snapply ab_coeq_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 664
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
    snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 665
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 666
Time: 0.082s">
<div class="time" style="width: 100%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 667
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The equivalence respects the natural maps from [ab_tensor_prod A C]. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 669
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Definition ab_tensor_prod_coeq_l_triangle A {B C : AbGroup} (f g : B $-&gt; C)
  : grp_iso_ab_tensor_prod_coeq_l A f g $o ab_coeq_in
    $== fmap01 ab_tensor_prod A ab_coeq_in.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 671
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 672
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 673
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 674
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 675
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Tensor products preserve coequalizers on the left. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 677
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Definition grp_iso_ab_tensor_prod_coeq_r {A B : AbGroup} (f g : A $-&gt; B) C
  : ab_coeq (fmap10 ab_tensor_prod f C) (fmap10 ab_tensor_prod g C)
    $&lt;~&gt; ab_tensor_prod (ab_coeq f g) C.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 679
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 680
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (braide _ _ $oE _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 681
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  nrefine (grp_iso_ab_tensor_prod_coeq_l _ f g $oE _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 682
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  snapply grp_iso_ab_coeq.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 683
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  1,2: rapply braide.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 684
Time: 0.004s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>
  1,2: symmetry; napply ab_tensor_swap_natural.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 685
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 686
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The equivalence respects the natural maps from [ab_tensor_prod B C]. *)</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 688
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>Definition ab_tensor_prod_coeq_r_triangle {A B : AbGroup} (f g : A $-&gt; B) C
  : grp_iso_ab_tensor_prod_coeq_r f g C $o ab_coeq_in
    $== fmap10 ab_tensor_prod ab_coeq_in C.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 690
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 691
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 692
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 693
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Tensor Product of Free Abelian Groups *)

</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 697
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition equiv_ab_tensor_prod_freeabgroup X Y
  : FreeAbGroup (X * Y) $&lt;~&gt; ab_tensor_prod (FreeAbGroup X) (FreeAbGroup Y).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 698
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 699
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  srefine (let f:=_ in let g:=_ in cate_adjointify f g _ _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 700
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 701
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply FreeAbGroup_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 701
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros [x y].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 702
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    exact (tensor (freeabgroup_in x) (freeabgroup_in y)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 703
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 704
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply ab_tensor_prod_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 704
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 705
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 705
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      snapply FreeAbGroup_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 706
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros y; revert x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 707
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold FreeAbGroup.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 708
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      snapply FreeAbGroup_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 709
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 710
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply abel_unit.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 711
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply freegroup_in.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 712
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (x, y).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 713
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 714
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y y'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 714
Time: 0.012s">
<div class="time" style="width: 14.634146341463%"></div>
<pre>
      snapply grp_homo_op.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 715
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 716
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x x'.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 716
Time: 0.008s">
<div class="time" style="width: 9.7560975609756%"></div>
<pre>
      rapply Abel_ind_hprop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 717
Time: 0.038s">
<div class="time" style="width: 46.341463414634%"></div>
<pre>
      snapply (FreeGroup_ind_homotopy _ (f' := sgop_hom _ _)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 718
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros y.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 719
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
      lhs napply FreeGroup_rec_beta.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 720
Time: 0.012s">
<div class="time" style="width: 14.634146341463%"></div>
<pre>
      lhs napply grp_homo_op.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 721
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
      snapply (ap011 (+) _^ _^).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 722
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
      1,2: napply FreeGroup_rec_beta.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 723
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 724
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre> snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 724
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 725
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
    change (f $o g $o grp_homo_tensor_l x $== grp_homo_tensor_l x).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 726
Time: 0.009s">
<div class="time" style="width: 10.975609756098%"></div>
<pre>
    rapply Abel_ind_hprop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 727
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change (@abel_in ?G) with (grp_homo_map (@abel_unit G)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 728
Time: 0.003s">
<div class="time" style="width: 3.6585365853659%"></div>
<pre>
    repeat change (cat_comp (A:=AbGroup) ?f ?g) with (cat_comp (A:=Group) f g).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 729
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
    change (forall y, grp_homo_map ?f (abel_unit y) = grp_homo_map ?g (abel_unit y))
      with (cat_comp (A:=Group) f abel_unit $== cat_comp (A:=Group) g abel_unit).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 731
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    rapply FreeGroup_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 732
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros y; revert x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 733
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
    change (f $o g $o grp_homo_tensor_r (freeabgroup_in y) $== grp_homo_tensor_r (freeabgroup_in y)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 734
Time: 0.008s">
<div class="time" style="width: 9.7560975609756%"></div>
<pre>
    rapply Abel_ind_hprop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 735
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    change (@abel_in ?G) with (grp_homo_map (@abel_unit G)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 736
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
    repeat change (cat_comp (A:=AbGroup) ?f ?g) with (cat_comp (A:=Group) f g).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 737
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
    change (forall y, grp_homo_map ?f (abel_unit y) = grp_homo_map ?g (abel_unit y))
      with (cat_comp (A:=Group) f abel_unit $== cat_comp (A:=Group) g abel_unit).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 739
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    rapply FreeGroup_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 740
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 741
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 742
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 743
Time: 0.009s">
<div class="time" style="width: 10.975609756098%"></div>
<pre> rapply Abel_ind_hprop.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 743
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre>
    change (GpdHom (A:=Hom(A:=Group) (FreeGroup (X * Y)) _)
      (cat_comp (A:=Group) (g $o f) (@abel_unit (FreeGroup (X * Y))))
      (@abel_unit (FreeGroup (X * Y)))).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 746
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    snapply FreeGroup_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 747
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 748
Time: 0.05s">
<div class="time" style="width: 60.975609756098%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 749
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Tensor products distribute over direct sums *)

</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 752
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>Definition ab_tensor_prod_dist_l {A B C : AbGroup}
  : ab_tensor_prod A (ab_biprod B C)
    $&lt;~&gt; ab_biprod (ab_tensor_prod A B) (ab_tensor_prod A C).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 754
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 755
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
  stapply (let f := _ in let g := _ in cate_adjointify f g _ _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 756
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 757
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply ab_tensor_prod_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 757
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 758
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a bc.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 758
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (tensor a (fst bc), tensor a (snd bc)).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 759
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 760
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a bc bc'; cbn beta.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 760
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
      snapply path_prod'; snapply tensor_dist_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 761
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 762
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a a' bc; cbn beta.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 762
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
      snapply path_prod; snapply tensor_dist_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 763
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 764
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> snapply ab_biprod_rec.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 764
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 765
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fmap01 ab_tensor_prod A ab_biprod_inl).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 765
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 766
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fmap01 ab_tensor_prod A ab_biprod_inr).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 766
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 767
Time: 0.033s">
<div class="time" style="width: 40.243902439024%"></div>
<pre> snapply ab_biprod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 767
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 768
Time: 0.017s">
<div class="time" style="width: 20.731707317073%"></div>
<pre> refine (cat_assoc _ _ _ $@ (_ $@L _) $@ _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 768
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre> 
      1: snapply ab_biprod_rec_beta_inl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 769
Time: 0.007s">
<div class="time" style="width: 8.5365853658537%"></div>
<pre>
      snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 770
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros a b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 771
Time: 0.013s">
<div class="time" style="width: 15.853658536585%"></div>
<pre>
      snapply path_prod; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 772
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 773
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 773
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 774
Time: 0.025s">
<div class="time" style="width: 30.487804878049%"></div>
<pre> snapply tensor_zero_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 774
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 775
Time: 0.014s">
<div class="time" style="width: 17.073170731707%"></div>
<pre> refine (cat_assoc _ _ _ $@ (_ $@L _) $@ _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 775
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
      1: snapply ab_biprod_rec_beta_inr.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 776
Time: 0.008s">
<div class="time" style="width: 9.7560975609756%"></div>
<pre>
      snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 777
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros a b.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 778
Time: 0.013s">
<div class="time" style="width: 15.853658536585%"></div>
<pre>
      snapply path_prod; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 779
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 780
Time: 0.006s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre> snapply tensor_zero_r.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 780
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 781
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 781
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 782
Time: 0.005s">
<div class="time" style="width: 6.0975609756098%"></div>
<pre> snapply ab_tensor_prod_ind_homotopy.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 782
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a [b c].</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 783
Time: 0.042s">
<div class="time" style="width: 51.219512195122%"></div>
<pre>
    lhs_V napply tensor_dist_l; simpl.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 784
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    snapply ap.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 785
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>
    symmetry; apply grp_prod_decompose.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 786
Time: 0.078s">
<div class="time" style="width: 95.121951219512%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 787
Time: 0.001s">
<div class="time" style="width: 1.219512195122%"></div>
<pre>

Definition ab_tensor_prod_dist_r {A B C : AbGroup}
  : ab_tensor_prod (ab_biprod A B) C
    $&lt;~&gt; ab_biprod (ab_tensor_prod A C) (ab_tensor_prod B C).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 791
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 792
Time: 0.002s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
  refine (emap11 ab_biprod (braide _ _) (braide _ _)
    $oE _ $oE braide _ _).</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 794
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  snapply ab_tensor_prod_dist_l.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 795
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: TensorProduct.v
Line: 797
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** TODO: Show that the category of abelian groups is symmetric closed and therefore we have adjoint pair with the tensor and internal hom. This should allow us to prove lemmas such as tensors distributing over coproducts. *)

</pre>
</div>
</body>
</html>

