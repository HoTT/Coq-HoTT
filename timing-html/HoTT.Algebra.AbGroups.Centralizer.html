<html>
<head>
<title>Centralizer.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Centralizer.v</h1>

<div class="code" title="File: Centralizer.v
Line: 1
Time: 0.062s">
<div class="time" style="width: 78.481012658228%"></div>
<pre>From HoTT Require Import Basics Types Truncations.Core.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 1
Time: 0.046s">
<div class="time" style="width: 58.227848101266%"></div>
<pre>
Require Import HFiber AbelianGroup.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Given a group [G], we define the centralizer of an element [g : G] as a subgroup and use this to show that the cyclic subgroup generated by [g] is abelian. *)

</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Open Scope mc_scope.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope mc_mult_scope.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* First we show that the collection of elements that commute with a fixed element [g] is a subgroup. *)

</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition centralizer {G : Group} (g : G)
  := fun h =&gt; g * h = h * g.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition centralizer_unit {G : Group} (g : G) : centralizer g mon_unit
  := grp_g1_1g _ _ idpath.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition centralizer_sgop {G : Group} (g h k : G)
           (p : centralizer g h) (q : centralizer g k)
  : centralizer g (h * k).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (grp_assoc _ _ _ @ _).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ap (fun x =&gt; x * k) p @ _).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine ((grp_assoc _ _ _)^ @ _).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ap (fun x =&gt; h * x) q @ _).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply grp_assoc.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition centralizer_inverse {G : Group} (g h : G)
           (p : centralizer g h)
  : centralizer g h^.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold centralizer in *.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 30
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  symmetry.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply grp_g1_1g.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ap ((_ * g) *.) (grp_inv_r h)^ @ _ @ ap (.* (g * _)) (grp_inv_l h)).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (grp_assoc _ _ _ @ _ @ (grp_assoc _ _ _)^).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (ap (.* h^) _).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine ((grp_assoc _ _ _)^ @ _ @ grp_assoc _ _ _).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (ap (h^ *.) p).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 37
Time: 0.002s">
<div class="time" style="width: 2.5316455696203%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Instance issubgroup_centralizer {G : Group} (g : G)
  : IsSubgroup (centralizer g).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 42
Time: 0.008s">
<div class="time" style="width: 10.126582278481%"></div>
<pre>
  srapply Build_IsSubgroup.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply centralizer_unit.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply centralizer_sgop.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply centralizer_inverse.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition centralizer_subgroup {G : Group} (g : G)
  := Build_Subgroup G (centralizer g) _.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Now we define cyclic subgroups.  We allow any map [Unit -&gt; G] in this definition, because in applications (such as [Z_commutative]) we have no control over the map. *)</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition cyclic_subgroup_from_unit {G : Group} (gen : Unit -&gt; G) := subgroup_generated (hfiber gen).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* When we have a particular element [g] of [G], we could choose the predicate to be [fun h =&gt; h = g], but to fit into the above definition, we use [unit_name g], which gives the predicate [fun h =&gt; hfiber (unit_name g) h]. *)</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition cyclic_subgroup {G : Group} (g : G) := cyclic_subgroup_from_unit (unit_name g).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Any cyclic subgroup is commutative. *)</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance commutative_cyclic_subgroup {G : Group} (gen : Unit -&gt; G)
  : Commutative (@group_sgop (cyclic_subgroup_from_unit gen)).</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros h k.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct h as [h H]; cbn in H.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  destruct k as [k K]; cbn in K.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 61
Time: 0.079s">
<div class="time" style="width: 100%"></div>
<pre>
  strip_truncations.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* It's enough to check equality after including into [G]: *)
 </pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 64
Time: 0.005s">
<div class="time" style="width: 6.3291139240506%"></div>
<pre>apply (equiv_ap_isembedding (subgroup_incl _) _ _)^-1.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>  cbn.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  induction H as [h [[] p]| |h1 h2 H1 H2 IHH1 IHH2].</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* The case when [h = g]: *)
   </pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>induction p.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    induction K as [k [[] q]| |k1 k2 K1 K2 IHK1 IHK2].</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* The case when k = g: *)
     </pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>induction q.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* The case when [k = mon_unit]: *)
     </pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>apply centralizer_unit.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* The case when [k = k1 (-k2)]: *)
     </pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>srapply (issubgroup_in_op_inv (H:=centralizer (gen tt))); assumption.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* The case when [h = mon_unit]: *)
   </pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>symmetry; apply centralizer_unit.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* The case when [h = h1 (-h2)]: *)
   </pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>symmetry.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 79
Time: 0.001s">
<div class="time" style="width: 1.2658227848101%"></div>
<pre>
    srapply (issubgroup_in_op_inv (H:=centralizer k)); unfold centralizer; symmetry; assumption.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 80
Time: 0.003s">
<div class="time" style="width: 3.7974683544304%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition abgroup_cyclic_subgroup {G : Group} (g : G) : AbGroup
  := Build_AbGroup (cyclic_subgroup g) _.</pre>
</div>
<div class="code" title="File: Centralizer.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

