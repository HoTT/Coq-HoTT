<html>
<head>
<title>SetoidRewrite.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for SetoidRewrite.v</h1>

<div class="code" title="File: SetoidRewrite.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** * Typeclass instances to allow rewriting in wild categories *)

(** This file uses the setoid rewriting machinery from the Coq standard library to allow rewriting in wild-categories.  Examples are given in test/WildCat/SetoidRewrite.v. *)

(** Init.Tactics contains the definition of the Coq stdlib typeclass_inferences database.  With Coq 8.x, it must be imported before Basics.Overture.  Otherwise, the typeclasses hintdb is cleared, breaking typeclass inference.  Because of this, this file also needs to be the first file Require'd in any file that uses it.  Moreover, if Foo Requires this file, then Foo must also be the first file Require'd in any file that Requires Foo, and so on.  Once we assume Rocq 9.0 as our minimum, these comments can be removed. *)

</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 6
Time: 0.021s">
<div class="time" style="width: 100%"></div>
<pre>#[warnings="-deprecated-from-Coq"]
From Coq Require Init.Tactics.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 7
Time: 0.007s">
<div class="time" style="width: 33.333333333333%"></div>
<pre>
From HoTT Require Import Basics.Overture Basics.Tactics.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 8
Time: 0.017s">
<div class="time" style="width: 80.952380952381%"></div>
<pre>
#[warnings="-deprecated-from-Coq"]
From Coq Require Setoids.Setoid.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Import CMorphisms.ProperNotations.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 11
Time: 0.011s">
<div class="time" style="width: 52.380952380952%"></div>
<pre>
From HoTT Require Import WildCat.Core.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

#[export] Instance reflexive_proper_proxy {A : Type}
  {R : Relation A} `(Reflexive A R) (x : A)
  : CMorphisms.ProperProxy R x := reflexivity x.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** forall (x y : A), x $== y -&gt; forall (a b : A), a $== b -&gt; y $== b -&gt; x $==a *)</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 18
Time: 0.001s">
<div class="time" style="width: 4.7619047619048%"></div>
<pre>#[export] Instance IsProper_GpdHom_from {A : Type} `{Is0Gpd A}
  : CMorphisms.Proper
      (GpdHom ==&gt;
         GpdHom ==&gt;
         CRelationClasses.flip CRelationClasses.arrow) GpdHom.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* Add the next line to the start of any proof to see what it means: *)
 </pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>unfold "==&gt;", CMorphisms.Proper, CRelationClasses.arrow, CRelationClasses.flip in *.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x y eq_xy a b eq_ab eq_yb.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (transitivity eq_xy (transitivity eq_yb
                              (symmetry _ _ eq_ab))).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* We could also just write:
    exact (eq_xy $@ eq_yb $@ eq_ab^$).
  The advantage of the above proof is that it works for other transitive and symmetric relations. *)</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Defined.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** forall (x y : A), x $== y -&gt; forall (a b : A), a $== b -&gt; x $== a -&gt; y $== b *)</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 33
Time: 0.001s">
<div class="time" style="width: 4.7619047619048%"></div>
<pre>#[export] Instance IsProper_GpdHom_to {A : Type} `{Is0Gpd A}
  : CMorphisms.Proper
      (GpdHom ==&gt;
         GpdHom ==&gt;
         CRelationClasses.arrow) GpdHom.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x y eq_xy a b eq_ab eq_xa.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (transitivity _ eq_ab).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (transitivity _ eq_xa).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (symmetry _ _ eq_xy).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** forall a x y : A, x $== y -&gt; a $== x -&gt; a $== y *)</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>#[export] Instance IsProper_GpdHom_to_a {A : Type} `{Is0Gpd A}
  {a : A}
  : CMorphisms.Proper
      (GpdHom ==&gt;
         CRelationClasses.arrow) (GpdHom a).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x y eq_xy eq_ax.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  by transitivity x.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** forall a x y : A, x $== y -&gt; a $== y -&gt; a $== x *)</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>#[export] Instance IsProper_GpdHom_from_a {A : Type} `{Is0Gpd A}
  {a : A}
  : CMorphisms.Proper
      (GpdHom ==&gt;
         CRelationClasses.flip CRelationClasses.arrow) (GpdHom a).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x y eq_xy eq_ay.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (transitivity eq_ay (symmetry _ _ eq_xy)).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Open Scope signatureT_scope.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** If [R] is symmetric and [R x y -&gt; R' (f x) (f y)], then [R y x -&gt; R' (f x) (f y)]. *)</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>#[export] Instance symmetry_flip {A B : Type} {f : A -&gt; B}
  {R : Relation A} {R' : Relation B} `{Symmetric _ R}
  (H0 : CMorphisms.Proper (R ++&gt; R') f)
  : CMorphisms.Proper (R --&gt; R') f.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros a b Rba; unfold CRelationClasses.flip in Rba.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply H0.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact Rba.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** If [R'] is symmetric and [R x y -&gt; R' x' y' -&gt; R'' (f x x') (f y y')], then [R x y -&gt; R' y' x' -&gt; R'' (f x x') (f y y')]. *)</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 76
Time: 0.001s">
<div class="time" style="width: 4.7619047619048%"></div>
<pre>#[export] Instance symmetric_flip_snd {A B C : Type} {R : Relation A}
  {R' : Relation B} {R'' : Relation C} `{Symmetric _ R'}
  (f : A -&gt; B -&gt; C) (H1 : CMorphisms.Proper (R ++&gt; R' ++&gt; R'') f)
  : CMorphisms.Proper (R ++&gt; R' --&gt; R'') f.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros a b Rab x y R'yx.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply H1; [ assumption | symmetry; assumption ].</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 82
Time: 0.004s">
<div class="time" style="width: 19.047619047619%"></div>
<pre>

#[export] Instance IsProper_fmap {A B : Type}
  (F : A -&gt; B) `{Is1Functor _ _ F} (a b : A)
  : CMorphisms.Proper (GpdHom ==&gt; GpdHom) (@fmap _ _ _ _ F _ a b)
  := fun _ _ =&gt; fmap2 F.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 87
Time: 0.002s">
<div class="time" style="width: 9.5238095238095%"></div>
<pre>

#[export] Instance IsProper_catcomp_g {A : Type} `{Is1Cat A}
  {a b c : A} (g : b $-&gt; c)
  : CMorphisms.Proper (GpdHom ==&gt; GpdHom) (@cat_comp _ _ _ a b c g)
  := fun _ _ =&gt; cat_postwhisker g.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 92
Time: 0.002s">
<div class="time" style="width: 9.5238095238095%"></div>
<pre>

#[export] Instance IsProper_catcomp {A : Type} `{Is1Cat A}
  {a b c : A}
  : CMorphisms.Proper (GpdHom ==&gt; GpdHom ==&gt; GpdHom)
      (@cat_comp _ _ _ a b c).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros g1 g2 eq_g f1 f2 eq_f.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (cat_comp2 eq_f eq_g).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 101
Time: 0.001s">
<div class="time" style="width: 4.7619047619048%"></div>
<pre>

#[export] Instance gpd_hom_to_hom_proper {A B : Type} `{Is0Gpd A}
  {R : Relation B} (F : A -&gt; B)
  {H2 : CMorphisms.Proper (GpdHom ==&gt; R) F}
  : CMorphisms.Proper (Hom ==&gt; R) F.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros a b eq_ab; apply H2; exact eq_ab.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 109
Time: 0.001s">
<div class="time" style="width: 4.7619047619048%"></div>
<pre>

#[export] Instance IsProper_Hom {A : Type} `{Is0Gpd A}
  : CMorphisms.Proper
      (Hom ==&gt; Hom ==&gt; CRelationClasses.arrow) Hom.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x y eq_xy a b eq_ab f.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (transitivity _ eq_ab).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (transitivity _ f).</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  symmetry; exact eq_xy.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 119
Time: 0.001s">
<div class="time" style="width: 4.7619047619048%"></div>
<pre>

#[export] Instance transitive_hom {A : Type} `{Is01Cat A} {x : A}
  : CMorphisms.Proper
      (Hom ==&gt; CRelationClasses.arrow) (Hom x)
  := fun y z =&gt; cat_comp.</pre>
</div>
<div class="code" title="File: SetoidRewrite.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

